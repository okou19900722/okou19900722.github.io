{"pageProps":{"categories":["releases","guides","news"],"page":7,"posts":[{"filename":"blog/2018-04-09-eclipse-vert-x-metrics-now-with-micrometer-io.mdx","date":"2018-04-09","slug":"eclipse-vert-x-metrics-now-with-micrometer-io","meta":{"title":"Eclipse Vert.x metrics now with Micrometer.io","category":"guides","authors":[{"name":"Joel Takvorian","github_id":"jotak"}],"summary":"The new vertx-micrometer-metrics module provides support for collecting metrics with Micrometer.io and storing them in backends such as Graphite or InfluxDB."},"readingTime":{"text":"8 min read","minutes":7.405,"time":444300,"words":1481},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Vert.x has al\\xADready been pro\\xADvid\\xADing met\\xADrics for some time, through the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://vertx.io/docs/vertx-dropwizard-metrics/java/\"\n  }), \"vertx-\\u200Bdropwizard-metrics\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://vertx.io/docs/vertx-hawkular-metrics/java/\"\n  }), \"vertx-\\u200Bhawkular-metrics\"), \" mod\\xADules. Both of them im\\xADple\\xADment a ser\\xADvice provider in\\xADter\\xADface (SPI) to col\\xADlect the Vert.x met\\xADrics and make them avail\\xADable to their re\\xADspec\\xADtive back\\xADends.\"), mdx(\"p\", null, \"A new mod\\xADule, \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://vertx.io/docs/vertx-micrometer-metrics/java/\"\n  }), \"vertx-\\u200Bmicrometer-metrics\"), \", is now added to the fam\\xADily. It im\\xADple\\xADments the same SPI, which means that it is able to pro\\xADvide the same met\\xADrics.\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://micrometer.io/\"\n  }), mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Mi\\xADcrom\\xADe\\xADter.io\")), \" is a pretty new met\\xADrics li\\xADbrary, quite com\\xADpa\\xADra\\xADble to \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"drop\\xADwiz\\xADard met\\xADrics\"), \" in that it col\\xADlects met\\xADrics in a local, in-\\u200Bmemory reg\\xADistry and is able to store them in var\\xADi\\xADous back\\xADends such as \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Graphite\"), \" or \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"In\\xADfluxDB\"), \". It has sev\\xADeral ad\\xADvan\\xADtages as we will see below.\"), mdx(\"h2\", {\n    \"id\": \"tell-me-more-about-micrometer\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#tell-me-more-about-micrometer\"\n  })), \"Tell me more about Micrometer\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://micrometer.io/\"\n  }), mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Mi\\xADcrom\\xADe\\xADter.io\")), \" de\\xADscribes it\\xADself as a a vendor-\\u200Bneutral ap\\xADpli\\xADca\\xADtion met\\xADrics fa\\xADcade.\\nIt pro\\xADvides a well de\\xADsigned API, in Java, to de\\xADfine \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"gauges\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"coun\\xADters\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"timers\"), \" and \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"dis\\xADtri\\xADb\\xADu\\xADtion sum\\xADmaries\"), \".\"), mdx(\"p\", null, \"Among the avail\\xADable back\\xADends, Mi\\xADcrom\\xADe\\xADter na\\xADtively sup\\xADports \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Graphite\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"In\\xADfluxDB\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"JMX\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Prometheus\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://micrometer.io/docs\"\n  }), \"sev\\xADeral oth\\xADers\"), \". Prometheus is very pop\\xADu\\xADlar in the Ku\\xADber\\xADnetes and mi\\xADcroser\\xADvices ecosys\\xADtems, so its sup\\xADport by Mi\\xADcrom\\xADe\\xADter was a strong mo\\xADti\\xADva\\xADtion for im\\xADple\\xADment\\xADing it in Vert.x.\"), mdx(\"p\", null, \"For the the mo\\xADment, our im\\xADple\\xADmen\\xADta\\xADtion in Vert.x sup\\xADports \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Prometheus\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"In\\xADfluxDB\"), \" and \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"JMX\"), \". More should quickly come in the near fu\\xADture.\"), mdx(\"h3\", {\n    \"id\": \"dimensionality\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#dimensionality\"\n  })), \"Dimensionality\"), mdx(\"p\", null, \"An\\xADother in\\xADter\\xADest\\xADing as\\xADpect in Mi\\xADcrom\\xADe\\xADter is that it han\\xADdles met\\xADrics \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"di\\xADmen\\xADsion\\xADal\\xADity\"), \": met\\xADrics can be as\\xADso\\xADci\\xADated with a set of key/value pairs (some\\xADtimes ref\\xADered as \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"tags\"), \", some\\xADtimes as \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"la\\xADbels\"), \"). Every value brings a new di\\xADmen\\xADsion to the met\\xADric, so that in Prometheus or any other back\\xADend that sup\\xADports di\\xADmen\\xADsion\\xADal\\xADity, we can query for dat\\xADa\\xADpoints of one or sev\\xADeral di\\xADmen\\xADsions, or query for dat\\xADa\\xADpoints ag\\xADgre\\xADgated over sev\\xADeral di\\xADmen\\xADsions.\"), mdx(\"p\", null, \"  \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Ex\\xADam\\xADple: our met\\xADric \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"vertx_http_server_connections\"), \" ac\\xADcepts la\\xADbels \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"local\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"remote\"), \", that are used to store ad\\xADdresses on HTTP con\\xADnec\\xADtions\")), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"Prometheus is used in the fol\\xADlow\\xADing ex\\xADam\\xADples, but equiv\\xADa\\xADlent queries can be per\\xADformed with \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"In\\xADfluxDB\"), \".\")), mdx(\"p\", null, \"In Prometheus, the query \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_http_server_connections\"), \" will re\\xADturn as many time\\xADseries as there are com\\xADbi\\xADna\\xADtions of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"local\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"remote\"), \" val\\xADues. Ex\\xADam\\xADple:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-basic\"\n  }), \"vertx_http_server_connections{local=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"0.0.0.0:8080\\\"\"), \",\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"remote=\\\"1.1.1.1\\\"}\"), \"\\nvertx_http_server_connections{local=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"0.0.0.0:8080\\\"\"), \",\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"remote=\\\"2.2.2.2\\\"}\"), \"\\nvertx_http_server_connections{local=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"0.0.0.0:8080\\\"\"), \",\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"remote=\\\"3.3.3.3\\\"}\"), \"\\n\")), mdx(\"p\", null, \"To query on a sin\\xADgle di\\xADmen\\xADsion, we must pro\\xADvide the la\\xADbels:\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_http_server_connections{local=\\\"0.0.0.0:8080\\\",remote=\\\"1.1.1.1\\\"}\"), \". It will re\\xADturn a sin\\xADgle time\\xADseries.\"), mdx(\"p\", null, \"To get an ag\\xADgre\\xADgate, Prometheus (PromQL) pro\\xADvides sev\\xADeral \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators\"\n  }), \"ag\\xADgre\\xADga\\xADtion op\\xADer\\xADa\\xADtors\"), \":\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sum(vertx_http_server_connections)\"), \" will re\\xADturn the sum across all di\\xADmen\\xADsions.\"), mdx(\"h2\", {\n    \"id\": \"so-what-are-the-vertx-metrics\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#so-what-are-the-vertx-metrics\"\n  })), \"So what are the Vert.x metrics?\"), mdx(\"p\", null, \"Peo\\xADple al\\xADready fa\\xADmil\\xADiar with the ex\\xADist\\xADing met\\xADrics mod\\xADules (\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"drop\\xADwiz\\xADard\"), \" or \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"hawku\\xADlar\"), \") will not be too dis\\xADori\\xADented. They are roughly the same. The main dif\\xADfer\\xADence is where pre\\xADvi\\xADously, some met\\xADric names could have a vari\\xADable part within - such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.eventbus.handlers.myaddress\"), \" - here we take ad\\xADvan\\xADtage of di\\xADmen\\xADsion\\xADal\\xADity and we will have \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_eventbus_handlers{address=\\\"myaddress\\\"}\"), \".\"), mdx(\"p\", null, \"Some other met\\xADrics are no longer use\\xADful, for in\\xADstance the drop\\xADwiz\\xADard\\u2019s \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.eventbus.messages.pending\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.eventbus.messages.pending-local\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.eventbus.messages.pending-remote\"), \" are now just \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_eventbus_pending{side=local}\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_eventbus_pending{side=remote}\"), \" in mi\\xADcrom\\xADe\\xADter. The sum of them can eas\\xADily be com\\xADputed at query time.\"), mdx(\"p\", null, \"The met\\xADrics pro\\xADvided by Vert.x are dis\\xADpatched into eight big fam\\xADi\\xADlies:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Net client\"), \": dis\\xADtri\\xADb\\xADu\\xADtion sum\\xADmaries of bytes sent and re\\xADceived, num\\xADber of con\\xADnec\\xADtions, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Net server\"), \": dis\\xADtri\\xADb\\xADu\\xADtion sum\\xADmaries of bytes sent and re\\xADceived, num\\xADber of con\\xADnec\\xADtions, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"HTTP client\"), \": counter of re\\xADquests, re\\xADsponse times, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"HTTP server\"), \": counter of re\\xADquests, pro\\xADcess\\xADing times, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Event bus\"), \": counter of han\\xADdlers, mes\\xADsages sent and re\\xADceived, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Pool\"), \": for worker pools and some data\\xADsource pools, queue size and wait\\xADing time, pro\\xADcess\\xADing time, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Ver\\xADti\\xADcles\"), \": num\\xADber of ver\\xADti\\xADcles de\\xADployed.\")), mdx(\"p\", null, \"The full list of col\\xADlected met\\xADrics is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://vertx.io/docs/vertx-micrometer-metrics/java/#_vert_x_core_tools_metrics\"\n  }), \"avail\\xADable here\"), \".\"), mdx(\"h2\", {\n    \"id\": \"getting-started\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#getting-started\"\n  })), \"Getting started\"), mdx(\"p\", null, \"This sec\\xADtion will guide you through a quick setup to run a Vert.x ap\\xADpli\\xADca\\xADtion with Mi\\xADcrom\\xADe\\xADter. The code ex\\xADam\\xADples used here are taken from the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"micrometer-metrics-example\"), \" in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-examples\"), \" repos\\xADi\\xADtory, in Java, using \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"maven\"), \". But the same could be done with other Vert.x sup\\xADported lan\\xADguages, as well as \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"gra\\xADdle\"), \" in\\xADstead of \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"maven\"), \".\"), mdx(\"h3\", {\n    \"id\": \"maven-configuration\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#maven-configuration\"\n  })), \"Maven configuration\"), mdx(\"p\", null, \"The con\\xADfig\\xADu\\xADra\\xADtion and the maven im\\xADports will vary ac\\xADcord\\xADing to the back\\xADend stor\\xADage that will be used. For maven, the com\\xADmon part is al\\xADways:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"io.vertx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"vertx-micrometer-metrics\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"3.5.1\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Then, to re\\xADport to In\\xADfluxDB:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"io.micrometer\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"micrometer-registry-influx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"1.0.0\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Or Prometheus:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"io.micrometer\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"micrometer-registry-prometheus\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"1.0.0\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"io.vertx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"vertx-web\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"3.5.1\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n\")), mdx(\"p\", null, \"Re\\xADmark that, since Prometheus pulls met\\xADrics from their source, they must be ex\\xADposed on an HTTP end\\xADpoint. That\\u2019s why \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-web\"), \" is im\\xADported here. It is not \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"ab\\xADsolutely\"), \" nec\\xADes\\xADsary (it\\u2019s pos\\xADsi\\xADble to get the met\\xADrics reg\\xADistry con\\xADtent and ex\\xADpose it in any other way) but it\\u2019s prob\\xADa\\xADbly the eas\\xADi\\xADest way to do.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Or JMX:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"io.micrometer\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"micrometer-registry-jmx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \">\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"<\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"1.0.0\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \">\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"</\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \">\"), \"\\n\")), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"At the mo\\xADment, it is not pos\\xADsi\\xADble to re\\xADport met\\xADrics to sev\\xADeral back\\xADends at the same time. \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16\"\n  }), \"It might be soon im\\xADple\\xADmented\"), \".\")), mdx(\"h3\", {\n    \"id\": \"setting-up-vertx-options\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#setting-up-vertx-options\"\n  })), \"Setting up Vert.x options\"), mdx(\"p\", null, \"A \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MicrometerMetricsOptions\"), \" ob\\xADject must be cre\\xADated and passed to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"VertxOptions\"), \", with one back\\xADend con\\xADfig\\xADured (though hav\\xADing no back\\xADend is pos\\xADsi\\xADble: you would get met\\xADrics sent to a de\\xADfault Mi\\xADcrom\\xADe\\xADter reg\\xADistry, but with\\xADout any per\\xADsis\\xADtent stor\\xADage).\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In\\xADfluxDB ex\\xADam\\xADple:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Default InfluxDB options will push metrics to localhost:8086, db \\\"default\\\"\"), \"\\nMicrometerMetricsOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" MicrometerMetricsOptions()\\n  .setInfluxDbOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxInfluxDbOptions().setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \"))\\n  .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \");\\nVertx vertx = Vertx.vertx(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxOptions().setMetricsOptions(options));\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Then deploy verticles with this vertx instance\"), \"\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Prometheus ex\\xADam\\xADple:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Deploy with embedded server: prometheus metrics will be automatically exposed,\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// independently from any other HTTP server defined\"), \"\\nMicrometerMetricsOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" MicrometerMetricsOptions()\\n  .setPrometheusOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxPrometheusOptions()\\n    .setStartEmbeddedServer(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \")\\n    .setEmbeddedServerOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" HttpServerOptions().setPort(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8081\"), \"))\\n    .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \"))\\n  .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \");\\nVertx vertx = Vertx.vertx(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxOptions().setMetricsOptions(options));\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Then deploy verticles with this vertx instance\"), \"\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Or Prometheus with the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"/metrics\"), \" end\\xADpoint bound to an ex\\xADist\\xADing HTTP server:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Deploy without embedded server: we need to \\\"manually\\\" expose the prometheus metrics\"), \"\\nMicrometerMetricsOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" MicrometerMetricsOptions()\\n  .setPrometheusOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxPrometheusOptions().setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \"))\\n  .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \");\\nVertx vertx = Vertx.vertx(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxOptions().setMetricsOptions(options));\\n\\nRouter router = Router.router(vertx);\\nPrometheusMeterRegistry registry = (PrometheusMeterRegistry) BackendRegistries.getDefaultNow();\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Setup a route for metrics\"), \"\\nrouter.route(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"/metrics\\\"\"), \").handler(ctx -> {\\n  String response = registry.scrape();\\n  ctx.response().end(response);\\n});\\nvertx.createHttpServer().requestHandler(router::accept).listen(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8080\"), \");\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"JMX ex\\xADam\\xADple:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Default JMX options will publish MBeans under domain \\\"metrics\\\"\"), \"\\nMicrometerMetricsOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" MicrometerMetricsOptions()\\n  .setJmxMetricsOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxJmxMetricsOptions().setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \"))\\n  .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \");\\nVertx vertx = Vertx.vertx(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxOptions().setMetricsOptions(options));\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Then deploy verticles with this vertx instance\"), \"\\n\")), mdx(\"h3\", {\n    \"id\": \"setup-the-backend-server\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#setup-the-backend-server\"\n  })), \"Setup the backend server\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://www.influxdata.com/\"\n  }), \"In\\xADfluxDB\"), \", by de\\xADfault, is ex\\xADpected to run on \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"localhost:8086\"), \" with\\xADout au\\xADthen\\xADti\\xADca\\xADtion, data\\xADbase \\u201Cde\\xADfault\\u201D. It is con\\xADfig\\xADurable in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"VertxInfluxDbOptions\"), \".\\nIf you don\\u2019t have a run\\xADning in\\xADstance of In\\xADfluxDB, the short\\xADest way to start is cer\\xADtainly with docker, just run:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"docker run -p 8086:8086 influxdb\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://prometheus.io/docs/prometheus/latest/getting_started/\"\n  }), \"Prometheus\"), \" needs some con\\xADfig\\xADu\\xADra\\xADtion since it pulls met\\xADrics from the sources. Once it is in\\xADstalled, con\\xADfig\\xADure the scrape end\\xADpoints in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"prometheus.yml\"), \":\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-yaml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"job_name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'vertx-8081'\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"static_configs:\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"targets:\"), \" [\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'localhost:8081'\"), \"]\\n\")), mdx(\"p\", null, \"or, when using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/metrics\"), \" end\\xADpoint bound to an ex\\xADist\\xADing HTTP server:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-yaml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"job_name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'vertx-8080'\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"static_configs:\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"targets:\"), \" [\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'localhost:8080'\"), \"]\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"For JMX there is noth\\xADing spe\\xADcial to con\\xADfig\\xADure.\")), mdx(\"h3\", {\n    \"id\": \"collecting-vertx-metrics\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#collecting-vertx-metrics\"\n  })), \"Collecting Vert.x metrics\"), mdx(\"p\", null, \"From now on, all Vert.x met\\xADrics will be col\\xADlected and sent to the con\\xADfig\\xADured back\\xADend. In our Vert.x ex\\xADam\\xADple, we setup an HTTP server met\\xADrics:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"Router router = Router.router(vertx);\\nrouter.get(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"/\\\"\"), \").handler(ctx -> {\\n  ctx.response().end(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Hello Micrometer from HTTP!\\\"\"), \");\\n});\\nvertx.createHttpServer().requestHandler(router::accept).listen(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8080\"), \");\\n\")), mdx(\"p\", null, \" And some event bus ping-\\u200Bpong:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Producer side\"), \"\\nvertx.setPeriodic(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"1000\"), \", x -> {\\n  vertx.eventBus().send(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"greeting\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Hello Micrometer from event bus!\\\"\"), \");\\n});\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Consumer side\"), \"\\nvertx.eventBus().<String>consumer(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"greeting\\\"\"), \", message -> {\\n  String greeting = message.body();\\n  System.out.println(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Received: \\\"\"), \" + greeting);\\n  message.reply(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Hello back!\\\"\"), \");\\n});\\n\")), mdx(\"p\", null, \"To trig\\xADger some ac\\xADtiv\\xADity on the HTTP server, we can write a small bash script:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"while\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-literal\"\n  }), \"true\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"do\"), \" curl http://localhost:8080/\\n    sleep .8\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"done\"), \"\\n\")), mdx(\"h3\", {\n    \"id\": \"viewing-the-results\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#viewing-the-results\"\n  })), \"Viewing the results\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://grafana.com/\"\n  }), \"Grafana\"), \" can be used to dis\\xADplay the In\\xADfluxDB and Prometheus met\\xADrics. The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-examples\"), \" repos\\xADi\\xADtory con\\xADtains two dash\\xADboards for that: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-InfluxDB.json\"\n  }), \"for In\\xADfluxDB\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-Prometheus.json\"\n  }), \"for Prometheus\"), \".\"), mdx(\"h5\", {\n    \"id\": \"http-server-metrics\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h5\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#http-server-metrics\"\n  })), \"HTTP server metrics\"), mdx(\"img\", {\n    alt: \"HTTP server metrics\",\n    className: \"img-fluid\",\n    src: \"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/http-server-metrics.png\"\n  }), mdx(\"h5\", {\n    \"id\": \"event-bus-metrics\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h5\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#event-bus-metrics\"\n  })), \"Event bus metrics\"), mdx(\"img\", {\n    alt: \"Event bus metrics\",\n    className: \"img-fluid\",\n    src: \"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/eventbus-metrics.png\"\n  }), mdx(\"h2\", {\n    \"id\": \"going-further\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#going-further\"\n  })), \"Going further\"), mdx(\"p\", null, \"We\\u2019ve seen the basic setup. There is a good bunch of op\\xADtions avail\\xADable, de\\xADtailed \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://vertx.io/docs/vertx-micrometer-metrics/java/\"\n  }), \"in the doc\\xADu\\xADmen\\xADta\\xADtion\"), \": how to dis\\xADable some met\\xADrics do\\xADmains, how to fil\\xADter or re\\xADarrange la\\xADbels, how to ex\\xADport met\\xADrics snap\\xADshots to Json ob\\xADjects, how to add JVM or proces\\xADsor in\\xADstru\\xADmen\\xADta\\xADtion, etc.\"), mdx(\"p\", null, \"Be\\xADfore we fin\\xADish, there is one im\\xADpor\\xADtant point that we can cover here: defin\\xADing cus\\xADtom met\\xADrics.\\nBe\\xADcause the mod\\xADule gives you ac\\xADcess to its Mi\\xADcrom\\xADe\\xADter reg\\xADistry, you can add your cus\\xADtom met\\xADrics there.\"), mdx(\"p\", null, \"Get\\xADting the de\\xADfault reg\\xADistry is straight\\xADfor\\xADward:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"MeterRegistry registry = BackendRegistries.getDefaultNow();\\n\")), mdx(\"p\", null, \"Then you have plain ac\\xADcess to the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://micrometer.io/docs/concepts\"\n  }), \"Mi\\xADcrom\\xADe\\xADter API\"), \".\"), mdx(\"p\", null, \"For in\\xADstance, here is how you can track the ex\\xADe\\xADcu\\xADtion time of a piece of code that is reg\\xADu\\xADlarly called:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"MeterRegistry registry = BackendRegistries.getDefaultNow();\\nTimer timer = Timer\\n  .builder(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"my.timer\\\"\"), \")\\n  .description(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Time tracker for my extremely sophisticated algorithm\\\"\"), \")\\n  .register(registry);\\n\\nvertx.setPeriodic(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"1000\"), \", l -> {\\n  timer.record(() -> myExtremelySophisticatedAlgorithm());\\n});\\n\")), mdx(\"p\", null, \"Since it is using the same reg\\xADistry, there is no extra back\\xADend con\\xADfig\\xADu\\xADra\\xADtion to do.\"), mdx(\"h2\", {\n    \"id\": \"whats-next\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#whats-next\"\n  })), \"What\\u2019s next?\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-micrometer-metrics\"), \" mod\\xADule will con\\xADtinue to be im\\xADproved, with al\\xADready two planned en\\xADhance\\xADments:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-micrometer-metrics/issues/15\"\n  }), \"Adding more back\\xADends\"), \", like Graphite.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16\"\n  }), \"Allow to con\\xADfig\\xADure sev\\xADeral back\\xADends\"), \", and not only one at the same time.\")), mdx(\"p\", null, \"Would you miss any fea\\xADture, please \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-micrometer-metrics/issues\"\n  }), \"ask on GitHub\"), \". Con\\xADtri\\xADbu\\xADtions and bug fixes are also wel\\xADcome!\"), mdx(\"p\", null, \"Now is time to enter the Met\\xADrics.\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"<p>Vert.x has al­ready been pro­vid­ing met­rics for some time, through the <a href=\"https://vertx.io/docs/vertx-dropwizard-metrics/java/\">vertx-​dropwizard-metrics</a> and <a href=\"https://vertx.io/docs/vertx-hawkular-metrics/java/\">vertx-​hawkular-metrics</a> mod­ules. Both of them im­ple­ment a ser­vice provider in­ter­face (SPI) to col­lect the Vert.x met­rics and make them avail­able to their re­spec­tive back­ends.</p><p>A new mod­ule, <a href=\"https://vertx.io/docs/vertx-micrometer-metrics/java/\">vertx-​micrometer-metrics</a>, is now added to the fam­ily. It im­ple­ments the same SPI, which means that it is able to pro­vide the same met­rics.\n<a href=\"http://micrometer.io/\"><em>Mi­crom­e­ter.io</em></a> is a pretty new met­rics li­brary, quite com­pa­ra­ble to <em>drop­wiz­ard met­rics</em> in that it col­lects met­rics in a local, in-​memory reg­istry and is able to store them in var­i­ous back­ends such as <em>Graphite</em> or <em>In­fluxDB</em>. It has sev­eral ad­van­tages as we will see below.</p><h2 id=\"tell-me-more-about-micrometer\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#tell-me-more-about-micrometer\"></a>Tell me more about Micrometer</h2><p><a href=\"http://micrometer.io/\"><em>Mi­crom­e­ter.io</em></a> de­scribes it­self as a a vendor-​neutral ap­pli­ca­tion met­rics fa­cade.\nIt pro­vides a well de­signed API, in Java, to de­fine <em>gauges</em>, <em>coun­ters</em>, <em>timers</em> and <em>dis­tri­b­u­tion sum­maries</em>.</p><p>Among the avail­able back­ends, Mi­crom­e­ter na­tively sup­ports <em>Graphite</em>, <em>In­fluxDB</em>, <em>JMX</em>, <em>Prometheus</em> and <a href=\"http://micrometer.io/docs\">sev­eral oth­ers</a>. Prometheus is very pop­u­lar in the Ku­ber­netes and mi­croser­vices ecosys­tems, so its sup­port by Mi­crom­e­ter was a strong mo­ti­va­tion for im­ple­ment­ing it in Vert.x.</p><p>For the the mo­ment, our im­ple­men­ta­tion in Vert.x sup­ports <em>Prometheus</em>, <em>In­fluxDB</em> and <em>JMX</em>. More should quickly come in the near fu­ture.</p><h3 id=\"dimensionality\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#dimensionality\"></a>Dimensionality</h3><p>An­other in­ter­est­ing as­pect in Mi­crom­e­ter is that it han­dles met­rics <em>di­men­sion­al­ity</em>: met­rics can be as­so­ci­ated with a set of key/value pairs (some­times ref­ered as <em>tags</em>, some­times as <em>la­bels</em>). Every value brings a new di­men­sion to the met­ric, so that in Prometheus or any other back­end that sup­ports di­men­sion­al­ity, we can query for dat­a­points of one or sev­eral di­men­sions, or query for dat­a­points ag­gre­gated over sev­eral di­men­sions.</p><p>  <em>Ex­am­ple: our met­ric <code>vertx_http_server_connections</code> ac­cepts la­bels <code>local</code> and <code>remote</code>, that are used to store ad­dresses on HTTP con­nec­tions</em></p><div class=\"alert info\"><p>Prometheus is used in the fol­low­ing ex­am­ples, but equiv­a­lent queries can be per­formed with <em>In­fluxDB</em>.</p></div><p>In Prometheus, the query <code>vertx_http_server_connections</code> will re­turn as many time­series as there are com­bi­na­tions of <code>local</code> and <code>remote</code> val­ues. Ex­am­ple:</p><pre><code class=\"hljs language-basic\">vertx_http_server_connections{local=<span class=\"hljs-string\">&quot;0.0.0.0:8080&quot;</span>,<span class=\"hljs-comment\">remote=&quot;1.1.1.1&quot;}</span>\nvertx_http_server_connections{local=<span class=\"hljs-string\">&quot;0.0.0.0:8080&quot;</span>,<span class=\"hljs-comment\">remote=&quot;2.2.2.2&quot;}</span>\nvertx_http_server_connections{local=<span class=\"hljs-string\">&quot;0.0.0.0:8080&quot;</span>,<span class=\"hljs-comment\">remote=&quot;3.3.3.3&quot;}</span>\n</code></pre><p>To query on a sin­gle di­men­sion, we must pro­vide the la­bels:</p><p><code>vertx_http_server_connections{local=&quot;0.0.0.0:8080&quot;,remote=&quot;1.1.1.1&quot;}</code>. It will re­turn a sin­gle time­series.</p><p>To get an ag­gre­gate, Prometheus (PromQL) pro­vides sev­eral <a href=\"https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators\">ag­gre­ga­tion op­er­a­tors</a>:</p><p><code>sum(vertx_http_server_connections)</code> will re­turn the sum across all di­men­sions.</p><h2 id=\"so-what-are-the-vertx-metrics\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#so-what-are-the-vertx-metrics\"></a>So what are the Vert.x metrics?</h2><p>Peo­ple al­ready fa­mil­iar with the ex­ist­ing met­rics mod­ules (<em>drop­wiz­ard</em> or <em>hawku­lar</em>) will not be too dis­ori­ented. They are roughly the same. The main dif­fer­ence is where pre­vi­ously, some met­ric names could have a vari­able part within - such as <code>vertx.eventbus.handlers.myaddress</code> - here we take ad­van­tage of di­men­sion­al­ity and we will have <code>vertx_eventbus_handlers{address=&quot;myaddress&quot;}</code>.</p><p>Some other met­rics are no longer use­ful, for in­stance the drop­wiz­ard’s <code>vertx.eventbus.messages.pending</code>, <code>vertx.eventbus.messages.pending-local</code> and <code>vertx.eventbus.messages.pending-remote</code> are now just <code>vertx_eventbus_pending{side=local}</code> and <code>vertx_eventbus_pending{side=remote}</code> in mi­crom­e­ter. The sum of them can eas­ily be com­puted at query time.</p><p>The met­rics pro­vided by Vert.x are dis­patched into eight big fam­i­lies:</p><ul><li><strong>Net client</strong>: dis­tri­b­u­tion sum­maries of bytes sent and re­ceived, num­ber of con­nec­tions, etc.</li><li><strong>Net server</strong>: dis­tri­b­u­tion sum­maries of bytes sent and re­ceived, num­ber of con­nec­tions, etc.</li><li><strong>HTTP client</strong>: counter of re­quests, re­sponse times, etc.</li><li><strong>HTTP server</strong>: counter of re­quests, pro­cess­ing times, etc.</li><li><strong>Event bus</strong>: counter of han­dlers, mes­sages sent and re­ceived, etc.</li><li><strong>Pool</strong>: for worker pools and some data­source pools, queue size and wait­ing time, pro­cess­ing time, etc.</li><li><strong>Ver­ti­cles</strong>: num­ber of ver­ti­cles de­ployed.</li></ul><p>The full list of col­lected met­rics is <a href=\"https://vertx.io/docs/vertx-micrometer-metrics/java/#_vert_x_core_tools_metrics\">avail­able here</a>.</p><h2 id=\"getting-started\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#getting-started\"></a>Getting started</h2><p>This sec­tion will guide you through a quick setup to run a Vert.x ap­pli­ca­tion with Mi­crom­e­ter. The code ex­am­ples used here are taken from the <code>micrometer-metrics-example</code> in <code>vertx-examples</code> repos­i­tory, in Java, using <em>maven</em>. But the same could be done with other Vert.x sup­ported lan­guages, as well as <em>gra­dle</em> in­stead of <em>maven</em>.</p><h3 id=\"maven-configuration\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#maven-configuration\"></a>Maven configuration</h3><p>The con­fig­u­ra­tion and the maven im­ports will vary ac­cord­ing to the back­end stor­age that will be used. For maven, the com­mon part is al­ways:</p><pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.vertx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>vertx-micrometer-metrics<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>3.5.1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre><ul><li>Then, to re­port to In­fluxDB:</li></ul><pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.micrometer<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>micrometer-registry-influx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.0.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre><ul><li>Or Prometheus:</li></ul><pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.micrometer<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>micrometer-registry-prometheus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.0.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.vertx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>vertx-web<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>3.5.1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre><p>Re­mark that, since Prometheus pulls met­rics from their source, they must be ex­posed on an HTTP end­point. That’s why <code>vertx-web</code> is im­ported here. It is not <em>ab­solutely</em> nec­es­sary (it’s pos­si­ble to get the met­rics reg­istry con­tent and ex­pose it in any other way) but it’s prob­a­bly the eas­i­est way to do.</p><ul><li>Or JMX:</li></ul><pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.micrometer<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>micrometer-registry-jmx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.0.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n</code></pre><div class=\"alert info\"><p>At the mo­ment, it is not pos­si­ble to re­port met­rics to sev­eral back­ends at the same time. <a href=\"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16\">It might be soon im­ple­mented</a>.</p></div><h3 id=\"setting-up-vertx-options\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#setting-up-vertx-options\"></a>Setting up Vert.x options</h3><p>A <code>MicrometerMetricsOptions</code> ob­ject must be cre­ated and passed to <code>VertxOptions</code>, with one back­end con­fig­ured (though hav­ing no back­end is pos­si­ble: you would get met­rics sent to a de­fault Mi­crom­e­ter reg­istry, but with­out any per­sis­tent stor­age).</p><ul><li>In­fluxDB ex­am­ple:</li></ul><pre><code class=\"hljs language-java\"><span class=\"hljs-comment\">// Default InfluxDB options will push metrics to localhost:8086, db &quot;default&quot;</span>\nMicrometerMetricsOptions options = <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n  .setInfluxDbOptions(<span class=\"hljs-keyword\">new</span> VertxInfluxDbOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n  .setEnabled(<span class=\"hljs-keyword\">true</span>);\nVertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(options));\n<span class=\"hljs-comment\">// Then deploy verticles with this vertx instance</span>\n</code></pre><ul><li>Prometheus ex­am­ple:</li></ul><pre><code class=\"hljs language-java\"><span class=\"hljs-comment\">// Deploy with embedded server: prometheus metrics will be automatically exposed,</span>\n<span class=\"hljs-comment\">// independently from any other HTTP server defined</span>\nMicrometerMetricsOptions options = <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n  .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions()\n    .setStartEmbeddedServer(<span class=\"hljs-keyword\">true</span>)\n    .setEmbeddedServerOptions(<span class=\"hljs-keyword\">new</span> HttpServerOptions().setPort(<span class=\"hljs-number\">8081</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>))\n  .setEnabled(<span class=\"hljs-keyword\">true</span>);\nVertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(options));\n<span class=\"hljs-comment\">// Then deploy verticles with this vertx instance</span>\n</code></pre><ul><li>Or Prometheus with the <code>/metrics</code> end­point bound to an ex­ist­ing HTTP server:</li></ul><pre><code class=\"hljs language-java\"><span class=\"hljs-comment\">// Deploy without embedded server: we need to &quot;manually&quot; expose the prometheus metrics</span>\nMicrometerMetricsOptions options = <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n  .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n  .setEnabled(<span class=\"hljs-keyword\">true</span>);\nVertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(options));\n\nRouter router = Router.router(vertx);\nPrometheusMeterRegistry registry = (PrometheusMeterRegistry) BackendRegistries.getDefaultNow();\n<span class=\"hljs-comment\">// Setup a route for metrics</span>\nrouter.route(<span class=\"hljs-string\">&quot;/metrics&quot;</span>).handler(ctx -&gt; {\n  String response = registry.scrape();\n  ctx.response().end(response);\n});\nvertx.createHttpServer().requestHandler(router::accept).listen(<span class=\"hljs-number\">8080</span>);\n</code></pre><ul><li>JMX ex­am­ple:</li></ul><pre><code class=\"hljs language-java\"><span class=\"hljs-comment\">// Default JMX options will publish MBeans under domain &quot;metrics&quot;</span>\nMicrometerMetricsOptions options = <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n  .setJmxMetricsOptions(<span class=\"hljs-keyword\">new</span> VertxJmxMetricsOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n  .setEnabled(<span class=\"hljs-keyword\">true</span>);\nVertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(options));\n<span class=\"hljs-comment\">// Then deploy verticles with this vertx instance</span>\n</code></pre><h3 id=\"setup-the-backend-server\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#setup-the-backend-server\"></a>Setup the backend server</h3><ul><li><a href=\"https://www.influxdata.com/\">In­fluxDB</a>, by de­fault, is ex­pected to run on <code>localhost:8086</code> with­out au­then­ti­ca­tion, data­base “de­fault”. It is con­fig­urable in <code>VertxInfluxDbOptions</code>.\nIf you don’t have a run­ning in­stance of In­fluxDB, the short­est way to start is cer­tainly with docker, just run:</li></ul><pre><code class=\"hljs language-bash\">docker run -p 8086:8086 influxdb\n</code></pre><ul><li><a href=\"https://prometheus.io/docs/prometheus/latest/getting_started/\">Prometheus</a> needs some con­fig­u­ra­tion since it pulls met­rics from the sources. Once it is in­stalled, con­fig­ure the scrape end­points in <code>prometheus.yml</code>:</li></ul><pre><code class=\"hljs language-yaml\"><span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">job_name:</span> <span class=\"hljs-string\">&#x27;vertx-8081&#x27;</span>\n  <span class=\"hljs-attr\">static_configs:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">targets:</span> [<span class=\"hljs-string\">&#x27;localhost:8081&#x27;</span>]\n</code></pre><p>or, when using <code>/metrics</code> end­point bound to an ex­ist­ing HTTP server:</p><pre><code class=\"hljs language-yaml\"><span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">job_name:</span> <span class=\"hljs-string\">&#x27;vertx-8080&#x27;</span>\n  <span class=\"hljs-attr\">static_configs:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">targets:</span> [<span class=\"hljs-string\">&#x27;localhost:8080&#x27;</span>]\n</code></pre><ul><li>For JMX there is noth­ing spe­cial to con­fig­ure.</li></ul><h3 id=\"collecting-vertx-metrics\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#collecting-vertx-metrics\"></a>Collecting Vert.x metrics</h3><p>From now on, all Vert.x met­rics will be col­lected and sent to the con­fig­ured back­end. In our Vert.x ex­am­ple, we setup an HTTP server met­rics:</p><pre><code class=\"hljs language-java\">Router router = Router.router(vertx);\nrouter.get(<span class=\"hljs-string\">&quot;/&quot;</span>).handler(ctx -&gt; {\n  ctx.response().end(<span class=\"hljs-string\">&quot;Hello Micrometer from HTTP!&quot;</span>);\n});\nvertx.createHttpServer().requestHandler(router::accept).listen(<span class=\"hljs-number\">8080</span>);\n</code></pre><p> And some event bus ping-​pong:</p><pre><code class=\"hljs language-java\"><span class=\"hljs-comment\">// Producer side</span>\nvertx.setPeriodic(<span class=\"hljs-number\">1000</span>, x -&gt; {\n  vertx.eventBus().send(<span class=\"hljs-string\">&quot;greeting&quot;</span>, <span class=\"hljs-string\">&quot;Hello Micrometer from event bus!&quot;</span>);\n});\n</code></pre><pre><code class=\"hljs language-java\"><span class=\"hljs-comment\">// Consumer side</span>\nvertx.eventBus().&lt;String&gt;consumer(<span class=\"hljs-string\">&quot;greeting&quot;</span>, message -&gt; {\n  String greeting = message.body();\n  System.out.println(<span class=\"hljs-string\">&quot;Received: &quot;</span> + greeting);\n  message.reply(<span class=\"hljs-string\">&quot;Hello back!&quot;</span>);\n});\n</code></pre><p>To trig­ger some ac­tiv­ity on the HTTP server, we can write a small bash script:</p><pre><code class=\"hljs language-bash\"><span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">true</span>\n<span class=\"hljs-keyword\">do</span> curl http://localhost:8080/\n    sleep .8\n<span class=\"hljs-keyword\">done</span>\n</code></pre><h3 id=\"viewing-the-results\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#viewing-the-results\"></a>Viewing the results</h3><p><a href=\"https://grafana.com/\">Grafana</a> can be used to dis­play the In­fluxDB and Prometheus met­rics. The <code>vertx-examples</code> repos­i­tory con­tains two dash­boards for that: <a href=\"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-InfluxDB.json\">for In­fluxDB</a> and <a href=\"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-Prometheus.json\">for Prometheus</a>.</p><h5 id=\"http-server-metrics\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#http-server-metrics\"></a>HTTP server metrics</h5><img alt=\"HTTP server metrics\" class=\"img-fluid\" src=\"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/http-server-metrics.png\"/><h5 id=\"event-bus-metrics\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#event-bus-metrics\"></a>Event bus metrics</h5><img alt=\"Event bus metrics\" class=\"img-fluid\" src=\"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/eventbus-metrics.png\"/><h2 id=\"going-further\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#going-further\"></a>Going further</h2><p>We’ve seen the basic setup. There is a good bunch of op­tions avail­able, de­tailed <a href=\"https://vertx.io/docs/vertx-micrometer-metrics/java/\">in the doc­u­men­ta­tion</a>: how to dis­able some met­rics do­mains, how to fil­ter or re­arrange la­bels, how to ex­port met­rics snap­shots to Json ob­jects, how to add JVM or proces­sor in­stru­men­ta­tion, etc.</p><p>Be­fore we fin­ish, there is one im­por­tant point that we can cover here: defin­ing cus­tom met­rics.\nBe­cause the mod­ule gives you ac­cess to its Mi­crom­e­ter reg­istry, you can add your cus­tom met­rics there.</p><p>Get­ting the de­fault reg­istry is straight­for­ward:</p><pre><code class=\"hljs language-java\">MeterRegistry registry = BackendRegistries.getDefaultNow();\n</code></pre><p>Then you have plain ac­cess to the <a href=\"https://micrometer.io/docs/concepts\">Mi­crom­e­ter API</a>.</p><p>For in­stance, here is how you can track the ex­e­cu­tion time of a piece of code that is reg­u­larly called:</p><pre><code class=\"hljs language-java\">MeterRegistry registry = BackendRegistries.getDefaultNow();\nTimer timer = Timer\n  .builder(<span class=\"hljs-string\">&quot;my.timer&quot;</span>)\n  .description(<span class=\"hljs-string\">&quot;Time tracker for my extremely sophisticated algorithm&quot;</span>)\n  .register(registry);\n\nvertx.setPeriodic(<span class=\"hljs-number\">1000</span>, l -&gt; {\n  timer.record(() -&gt; myExtremelySophisticatedAlgorithm());\n});\n</code></pre><p>Since it is using the same reg­istry, there is no extra back­end con­fig­u­ra­tion to do.</p><h2 id=\"whats-next\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#whats-next\"></a>What’s next?</h2><p>The <code>vertx-micrometer-metrics</code> mod­ule will con­tinue to be im­proved, with al­ready two planned en­hance­ments:</p><ul><li><a href=\"https://github.com/vert-x3/vertx-micrometer-metrics/issues/15\">Adding more back­ends</a>, like Graphite.</li><li><a href=\"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16\">Allow to con­fig­ure sev­eral back­ends</a>, and not only one at the same time.</li></ul><p>Would you miss any fea­ture, please <a href=\"https://github.com/vert-x3/vertx-micrometer-metrics/issues\">ask on GitHub</a>. Con­tri­bu­tions and bug fixes are also wel­come!</p><p>Now is time to enter the Met­rics.</p>","scope":{}},"tfIdfTerms":[{"term":"metric","tf":36},{"term":"prometheu","tf":14},{"term":"backend","tf":13},{"term":"micromet","tf":12},{"term":"will","tf":11},{"term":"time","tf":10},{"term":"influxdb","tf":10},{"term":"configur","tf":10},{"term":"us","tf":9},{"term":"http","tf":9},{"term":"exampl","tf":8},{"term":"server","tf":8},{"term":"provid","tf":7},{"term":"sever","tf":7},{"term":"etc","tf":7},{"term":"registri","tf":6},{"term":"queri","tf":6},{"term":"modul","tf":5},{"term":"implement","tf":5},{"term":"collect","tf":5},{"term":"support","tf":5},{"term":"jmx","tf":5},{"term":"dimens","tf":5},{"term":"sent","tf":5},{"term":"maven","tf":5}]},{"filename":"blog/2018-03-13-google-summer-of-code-2018.mdx","date":"2018-03-13","slug":"google-summer-of-code-2018","meta":{"title":"Google Summer of Code 2018","category":"news","authors":[{"name":"Thomas Segismont","github_id":"tsegismont"}],"summary":"It's this time of year again! Google Summer of Code 2018 submission period has just started!"},"readingTime":{"text":"1 min read","minutes":0.765,"time":45900,"words":153},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"It\\u2019s this time of year again!\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://summerofcode.withgoogle.com/\"\n  }), \"Google Sum\\xADmer of Code\"), \" 2018 sub\\xADmis\\xADsion pe\\xADriod has just started!\"), mdx(\"h2\", {\n    \"id\": \"submit-through-the-eclipse-organization\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#submit-through-the-eclipse-organization\"\n  })), \"Submit through the Eclipse organization\"), mdx(\"p\", null, \"This year, the Eclipse Vert.x project par\\xADtic\\xADi\\xADpates through the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://summerofcode.withgoogle.com/organizations/6364590460370944/\"\n  }), \"Eclipse or\\xADga\\xADni\\xADza\\xADtion\"), \".\\nMake sure to re\\xADview our \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://wiki.eclipse.org/Google_Summer_of_Code_2018_Ideas#Eclipse_Vert.x\"\n  }), \"GSoC 2018 ideas\"), \" and to sub\\xADmit be\\xADfore March, 27!\"), mdx(\"h2\", {\n    \"id\": \"assessment-application\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#assessment-application\"\n  })), \"Assessment application\"), mdx(\"p\", null, \"As we did be\\xADfore, we ask can\\xADdi\\xADdates to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/tsegismont/vertx-gsoc-2018-qotd\"\n  }), \"im\\xADple\\xADment a sim\\xADple Vert.x ap\\xADpli\\xADca\\xADtion\"), \".\\nThis helps us make sure can\\xADdi\\xADdates have a basic un\\xADder\\xADstand\\xADing of asyn\\xADchro\\xADnous pro\\xADgram\\xADming and the Vert.x toolkit.\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"But sub\\xADmit your pro\\xADposal even if not done with the as\\xADsess\\xADment ap\\xADpli\\xADca\\xADtion!\"), \"\\nGoogle will not ex\\xADtend the sub\\xADmis\\xADsion pe\\xADriod but we can con\\xADtinue re\\xADview\\xADing as\\xADsess\\xADments while eval\\xADu\\xADat\\xADing the sub\\xADmit\\xADted pro\\xADpos\\xADals.\"), mdx(\"h2\", {\n    \"id\": \"questions\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#questions\"\n  })), \"Questions?\"), mdx(\"p\", null, \"If you have ques\\xADtions, feel free to ask pos\\xADsi\\xADble men\\xADtors via email or on our \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/community\"\n  }), \"com\\xADmu\\xADnity chan\\xADnels\"), \".\"), mdx(\"p\", null, \"All the de\\xADtails for this year (and ideas from past years) can be found on the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/gsoc\"\n  }), \"Vert.x GSoC page\"), \".\"), mdx(\"p\", null, \"Look\\xADing for\\xADward to your pro\\xADpos\\xADals!\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"<p>It’s this time of year again!\n<a href=\"https://summerofcode.withgoogle.com/\">Google Sum­mer of Code</a> 2018 sub­mis­sion pe­riod has just started!</p><h2 id=\"submit-through-the-eclipse-organization\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#submit-through-the-eclipse-organization\"></a>Submit through the Eclipse organization</h2><p>This year, the Eclipse Vert.x project par­tic­i­pates through the <a href=\"https://summerofcode.withgoogle.com/organizations/6364590460370944/\">Eclipse or­ga­ni­za­tion</a>.\nMake sure to re­view our <a href=\"https://wiki.eclipse.org/Google_Summer_of_Code_2018_Ideas#Eclipse_Vert.x\">GSoC 2018 ideas</a> and to sub­mit be­fore March, 27!</p><h2 id=\"assessment-application\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#assessment-application\"></a>Assessment application</h2><p>As we did be­fore, we ask can­di­dates to <a href=\"https://github.com/tsegismont/vertx-gsoc-2018-qotd\">im­ple­ment a sim­ple Vert.x ap­pli­ca­tion</a>.\nThis helps us make sure can­di­dates have a basic un­der­stand­ing of asyn­chro­nous pro­gram­ming and the Vert.x toolkit.\n<strong>But sub­mit your pro­posal even if not done with the as­sess­ment ap­pli­ca­tion!</strong>\nGoogle will not ex­tend the sub­mis­sion pe­riod but we can con­tinue re­view­ing as­sess­ments while eval­u­at­ing the sub­mit­ted pro­pos­als.</p><h2 id=\"questions\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#questions\"></a>Questions?</h2><p>If you have ques­tions, feel free to ask pos­si­ble men­tors via email or on our <a href=\"/community\">com­mu­nity chan­nels</a>.</p><p>All the de­tails for this year (and ideas from past years) can be found on the <a href=\"/gsoc\">Vert.x GSoC page</a>.</p><p>Look­ing for­ward to your pro­pos­als!</p>","scope":{}},"tfIdfTerms":[{"term":"year","tf":4},{"term":"submit","tf":4},{"term":"assess","tf":3},{"term":"applic","tf":3},{"term":"propos","tf":3},{"term":"2018","tf":2},{"term":"googl","tf":2},{"term":"submiss","tf":2},{"term":"period","tf":2},{"term":"organ","tf":2},{"term":"sure","tf":2},{"term":"review","tf":2},{"term":"gsoc","tf":2},{"term":"idea","tf":2},{"term":"ask","tf":2},{"term":"candid","tf":2},{"term":"not","tf":2},{"term":"question","tf":2},{"term":"27","tf":1},{"term":"time","tf":1},{"term":"summer","tf":1},{"term":"code","tf":1},{"term":"just","tf":1},{"term":"start","tf":1},{"term":"project","tf":1}]},{"filename":"blog/2018-02-13-eclipse-vert-x-3-5-1-released.mdx","date":"2018-02-13","slug":"eclipse-vert-x-3-5-1-released","meta":{"title":"Eclipse Vert.x 3.5.1 released!","category":"releases","authors":[{"name":"Julien Viet","github_id":"vietj"}],"summary":"We have just released Vert.x 3.5.1!"},"readingTime":{"text":"4 min read","minutes":3.39,"time":203400,"words":678},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"We have just re\\xADleased Vert.x 3.5.1!\"), mdx(\"h2\", {\n    \"id\": \"fixes-first\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#fixes-first\"\n  })), \"Fixes first!\"), mdx(\"p\", null, \"As usual this re\\xADlease fixes bugs re\\xADported in 3.5.0, see the re\\xADlease notes.\"), mdx(\"h2\", {\n    \"id\": \"junit-5-support\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#junit-5-support\"\n  })), \"JUnit 5 support\"), mdx(\"p\", null, \"This re\\xADlease in\\xADtro\\xADduces the new \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-junit5\"\n  }), \"vertx-\\u200Bjunit5 mod\\xADule\"), \".\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://junit.org/junit5/\"\n  }), \"JUnit 5\"), \" is a rewrite of the fa\\xADmous Java test\\xADing frame\\xADwork that brings new in\\xADter\\xADest\\xADing fea\\xADtures, in\\xADclud\\xADing:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"nested tests,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"the abil\\xADity to give a human-\\u200Breadable de\\xADscrip\\xADtion of tests and test cases (and yes, even use emo\\xADjis),\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a mod\\xADu\\xADlar ex\\xADten\\xADsion mech\\xADa\\xADnism that is more pow\\xADer\\xADful than the JUnit 4 run\\xADner mech\\xADa\\xADnism (@Run\\xADWith an\\xADno\\xADta\\xADtion),\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"con\\xADdi\\xADtional test ex\\xADe\\xADcu\\xADtion,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"pa\\xADra\\xADme\\xADter\\xADized tests, in\\xADclud\\xADing from sources such as CSV data,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"the sup\\xADport of Java 8 lambda ex\\xADpres\\xADsions in the re\\xADworked built-\\u200Bin as\\xADser\\xADtions API,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"sup\\xADport for run\\xADning tests pre\\xADvi\\xADously writ\\xADten for JUnit 4.\")), mdx(\"p\", null, \"Sup\\xADpose that we have a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SampleVerticle\"), \" ver\\xADti\\xADcle that ex\\xADposes a HTTP server on port 11981.\\nHere is how we can test its de\\xADploy\\xADment as well as the re\\xADsult of 10 con\\xADcur\\xADrent HTTP re\\xADquests:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-meta\"\n  }), \"@Test\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-meta\"\n  }), \"@DisplayName(\\\"\\uD83D\\uDE80 Deploy a HTTP service verticle and make 10 requests\\\")\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"void\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"useSampleVerticle\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(Vertx vertx, VertxTestContext testContext)\"), \" \"), \"{\\n  WebClient webClient = WebClient.create(vertx);\\n  Checkpoint deploymentCheckpoint = testContext.checkpoint();\\n\\n  Checkpoint requestCheckpoint = testContext.checkpoint(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"10\"), \");\\n  vertx.deployVerticle(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" SampleVerticle(), testContext.succeeding(id -> {\\n    deploymentCheckpoint.flag();\\n\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"for\"), \" (\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"int\"), \" i = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"0\"), \"; i < \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"10\"), \"; i++) {\\n      webClient.get(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"11981\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"localhost\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"/\\\"\"), \")\\n        .as(BodyCodec.string())\\n        .send(testContext.succeeding(resp -> {\\n          testContext.verify(() -> {\\n            assertThat(resp.statusCode()).isEqualTo(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"200\"), \");\\n            assertThat(resp.body()).contains(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Yo!\\\"\"), \");\\n            requestCheckpoint.flag();\\n          });\\n        }));\\n    }\\n  }));\\n}\\n\")), mdx(\"p\", null, \"The test method above ben\\xADe\\xADfits from the in\\xADjec\\xADtion of a work\\xADing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Vertx\"), \" con\\xADtext, a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"VertxTestContext\"), \" for deal\\xADing with\\nasyn\\xADchro\\xADnous op\\xADer\\xADa\\xADtions, and the guar\\xADan\\xADtee that the ex\\xADe\\xADcu\\xADtion time is bound by a time\\xADout which can op\\xADtion\\xADally be con\\xADfig\\xADured\\nusing a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@Timeout\"), \" an\\xADno\\xADta\\xADtion.\"), mdx(\"p\", null, \"The test suc\\xADceeds when all check\\xADpoints have been flagged.\\nNote that \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-junit5\"), \" is ag\\xADnos\\xADtic of the as\\xADser\\xADtions li\\xADbrary being used: you may opt for the built-\\u200Bin JUnit 5 as\\xADser\\xADtions\\nor use a 3rd-\\u200Bparty li\\xADbrary such as \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://joel-costigliola.github.io/assertj/\"\n  }), \"As\\xADsertJ\"), \" as we did in the ex\\xADam\\xADple above.\"), mdx(\"p\", null, \"You can check\\xADout the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-junit5\"\n  }), \"source on GitHub\"), \", read \", mdx(Link, {\n    href: \"/docs/[[...slug]]\",\n    as: \"/docs/vertx-junit5/java/\",\n    mdxType: \"Link\"\n  }, mdx(\"a\", null, \"the man\\xADual\")), \" and learn from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-examples/tree/master/junit5-examples\"\n  }), \"the ex\\xADam\\xADples\"), \".\"), mdx(\"h2\", {\n    \"id\": \"web-api-contract-enhancements\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#web-api-contract-enhancements\"\n  })), \"Web API Contract enhancements\"), mdx(\"p\", null, \"The pack\\xADage \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-web-api-contract\"), \" in\\xADcludes a va\\xADri\\xADety of fixes, from schema \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$ref\"), \" to\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://vertx.io/docs/vertx-web-api-contract/java/\"\n  }), \"re\\xADvamped doc\\xADu\\xADmen\\xADta\\xADtion\"), \". You can give a look at list of all\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-web/pull/802\"\n  }), \"fixes/im\\xADprove\\xADments here\"), \" and all\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/wiki/wiki/3.5.1-Breaking-Changes#vertx-web-api-contracts\"\n  }), \"break\\xADing changes here\"), \".\"), mdx(\"p\", null, \"From 3.5.1 to load the ope\\xADnapi spec and in\\xADstan\\xADti\\xADate the Router you should use new method \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OpenAPI3RouterFactory.create()\"), \"\\nthat re\\xADplaces old meth\\xADods \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"createRouterFactoryFromFile()\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"createRouterFactoryFromURL()\"), \". This new method ac\\xADcepts\\nrel\\xADa\\xADtive paths, ab\\xADsolute paths, local URL with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"file://\"), \" and re\\xADmote URL with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://\"), \". Note that if you want refeer to\\na file rel\\xADa\\xADtive to your jar\\u2019s root, you can sim\\xADply use a rel\\xADa\\xADtive path and the parser will look out the jar and into the\\njar for the spec.\"), mdx(\"p\", null, \"From 3.5.1 all set\\xADtings about \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OpenAPI3RouterFactory\"), \" be\\xADhav\\xADiours dur\\xADing router gen\\xADer\\xADa\\xADtion are in\\xADglobed in a new ob\\xADject called\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://vertx.io/docs/apidocs/io/vertx/ext/web/api/contract/RouterFactoryOptions.html\"\n  }), mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"RouterFactoryOptions\")), \". From\\nthis ob\\xADject you can:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Con\\xADfig\\xADure if you want to mount a de\\xADfault val\\xADi\\xADda\\xADtion fail\\xADure han\\xADdler and which one\\n(meth\\xADods \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"setMountValidationFailureHandler(boolean)\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"setValidationFailureHandler(Handler)\"), \")\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Con\\xADfig\\xADure if you want to mount a de\\xADfault 501 not im\\xADple\\xADmented han\\xADdler and which one\\n(meth\\xADods \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"setMountNotImplementedFailureHandler(boolean)\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"setNotImplementedFailureHandler(Handler)\"), \")\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Con\\xADfig\\xADure if you want to mount \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"ResponseContentTypeHandler\"), \" au\\xADto\\xADmat\\xADi\\xADcally\\n(method \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"setMountResponseContentTypeHandler(boolean)\"), \")\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Con\\xADfig\\xADure if you want to fail dur\\xADing router gen\\xADer\\xADa\\xADtion when se\\xADcu\\xADrity han\\xADdlers are not con\\xADfig\\xADured\\n(method \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"setRequireSecurityHandlers(boolean)\"), \")\")), mdx(\"p\", null, \"After ini\\xADtial\\xADiza\\xADtion of route, you can mount the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"RouterFactoryOptions\"), \" ob\\xADject with method \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"routerFactory.setOptions()\"), \"\\nwhen you want be\\xADfore call\\xADing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getRouter()\"), \".\"), mdx(\"h2\", {\n    \"id\": \"rxjava-deprecation-removal\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#rxjava-deprecation-removal\"\n  })), \"RxJava deprecation removal\"), mdx(\"p\", null, \"It is im\\xADpor\\xADtant to know that 3.5.x will be the last re\\xADlease with the legacy \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"xyzObservable()\"), \" meth\\xADods:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-meta\"\n  }), \"@Deprecated()\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" Observable<HttpServer> \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"listenObservable\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"int\"), \" port, String host)\")), \";\\n\")), mdx(\"p\", null, \"has been re\\xADplaced since Vert.x 3.4 by:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" Single<HttpServer> \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"rxListen\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"int\"), \" port, String host)\")), \";\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"xyzObservable()\"), \" dep\\xADre\\xADcated meth\\xADods will be \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-rx/issues/113\"\n  }), \"re\\xADmoved\"), \" in Vert.x 3.6.\"), mdx(\"h2\", {\n    \"id\": \"wrap-up\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#wrap-up\"\n  })), \"Wrap up\"), mdx(\"p\", null, \"Vert.x 3.5.1 re\\xADlease notes and break\\xADing changes:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/wiki/wiki/3.5.1-Release-Notes\"\n  }), \"https://github.com/vert-\\u200Bx3/wiki/wiki/3.5.1-\\u200BRelease-Notes\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/wiki/wiki/3.5.1-Breaking-Changes\"\n  }), \"https://github.com/vert-\\u200Bx3/wiki/wiki/3.5.1-\\u200BBreaking-Changes\"))), mdx(\"p\", null, \"The event bus client using the SockJS bridge are avail\\xADable from NPM, Bower and as a We\\xADb\\xADJar:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://www.npmjs.com/package/vertx3-eventbus-client\"\n  }), \"https://www.npmjs.com/pack\\xADage/vertx3-\\u200Beventbus-client\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-bus-bower\"\n  }), \"https://github.com/vert-\\u200Bx3/vertx-\\u200Bbus-bower\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://www.webjars.org/\"\n  }), \"http://www.we\\xADb\\xADjars.org/\"))), mdx(\"p\", null, \"Docker im\\xADages are also avail\\xADable on the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://hub.docker.com/u/vertx/\"\n  }), \"Docker Hub\"), \". The Vert.x dis\\xADtri\\xADb\\xADu\\xADtion is also avail\\xADable from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://sdkman.io/index.html\"\n  }), \"SD\\xADKMan\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://brew.sh/\"\n  }), \"Home\\xADBrew\"), \".\"), mdx(\"p\", null, \"The ar\\xADti\\xADfacts have been de\\xADployed to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.5.1%22\"\n  }), \"Maven Cen\\xADtral\"), \" and you can get the dis\\xADtri\\xADb\\xADu\\xADtion on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://bintray.com/vertx/downloads/distribution/3.3.3/view\"\n  }), \"Bin\\xADtray\"), \".\"), mdx(\"p\", null, \"Happy cod\\xADing !\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"<p>We have just re­leased Vert.x 3.5.1!</p><h2 id=\"fixes-first\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#fixes-first\"></a>Fixes first!</h2><p>As usual this re­lease fixes bugs re­ported in 3.5.0, see the re­lease notes.</p><h2 id=\"junit-5-support\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#junit-5-support\"></a>JUnit 5 support</h2><p>This re­lease in­tro­duces the new <a href=\"https://github.com/vert-x3/vertx-junit5\">vertx-​junit5 mod­ule</a>.</p><p><a href=\"http://junit.org/junit5/\">JUnit 5</a> is a rewrite of the fa­mous Java test­ing frame­work that brings new in­ter­est­ing fea­tures, in­clud­ing:</p><ul><li>nested tests,</li><li>the abil­ity to give a human-​readable de­scrip­tion of tests and test cases (and yes, even use emo­jis),</li><li>a mod­u­lar ex­ten­sion mech­a­nism that is more pow­er­ful than the JUnit 4 run­ner mech­a­nism (@Run­With an­no­ta­tion),</li><li>con­di­tional test ex­e­cu­tion,</li><li>pa­ra­me­ter­ized tests, in­clud­ing from sources such as CSV data,</li><li>the sup­port of Java 8 lambda ex­pres­sions in the re­worked built-​in as­ser­tions API,</li><li>sup­port for run­ning tests pre­vi­ously writ­ten for JUnit 4.</li></ul><p>Sup­pose that we have a <code>SampleVerticle</code> ver­ti­cle that ex­poses a HTTP server on port 11981.\nHere is how we can test its de­ploy­ment as well as the re­sult of 10 con­cur­rent HTTP re­quests:</p><pre><code class=\"hljs language-java\"><span class=\"hljs-meta\">@Test</span>\n<span class=\"hljs-meta\">@DisplayName(&quot;🚀 Deploy a HTTP service verticle and make 10 requests&quot;)</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">useSampleVerticle</span><span class=\"hljs-params\">(Vertx vertx, VertxTestContext testContext)</span> </span>{\n  WebClient webClient = WebClient.create(vertx);\n  Checkpoint deploymentCheckpoint = testContext.checkpoint();\n\n  Checkpoint requestCheckpoint = testContext.checkpoint(<span class=\"hljs-number\">10</span>);\n  vertx.deployVerticle(<span class=\"hljs-keyword\">new</span> SampleVerticle(), testContext.succeeding(id -&gt; {\n    deploymentCheckpoint.flag();\n\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-number\">10</span>; i++) {\n      webClient.get(<span class=\"hljs-number\">11981</span>, <span class=\"hljs-string\">&quot;localhost&quot;</span>, <span class=\"hljs-string\">&quot;/&quot;</span>)\n        .as(BodyCodec.string())\n        .send(testContext.succeeding(resp -&gt; {\n          testContext.verify(() -&gt; {\n            assertThat(resp.statusCode()).isEqualTo(<span class=\"hljs-number\">200</span>);\n            assertThat(resp.body()).contains(<span class=\"hljs-string\">&quot;Yo!&quot;</span>);\n            requestCheckpoint.flag();\n          });\n        }));\n    }\n  }));\n}\n</code></pre><p>The test method above ben­e­fits from the in­jec­tion of a work­ing <code>Vertx</code> con­text, a <code>VertxTestContext</code> for deal­ing with\nasyn­chro­nous op­er­a­tions, and the guar­an­tee that the ex­e­cu­tion time is bound by a time­out which can op­tion­ally be con­fig­ured\nusing a <code>@Timeout</code> an­no­ta­tion.</p><p>The test suc­ceeds when all check­points have been flagged.\nNote that <code>vertx-junit5</code> is ag­nos­tic of the as­ser­tions li­brary being used: you may opt for the built-​in JUnit 5 as­ser­tions\nor use a 3rd-​party li­brary such as <a href=\"http://joel-costigliola.github.io/assertj/\">As­sertJ</a> as we did in the ex­am­ple above.</p><p>You can check­out the <a href=\"https://github.com/vert-x3/vertx-junit5\">source on GitHub</a>, read <a>the man­ual</a> and learn from <a href=\"https://github.com/vert-x3/vertx-examples/tree/master/junit5-examples\">the ex­am­ples</a>.</p><h2 id=\"web-api-contract-enhancements\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#web-api-contract-enhancements\"></a>Web API Contract enhancements</h2><p>The pack­age <code>vertx-web-api-contract</code> in­cludes a va­ri­ety of fixes, from schema <code>$ref</code> to\n<a href=\"http://vertx.io/docs/vertx-web-api-contract/java/\">re­vamped doc­u­men­ta­tion</a>. You can give a look at list of all\n<a href=\"https://github.com/vert-x3/vertx-web/pull/802\">fixes/im­prove­ments here</a> and all\n<a href=\"https://github.com/vert-x3/wiki/wiki/3.5.1-Breaking-Changes#vertx-web-api-contracts\">break­ing changes here</a>.</p><p>From 3.5.1 to load the ope­napi spec and in­stan­ti­ate the Router you should use new method <code>OpenAPI3RouterFactory.create()</code>\nthat re­places old meth­ods <code>createRouterFactoryFromFile()</code> and <code>createRouterFactoryFromURL()</code>. This new method ac­cepts\nrel­a­tive paths, ab­solute paths, local URL with <code>file://</code> and re­mote URL with <code>http://</code>. Note that if you want refeer to\na file rel­a­tive to your jar’s root, you can sim­ply use a rel­a­tive path and the parser will look out the jar and into the\njar for the spec.</p><p>From 3.5.1 all set­tings about <code>OpenAPI3RouterFactory</code> be­hav­iours dur­ing router gen­er­a­tion are in­globed in a new ob­ject called\n<a href=\"http://vertx.io/docs/apidocs/io/vertx/ext/web/api/contract/RouterFactoryOptions.html\"><code>RouterFactoryOptions</code></a>. From\nthis ob­ject you can:</p><ul><li>Con­fig­ure if you want to mount a de­fault val­i­da­tion fail­ure han­dler and which one\n(meth­ods <code>setMountValidationFailureHandler(boolean)</code> and <code>setValidationFailureHandler(Handler)</code>)</li><li>Con­fig­ure if you want to mount a de­fault 501 not im­ple­mented han­dler and which one\n(meth­ods <code>setMountNotImplementedFailureHandler(boolean)</code> and <code>setNotImplementedFailureHandler(Handler)</code>)</li><li>Con­fig­ure if you want to mount <code>ResponseContentTypeHandler</code> au­to­mat­i­cally\n(method <code>setMountResponseContentTypeHandler(boolean)</code>)</li><li>Con­fig­ure if you want to fail dur­ing router gen­er­a­tion when se­cu­rity han­dlers are not con­fig­ured\n(method <code>setRequireSecurityHandlers(boolean)</code>)</li></ul><p>After ini­tial­iza­tion of route, you can mount the <code>RouterFactoryOptions</code> ob­ject with method <code>routerFactory.setOptions()</code>\nwhen you want be­fore call­ing <code>getRouter()</code>.</p><h2 id=\"rxjava-deprecation-removal\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#rxjava-deprecation-removal\"></a>RxJava deprecation removal</h2><p>It is im­por­tant to know that 3.5.x will be the last re­lease with the legacy <code>xyzObservable()</code> meth­ods:</p><pre><code class=\"hljs language-java\"><span class=\"hljs-meta\">@Deprecated()</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> Observable&lt;HttpServer&gt; <span class=\"hljs-title\">listenObservable</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> port, String host)</span></span>;\n</code></pre><p>has been re­placed since Vert.x 3.4 by:</p><pre><code class=\"hljs language-java\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> Single&lt;HttpServer&gt; <span class=\"hljs-title\">rxListen</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> port, String host)</span></span>;\n</code></pre><p>The <code>xyzObservable()</code> dep­re­cated meth­ods will be <a href=\"https://github.com/vert-x3/vertx-rx/issues/113\">re­moved</a> in Vert.x 3.6.</p><h2 id=\"wrap-up\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#wrap-up\"></a>Wrap up</h2><p>Vert.x 3.5.1 re­lease notes and break­ing changes:</p><ul><li><a href=\"https://github.com/vert-x3/wiki/wiki/3.5.1-Release-Notes\">https://github.com/vert-​x3/wiki/wiki/3.5.1-​Release-Notes</a></li><li><a href=\"https://github.com/vert-x3/wiki/wiki/3.5.1-Breaking-Changes\">https://github.com/vert-​x3/wiki/wiki/3.5.1-​Breaking-Changes</a></li></ul><p>The event bus client using the SockJS bridge are avail­able from NPM, Bower and as a We­b­Jar:</p><ul><li><a href=\"https://www.npmjs.com/package/vertx3-eventbus-client\">https://www.npmjs.com/pack­age/vertx3-​eventbus-client</a></li><li><a href=\"https://github.com/vert-x3/vertx-bus-bower\">https://github.com/vert-​x3/vertx-​bus-bower</a></li><li><a href=\"http://www.webjars.org/\">http://www.we­b­jars.org/</a></li></ul><p>Docker im­ages are also avail­able on the <a href=\"https://hub.docker.com/u/vertx/\">Docker Hub</a>. The Vert.x dis­tri­b­u­tion is also avail­able from <a href=\"http://sdkman.io/index.html\">SD­KMan</a> and <a href=\"http://brew.sh/\">Home­Brew</a>.</p><p>The ar­ti­facts have been de­ployed to <a href=\"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.5.1%22\">Maven Cen­tral</a> and you can get the dis­tri­b­u­tion on <a href=\"https://bintray.com/vertx/downloads/distribution/3.3.3/view\">Bin­tray</a>.</p><p>Happy cod­ing !</p>","scope":{}},"tfIdfTerms":[{"term":"method","tf":11},{"term":"test","tf":10},{"term":"releas","tf":7},{"term":"us","tf":7},{"term":"http","tf":7},{"term":"configur","tf":6},{"term":"want","tf":6},{"term":"note","tf":5},{"term":"junit","tf":5},{"term":"new","tf":5},{"term":"fix","tf":4},{"term":"github","tf":4},{"term":"mount","tf":4},{"term":"com","tf":4},{"term":"wiki","tf":4},{"term":"support","tf":3},{"term":"includ","tf":3},{"term":"assert","tf":3},{"term":"break","tf":3},{"term":"chang","tf":3},{"term":"router","tf":3},{"term":"rel","tf":3},{"term":"path","tf":3},{"term":"jar","tf":3},{"term":"will","tf":3}]},{"filename":"blog/2017-12-21-eclipse-vert-x-based-framework-url-shortener-backend.mdx","date":"2017-12-21","slug":"eclipse-vert-x-based-framework-url-shortener-backend","meta":{"title":"Eclipse Vert.x based Framework URL Shortener Backend","category":"guides","authors":[{"name":"Lazar Bulić","github_id":"pendula95"}],"summary":"We combine Vert.x with the serverless framework to write a microservice that runs on AWS Lambda."},"readingTime":{"text":"5 min read","minutes":4.65,"time":279000,"words":930},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Re\\xADcently, I stum\\xADbled upon \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://vertx.io/\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"Vertx\")), \". \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Event-\\u200Bdriven, asyn\\xADchro\\xADnized, light\\xADweight, re\\xADac\\xADtive, highly per\\xADfor\\xADmant, poly\\xADglot\"), \" ap\\xADpli\\xADca\\xADtion frame\\xADwork. Ideal for writ\\xADing \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"micro-\\u200Bservices\"), \". I played around with it for a while and re\\xADally en\\xADjoyed the con\\xADcept of \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"server\\xADless\"), \" ap\\xADpli\\xADca\\xADtions.\"), mdx(\"p\", null, \"I de\\xADvel\\xADoped a few apps and cases and started to won\\xADder how to run and de\\xADploy them so that I get a 100% re\\xADli\\xADable ser\\xADvice. I sud\\xADdenly re\\xADmem\\xADbered the tech sem\\xADi\\xADnar that I at\\xADtended re\\xADcently, specif\\xADi\\xADcally ses\\xADsion about server\\xADless apps with \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://aws.amazon.com/\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"AWS\")), \" (Ama\\xADzon Web Ser\\xADvices) \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Lambda\"), \". Lambda is a server\\xADless com\\xADpute ser\\xADvice that runs your code in re\\xADsponse to events and au\\xADto\\xADmat\\xADi\\xADcally man\\xADages the un\\xADder\\xADly\\xADing com\\xADpute re\\xADsources for you. Fairly sim\\xADi\\xADlar con\\xADcepts \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Vertx\"), \" and \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"AWS Lambda\"), \", so maybe they com\\xADple\\xADment each other? As it turns out they do, \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Vertx\"), \" can get most of your \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Lamb\\xADdas\"), \"\\u2026\"), mdx(\"p\", null, \"Using the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://serverless.com/\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"Server\\xADless Frame\\xADwork\")), \" to cre\\xADate, man\\xADage and de\\xADploy your new \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Lamb\\xADdas\"), \" I was able to get this \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"micro-\\u200Bservice\"), \" up and run\\xADning in no time.\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Enough with the talk, lets see the im\\xADple\\xADmen\\xADta\\xADtion.\")), mdx(\"h2\", {\n    \"id\": \"code\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#code\"\n  })), \"Code\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Han\\xADdler Class, entry point of AWS Re\\xADquest.\")), mdx(\"p\", null, \"The first issue that I had was the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"sync\"), \" Event Han\\xADdler that is pro\\xADvided by AWS. So I had to by pass it with Fu\\xADture. In the Han\\xADdler class I first ini\\xADti\\xADate Vertx in\\xADstance in a sta\\xADtic block and de\\xADploy few Ver\\xADti\\xADcles that will do the work. This class only re\\xADceives the event, ex\\xADtracts needed data from the re\\xADquest and passes the data to Vertx Event\\xADBus. After the Con\\xADsumers han\\xADdle the re\\xADquest, Han\\xADdler class will gen\\xADer\\xADate a proper re\\xADsponse and fin\\xADish the AWS re\\xADquest.\"), mdx(Gist, {\n    url: \"https://gist.github.com/pendula95/583eb45bd0a7990136fba029bdcd555b\",\n    mdxType: \"Gist\"\n  }), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Line 4-18:\"), \" This is where Vertx in\\xADstance is cre\\xADated, Ver\\xADti\\xADcles are de\\xADployed and \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Async JDBC\"), \" client is cre\\xADated. I fig\\xADured out that it is bet\\xADter to cre\\xADated JDBC client here as in some cases I was time\\xADout when that logic was in the Ver\\xADti\\xADcle start method.\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Line 27-36:\"), \" These are helper lines, pars\\xADing and for\\xADmat\\xADting the data so I can pass it to the Ver\\xADti\\xADcles.\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Line 38-45:\"), \" I have de\\xADcided to map the con\\xADsumers to the ad\\xADdress that is made of re\\xADquest method and url path, ex\\xADam\\xADple POST/api. This means each API re\\xADquest is mapped to its own con\\xADsumer in Ver\\xADti\\xADcle class.\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Line 47-77:\"), \" This is noth\\xADing but a block of code that han\\xADdles the re\\xADsponse that was passed from Ver\\xADti\\xADcles to the Fu\\xADture and gen\\xADer\\xADates the final re\\xADsponse that will be re\\xADturn to API Gate\\xADway.\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"UrlSer\\xADvice, Vertx Ver\\xADti\\xADcle.\")), mdx(\"p\", null, \"Ver\\xADti\\xADcle class is pretty for\\xADward. Con\\xADsumers that will process the mes\\xADsage, meth\\xADods for work\\xADing with JDBC and helper meth\\xADods for hash\\xADing/de\\xADhash\\xADing id. The logic be\\xADhind url short\\xADen\\xADing is fairly sim\\xADple here. Each long url is stored in data\\xADbase with a unique id and few ad\\xADdi\\xADtional columns. Row id is hashed and re\\xADturned as short url. When re\\xADtriev\\xADing long url hash is de\\xADcoded to row id and long url is re\\xADtrieved. Later user is redi\\xADrected to long url. With this im\\xADple\\xADmen\\xADta\\xADtion, on 6 char short url (char\\xADac\\xADters after the do\\xADmain) you get 62^6 com\\xADbi\\xADna\\xADtions which is 56 800 235 584 rows for stor\\xADing your urls. TinyURL is cur\\xADrently at 6 long char urls (char\\xADac\\xADters after do\\xADmain). You can of course im\\xADple\\xADment meth\\xADods for reusing and re\\xADcy\\xADcling ids.\"), mdx(Gist, {\n    url: \"https://gist.github.com/pendula95/aeb4479162e6e33504add2af9fa68bc5\",\n    mdxType: \"Gist\"\n  }), mdx(\"p\", null, \"As said, this is all fairly straight for\\xADward, if you are al\\xADready fa\\xADmil\\xADiar with \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Vertx\"), \". If you are think\\xADing why have I re\\xADpeated the code for es\\xADtab\\xADlish a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"JDBC\"), \" con\\xADnec\\xADtion, here is the ex\\xADpla\\xADna\\xADtion \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"(line: 10-16)\"), \". I was get\\xADting Time\\xADouts when cre\\xADat\\xADing JDBC con\\xADnec\\xADtion in Ver\\xADti\\xADcles. To avoid this I also added this code to my Han\\xADdler class. This way con\\xADnec\\xADtion is cre\\xADated there and be\\xADcause of the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Vertx\"), \" im\\xADple\\xADmen\\xADta\\xADtion any later at\\xADtempt to cre\\xADate it again will re\\xADsult in just get\\xADting the in\\xADstances from the first in\\xADvo\\xADca\\xADtion. This es\\xADcaped the need to pass the in\\xADstances di\\xADrectly from the Han\\xADdler class when cre\\xADat\\xADing Ver\\xADti\\xADcle in\\xADstances.\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Server\\xADless con\\xADfig\\xADu\\xADra\\xADtion.\")), mdx(\"p\", null, \"Lastly I would like to share the server\\xADless.yml, con\\xADfir\\xADma\\xADtion file that al\\xADlows seam\\xADlessly de\\xADploy and man\\xADage\\xADment of AWS Lambda. With just a few com\\xADmands and lines of con\\xADfig\\xADu\\xADra\\xADtion you are able to con\\xADfig\\xADure all nec\\xADes\\xADsary steps for de\\xADploy\\xADing your AWS Lambda. Frame\\xADwork takes care of mak\\xADing con\\xADfig\\xADu\\xADra\\xADtion of Api-\\u200BGateway and other AWS has\\xADsle that would oth\\xADer\\xADwise needed to be done by hand. In this case Lambda is in\\xADvoked by HTTP events.\"), mdx(Gist, {\n    url: \"https://gist.github.com/pendula95/33adc47265072ed930c7df98c9ace7be\",\n    mdxType: \"Gist\"\n  }), mdx(\"h2\", {\n    \"id\": \"performance-and-tests\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#performance-and-tests\"\n  })), \"Performance and Tests\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Vertx\"), \" async ca\\xADpa\\xADbil\\xADi\\xADties eased the stress and mem\\xADory needs of tra\\xADdi\\xADtional \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"AWS Lamb\\xADdas\"), \" with sync meth\\xADods. After per\\xADform\\xADing load tests Lamb\\xADdas that were writ\\xADten using Vertx frame\\xADwork pre\\xADformed \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"10% faster and con\\xADsumed 40% less mem\\xADory\"), \". As I have read some\\xADwhere in Vertx doc\\xADu\\xADmen\\xADta\\xADtion, Sync meth\\xADods will def\\xADi\\xADnitely fin\\xADish the first re\\xADquest faster but in total Async will be faster in the end. This sav\\xADings in mem\\xADory and time will def\\xADi\\xADnitely re\\xADduce the cost of run\\xADning your Lamb\\xADdas and the lit\\xADtle over\\xADhead with ad\\xADdi\\xADtional code is for sure worth it.\"), mdx(\"h2\", {\n    \"id\": \"conclusion\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#conclusion\"\n  })), \"Conclusion\"), mdx(\"p\", null, \"To fol\\xADlow the pace of de\\xADmand\\xADing needs for fast and re\\xADsilient ser\\xADvices we need to move from tra\\xADdi\\xADtional Mono\\xADliths. Em\\xADbrac\\xADing the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"micro ser\\xADvice\"), \" ar\\xADchi\\xADtec\\xADture alone will not cut it, not any\\xADmore. With the rise and rapid ad\\xADvance\\xADment of \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Cloud\"), \" so\\xADlu\\xADtions it has never been so easy to make a truly \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Server\\xADless\"), \" sys\\xADtems build upon net\\xADwork of \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"micro ser\\xADvices\"), \".\\nAs you have seen \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Vertx\"), \" with its async API makes the full ad\\xADvan\\xADtage of \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"AWS Lamb\\xADdas\"), \", em\\xADbrac\\xADing them while also im\\xADprov\\xADing the per\\xADfor\\xADmance and low\\xADer\\xADing the costs. With the help from \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Server\\xADless Frame\\xADwork\"), \" writ\\xADing, de\\xADploy\\xADing and man\\xADag\\xADing your \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Lamb\\xADdas\"), \" has never been so easy.\"), mdx(\"p\", null, \"If you are in\\xADter\\xADested in the whole project, you can find it on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/pendula95/vertx-aws-url-shortener-service/tree/master\"\n  }), mdx(\"strong\", {\n    parentName: \"a\"\n  }, \"GitHub\")), \".\"), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"This is a re-\\u200Bpublication of the fol\\xADlow\\xADing \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://lazarbulic.com/blog/2017/11/10/aws-lambda-vertx-framework-url-shortener-backend/\"\n  }), \"blog post\"))));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"<p>Re­cently, I stum­bled upon <a href=\"http://vertx.io/\"><strong>Vertx</strong></a>. <strong>Event-​driven, asyn­chro­nized, light­weight, re­ac­tive, highly per­for­mant, poly­glot</strong> ap­pli­ca­tion frame­work. Ideal for writ­ing <strong>micro-​services</strong>. I played around with it for a while and re­ally en­joyed the con­cept of <strong>server­less</strong> ap­pli­ca­tions.</p><p>I de­vel­oped a few apps and cases and started to won­der how to run and de­ploy them so that I get a 100% re­li­able ser­vice. I sud­denly re­mem­bered the tech sem­i­nar that I at­tended re­cently, specif­i­cally ses­sion about server­less apps with <a href=\"https://aws.amazon.com/\"><strong>AWS</strong></a> (Ama­zon Web Ser­vices) <strong>Lambda</strong>. Lambda is a server­less com­pute ser­vice that runs your code in re­sponse to events and au­to­mat­i­cally man­ages the un­der­ly­ing com­pute re­sources for you. Fairly sim­i­lar con­cepts <strong>Vertx</strong> and <strong>AWS Lambda</strong>, so maybe they com­ple­ment each other? As it turns out they do, <strong>Vertx</strong> can get most of your <strong>Lamb­das</strong>…</p><p>Using the <a href=\"https://serverless.com/\"><strong>Server­less Frame­work</strong></a> to cre­ate, man­age and de­ploy your new <strong>Lamb­das</strong> I was able to get this <strong>micro-​service</strong> up and run­ning in no time.</p><p><em>Enough with the talk, lets see the im­ple­men­ta­tion.</em></p><h2 id=\"code\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#code\"></a>Code</h2><p><em>Han­dler Class, entry point of AWS Re­quest.</em></p><p>The first issue that I had was the <strong>sync</strong> Event Han­dler that is pro­vided by AWS. So I had to by pass it with Fu­ture. In the Han­dler class I first ini­ti­ate Vertx in­stance in a sta­tic block and de­ploy few Ver­ti­cles that will do the work. This class only re­ceives the event, ex­tracts needed data from the re­quest and passes the data to Vertx Event­Bus. After the Con­sumers han­dle the re­quest, Han­dler class will gen­er­ate a proper re­sponse and fin­ish the AWS re­quest.</p><div>...waiting for Gist...</div><p><em>Line 4-18:</em> This is where Vertx in­stance is cre­ated, Ver­ti­cles are de­ployed and <strong>Async JDBC</strong> client is cre­ated. I fig­ured out that it is bet­ter to cre­ated JDBC client here as in some cases I was time­out when that logic was in the Ver­ti­cle start method.</p><p><em>Line 27-36:</em> These are helper lines, pars­ing and for­mat­ting the data so I can pass it to the Ver­ti­cles.</p><p><em>Line 38-45:</em> I have de­cided to map the con­sumers to the ad­dress that is made of re­quest method and url path, ex­am­ple POST/api. This means each API re­quest is mapped to its own con­sumer in Ver­ti­cle class.</p><p><em>Line 47-77:</em> This is noth­ing but a block of code that han­dles the re­sponse that was passed from Ver­ti­cles to the Fu­ture and gen­er­ates the final re­sponse that will be re­turn to API Gate­way.</p><p><em>UrlSer­vice, Vertx Ver­ti­cle.</em></p><p>Ver­ti­cle class is pretty for­ward. Con­sumers that will process the mes­sage, meth­ods for work­ing with JDBC and helper meth­ods for hash­ing/de­hash­ing id. The logic be­hind url short­en­ing is fairly sim­ple here. Each long url is stored in data­base with a unique id and few ad­di­tional columns. Row id is hashed and re­turned as short url. When re­triev­ing long url hash is de­coded to row id and long url is re­trieved. Later user is redi­rected to long url. With this im­ple­men­ta­tion, on 6 char short url (char­ac­ters after the do­main) you get 62^6 com­bi­na­tions which is 56 800 235 584 rows for stor­ing your urls. TinyURL is cur­rently at 6 long char urls (char­ac­ters after do­main). You can of course im­ple­ment meth­ods for reusing and re­cy­cling ids.</p><div>...waiting for Gist...</div><p>As said, this is all fairly straight for­ward, if you are al­ready fa­mil­iar with <strong>Vertx</strong>. If you are think­ing why have I re­peated the code for es­tab­lish a <strong>JDBC</strong> con­nec­tion, here is the ex­pla­na­tion <em>(line: 10-16)</em>. I was get­ting Time­outs when cre­at­ing JDBC con­nec­tion in Ver­ti­cles. To avoid this I also added this code to my Han­dler class. This way con­nec­tion is cre­ated there and be­cause of the <strong>Vertx</strong> im­ple­men­ta­tion any later at­tempt to cre­ate it again will re­sult in just get­ting the in­stances from the first in­vo­ca­tion. This es­caped the need to pass the in­stances di­rectly from the Han­dler class when cre­at­ing Ver­ti­cle in­stances.</p><p><em>Server­less con­fig­u­ra­tion.</em></p><p>Lastly I would like to share the server­less.yml, con­fir­ma­tion file that al­lows seam­lessly de­ploy and man­age­ment of AWS Lambda. With just a few com­mands and lines of con­fig­u­ra­tion you are able to con­fig­ure all nec­es­sary steps for de­ploy­ing your AWS Lambda. Frame­work takes care of mak­ing con­fig­u­ra­tion of Api-​Gateway and other AWS has­sle that would oth­er­wise needed to be done by hand. In this case Lambda is in­voked by HTTP events.</p><div>...waiting for Gist...</div><h2 id=\"performance-and-tests\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#performance-and-tests\"></a>Performance and Tests</h2><p><strong>Vertx</strong> async ca­pa­bil­i­ties eased the stress and mem­ory needs of tra­di­tional <strong>AWS Lamb­das</strong> with sync meth­ods. After per­form­ing load tests Lamb­das that were writ­ten using Vertx frame­work pre­formed <strong>10% faster and con­sumed 40% less mem­ory</strong>. As I have read some­where in Vertx doc­u­men­ta­tion, Sync meth­ods will def­i­nitely fin­ish the first re­quest faster but in total Async will be faster in the end. This sav­ings in mem­ory and time will def­i­nitely re­duce the cost of run­ning your Lamb­das and the lit­tle over­head with ad­di­tional code is for sure worth it.</p><h2 id=\"conclusion\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#conclusion\"></a>Conclusion</h2><p>To fol­low the pace of de­mand­ing needs for fast and re­silient ser­vices we need to move from tra­di­tional Mono­liths. Em­brac­ing the <strong>micro ser­vice</strong> ar­chi­tec­ture alone will not cut it, not any­more. With the rise and rapid ad­vance­ment of <strong>Cloud</strong> so­lu­tions it has never been so easy to make a truly <strong>Server­less</strong> sys­tems build upon net­work of <strong>micro ser­vices</strong>.\nAs you have seen <strong>Vertx</strong> with its async API makes the full ad­van­tage of <strong>AWS Lamb­das</strong>, em­brac­ing them while also im­prov­ing the per­for­mance and low­er­ing the costs. With the help from <strong>Server­less Frame­work</strong> writ­ing, de­ploy­ing and man­ag­ing your <strong>Lamb­das</strong> has never been so easy.</p><p>If you are in­ter­ested in the whole project, you can find it on <a href=\"https://github.com/pendula95/vertx-aws-url-shortener-service/tree/master\"><strong>GitHub</strong></a>.</p><div class=\"alert info\"><p>This is a re-​publication of the fol­low­ing <a href=\"http://lazarbulic.com/blog/2017/11/10/aws-lambda-vertx-framework-url-shortener-backend/\">blog post</a></p></div>","scope":{}},"tfIdfTerms":[{"term":"lambda","tf":13},{"term":"aw","tf":10},{"term":"verticl","tf":10},{"term":"url","tf":10},{"term":"will","tf":9},{"term":"servic","tf":8},{"term":"serverless","tf":8},{"term":"creat","tf":8},{"term":"class","tf":8},{"term":"deploi","tf":7},{"term":"request","tf":7},{"term":"line","tf":7},{"term":"method","tf":7},{"term":"code","tf":6},{"term":"handler","tf":6},{"term":"need","tf":6},{"term":"event","tf":5},{"term":"framework","tf":5},{"term":"pass","tf":5},{"term":"instanc","tf":5},{"term":"consum","tf":5},{"term":"jdbc","tf":5},{"term":"api","tf":5},{"term":"id","tf":5},{"term":"long","tf":5}]},{"filename":"blog/2017-12-20-tcp-client-using-eclipse-vert-x-kotlin-and-gradle-build.mdx","date":"2017-12-20","slug":"tcp-client-using-eclipse-vert-x-kotlin-and-gradle-build","meta":{"title":"TCP Client using Eclipse Vert.x, Kotlin and Gradle build","category":"guides","authors":[{"name":"Usman Saleem","github_id":"usmansaleem"}],"summary":"In this blog post, I demonstrate how to write a very simple TCP client that keeps a connection open to a custom-written server in cloud."},"readingTime":{"text":"5 min read","minutes":4.185,"time":251099.99999999997,"words":837},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"As part of my hobby project to con\\xADtrol Rasp\\xADber\\xADryPi using Google Home Mini and/or Alexa, I wanted to write a very sim\\xADple TCP client that keeps a con\\xADnec\\xADtion open to one of my cus\\xADtom writ\\xADten server in cloud (I will write an\\xADother blog post to cover the server side on a later date). The re\\xADquire\\xADment of the client is to send a shared se\\xADcret upon con\\xADnect\\xADing and then keep wait\\xADing for mes\\xADsage from server. Vert.x, Kotlin and Gra\\xADdle allow rapid de\\xADvel\\xADop\\xADment of such project. The gen\\xADer\\xADated jar can be ex\\xADe\\xADcuted on Rasp\\xADberry Pi. These steps out\\xADline the project setup and re\\xADlated source code to show\\xADcase a Vert.x and Kotlin project with Gra\\xADdle.\"), mdx(\"h2\", {\n    \"id\": \"project-directory-structure\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#project-directory-structure\"\n  })), \"Project Directory Structure\"), mdx(\"p\", null, \"From com\\xADmand line (or via Win\\xADdows Ex\\xADplorer, what\\xADever you pre\\xADfer to use) cre\\xADate a di\\xADrec\\xADtory for project,for in\\xADstance \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-net-client\"), \". Since we are using Kotlin, we will place all Kotlin files in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/kotlin\"), \" folder. The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/resources\"), \" folder will con\\xADtain our log\\xADging con\\xADfig\\xADu\\xADra\\xADtion re\\xADlated files.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-awk\"\n  }), \"cd vertx-net-client\\nmkdir -p src\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-regexp\"\n  }), \"/main/\"), \"kotlin\\nmkdir -p src\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-regexp\"\n  }), \"/main/\"), \"resources\\n\")), mdx(\"h3\", {\n    \"id\": \"project-files\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#project-files\"\n  })), \"Project Files\"), mdx(\"p\", null, \"We need to add fol\\xADlow\\xADing files in the project\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".gitignore\"), \"\\nIf you want to check your project into git, you may con\\xADsider adding fol\\xADlow\\xADing \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".gitignore\"), \" file at root of your project\")), mdx(Gist, {\n    url: \"https://gist.github.com/usmansaleem/b5838484a20cb8b08f236f2265ad7a8e\",\n    mdxType: \"Gist\"\n  }), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"logback.xml\"), \"\\nThis ex\\xADam\\xADple is using slf4j and log\\xADback for log\\xADging. If you de\\xADcide to use it in your project, you may also add fol\\xADlow\\xADing log\\xADback.xml file in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"src/main/resources\"), \". Mod\\xADify it as per your re\\xADquire\\xADments. This ex\\xADam\\xADple will\\nlog on con\\xADsole.\")), mdx(Gist, {\n    url: \"https://gist.github.com/usmansaleem/750c6d1cad0721b52be2ff00f758fb9f\",\n    mdxType: \"Gist\"\n  }), mdx(\"h2\", {\n    \"id\": \"gradle-setup\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#gradle-setup\"\n  })), \"Gradle Setup\"), mdx(\"p\", null, \"We will use Gra\\xADdle build sys\\xADtem for this project. If you don\\u2019t al\\xADready have Gra\\xADdle avail\\xADable on your sys\\xADtem, down\\xADload and unzip gra\\xADdle in a di\\xADrec\\xADtory of your choice (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$GRADLE_HOME\"), \" is used here to rep\\xADre\\xADsent this di\\xADrec\\xADtory). This gra\\xADdle dis\\xADtri\\xADb\\xADu\\xADtion will be used as a start\\xADing point to cre\\xADate Gra\\xADdle wrap\\xADper scripts for our project. These scripts will allow our project to down\\xADload and use cor\\xADrect ver\\xADsion of gra\\xADdle dis\\xADtri\\xADb\\xADu\\xADtion au\\xADto\\xADmat\\xADi\\xADcally with\\xADout mess\\xADing up sys\\xADtem. Re\\xADally use\\xADful when build\\xADing your project on CI tool or on any other de\\xADvel\\xADoper\\u2019s ma\\xADchine.\"), mdx(\"p\", null, \"Run fol\\xADlow\\xADing com\\xADmand in project\\u2019s di\\xADrec\\xADtory\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-variable\"\n  }), \"$GRADLE_HOME\"), \"/bin/gradle wrapper\\n\")), mdx(\"p\", null, \"The above com\\xADmands will gen\\xADer\\xADate fol\\xADlow\\xADing files and di\\xADrec\\xADto\\xADries.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"gradle/  gradlew  gradlew.bat\\n\")), mdx(\"h3\", {\n    \"id\": \"gradle-build-file-buildgradle\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#gradle-build-file-buildgradle\"\n  })), \"Gradle build file \", mdx(\"inlineCode\", {\n    parentName: \"h3\"\n  }, \"build.gradle\")), mdx(\"p\", null, \"Cre\\xADate (and/or copy and mod\\xADify) fol\\xADlow\\xADing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"build.gradle\"), \" in your project\\u2019s root di\\xADrec\\xADtory. Our ex\\xADam\\xADple gra\\xADdle build file is using \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/jponge/vertx-gradle-plugin/\"\n  }), \"vertx-\\u200Bgradle-plugin\"), \".\"), mdx(Gist, {\n    url: \"https://gist.github.com/usmansaleem/e723f25b827e0a925eaef2957a80132d\",\n    mdxType: \"Gist\"\n  }), mdx(\"p\", null, \"In the project di\\xADrec\\xADtory, run fol\\xADlow\\xADing com\\xADmand to down\\xADload local gra\\xADdle dis\\xADtri\\xADb\\xADu\\xADtion:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"./gradlew\\n\")), mdx(\"p\", null, \"(or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".\\\\gradlew.bat\"), \" if in Win\\xADdows)\"), mdx(\"p\", null, \"At this stage we should have fol\\xADlow\\xADing file struc\\xADture. This is also a good time to com\\xADmit changes if you are work\\xADing with git.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".gitignore\"), \"                              \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"build.gradle\"), \"                            \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gradle/wrapper/gradle-wrapper.jar\"), \"       \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gradle/wrapper/gradle-wrapper.properties\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gradlew\"), \"                                 \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gradlew.bat\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"src/main/resources/logback.xml\"))), mdx(\"p\", null, \"Now that our project struc\\xADture is ready, time to add the meat of the project. You may use any IDE of your choice. My pref\\xADer\\xADence is In\\xADtel\\xADliJ IDEA.\"), mdx(\"p\", null, \"Cre\\xADate a new pack\\xADage under \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/kotlin\"), \". The pack\\xADage name should be adapted from the fol\\xADlow\\xADing sec\\xADtion of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"build.gradle\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-ebnf\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attribute\"\n  }), \"vertx\"), \" {\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attribute\"\n  }), \"    mainVerticle\"), \" = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"info.usmans.blog.vertx.NetClientVerticle\\\"\"), \"\\n}\\n\")), mdx(\"p\", null, \"From the above ex\\xADam\\xADple, the pack\\xADage name is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"info.usmans.blog.vertx\")), mdx(\"p\", null, \"Add a new Kotlin Class/file in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/kotlin/info/usmans/blog/vertx\"), \" as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"NetClientVerticle.kt\")), mdx(\"p\", null, \"The con\\xADtents of this class is as fol\\xADlows\"), mdx(Gist, {\n    url: \"https://gist.github.com/usmansaleem/2a176a7b752fcb72f7f31964809696fe\",\n    mdxType: \"Gist\"\n  }), mdx(\"h2\", {\n    \"id\": \"explaining-the-code\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#explaining-the-code\"\n  })), \"Explaining the Code\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fun main(args: Array<String>)\"), \" is not strictly re\\xADquired, it quickly al\\xADlows run\\xADning the Vert.x ver\\xADti\\xADcle from within IDE. You will also no\\xADtice a small hack in the method for set\\xADting sys\\xADtem prop\\xADerty \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.disableDnsResolver\"), \" which is to avoid a Netty bug that I ob\\xADserved when run\\xADning on Win\\xADdows ma\\xADchine and re\\xADmote server is down. Of course, since we are using vertx-\\u200Bgradle-plugin, we can also use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gradle vertxRun\"), \" to run our ver\\xADti\\xADcle. In this case the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"main\"), \" method will not get called.\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"override fun start()\"), \" method calls \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fireReconnectTimer\"), \" which in turn calls \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"reconnect\"), \" method. \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"reconnect\"), \" method con\\xADtains the con\\xADnec\\xADtion logic to server as well as it calls \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fireReconnectTimer\"), \" if it is un\\xADable to con\\xADnect to server or dis\\xADcon\\xADnects from server. In \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"reconnect\"), \" method the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"socket.handler\"), \" gets called when server send mes\\xADsage to client.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xl\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"socket\"), \".handler({ \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"data\"), \" ->\"), \"\\n                        logger.info(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Data received: ${data}\\\"\"), \")\\n                        \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"//\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-doctag\"\n  }), \"TODO:\"), \" Do the work here ...\"), \"\\n               })\\n\")), mdx(\"h2\", {\n    \"id\": \"distributing-the-project\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#distributing-the-project\"\n  })), \"Distributing the project\"), mdx(\"p\", null, \"To cre\\xADate re\\xADdis\\xADtrib\\xADutable jar, use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"./gradlew shadowJar\"), \" com\\xADmand. Or if using In\\xADtel\\xADliJ: from Gra\\xADdle projects, Tasks, shadow, shad\\xADow\\xADJar (right click run). This com\\xADmand will gen\\xADer\\xADate \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"./build/libs/vertx-net-client-fat.jar\"), \".\"), mdx(\"h3\", {\n    \"id\": \"executing-the-client\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#executing-the-client\"\n  })), \"Executing the client\"), mdx(\"p\", null, \"The client jar can be ex\\xADe\\xADcuted using fol\\xADlow\\xADing com\\xADmand:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \" java -DserverHost=127.0.0.1 -DserverPort=8888 -DconnectMessage=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"hello\\\"\"), \" -jar vertx-net-client-full.jar\\n\")), mdx(\"p\", null, \"If you wish to use SLF4J for Vert.x in\\xADter\\xADnal log\\xADging, you need to pass sys\\xADtem prop\\xADerty \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.logger-delegate-factory-class-name\"), \" with value of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"io.vertx.core.logging.SLF4JLogDelegateFactory\"), \". The final com\\xADmand would look like:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"java -DserverHost=127.0.0.1 -DserverPort=8888 -DconnectMessage=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"hello\\\"\"), \" -Dvertx.logger-delegate-factory-class-name=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"io.vertx.core.logging.SLF4JLogDelegateFactory\\\"\"), \" -jar vertx-net-client-full.jar\\n\")), mdx(\"p\", null, \"You can con\\xADfig\\xADure Vert.x log\\xADging lev\\xADels in log\\xADback.xml file if re\\xADquired.\"), mdx(\"h2\", {\n    \"id\": \"conclusion\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#conclusion\"\n  })), \"Conclusion\"), mdx(\"p\", null, \"This post de\\xADscribes how easy it is to cre\\xADate a sim\\xADple TCP client using Vert.x, Kotlin and Gra\\xADdle build sys\\xADtem. Hope\\xADfully the tech\\xADniques shown here will serve as a start\\xADing point for your next DIY project.\"), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"This post is adapted and re\\xADpro\\xADduced from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://usmans.info/view/blog/tcp_client_using_vertx_kotlin_gradle\"\n  }), \"au\\xADthor\\u2019s blog post\"))));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"<p>As part of my hobby project to con­trol Rasp­ber­ryPi using Google Home Mini and/or Alexa, I wanted to write a very sim­ple TCP client that keeps a con­nec­tion open to one of my cus­tom writ­ten server in cloud (I will write an­other blog post to cover the server side on a later date). The re­quire­ment of the client is to send a shared se­cret upon con­nect­ing and then keep wait­ing for mes­sage from server. Vert.x, Kotlin and Gra­dle allow rapid de­vel­op­ment of such project. The gen­er­ated jar can be ex­e­cuted on Rasp­berry Pi. These steps out­line the project setup and re­lated source code to show­case a Vert.x and Kotlin project with Gra­dle.</p><h2 id=\"project-directory-structure\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#project-directory-structure\"></a>Project Directory Structure</h2><p>From com­mand line (or via Win­dows Ex­plorer, what­ever you pre­fer to use) cre­ate a di­rec­tory for project,for in­stance <code>vertx-net-client</code>. Since we are using Kotlin, we will place all Kotlin files in <code>src/main/kotlin</code> folder. The <code>src/main/resources</code> folder will con­tain our log­ging con­fig­u­ra­tion re­lated files.</p><pre><code class=\"hljs language-awk\">cd vertx-net-client\nmkdir -p src<span class=\"hljs-regexp\">/main/</span>kotlin\nmkdir -p src<span class=\"hljs-regexp\">/main/</span>resources\n</code></pre><h3 id=\"project-files\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#project-files\"></a>Project Files</h3><p>We need to add fol­low­ing files in the project</p><ul><li><code>.gitignore</code>\nIf you want to check your project into git, you may con­sider adding fol­low­ing <code>.gitignore</code> file at root of your project</li></ul><div>...waiting for Gist...</div><ul><li><code>logback.xml</code>\nThis ex­am­ple is using slf4j and log­back for log­ging. If you de­cide to use it in your project, you may also add fol­low­ing log­back.xml file in <code>src/main/resources</code>. Mod­ify it as per your re­quire­ments. This ex­am­ple will\nlog on con­sole.</li></ul><div>...waiting for Gist...</div><h2 id=\"gradle-setup\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#gradle-setup\"></a>Gradle Setup</h2><p>We will use Gra­dle build sys­tem for this project. If you don’t al­ready have Gra­dle avail­able on your sys­tem, down­load and unzip gra­dle in a di­rec­tory of your choice (<code>$GRADLE_HOME</code> is used here to rep­re­sent this di­rec­tory). This gra­dle dis­tri­b­u­tion will be used as a start­ing point to cre­ate Gra­dle wrap­per scripts for our project. These scripts will allow our project to down­load and use cor­rect ver­sion of gra­dle dis­tri­b­u­tion au­to­mat­i­cally with­out mess­ing up sys­tem. Re­ally use­ful when build­ing your project on CI tool or on any other de­vel­oper’s ma­chine.</p><p>Run fol­low­ing com­mand in project’s di­rec­tory</p><pre><code class=\"hljs language-bash\"><span class=\"hljs-variable\">$GRADLE_HOME</span>/bin/gradle wrapper\n</code></pre><p>The above com­mands will gen­er­ate fol­low­ing files and di­rec­to­ries.</p><pre><code class=\"hljs language-bash\">gradle/  gradlew  gradlew.bat\n</code></pre><h3 id=\"gradle-build-file-buildgradle\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#gradle-build-file-buildgradle\"></a>Gradle build file <code>build.gradle</code></h3><p>Cre­ate (and/or copy and mod­ify) fol­low­ing <code>build.gradle</code> in your project’s root di­rec­tory. Our ex­am­ple gra­dle build file is using <a href=\"https://github.com/jponge/vertx-gradle-plugin/\">vertx-​gradle-plugin</a>.</p><div>...waiting for Gist...</div><p>In the project di­rec­tory, run fol­low­ing com­mand to down­load local gra­dle dis­tri­b­u­tion:</p><pre><code class=\"hljs language-bash\">./gradlew\n</code></pre><p>(or <code>.\\gradlew.bat</code> if in Win­dows)</p><p>At this stage we should have fol­low­ing file struc­ture. This is also a good time to com­mit changes if you are work­ing with git.</p><ul><li><code>.gitignore</code>                              </li><li><code>build.gradle</code>                            </li><li><code>gradle/wrapper/gradle-wrapper.jar</code>       </li><li><code>gradle/wrapper/gradle-wrapper.properties</code></li><li><code>gradlew</code>                                 </li><li><code>gradlew.bat</code></li><li><code>src/main/resources/logback.xml</code></li></ul><p>Now that our project struc­ture is ready, time to add the meat of the project. You may use any IDE of your choice. My pref­er­ence is In­tel­liJ IDEA.</p><p>Cre­ate a new pack­age under <code>src/main/kotlin</code>. The pack­age name should be adapted from the fol­low­ing sec­tion of <code>build.gradle</code></p><pre><code class=\"hljs language-ebnf\"><span class=\"hljs-attribute\">vertx</span> {\n<span class=\"hljs-attribute\">    mainVerticle</span> = <span class=\"hljs-string\">&quot;info.usmans.blog.vertx.NetClientVerticle&quot;</span>\n}\n</code></pre><p>From the above ex­am­ple, the pack­age name is <code>info.usmans.blog.vertx</code></p><p>Add a new Kotlin Class/file in <code>src/main/kotlin/info/usmans/blog/vertx</code> as <code>NetClientVerticle.kt</code></p><p>The con­tents of this class is as fol­lows</p><div>...waiting for Gist...</div><h2 id=\"explaining-the-code\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#explaining-the-code\"></a>Explaining the Code</h2><p>The <code>fun main(args: Array&lt;String&gt;)</code> is not strictly re­quired, it quickly al­lows run­ning the Vert.x ver­ti­cle from within IDE. You will also no­tice a small hack in the method for set­ting sys­tem prop­erty <code>vertx.disableDnsResolver</code> which is to avoid a Netty bug that I ob­served when run­ning on Win­dows ma­chine and re­mote server is down. Of course, since we are using vertx-​gradle-plugin, we can also use <code>gradle vertxRun</code> to run our ver­ti­cle. In this case the <code>main</code> method will not get called.</p><p>The <code>override fun start()</code> method calls <code>fireReconnectTimer</code> which in turn calls <code>reconnect</code> method. <code>reconnect</code> method con­tains the con­nec­tion logic to server as well as it calls <code>fireReconnectTimer</code> if it is un­able to con­nect to server or dis­con­nects from server. In <code>reconnect</code> method the <code>socket.handler</code> gets called when server send mes­sage to client.</p><pre><code class=\"hljs language-xl\"><span class=\"hljs-function\"><span class=\"hljs-title\">socket</span>.handler({ <span class=\"hljs-keyword\">data</span> -&gt;</span>\n                        logger.info(<span class=\"hljs-string\">&quot;Data received: ${data}&quot;</span>)\n                        <span class=\"hljs-comment\">//<span class=\"hljs-doctag\">TODO:</span> Do the work here ...</span>\n               })\n</code></pre><h2 id=\"distributing-the-project\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#distributing-the-project\"></a>Distributing the project</h2><p>To cre­ate re­dis­trib­utable jar, use <code>./gradlew shadowJar</code> com­mand. Or if using In­tel­liJ: from Gra­dle projects, Tasks, shadow, shad­ow­Jar (right click run). This com­mand will gen­er­ate <code>./build/libs/vertx-net-client-fat.jar</code>.</p><h3 id=\"executing-the-client\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#executing-the-client\"></a>Executing the client</h3><p>The client jar can be ex­e­cuted using fol­low­ing com­mand:</p><pre><code class=\"hljs language-bash\"> java -DserverHost=127.0.0.1 -DserverPort=8888 -DconnectMessage=<span class=\"hljs-string\">&quot;hello&quot;</span> -jar vertx-net-client-full.jar\n</code></pre><p>If you wish to use SLF4J for Vert.x in­ter­nal log­ging, you need to pass sys­tem prop­erty <code>vertx.logger-delegate-factory-class-name</code> with value of <code>io.vertx.core.logging.SLF4JLogDelegateFactory</code>. The final com­mand would look like:</p><pre><code class=\"hljs language-bash\">java -DserverHost=127.0.0.1 -DserverPort=8888 -DconnectMessage=<span class=\"hljs-string\">&quot;hello&quot;</span> -Dvertx.logger-delegate-factory-class-name=<span class=\"hljs-string\">&quot;io.vertx.core.logging.SLF4JLogDelegateFactory&quot;</span> -jar vertx-net-client-full.jar\n</code></pre><p>You can con­fig­ure Vert.x log­ging lev­els in log­back.xml file if re­quired.</p><h2 id=\"conclusion\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#conclusion\"></a>Conclusion</h2><p>This post de­scribes how easy it is to cre­ate a sim­ple TCP client using Vert.x, Kotlin and Gra­dle build sys­tem. Hope­fully the tech­niques shown here will serve as a start­ing point for your next DIY project.</p><div class=\"alert info\"><p>This post is adapted and re­pro­duced from <a href=\"https://usmans.info/view/blog/tcp_client_using_vertx_kotlin_gradle\">au­thor’s blog post</a></p></div>","scope":{}},"tfIdfTerms":[{"term":"project","tf":23},{"term":"us","tf":19},{"term":"gradl","tf":16},{"term":"will","tf":12},{"term":"file","tf":12},{"term":"follow","tf":11},{"term":"server","tf":8},{"term":"directori","tf":8},{"term":"command","tf":8},{"term":"client","tf":6},{"term":"kotlin","tf":6},{"term":"creat","tf":6},{"term":"system","tf":6},{"term":"run","tf":6},{"term":"method","tf":6},{"term":"log","tf":5},{"term":"build","tf":5},{"term":"call","tf":5},{"term":"connect","tf":4},{"term":"post","tf":4},{"term":"requir","tf":4},{"term":"add","tf":4},{"term":"exampl","tf":4},{"term":"distribut","tf":4},{"term":"allow","tf":3}]},{"filename":"blog/2017-11-14-eclipse-vert-x-meets-graphql.mdx","date":"2017-11-14","slug":"eclipse-vert-x-meets-graphql","meta":{"title":"Eclipse Vert.x meets GraphQL","category":"guides","authors":[{"name":"Johannes Schüth","github_id":"jotschi"}],"summary":"In this blog post, we will look at an example application written in Vert.x that uses the new GraphQL API of Gentics Mesh."},"readingTime":{"text":"7 min read","minutes":6.31,"time":378599.99999999994,"words":1262},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I re\\xADcently added GraphQL sup\\xADport to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/gentics/mesh\"\n  }), \"Gen\\xADtics Mesh\"), \" and I thought it would be a good idea to boil down the essence of my im\\xADple\\xADmen\\xADta\\xADtion in ex\\xADam\\xADple so that I could share it in a sim\\xADpler form.\\nThe ex\\xADam\\xADple I\\u2019m about to show will not cover all as\\xADpects that I have added to the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://getmesh.io/docs/beta/graphql.html\"\n  }), \"Gen\\xADtics Mesh API\"), \" (e.g. pag\\xADing, search and error han\\xADdling) but it will give you a basic overview of the parts that I put to\\xADgether.\\nGraphQL does not re\\xADquire a GraphDB even if the name might sug\\xADgest it.\"), mdx(\"p\", null, \"Using a graphdb in com\\xADbi\\xADna\\xADtion with GraphQL does nev\\xADer\\xADthe\\xADless pro\\xADvide you with some ad\\xADvan\\xADtages which I will high\\xADlight later on.\"), mdx(\"h2\", {\n    \"id\": \"what-is-graphql-what-is-it-good-for\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#what-is-graphql-what-is-it-good-for\"\n  })), \"What is GraphQL? What is it good for?\"), mdx(\"p\", null, \"GraphQL as the name sug\\xADgests is a new query lan\\xADguage which can be used to load ex\\xADactly the amount of data which you ask for. \"), mdx(\"p\", null, \"The query is de\\xADfined in way that the query fields cor\\xADre\\xADlate to the JSON data that is being re\\xADtrieved.\\nIn our Star\\xADWars Demo do\\xADmain model this query will load the name of human 1001 which is Darth Vader.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-css\"\n  }), \"{\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attribute\"\n  }), \"vader\"), \": \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-built_in\"\n  }), \"human\"), \"(id: \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"1001\"), \") {\\n    name\\n  }\\n}\\n\")), mdx(\"p\", null, \"Would re\\xADsult in:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-json\"\n  }), \"{\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"data\\\"\"), \": {\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"vader\\\"\"), \": {\\n      \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"name\\\"\"), \": \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Darth Vader\\\"\"), \"\\n    }\\n  }\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"the-demo-app\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#the-demo-app\"\n  })), \"The Demo App\"), mdx(\"p\", null, \"The demo ap\\xADpli\\xADca\\xADtion I build makes use of the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/graphql-java/graphql-java\"\n  }), \"graphql-\\u200Bjava\"), \" li\\xADbrary. The data is being stored in a graph data\\xADbase.\\nI use \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://orientdb.com/orientdb/\"\n  }), \"Ori\\xADentDB\"), \" in com\\xADbi\\xADna\\xADtion with the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Syncleus/Ferma\"\n  }), \"OGM Ferma\"), \" to pro\\xADvide a data ac\\xADcess layer.\\nGraphQL does not nec\\xADes\\xADsar\\xADily re\\xADquire a graph data\\xADbase but in this ex\\xADam\\xADple I will make use of one and high\\xADlight the ben\\xADe\\xADfits of using a GraphDB for my use\\xADcase.\"), mdx(\"p\", null, \"You can find the sources here: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graphql-example\"\n  }), \"https://github.com/Jotschi/vertx-\\u200Bgraphql-example\")), mdx(\"h3\", {\n    \"id\": \"data\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#data\"\n  })), \"Data\"), mdx(\"p\", null, \"The \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/data/StarWarsData.java\"\n  }), \"Star\\xADWars\\xADData\"), \" class cre\\xADates a Graph which con\\xADtains the Star Wars Movies and Char\\xADac\\xADters, Plan\\xADets and their re\\xADla\\xADtions.\\nThe model is fairly sim\\xADple. There is a sin\\xADgle Star\\xADWars\\xADRoot ver\\xADtex which acts as a start el\\xADe\\xADment for var\\xADi\\xADous ag\\xADgre\\xADga\\xADtion ver\\xADtices: Movies are stored in Movie\\xADRoot, Plan\\xADets in Plan\\xADet\\xADs\\xADRoot, Char\\xADac\\xADters are stored in Hu\\xADman\\xADs\\xADRoot and Droid\\xADs\\xADRoot.\"), mdx(\"p\", null, \"The model classes are used for wrap\\xADpers of the spe\\xADcific graph ver\\xADtices. The \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://syncleus.com/Ferma/\"\n  }), \"Ferma OGM\"), \" is used to pro\\xADvide these wrap\\xADpers. Each class con\\xADtains meth\\xADods which can be used to tra\\xADverse the graph to lo\\xADcate the needed ver\\xADtices.\\nThe found ver\\xADtices are in turn again wrapped and can be used to lo\\xADcate other graph el\\xADe\\xADments.\"), mdx(\"h3\", {\n    \"id\": \"schema\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#schema\"\n  })), \"Schema\"), mdx(\"p\", null, \"The next thing we need is the GraphQL schema. The schema de\\xADscribes each el\\xADe\\xADment which can be re\\xADtrieved. It also de\\xADscribes the prop\\xADer\\xADties and re\\xADla\\xADtion\\xADships for these el\\xADe\\xADments.\"), mdx(\"p\", null, \"The graphql-\\u200Bjava li\\xADbrary pro\\xADvides an API to cre\\xADate the ob\\xADject types and schema in\\xADfor\\xADma\\xADtion.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-clojure\"\n  }), \"private GraphQLObjectType createMovieType() {\\n  return newObject().name(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Movie\\\"\"), \")\\n    .description(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"One of the films in the Star Wars universe.\\\"\"), \")\\n\\n    // .title\\n    .field(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"newFieldDefinition\"), \"().name(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"title\\\"\"), \")\\n        .description(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Title of the episode.\\\"\"), \")\\n        .type(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"GraphQLString\"), \")\\n        .dataFetcher((\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"env\"), \") -> {\\n          Movie movie = env.getSource()\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \";\"), \"\\n          return movie.getName()\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \";\"), \"\\n        }))\\n\\n    // .description\\n    .field(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"newFieldDefinition\"), \"().name(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"description\\\"\"), \")\\n        .description(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Description of the episode.\\\"\"), \")\\n        .type(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"GraphQLString\"), \"))\\n\\n    .build()\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \";\"), \"\\n}\\n\")), mdx(\"p\", null, \"A type can be ref\\xADer\\xADenced via a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GraphQLTypeReference\"), \" once it has been cre\\xADated and added to the schema. This is es\\xADpe\\xADcially im\\xADpor\\xADtant if you need to add fields which ref\\xADer\\xADence other types.\\nData fetch\\xADers are used to ac\\xADcess the con\\xADtext, tra\\xADverse the graph and re\\xADtrieve prop\\xADer\\xADties from graph el\\xADe\\xADments.\"), mdx(\"p\", null, \"An\\xADother great source to learn more about the schema op\\xADtions is the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/graphql-java/graphql-java/blob/master/src/test/groovy/graphql/GarfieldSchema.java\"\n  }), \"Garfield\\xADSchema\"), \" ex\\xADam\\xADple.\"), mdx(\"p\", null, \"Fi\\xADnally all the cre\\xADated types must be ref\\xADer\\xADenced by a cen\\xADtral ob\\xADject type \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/data/StarWarsSchema.java#L204\"\n  }), \"Query\\xADType\"), \".\\nThe query type ob\\xADject is ba\\xADsi\\xADcally the root ob\\xADject for the query.\\nIt de\\xADfines what query op\\xADtions are ini\\xADtially pos\\xADsi\\xADble. In our case it is pos\\xADsi\\xADble to load the hero of the sage, spe\\xADcific movies, hu\\xADmans or droids.\"), mdx(\"h3\", {\n    \"id\": \"verticle\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#verticle\"\n  })), \"Verticle\"), mdx(\"p\", null, \"The \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/GraphQLVerticle.java\"\n  }), \"GraphQLVer\\xADti\\xADcle\"), \" is used to ac\\xADcept the GraphQL re\\xADquest and process it.\"), mdx(\"p\", null, \"The ver\\xADti\\xADcle also con\\xADtains a Sta\\xADticHan\\xADdler to pro\\xADvide the Graphiql Browser web in\\xADter\\xADface. This in\\xADter\\xADface will allow you to quickly dis\\xADcover and ex\\xADper\\xADi\\xADment with GraphQL.\"), mdx(\"p\", null, \"The \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/GraphQLVerticle.java#L77\"\n  }), \"query han\\xADdler\"), \" ac\\xADcepts the query JSON data. \"), mdx(\"p\", null, \"An Ori\\xADentDB trans\\xADac\\xADtion is being opened and the query is ex\\xADe\\xADcuted:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"demoData.getGraph().asyncTx((tx) -> {\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Invoke the query and handle the resulting JSON\"), \"\\n  GraphQL graphQL = newGraphQL(schema).build();\\n  ExecutionInput input = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" ExecutionInput(query, \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"null\"), \", queryJson, demoData.getRoot(), extractVariables(queryJson));\\n  tx.complete(graphQL.execute(input));\\n}, (AsyncResult<ExecutionResult> rh) -> {\\n  ...\\n});\\n\")), mdx(\"p\", null, \"The ex\\xADe\\xADcute method ini\\xADtially needs a con\\xADtext vari\\xADable. This con\\xADtext passed along with the query.\\nIn our case the con\\xADtext is the root el\\xADe\\xADment of the graph \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"demoData.getRoot()\"), \".\\nThis con\\xADtext el\\xADe\\xADment also serves as the ini\\xADtial source for our data fetch\\xADers.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \".dataFetcher((env) -> {\\n  StarWarsRoot root = env.getSource();\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"return\"), \" root.getHero();\\n}))\\n\")), mdx(\"p\", null, \"The data fetch\\xADers for the hero type on the other hand will be able to ac\\xADcess the hero el\\xADe\\xADment since the fetcher above re\\xADturned the el\\xADe\\xADment.\\nUsing this mech\\xADa\\xADnism it is pos\\xADsi\\xADble to tra\\xADverse the graph. It is im\\xADpor\\xADtant to note that each in\\xADvo\\xADca\\xADtion on the do\\xADmain model meth\\xADods will di\\xADrectly ac\\xADcess the graph data\\xADbase.\\nThis way it is pos\\xADsi\\xADble to in\\xADflu\\xADence the graph data\\xADbase query down to the low\\xADest level. When omit\\xADting a prop\\xADerty from the graphql query it will not be loaded from the graph.\\nThus there is no need to write an ad\\xADdi\\xADtional data ac\\xADcess layer. All op\\xADer\\xADa\\xADtions are di\\xADrectly mapped to graph data\\xADbase.\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"StarWarsRoot\"), \" Ferma class \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getHero()\"), \" method in turn de\\xADfines a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://tinkerpop.apache.org/docs/3.3.0/tutorials/getting-started/#_graph_traversal_staying_simple\"\n  }), \"Tin\\xADker\\xADPop Grem\\xADlin tra\\xADver\\xADsal\"), \" which is used to load the Ver\\xADtex which rep\\xADre\\xADsents the hero of the Star Wars saga.\"), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://tinkerpop.apache.org/\"\n  }), \"Apache Tin\\xADker\\xADPop\"), \" is an open source, vendor-\\u200Bagnostic, graph frame\\xADwork / API which is sup\\xADported by many graph data\\xADbase ven\\xADdors.\\nOne part of Tin\\xADker\\xADPop is the Grem\\xADlin tra\\xADver\\xADsal lan\\xADguage which is great to query graph data\\xADbases.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"...\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" Droid \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"getHero\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"()\"), \" \"), \"{\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Follow the HAS_ROOT edge and return the first found Vertex which could be found. \"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Wrap the Vertex explicitly in the Droid Ferma class.  \"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"return\"), \" traverse((g) -> g.out(HAS_HERO)).nextOrDefaultExplicit(Droid.class, \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"null\"), \");\\n}\\n...\\n\")), mdx(\"p\", null, \"Once the query has been ex\\xADe\\xADcuted the re\\xADsult han\\xADdler is being in\\xADvoked. It con\\xADtains some code to process the re\\xADsult data and po\\xADten\\xADtial er\\xADrors.\\nIt is im\\xADpor\\xADtant to note that a GraphQL query will al\\xADways be an\\xADswered with a 2xx HTTP sta\\xADtus code.\\nIf an el\\xADe\\xADment which is being ref\\xADer\\xADenced in the query can\\u2019t be loaded an error will be added to the re\\xADsponse JSON ob\\xADject.\"), mdx(\"h3\", {\n    \"id\": \"testing\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#testing\"\n  })), \"Testing\"), mdx(\"p\", null, \"Test\\xADing is fairly straight for\\xADward. Al\\xADthough there are mul\\xADti\\xADple ap\\xADproaches. One ap\\xADproach is to use unit test\\xADing di\\xADrectly on the GraphQL types.\\nAn\\xADother op\\xADtion is to run queries against the end\\xADpoint.  \"), mdx(\"p\", null, \"The \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/test/java/de/jotschi/vertx/GraphQLTest.java\"\n  }), \"GraphQL\\xADTest class\"), \" I wrote will run mul\\xADti\\xADple queries against the end\\xADpoint.\\nA Pa\\xADra\\xADme\\xADter\\xADized JUnit test is used it\\xADer\\xADate over the queries.\"), mdx(\"p\", null, \"A \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/test/resources/graphql/full-query\"\n  }), \"typ\\xADi\\xADcal query\"), \" does not only con\\xADtain the query data.\\nThe as\\xADser\\xADtions on the re\\xADsponse JSON are di\\xADrectly in\\xADcluded in query using plain com\\xADments.\"), mdx(\"p\", null, \"I build an \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://joel-costigliola.github.io/assertj/\"\n  }), \"As\\xADsertJ\"), \" as\\xADser\\xADtion to check the com\\xADments of a query and ver\\xADify that the as\\xADser\\xADtion matches the re\\xADsponse.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"  assertThat(response).compliesToAssertions(queryName);\\n\")), mdx(\"h2\", {\n    \"id\": \"run-the-example\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#run-the-example\"\n  })), \"Run the example\"), mdx(\"p\", null, \"You can run the ex\\xADam\\xADple by ex\\xADe\\xADcut\\xADing the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GraphQLServer\"), \" class and ac\\xADcess the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://localhost:3000/browser/?query=%7B%0A%20%20movies%20%7B%0A%20%20%20%20title%0A%20%20%7D%0A%20%20hero%20%7B%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A\"\n  }), \"Graphiql browser on http://lo\\xADcal\\xADhost:3000/browser/\")), mdx(\"h2\", {\n    \"id\": \"where-to-go-from-here\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#where-to-go-from-here\"\n  })), \"Where to go from here?\"), mdx(\"p\", null, \"The ex\\xADam\\xADple is read-\\u200Bonly. GraphQL also sup\\xADports data mu\\xADta\\xADtion which can be used to ac\\xADtu\\xADally mod\\xADify and store data.\\nI have not yet ex\\xADplored that part of GraphQL but I as\\xADsume it might not be that hard to add mu\\xADta\\xADtion sup\\xADport to the ex\\xADam\\xADple.\"), mdx(\"p\", null, \"Ad\\xADdi\\xADtion\\xADally it does not cover how to ac\\xADtu\\xADally make use of such API. I re\\xADcently \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/gentics/mesh-vertx-example/\"\n  }), \"up\\xADdated my Vert.x ex\\xADam\\xADple\"), \" which shows how to use Vert.x tem\\xADplate han\\xADdlers to build a small server which ren\\xADders some pages using data which was loaded via GraphQL.\"), mdx(\"p\", null, \"Thanks for read\\xADing. If you have any fur\\xADther ques\\xADtions or feed\\xADback don\\u2019t hes\\xADi\\xADtate to send me a tweet to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/Jotschi/\"\n  }), \"@Jotschi\"), \" or \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/genticsmesh/\"\n  }), \"@gen\\xADtic\\xADsmesh\"), \".\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"<p>I re­cently added GraphQL sup­port to <a href=\"https://github.com/gentics/mesh\">Gen­tics Mesh</a> and I thought it would be a good idea to boil down the essence of my im­ple­men­ta­tion in ex­am­ple so that I could share it in a sim­pler form.\nThe ex­am­ple I’m about to show will not cover all as­pects that I have added to the <a href=\"https://getmesh.io/docs/beta/graphql.html\">Gen­tics Mesh API</a> (e.g. pag­ing, search and error han­dling) but it will give you a basic overview of the parts that I put to­gether.\nGraphQL does not re­quire a GraphDB even if the name might sug­gest it.</p><p>Using a graphdb in com­bi­na­tion with GraphQL does nev­er­the­less pro­vide you with some ad­van­tages which I will high­light later on.</p><h2 id=\"what-is-graphql-what-is-it-good-for\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#what-is-graphql-what-is-it-good-for\"></a>What is GraphQL? What is it good for?</h2><p>GraphQL as the name sug­gests is a new query lan­guage which can be used to load ex­actly the amount of data which you ask for. </p><p>The query is de­fined in way that the query fields cor­re­late to the JSON data that is being re­trieved.\nIn our Star­Wars Demo do­main model this query will load the name of human 1001 which is Darth Vader.</p><pre><code class=\"hljs language-css\">{\n  <span class=\"hljs-attribute\">vader</span>: <span class=\"hljs-built_in\">human</span>(id: <span class=\"hljs-number\">1001</span>) {\n    name\n  }\n}\n</code></pre><p>Would re­sult in:</p><pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">&quot;data&quot;</span>: {\n    <span class=\"hljs-attr\">&quot;vader&quot;</span>: {\n      <span class=\"hljs-attr\">&quot;name&quot;</span>: <span class=\"hljs-string\">&quot;Darth Vader&quot;</span>\n    }\n  }\n}\n</code></pre><h2 id=\"the-demo-app\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#the-demo-app\"></a>The Demo App</h2><p>The demo ap­pli­ca­tion I build makes use of the <a href=\"https://github.com/graphql-java/graphql-java\">graphql-​java</a> li­brary. The data is being stored in a graph data­base.\nI use <a href=\"http://orientdb.com/orientdb/\">Ori­entDB</a> in com­bi­na­tion with the <a href=\"https://github.com/Syncleus/Ferma\">OGM Ferma</a> to pro­vide a data ac­cess layer.\nGraphQL does not nec­es­sar­ily re­quire a graph data­base but in this ex­am­ple I will make use of one and high­light the ben­e­fits of using a GraphDB for my use­case.</p><p>You can find the sources here: <a href=\"https://github.com/Jotschi/vertx-graphql-example\">https://github.com/Jotschi/vertx-​graphql-example</a></p><h3 id=\"data\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#data\"></a>Data</h3><p>The <a href=\"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/data/StarWarsData.java\">Star­Wars­Data</a> class cre­ates a Graph which con­tains the Star Wars Movies and Char­ac­ters, Plan­ets and their re­la­tions.\nThe model is fairly sim­ple. There is a sin­gle Star­Wars­Root ver­tex which acts as a start el­e­ment for var­i­ous ag­gre­ga­tion ver­tices: Movies are stored in Movie­Root, Plan­ets in Plan­et­s­Root, Char­ac­ters are stored in Hu­man­s­Root and Droid­s­Root.</p><p>The model classes are used for wrap­pers of the spe­cific graph ver­tices. The <a href=\"http://syncleus.com/Ferma/\">Ferma OGM</a> is used to pro­vide these wrap­pers. Each class con­tains meth­ods which can be used to tra­verse the graph to lo­cate the needed ver­tices.\nThe found ver­tices are in turn again wrapped and can be used to lo­cate other graph el­e­ments.</p><h3 id=\"schema\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#schema\"></a>Schema</h3><p>The next thing we need is the GraphQL schema. The schema de­scribes each el­e­ment which can be re­trieved. It also de­scribes the prop­er­ties and re­la­tion­ships for these el­e­ments.</p><p>The graphql-​java li­brary pro­vides an API to cre­ate the ob­ject types and schema in­for­ma­tion.</p><pre><code class=\"hljs language-clojure\">private GraphQLObjectType createMovieType() {\n  return newObject().name(<span class=\"hljs-string\">&quot;Movie&quot;</span>)\n    .description(<span class=\"hljs-string\">&quot;One of the films in the Star Wars universe.&quot;</span>)\n\n    // .title\n    .field(<span class=\"hljs-name\">newFieldDefinition</span>().name(<span class=\"hljs-string\">&quot;title&quot;</span>)\n        .description(<span class=\"hljs-string\">&quot;Title of the episode.&quot;</span>)\n        .type(<span class=\"hljs-name\">GraphQLString</span>)\n        .dataFetcher((<span class=\"hljs-name\">env</span>) -&gt; {\n          Movie movie = env.getSource()<span class=\"hljs-comment\">;</span>\n          return movie.getName()<span class=\"hljs-comment\">;</span>\n        }))\n\n    // .description\n    .field(<span class=\"hljs-name\">newFieldDefinition</span>().name(<span class=\"hljs-string\">&quot;description&quot;</span>)\n        .description(<span class=\"hljs-string\">&quot;Description of the episode.&quot;</span>)\n        .type(<span class=\"hljs-name\">GraphQLString</span>))\n\n    .build()<span class=\"hljs-comment\">;</span>\n}\n</code></pre><p>A type can be ref­er­enced via a <code>GraphQLTypeReference</code> once it has been cre­ated and added to the schema. This is es­pe­cially im­por­tant if you need to add fields which ref­er­ence other types.\nData fetch­ers are used to ac­cess the con­text, tra­verse the graph and re­trieve prop­er­ties from graph el­e­ments.</p><p>An­other great source to learn more about the schema op­tions is the <a href=\"https://github.com/graphql-java/graphql-java/blob/master/src/test/groovy/graphql/GarfieldSchema.java\">Garfield­Schema</a> ex­am­ple.</p><p>Fi­nally all the cre­ated types must be ref­er­enced by a cen­tral ob­ject type <a href=\"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/data/StarWarsSchema.java#L204\">Query­Type</a>.\nThe query type ob­ject is ba­si­cally the root ob­ject for the query.\nIt de­fines what query op­tions are ini­tially pos­si­ble. In our case it is pos­si­ble to load the hero of the sage, spe­cific movies, hu­mans or droids.</p><h3 id=\"verticle\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#verticle\"></a>Verticle</h3><p>The <a href=\"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/GraphQLVerticle.java\">GraphQLVer­ti­cle</a> is used to ac­cept the GraphQL re­quest and process it.</p><p>The ver­ti­cle also con­tains a Sta­ticHan­dler to pro­vide the Graphiql Browser web in­ter­face. This in­ter­face will allow you to quickly dis­cover and ex­per­i­ment with GraphQL.</p><p>The <a href=\"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/GraphQLVerticle.java#L77\">query han­dler</a> ac­cepts the query JSON data. </p><p>An Ori­entDB trans­ac­tion is being opened and the query is ex­e­cuted:</p><pre><code class=\"hljs language-java\">demoData.getGraph().asyncTx((tx) -&gt; {\n  <span class=\"hljs-comment\">// Invoke the query and handle the resulting JSON</span>\n  GraphQL graphQL = newGraphQL(schema).build();\n  ExecutionInput input = <span class=\"hljs-keyword\">new</span> ExecutionInput(query, <span class=\"hljs-keyword\">null</span>, queryJson, demoData.getRoot(), extractVariables(queryJson));\n  tx.complete(graphQL.execute(input));\n}, (AsyncResult&lt;ExecutionResult&gt; rh) -&gt; {\n  ...\n});\n</code></pre><p>The ex­e­cute method ini­tially needs a con­text vari­able. This con­text passed along with the query.\nIn our case the con­text is the root el­e­ment of the graph <code>demoData.getRoot()</code>.\nThis con­text el­e­ment also serves as the ini­tial source for our data fetch­ers.</p><pre><code class=\"hljs language-java\">.dataFetcher((env) -&gt; {\n  StarWarsRoot root = env.getSource();\n  <span class=\"hljs-keyword\">return</span> root.getHero();\n}))\n</code></pre><p>The data fetch­ers for the hero type on the other hand will be able to ac­cess the hero el­e­ment since the fetcher above re­turned the el­e­ment.\nUsing this mech­a­nism it is pos­si­ble to tra­verse the graph. It is im­por­tant to note that each in­vo­ca­tion on the do­main model meth­ods will di­rectly ac­cess the graph data­base.\nThis way it is pos­si­ble to in­flu­ence the graph data­base query down to the low­est level. When omit­ting a prop­erty from the graphql query it will not be loaded from the graph.\nThus there is no need to write an ad­di­tional data ac­cess layer. All op­er­a­tions are di­rectly mapped to graph data­base.</p><p>The <code>StarWarsRoot</code> Ferma class <code>getHero()</code> method in turn de­fines a <a href=\"http://tinkerpop.apache.org/docs/3.3.0/tutorials/getting-started/#_graph_traversal_staying_simple\">Tin­ker­Pop Grem­lin tra­ver­sal</a> which is used to load the Ver­tex which rep­re­sents the hero of the Star Wars saga.</p><div class=\"alert info\"><p><a href=\"http://tinkerpop.apache.org/\">Apache Tin­ker­Pop</a> is an open source, vendor-​agnostic, graph frame­work / API which is sup­ported by many graph data­base ven­dors.\nOne part of Tin­ker­Pop is the Grem­lin tra­ver­sal lan­guage which is great to query graph data­bases.</p></div><pre><code class=\"hljs language-java\">...\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> Droid <span class=\"hljs-title\">getHero</span><span class=\"hljs-params\">()</span> </span>{\n  <span class=\"hljs-comment\">// Follow the HAS_ROOT edge and return the first found Vertex which could be found. </span>\n  <span class=\"hljs-comment\">// Wrap the Vertex explicitly in the Droid Ferma class.  </span>\n  <span class=\"hljs-keyword\">return</span> traverse((g) -&gt; g.out(HAS_HERO)).nextOrDefaultExplicit(Droid.class, <span class=\"hljs-keyword\">null</span>);\n}\n...\n</code></pre><p>Once the query has been ex­e­cuted the re­sult han­dler is being in­voked. It con­tains some code to process the re­sult data and po­ten­tial er­rors.\nIt is im­por­tant to note that a GraphQL query will al­ways be an­swered with a 2xx HTTP sta­tus code.\nIf an el­e­ment which is being ref­er­enced in the query can’t be loaded an error will be added to the re­sponse JSON ob­ject.</p><h3 id=\"testing\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#testing\"></a>Testing</h3><p>Test­ing is fairly straight for­ward. Al­though there are mul­ti­ple ap­proaches. One ap­proach is to use unit test­ing di­rectly on the GraphQL types.\nAn­other op­tion is to run queries against the end­point.  </p><p>The <a href=\"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/test/java/de/jotschi/vertx/GraphQLTest.java\">GraphQL­Test class</a> I wrote will run mul­ti­ple queries against the end­point.\nA Pa­ra­me­ter­ized JUnit test is used it­er­ate over the queries.</p><p>A <a href=\"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/test/resources/graphql/full-query\">typ­i­cal query</a> does not only con­tain the query data.\nThe as­ser­tions on the re­sponse JSON are di­rectly in­cluded in query using plain com­ments.</p><p>I build an <a href=\"http://joel-costigliola.github.io/assertj/\">As­sertJ</a> as­ser­tion to check the com­ments of a query and ver­ify that the as­ser­tion matches the re­sponse.</p><pre><code class=\"hljs language-java\">  assertThat(response).compliesToAssertions(queryName);\n</code></pre><h2 id=\"run-the-example\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#run-the-example\"></a>Run the example</h2><p>You can run the ex­am­ple by ex­e­cut­ing the <code>GraphQLServer</code> class and ac­cess the <a href=\"http://localhost:3000/browser/?query=%7B%0A%20%20movies%20%7B%0A%20%20%20%20title%0A%20%20%7D%0A%20%20hero%20%7B%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A\">Graphiql browser on http://lo­cal­host:3000/browser/</a></p><h2 id=\"where-to-go-from-here\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#where-to-go-from-here\"></a>Where to go from here?</h2><p>The ex­am­ple is read-​only. GraphQL also sup­ports data mu­ta­tion which can be used to ac­tu­ally mod­ify and store data.\nI have not yet ex­plored that part of GraphQL but I as­sume it might not be that hard to add mu­ta­tion sup­port to the ex­am­ple.</p><p>Ad­di­tion­ally it does not cover how to ac­tu­ally make use of such API. I re­cently <a href=\"https://github.com/gentics/mesh-vertx-example/\">up­dated my Vert.x ex­am­ple</a> which shows how to use Vert.x tem­plate han­dlers to build a small server which ren­ders some pages using data which was loaded via GraphQL.</p><p>Thanks for read­ing. If you have any fur­ther ques­tions or feed­back don’t hes­i­tate to send me a tweet to <a href=\"https://twitter.com/Jotschi/\">@Jotschi</a> or <a href=\"https://twitter.com/genticsmesh/\">@gen­tic­smesh</a>.</p>","scope":{}},"tfIdfTerms":[{"term":"queri","tf":24},{"term":"us","tf":21},{"term":"graphql","tf":18},{"term":"graph","tf":17},{"term":"data","tf":15},{"term":"will","tf":12},{"term":"exampl","tf":10},{"term":"element","tf":10},{"term":"not","tf":8},{"term":"type","tf":8},{"term":"load","tf":7},{"term":"databas","tf":7},{"term":"access","tf":6},{"term":"class","tf":6},{"term":"schema","tf":6},{"term":"provid","tf":5},{"term":"contain","tf":5},{"term":"travers","tf":5},{"term":"need","tf":5},{"term":"object","tf":5},{"term":"context","tf":5},{"term":"ad","tf":4},{"term":"support","tf":4},{"term":"api","tf":4},{"term":"json","tf":4}]}],"numPages":16},"__N_SSG":true}