(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"+/MD":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 3.9.1 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"The new version comes with many enhancements including an SQL client for DB2 and out-of-the-box support for HTTP/2 on JDK 8."}),i=[{term:"jdk",tf:5},{term:"releas",tf:4},{term:"support",tf:4},{term:"client",tf:3},{term:"http",tf:3},{term:"us",tf:3},{term:"avail",tf:3},{term:"version",tf:2},{term:"sql",tf:2},{term:"db2",tf:2},{term:"port",tf:2},{term:"alpn",tf:2},{term:"recent",tf:2},{term:"docker",tf:2},{term:"distribut",tf:2},{term:"extrem",tf:1},{term:"pleas",tf:1},{term:"announc",tf:1},{term:"among",tf:1},{term:"bug",tf:1},{term:"fix",tf:1},{term:"find",tf:1},{term:"enhanc",tf:1},{term:"databas",tf:1},{term:"nativ",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 3.9.1 released!"),Object(l.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce that the Eclipse Vert.x ver\xadsion 3.9.1 has been re\xadleased."),Object(l.a)("p",null,"Among all bug fixes you can find in 3.9.1 these en\xadhance\xadments:"),Object(l.a)("h4",null,"SQL Client for DB2"),Object(l.a)("p",null,"Vert.x SQL Client now sup\xadports the DB2 data\xadbase na\xadtively, this fea\xadture has been ported to Vert.x 3.9 in tech\npre\xadview"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"DB2ConnectOptions connectOptions = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," DB2ConnectOptions()\n  .setPort(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"50000"),")\n  .setHost(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"the-host"'),")\n  .setDatabase(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"the-db"'),")\n  .setUser(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"user"'),")\n  .setPassword(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"secret"'),");\n\nDB2Pool client = DB2Pool.pool(connectOptions);\n\nclient\n  .query(sql)\n  .execute(ar -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.succeeded()) {\n    RowSet<Row> result = ar.result();\n    System.out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Got "')," + result.size() + ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'" rows "'),");\n  } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    System.out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Failure: "')," + ar.cause().getMessage());\n  }\n});\n")),Object(l.a)("h4",null,"JDK 8 HTTP/2 support"),Object(l.a)("p",null,"Pre\xadvi\xadously using the Jetty ALPN agent or netty-\u200btcnative was re\xadquired to use HTTP/2 on JDK 8."),Object(l.a)("p",null,"TLS ALPN sup\xadport has been back-\u200bported to JDK 8 re\xadcently and Vert.x has been up\xadgraded to sup\xadport it, which means now you\ncan have HTTP/2 on JDK 8 out of the box. You need to most re\xadcent ver\xadsion of Open\xadJDK 8 or Or\xada\xadcle JDK 8."),Object(l.a)("h4",null,"Finally"),Object(l.a)("p",null,"The ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.1-Release-Notes"}),"3.9.1 re\xadlease notes")," can be found on the wiki, as well as the\nlist of ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.1-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes")),Object(l.a)("p",null,"Docker im\xadages are avail\xadable on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),"."),Object(l.a)("p",null,"The Vert.x dis\xadtri\xadb\xadu\xadtion can be down\xadloaded on the web\xadsite but is also avail\xadable from ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(l.a)("p",null,"The event bus client using the SockJS bridge is avail\xadable from:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"NPM")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"Bower")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"We\xadb\xadJars"))),Object(l.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.9.1%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.9.1/view"}),"Bin\xadtray"),"."),Object(l.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},"/pBu":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 3.8.2",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This version is a bug fix release of Vert.x 3.8.3, which addresses quite a few bugs reported by the community."}),i=[{term:"http",tf:6},{term:"releas",tf:5},{term:"com",tf:4},{term:"wiki",tf:4},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"deprec",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"note",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 3.8.2"),Object(l.a)("p",null,"We have just re\xadleased Vert.x 3.8.2, a bug fix re\xadlease of Vert.x 3.8.x."),Object(l.a)("p",null,"Since the re\xadlease of Vert.x 3.8.1, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},"Vert.x 3.8.2 dep\xadre\xadca\xadtions and break\xading changes")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.2-Deprecations-and-breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.2-\u200bDeprecations-and-breaking-changes")))),Object(l.a)("p",null,"Vert.x 3.8.2 re\xadlease notes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.2-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.2-\u200bRelease-Notes"))),Object(l.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.2%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.2/view"}),"Bin\xadtray"),"."),Object(l.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.2 project using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(l.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(l.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(l.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},"05nU":function(e,a,t){},"0JQy":function(e,a){var t="[\\ud800-\\udfff]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",s="\\ud83c[\\udffb-\\udfff]",r="[^\\ud800-\\udfff]",c="(?:\\ud83c[\\udde6-\\uddff]){2}",l="[\\ud800-\\udbff][\\udc00-\\udfff]",o="(?:"+n+"|"+s+")"+"?",i="[\\ufe0e\\ufe0f]?"+o+("(?:\\u200d(?:"+[r,c,l].join("|")+")[\\ufe0e\\ufe0f]?"+o+")*"),p="(?:"+[r+n+"?",n,c,l,t].join("|")+")",m=RegExp(s+"(?="+s+")|"+p+i,"g");e.exports=function(e){return e.match(m)||[]}},"0ZTe":function(e,a,t){var n=t("wy8a"),s=t("quyA"),r=t("Em2t"),c=t("dt0z");e.exports=function(e){return function(a){a=c(a);var t=s(a)?r(a):void 0,l=t?t[0]:a.charAt(0),o=t?n(t,1).join(""):a.slice(1);return l[e]()+o}}},"4Nad":function(e,a,t){},"4PoU":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Send web requests and assert results with vertx-junit5-web-client",category:"guides",authors:[{name:"Francesco Guardiani",github_id:"slinkydeveloper"}],summary:"In this blog post, you'll learn how to use the new vertx-junit5-web-client module to send web requests in your unit tests and to make assertions."}),i=[{term:"web",tf:5},{term:"request",tf:4},{term:"client",tf:4},{term:"send",tf:3},{term:"assert",tf:3},{term:"call",tf:2},{term:"test",tf:2},{term:"us",tf:2},{term:"result",tf:1},{term:"junit5",tf:1},{term:"last",tf:1},{term:"releas",tf:1},{term:"ad",tf:1},{term:"new",tf:1},{term:"modul",tf:1},{term:"bring",tf:1},{term:"inject",tf:1},{term:"provid",tf:1},{term:"api",tf:1},{term:"simplifi",tf:1},{term:"creation",tf:1},{term:"will",tf:1},{term:"respons",tf:1},{term:"receiv",tf:1},{term:"suc",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Send web requests and assert results with vertx-junit5-web-client"),Object(l.a)("p",null,"In last Vert.x 3.8 re\xadlease we added a new mod\xadule called ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-junit5-web-client"),", that brings ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web-client/java/"}),"Vert.x Web Client")," in\xadjec\xadtion\ninto tests and pro\xadvides an API called ",Object(l.a)("inlineCode",{parentName:"p"},"TestRequest")," to sim\xadplify the cre\xadation and as\xadser\xadtions on ",Object(l.a)("inlineCode",{parentName:"p"},"WebClient")," re\xadquests:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-d"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," io.vertx.junit5.web.TestRequest.*;\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"@ExtendWith"),"({\n  VertxExtension.",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// VertxExtension MUST be configured before VertxWebClientExtension"),"\n  VertxWebClientExtension.",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class"),"\n})\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class")," TestRequestExample {\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"@Test"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"void")," test1(WebClient client, VertxTestContext testContext) {\n    testRequest(client, HttpMethod.GET, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/hello"'),") ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Build the request"),"\n      .",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"with"),"(\n        queryParam(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"francesco"'),"), ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Add query param"),"\n        requestHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"x-my"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"foo"'),") ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Add request header"),"\n      )\n      .expect(\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Assert that response is a JSON with a specific body"),"\n        jsonBodyResponse(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"value"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello Francesco!"'),")),\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Assert that response contains a particular header"),"\n        responseHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"x-my"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"bar"'),")\n      )\n      .send(testContext); ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Complete (or fail) the VertxTestContext"),"\n  }\n\n}\n")),Object(l.a)("p",null,Object(l.a)("inlineCode",{parentName:"p"},"testRequest()")," will use Vert.x Web Client to send the re\xadquest. When the re\xadsponse is re\xadceived, It suc\xadceds the test or it cor\xadrectly prop\xada\xadgates as\xadser\xadtion fail\xadures, if any."),Object(l.a)("p",null,"You can also send mul\xadti\xadple re\xadquests using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/apidocs/io/vertx/junit5/Checkpoint.html"}),Object(l.a)("inlineCode",{parentName:"a"},"Checkpoint")),":"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-arduino"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," io.vertx.junit5.web.TestRequest.*;\n\n@ExtendWith({\n  VertxExtension.class, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// VertxExtension MUST be configured before VertxWebClientExtension"),"\n  VertxWebClientExtension.class\n})\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"MultiTestRequestExample")," {"),"\n\n  @",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Test\n  ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"test2"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(WebClient client, VertxTestContext testContext)")," "),"{\n    Checkpoint checkpoint = testContext.checkpoint(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"2"),"); ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Create the Checkpoint to flag when request succeds"),"\n\n    testRequest(\n        client    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Create the test request using WebClient APIs"),"\n          .",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"get"),"(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/hello"'),")\n          .addQueryParam(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"francesco"'),")\n          .putHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"x-my"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"foo"'),")\n      )\n      .expect(\n        jsonBodyResponse(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"put"),"(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"value"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello Francesco!"'),")),\n        responseHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"x-my"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"bar"'),")\n      )\n      .send(testContext, checkpoint); ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Pass the checkpoint to flag"),"\n\n    testRequest(\n        client\n          .",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"get"),"(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/hello"'),")\n          .addQueryParam(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"julien"'),")\n          .putHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"x-my"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"foo"'),")\n      )\n      .expect(\n        jsonBodyResponse(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"put"),"(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"value"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello Julien!"'),")),\n        responseHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"x-my"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"bar"'),")\n      )\n      .send(testContext, checkpoint);\n  }\n\n}\n")),Object(l.a)("p",null,"Look at ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-junit5-web-client/java/"}),"Vert.x JUnit 5 Web Client doc\xadu\xadmen\xadta\xadtion")," for more de\xadtails"))}b.isMDXComponent=!0},"4Sve":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 4 milestone 4 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"The new milestone of Vert.x 4 makes progress in futurisation and includes improvements on the mail client, general clients, and security."}),i=[{term:"client",tf:12},{term:"mileston",tf:9},{term:"releas",tf:8},{term:"http",tf:5},{term:"io",tf:5},{term:"improv",tf:4},{term:"us",tf:4},{term:"verticl",tf:4},{term:"auth",tf:4},{term:"featur",tf:3},{term:"develop",tf:3},{term:"mail",tf:3},{term:"blog",tf:3},{term:"announc",tf:2},{term:"seri",tf:2},{term:"provid",tf:2},{term:"distribut",tf:2},{term:"callback",tf:2},{term:"model",tf:2},{term:"progress",tf:2},{term:"modul",tf:2},{term:"support",tf:2},{term:"within",tf:2},{term:"share",tf:2},{term:"limit",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 4 milestone 4 released!"),Object(l.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce the fourth 4.0 mile\xadstone re\xadlease of Eclipse Vert.x ."),Object(l.a)("p",null,"Vert.x 4 is the evo\xadlu\xadtion of the Vert.x 3.x se\xadries that will bring key fea\xadtures to Vert.x."),Object(l.a)("p",null,"This re\xadlease aims to pro\xadvide a re\xadli\xadable dis\xadtri\xadb\xadu\xadtion of the cur\xadrent de\xadvel\xadop\xadment of Vert.x 4 for peo\xadple that\nwant to try it and pro\xadvide feed\xadback."),Object(l.a)("h4",null,"Futurisation"),Object(l.a)("p",null,"Vert.x 4 ex\xadtends the 3.x call\xadback asyn\xadchro\xadnous model to a fu\xadture/call\xadback hy\xadbrid model."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"NetClient")," "),"{\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Since 3.0"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host, Handler<AsyncResult<NetSocket>> handler)")),";\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// New in 4.0"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Future<NetSocket> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host)")),";\n}\n")),Object(l.a)("p",null,"This third mile\xadstone makes progress and fully cov\xaders with the fol\xadlow\xading stack mod\xadules:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Vert.x Shell"),Object(l.a)("li",{parentName:"ul"},"Vert.x Mail Client"),Object(l.a)("li",{parentName:"ul"},"Vert.x Con\xadsul Client"),Object(l.a)("li",{parentName:"ul"},"Vert.x Rab\xadbitMQ Client"),Object(l.a)("li",{parentName:"ul"},"Vert.x Stomp"),Object(l.a)("li",{parentName:"ul"},"Vert.x Mongo Client")),Object(l.a)("h4",null,"Mail client improvements"),Object(l.a)("p",null,"Our mail clients had nice con\xadtri\xadbu\xadtion with the abil\xadity to use stream\xading pay\xadload for at\xadtache\xadments and the\nsup\xadport for DKIM sig\xadna\xadtures."),Object(l.a)("h4",null,"General client improvements"),Object(l.a)("p",null,"Some Vert.x clients are de\xadsigned to be used within the ver\xadti\xadcle that cre\xadated it while some can be shared be\xadtween\nver\xadti\xadcles. This is a tech\xadni\xadcal lim\xadi\xadta\xadtion that stems from the fact that client are im\xadple\xadmented using Vert.x or Netty\n(such as ",Object(l.a)("inlineCode",{parentName:"p"},"HttpClient"),") and are bound to the un\xadder\xadly\xading event-\u200bloop that pow\xaders them."),Object(l.a)("p",null,"In Vert.x 4 we de\xadcided to get away of this lim\xadi\xadta\xadtion to sim\xadplify the usage and the con\xadfig\xadu\xadra\xadtion of the clients. Of course\nit is pos\xadsi\xadble to con\xadtinue con\xadfin\xading clients within a ver\xadti\xadcle (for best per\xadfor\xadmance) but clients can be now shared be\xadtween\nver\xadti\xadcles when de\xadsired with a ne\xadglectible im\xadpact on per\xadfor\xadmance (re\xadquir\xading mes\xadsage pass\xading)."),Object(l.a)("h4",null,"Security improvements"),Object(l.a)("p",null,"Fi\xadnally here are a few im\xadprove\xadments done in our se\xadcu\xadrity layer:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Vertx Auth is now de\xadcou\xadpled to han\xaddle authn/authz as 2 in\xadde\xadpen\xaddent func\xadtions thanks to @sbas\xadtian\xaddev"),Object(l.a)("li",{parentName:"ul"},"Auth Shiro is dep\xadre\xadcated in favour of the new \u201cauth prop\xader\xadties\u201d mod\xadule and \u201cauth ldap\u201d"),Object(l.a)("li",{parentName:"ul"},"Web CSRF to\xadkens are ses\xadsion aware to allow mul\xadti\xadple re\xadquests from the same user"),Object(l.a)("li",{parentName:"ul"},"Ini\xadtial sup\xadport for we\xadbau\xadthn")),Object(l.a)("h4",null,"Ramping up to Vert.x 4"),Object(l.a)("p",null,"In\xadstead of de\xadvel\xadop\xading all new fea\xadtures ex\xadclu\xadsively in Vert.x 4, we in\xadtro\xadduce some of these fea\xadtures in the 3.x branch\nso the com\xadmu\xadnity can ben\xade\xadfit from them. The Vert.x 4 de\xadvel\xadop\xadment focus on more fun\xadda\xadmen\xadtal changes that can\xadnot be done\nin the 3.x se\xadries."),Object(l.a)("img",{src:"{{ site_url }}assets/blog/vertx-4-milestone4-release/vertx-4-timeline.png",alt:"Screenshot",class:"img-responsive"}),Object(l.a)("p",null,"This is the forth mile\xadstone of Vert.x 4, you can of course ex\xadpect more mile\xadstones to out\xadline the progress of the ef\xadfort."),Object(l.a)("p",null,"You can also read the pre\xadvi\xadous mile\xadstone an\xadnounces:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://vertx.io/blog/eclipse-vert-x-4-milestone-3-released"}),"https://vertx.io/blog/eclipse-\u200bvert-x-4-\u200bmilestone-3-\u200breleased")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://vertx.io/blog/eclipse-vert-x-4-milestone-2-released"}),"https://vertx.io/blog/eclipse-\u200bvert-x-4-\u200bmilestone-2-\u200breleased")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://vertx.io/blog/eclipse-vert-x-4-milestone-1-released"}),"https://vertx.io/blog/eclipse-\u200bvert-x-4-\u200bmilestone-1-\u200breleased"))),Object(l.a)("h4",null,"Finally"),Object(l.a)("p",null,"The ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes"),"\ncan be found on the wiki."),Object(l.a)("p",null,"For this re\xadlease there are no Docker im\xadages.,"),Object(l.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://search.maven.org/search?q=g:io.vertx%20AND%20v:4.0.0-milestone4"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://repo1.maven.org/maven2/io/vertx/vertx-stack-manager/4.0.0-milestone4/"}),"Maven Cen\xadtral"),"."),Object(l.a)("p",null,"You can boot\xadstrap a Vert.x 4.0.0-\u200bmilestone4 project using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(l.a)("p",null,"The doc\xadu\xadmen\xadta\xadtion has been de\xadployed on this pre\xadview web-\u200bsite ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx-ci.github.io/vertx-4-preview/docs/"}),"https://vertx-\u200bci.github.io/vertx-\u200b4-\u200bpreview/docs/")),Object(l.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},"4nW3":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 3.9.0 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"New features include fluent queries in SQL clients, a new Redis client, an updated Kafka client, an improved Future API, and many more things."}),i=[{term:"client",tf:11},{term:"api",tf:11},{term:"chang",tf:7},{term:"cooki",tf:7},{term:"kafka",tf:6},{term:"releas",tf:5},{term:"site",tf:5},{term:"deprec",tf:5},{term:"queri",tf:4},{term:"break",tf:4},{term:"new",tf:4},{term:"user",tf:4},{term:"version",tf:3},{term:"redi",tf:3},{term:"upcom",tf:3},{term:"will",tf:3},{term:"upgrad",tf:3},{term:"admin",tf:3},{term:"edn",tf:3},{term:"disabl",tf:3},{term:"default",tf:3},{term:"warn",tf:3},{term:"avail",tf:3},{term:"sql",tf:2},{term:"fluent",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 3.9.0 released!"),Object(l.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce that the Eclipse Vert.x ver\xadsion 3.9.0 has been re\xadleased."),Object(l.a)("h4",null,"SQL Client fluent queries"),Object(l.a)("p",null,"The query API be\xadcomes flu\xadent with the ad\xaddi\xadtion of a ",Object(l.a)("inlineCode",{parentName:"p"},"Query")," API for queries cre\xadation and con\xadfig\xadu\xadra\xadtion."),Object(l.a)("p",null,"Col\xadlec\xadtors query now be\xadcomes part of the ",Object(l.a)("inlineCode",{parentName:"p"},"Query")," in\xadter\xadface."),Object(l.a)("p",null,"This is a break\xading API change done under the tech pre\xadview sta\xadtus given that SQL client is a Vert.x 4 fea\xadture back-\u200bported to Vert.x 3."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"client.prepareQuery(sql).execute(tuple, ar -> ...);\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// With a collector"),"\nclient.preparedQuery(sql).collecting(Collectors.toList()).execute(tuple, ar -> ...);\n")),Object(l.a)("p",null,"You can read more about this new fea\xadture ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.0-Deprecations-and-breaking-changes#fluent-query-api"}),"here"),"."),Object(l.a)("h4",null,"Redis client backport"),Object(l.a)("p",null,"For Vert.x 4.0 we are doing a full re\xadboot to the redis client. The func\xadtion\xadal\xadity for the new client is ready to test on the mas\xadter branch. In order to give users the op\xadpor\xadtu\xadnity to test and make the up\xadcom\xading client even bet\xadter it has been back\xadported to the 3.9.0 re\xadlease. The new client will allow users to con\xadnect to a sin\xadgle node, sen\xadtinel or clus\xadter of redis nodes. The eas\xadi\xadest way to start is:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Redis.createClient(\n      vertx,\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RedisOptions()\n        .setConnectionString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"redis://localhost:7006"'),"))\n      .send(Request.cmd(Command.PING), send -> {\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (send.succeeded()) {\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Should have received a pong..."),"\n        }\n      });\n")),Object(l.a)("h4",null,"Same-site cookies"),Object(l.a)("p",null,Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://tools.ietf.org/html/draft-west-first-party-cookies-07"}),Object(l.a)("inlineCode",{parentName:"a"},"SameSite")," Cookie")," pol\xadicy has been added to the HTTP Server Cook\xadies."),Object(l.a)("p",null,"This is also ap\xadplic\xada\xadble to web which al\xadlows cookie ses\xadsions to use ",Object(l.a)("inlineCode",{parentName:"p"},"SameSite")," cook\xadies:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"SessionHandler.create(store)\n  .setCookieSameSite(CookieSameSite.STRICT);\n")),Object(l.a)("p",null,"Same-\u200bsite cook\xadies let servers re\xadquire that a cookie shouldn\u2019t be sent with cross-\u200bsite (where Site is de\xadfined by the reg\xadis\xadtra\xadble do\xadmain) re\xadquests,\nwhich pro\xadvides some pro\xadtec\xadtion against cross-\u200bsite re\xadquest forgery at\xadtacks (CSRF)."),Object(l.a)("h4",null,"Kafka client upgrade"),Object(l.a)("p",null,"The Kafka client has been up\xadgraded to Kafka 2.4.0 ."),Object(l.a)("p",null,"Our re\xadac\xadtive client ex\xadposes the Kafka Admin API. As of 2.4.0 this API has been re\xadplaced by a new Kafka Admin API and there\xadfore\nthe Vert.x Kafka Admin API changes, e.g list\xading con\xadsumers groups"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"adminClient.listConsumerGroups(ar -> {\n    System.out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"ConsumerGroups= "')," + ar.result());\n});\n")),Object(l.a)("h4",null,"Future API"),Object(l.a)("p",null,"With the re\xadcent ad\xaddi\xadtion of ",Object(l.a)("inlineCode",{parentName:"p"},"Future#onComplete(...)")," sup\xadport\xading sev\xaderal han\xaddlers per ",Object(l.a)("inlineCode",{parentName:"p"},"Future")," in 3.9 made the\n",Object(l.a)("inlineCode",{parentName:"p"},"Future#setHandler(...)")," method feel awk\xadward. In\xaddeed ",Object(l.a)("inlineCode",{parentName:"p"},"setHandler")," con\xadveys the mean\xading that the ",Object(l.a)("inlineCode",{parentName:"p"},"Future")," man\xadages\na sin\xadgle han\xaddler. In 3.9 we dep\xadre\xadcate ",Object(l.a)("inlineCode",{parentName:"p"},"Future#setHandler")," in favor of ",Object(l.a)("inlineCode",{parentName:"p"},"Future#onComplete"),"."),Object(l.a)("h4",null,"EDNS disabled by default"),Object(l.a)("p",null,"EDNS is an ex\xadten\xadsion mech\xada\xadnism for DNS (",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://fr.wikipedia.org/wiki/EDNS"}),"https://fr.wikipedia.org/wiki/EDNS"),") that should be dis\xadabled by de\xadfault. It might\ncause un\xadwanted issue and should be dis\xadabled by de\xadfault."),Object(l.a)("h4",null,"Auth Deprecation warnings"),Object(l.a)("p",null,"As of 3.9.0 many APIs will be start warn\xading about dep\xadre\xadca\xadtions. There is a big refac\xadtor\xading and some break\xading API changes com\xading\non 4.0.0 and these warn\xadings are just to give users a heads up that API will change on the up\xadcom\xading ver\xadsion."),Object(l.a)("p",null,"For more in\xadfor\xadma\xadtion about the up\xadcom\xading 4.0 changes you can read ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"4.0.0-\u200bDeprecations-and-breaking-changes")),Object(l.a)("h4",null,"Dependency upgrades"),Object(l.a)("p",null,"In 3.9 we up\xaddate a few ver\xadsions:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Netty 4.1.48.Final"),Object(l.a)("li",{parentName:"ul"},"Jack\xadson 2.10.2"),Object(l.a)("li",{parentName:"ul"},"Guava 25.1-jre"),Object(l.a)("li",{parentName:"ul"},"GraphQL Java 14")),Object(l.a)("h4",null,"Finally"),Object(l.a)("p",null,"The ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.0-Release-Notes"}),"3.9.0 re\xadlease notes")," can be found on the wiki, as well as the\nlist of ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes")),Object(l.a)("p",null,"Docker im\xadages are avail\xadable on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),"."),Object(l.a)("p",null,"The Vert.x dis\xadtri\xadb\xadu\xadtion can be down\xadloaded on the web\xadsite but is also avail\xadable from ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(l.a)("p",null,"The event bus client using the SockJS bridge is avail\xadable from:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"NPM")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"Bower")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"We\xadb\xadJars"))),Object(l.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.9.0%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.9.0/view"}),"Bin\xadtray"),"."),Object(l.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},"6acW":function(e,a,t){var n=t("dt0z"),s=t("gQMU");e.exports=function(e){return s(n(e).toLowerCase())}},"7ljp":function(e,a,t){"use strict";t.d(a,"a",(function(){return u}));var n=t("q1tI"),s=t.n(n);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function c(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?c(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var i=s.a.createContext({}),p=function(e){var a=s.a.useContext(i),t=a;return e&&(t="function"===typeof e?e(a):l(l({},a),e)),t},m="mdxType",b={inlineCode:"code",wrapper:function(e){var a=e.children;return s.a.createElement(s.a.Fragment,{},a)}},j=s.a.forwardRef((function(e,a){var t=e.components,n=e.mdxType,r=e.originalType,c=e.parentName,i=o(e,["components","mdxType","originalType","parentName"]),m=p(t),j=n,u=m["".concat(c,".").concat(j)]||m[j]||b[j]||r;return t?s.a.createElement(u,l(l({ref:a},i),{},{components:t})):s.a.createElement(u,l({ref:a},i))}));function u(e,a){var t=arguments,n=a&&a.mdxType;if("string"===typeof e||n){var r=t.length,c=new Array(r);c[0]=j;var l={};for(var o in a)hasOwnProperty.call(a,o)&&(l[o]=a[o]);l.originalType=e,l[m]="string"===typeof e?e:n,c[1]=l;for(var i=2;i<r;i++)c[i]=t[i];return s.a.createElement.apply(null,c)}return s.a.createElement.apply(null,t)}j.displayName="MDXCreateElement"},ACoj:function(e,a,t){"use strict";var n=t("q1tI"),s=t.n(n),r=t("YFqc"),c=t.n(r),l=(t("Agq3"),s.a.createElement);a.a=function(e){var a=e.href,t=e.as,n=e.children,s=void 0===n?l("a",null,"Read more"):n;return l("span",{className:"read-more-link"},l(c.a,{href:a,as:t},s))}},Agq3:function(e,a,t){},AiqT:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 3.8.4",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This version is a bug fix release of Vert.x 3.8.3, which addresses quite a few bugs reported by the community."}),i=[{term:"releas",tf:5},{term:"http",tf:5},{term:"com",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"note",tf:2},{term:"github",tf:2},{term:"x3",tf:2},{term:"wiki",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1},{term:"issu",tf:1},{term:"artifact",tf:1},{term:"deploi",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 3.8.4"),Object(l.a)("p",null,"We have just re\xadleased Vert.x 3.8.4, a bug fix re\xadlease of Vert.x 3.8.x."),Object(l.a)("p",null,"Since the re\xadlease of Vert.x 3.8.3, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(l.a)("p",null,"Vert.x 3.8.4 re\xadlease notes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.4-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.4-\u200bRelease-Notes"))),Object(l.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.4/view"}),"Bin\xadtray"),"."),Object(l.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.4 project using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(l.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(l.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(l.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},BuQJ:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"The RSS reader tutorial",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"In this tutorial, you will learn how to use the Eclipse Vert.x Cassandra client in practice. We will develop an RSS reader with three HTTP endpoints."}),i=[{term:"rss",tf:12},{term:"feed",tf:12},{term:"cassandra",tf:8},{term:"endpoint",tf:8},{term:"run",tf:7},{term:"first",tf:7},{term:"method",tf:7},{term:"start",tf:6},{term:"link",tf:6},{term:"will",tf:6},{term:"implement",tf:6},{term:"user",tf:5},{term:"not",tf:5},{term:"step",tf:5},{term:"schema",tf:5},{term:"initi",tf:5},{term:"tutori",tf:4},{term:"read",tf:4},{term:"app",tf:4},{term:"storag",tf:4},{term:"articl",tf:4},{term:"fetch",tf:4},{term:"complet",tf:4},{term:"reader",tf:3},{term:"find",tf:3}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"The RSS reader tutorial"),Object(l.a)("p",null,"This tu\xadto\xadr\xadial is ded\xadi\xadcated for users who\u2019d like to know how to use the Eclipse Vert.x Cas\xadsan\xaddra client in prac\xadtice."),Object(l.a)("h2",null,"Before you start this tutorial"),Object(l.a)("p",null,"Be\xadfore start\xading, you should"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},"be fa\xadmil\xadiar with ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/"}),"Eclipse Vert.x"),". If you are not, here is the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/guide-for-java-devs/"}),"guide for Java de\xadvel\xadop\xaders"),".")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},"have some basic un\xadder\xadstand\xading of data\xadbases. Ex\xadtended knowl\xadedge of Cas\xadsan\xaddra is not re\xadquired."))),Object(l.a)("p",null,"You also may find it use\xadful to read ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://validator.w3.org/feed/docs/rss2.html"}),"the RSS 2.0")," spec\xadi\xadfi\xadca\xadtion, be\xadcause the re\xadsulted app is, ba\xadsi\xadcally, a stor\xadage of RSS 2.0 feeds."),Object(l.a)("p",null,"To give you an idea of what the App is about, here is how it looks like from the fronted side:"),Object(l.a)("img",{src:"https://i.imgur.com/2V954zx.png",alt:"see how it looks",className:"img-fluid"}),Object(l.a)("p",null,"In the image, we see that browser space is split into 2 parts:"),Object(l.a)("ol",null,Object(l.a)("li",{parentName:"ol"},"Saved feed names"),Object(l.a)("li",{parentName:"ol"},"List of ar\xadti\xadcles for the se\xadlected feed")),Object(l.a)("p",null,"Here you also can enter a link to a new feed, so the App will fetch and parse the feed.\nAfter that, it will ap\xadpear in the left col\xadumn along with other saved feeds."),Object(l.a)("h2",null,"Requirements"),Object(l.a)("p",null,"For com\xadplet\xading this tu\xadto\xadr\xadial you need:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Java 8 or higher"),Object(l.a)("li",{parentName:"ul"},"Git"),Object(l.a)("li",{parentName:"ul"},"1 hour of your time"),Object(l.a)("li",{parentName:"ul"},"You fa\xadvorite code ed\xadi\xadtor")),Object(l.a)("p",null,"For run\xadning the ex\xadam\xadple you should en\xadsure that Cas\xadsan\xaddra ser\xadvice is run\xadning lo\xadcally on port 9042.\nAs an op\xadtion, you can run Cas\xadsan\xaddra with ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/riptano/ccm#installation"}),"ccm"),"(Cas\xadsan\xaddra Clus\xadter Man\xadager).\nFol\xadlow ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/riptano/ccm#installation"}),"this")," in\xadstruc\xadtions for in\xadstalling ccm.\nAfter in\xadstalling you will be able to run a sin\xadgle node clus\xadter:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," ccm create rss_reader -v 3.11.2 -n 1 -s"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," ccm start"),"\n")),Object(l.a)("p",null,"Be\xadfore com\xadplet\xading this step make sure that you have suc\xadcess\xadfully cloned the RSS reader repos\xadi\xadtory and checked out the ",Object(l.a)("inlineCode",{parentName:"p"},"step_1")," branch:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-built_in"}),"clone")," https://github.com/Sammers21/rss-reader"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-built_in"}),"cd")," rss-reader"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_1"),"\n")),Object(l.a)("p",null,"Now you can try to tun this ex\xadam\xadple and see if it works:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," ./gradlew vertxRun"),"\n")),Object(l.a)("h2",null,"Schema"),Object(l.a)("p",null,"If you are fa\xadmil\xadiar with ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://cassandra.apache.org/"}),"Apache Cas\xadsan\xaddra"),", you\nshould know that the way your data is stored in Cas\xadsan\xaddra is de\xadpen\xaddent on queries\nyou are run\xadning. It means that you need first to fig\xadure out what kind of queries\nyou will be run\xadning, and then you can pro\xadduce a stor\xadage scheme."),Object(l.a)("p",null,"In our case, we\u2019d like our ap\xadpli\xadca\xadtion to have 3 end\xadpoints:"),Object(l.a)("ol",null,Object(l.a)("li",{parentName:"ol"},Object(l.a)("inlineCode",{parentName:"li"},"POST /user/{user_id}/rss_link")," - for adding links to a user\u2019s feed"),Object(l.a)("li",{parentName:"ol"},Object(l.a)("inlineCode",{parentName:"li"},"GET /user/{user_id}/rss_channels")," - for re\xadtriev\xading in\xadfor\xadma\xadtion about RSS chan\xadnels a user sub\xadscribed on"),Object(l.a)("li",{parentName:"ol"},Object(l.a)("inlineCode",{parentName:"li"},"GET /articles/by_rss_link?link={rss_link}")," - for re\xadtriev\xading in\xadfor\xadma\xadtion about ar\xadti\xadcles on a spe\xadcific RSS chan\xadnel")),Object(l.a)("p",null,"For im\xadple\xadment\xading this end\xadpoints, the schema should look as fol\xadlows:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"CREATE")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"TABLE")," rss_by_user (login ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text")," , rss_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", PRIMARY ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"KEY")," (login, rss_link));\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"CREATE")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"TABLE")," articles_by_rss_link(rss_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", pubDate ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"timestamp"),", title ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", article_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", description ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", PRIMARY ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"KEY")," ( rss_link , pubDate , article_link));\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"CREATE")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"TABLE")," channel_info_by_rss_link(rss_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", last_fetch_time ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"timestamp"),",title ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", site_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", description ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", PRIMARY ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"KEY"),"(rss_link));\n")),Object(l.a)("h2",null,"What to do in this step"),Object(l.a)("p",null,"In this step, we will im\xadple\xadment only the first end\xadpoint"),Object(l.a)("h2",null,"Project overview"),Object(l.a)("p",null,"There are two no\xadtable classes in the project: ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle")," and ",Object(l.a)("inlineCode",{parentName:"p"},"FetchVerticle"),". The first one is a ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-core/java/#_verticles"}),"Ver\xadti\xadcle")," re\xadspon\xadsi\xadble for HTTP re\xadquest han\xaddling and stor\xadage schema ini\xadtial\xadiza\xadtion. The sec\xadond one is a ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-core/java/#_verticles"}),"Ver\xadti\xadcle")," as well, but re\xadspon\xadsi\xadble for RSS feeds fetch\xading."),Object(l.a)("p",null,"The idea is sim\xadple. When the ap\xadpli\xadca\xadtion is start\xading the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle")," is de\xadployed, then it tries to ini\xadtial\xadize stor\xadage schema, de\xadscribed in ",Object(l.a)("inlineCode",{parentName:"p"},"src/main/resources/schema.cql")," file by read\xading it and ex\xade\xadcut\xading listed queries line by line. After the schema ini\xadtial\xadiza\xadtion the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle")," de\xadploys ",Object(l.a)("inlineCode",{parentName:"p"},"FetchVerticle")," and starts a HTTP server."),Object(l.a)("h2",null,"Implementing the endpoint"),Object(l.a)("p",null,"Now, it is time to im\xadple\xadment the first end\xadpoint. Pay at\xadten\xadtion to ",Object(l.a)("inlineCode",{parentName:"p"},"TODO"),"s, they are for point\xading you out about where changes should be made."),Object(l.a)("p",null,"Now, let\u2019s have a look at the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle#postRssLink")," method. This method is called each time the first end\xadpoint is called, so we can fig\xadure out what is the posted body and id of the user, who per\xadformed the re\xadquest, di\xadrectly there. There are 2 main things we want to do in this method:"),Object(l.a)("ol",null,Object(l.a)("li",{parentName:"ol"},"No\xadti\xadfy\xading via the ",Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://vertx.io/docs/vertx-core/java/#event_bus"}),"Event Bus")," the ",Object(l.a)("inlineCode",{parentName:"li"},"FetchVerticle")," to fetch given by user link link to an RSS feed."),Object(l.a)("li",{parentName:"ol"},"In\xadsert\xading an entry to the ",Object(l.a)("inlineCode",{parentName:"li"},"rss_by_user")," table.")),Object(l.a)("p",null,"This is how the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle#postRssLink")," method should be im\xadple\xadmented:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"postRssLink"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    ctx.request().bodyHandler(body -> {\n        JsonObject bodyAsJson = body.toJsonObject();\n        String link = bodyAsJson.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"link"'),");\n        String userId = ctx.request().getParam(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"user_id"'),");\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (link == ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null")," || userId == ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n            responseWithInvalidRequest(ctx);\n        } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            vertx.eventBus().send(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"fetch.rss.link"'),", link);\n            Future<ResultSet> future = Future.future();\n            BoundStatement query = insertNewLinkForUser.bind(userId, link);\n            client.execute(query, future);\n            future.setHandler(result -> {\n                ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (result.succeeded()) {\n                    ctx.response().end(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"message"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"The feed just added"'),").toString());\n                } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n                    ctx.response().setStatusCode(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"400"),").end(result.cause().getMessage());\n                }\n            });\n        }\n    });\n}\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"responseWithInvalidRequest"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    ctx.response()\n            .setStatusCode(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"400"),")\n            .putHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json; charset=utf-8"'),")\n            .end(invalidRequest().toString());\n}\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," JsonObject ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"invalidRequest"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"message"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Invalid request"'),");\n}\n")),Object(l.a)("p",null,"You may no\xadtice that ",Object(l.a)("inlineCode",{parentName:"p"},"insertNewLinkForUser")," is a ",Object(l.a)("inlineCode",{parentName:"p"},"PreparedStatement"),", and should be ini\xadtial\xadized be\xadfore the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle")," start. Let\u2019s do it in the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle#prepareNecessaryQueries")," method:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Future<Void> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"prepareNecessaryQueries"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    Future<PreparedStatement> insertNewLinkForUserPrepFuture = Future.future();\n    client.prepare(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO rss_by_user (login , rss_link ) VALUES ( ?, ?);"'),", insertNewLinkForUserPrepFuture);\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," insertNewLinkForUserPrepFuture.compose(preparedStatement -> {\n        insertNewLinkForUser = preparedStatement;\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n    });\n}\n")),Object(l.a)("p",null,"Also, we should not for\xadget to fetch a RSS by the link sent to ",Object(l.a)("inlineCode",{parentName:"p"},"FetchVerticle")," via the Event Bus. We can do it in the ",Object(l.a)("inlineCode",{parentName:"p"},"FetchVerticle#startFetchEventBusConsumer")," method:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"vertx.eventBus().localConsumer(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"fetch.rss.link"'),", message -> {\n    String rssLink = (String) message.body();\n    log.info(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"fetching "')," + rssLink);\n    webClient.getAbs(rssLink).send(response -> {\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (response.succeeded()) {\n            String bodyAsString = response.result().bodyAsString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"UTF-8"'),");\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"try")," {\n                RssChannel rssChannel = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RssChannel(bodyAsString);\n\n                BatchStatement batchStatement = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," BatchStatement();\n                BoundStatement channelInfoInsertQuery = insertChannelInfo.bind(\n                        rssLink, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Date(System.currentTimeMillis()), rssChannel.description, rssChannel.link, rssChannel.title\n                );\n                batchStatement.add(channelInfoInsertQuery);\n\n                ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"for")," (Article article : rssChannel.articles) {\n                    batchStatement.add(insertArticleInfo.bind(rssLink, article.pubDate, article.link, article.description, article.title));\n                }\n                Future<ResultSet> insertArticlesFuture = Future.future();\n                cassandraClient.execute(batchStatement, insertArticlesFuture);\n\n                insertArticlesFuture.compose(insertDone -> Future.succeededFuture());\n            } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"catch")," (Exception e) {\n                log.error(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Unable to fetch: "')," + rssLink, e);\n            }\n        } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            log.error(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Unable to fetch: "')," + rssLink);\n        }\n    });\n});\n")),Object(l.a)("p",null,"And, fi\xadnally, this code would not work if ",Object(l.a)("inlineCode",{parentName:"p"},"insertChannelInfo")," and ",Object(l.a)("inlineCode",{parentName:"p"},"insertArticleInfo")," state\xadments will not be ini\xadtial\xadized at ver\xadti\xadcle start. Let\u2019s to this in the ",Object(l.a)("inlineCode",{parentName:"p"},"FetchVerticle#prepareNecessaryQueries")," method:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"})," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Future<Void> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"prepareNecessaryQueries"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n        Future<PreparedStatement> insertChannelInfoPrepFuture = Future.future();\n        cassandraClient.prepare(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO channel_info_by_rss_link ( rss_link , last_fetch_time, description , site_link , title ) VALUES (?, ?, ?, ?, ?);"'),", insertChannelInfoPrepFuture);\n\n        Future<PreparedStatement> insertArticleInfoPrepFuture = Future.future();\n        cassandraClient.prepare(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO articles_by_rss_link ( rss_link , pubdate , article_link , description , title ) VALUES ( ?, ?, ?, ?, ?);"'),", insertArticleInfoPrepFuture);\n\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," CompositeFuture.all(\n                insertChannelInfoPrepFuture.compose(preparedStatement -> {\n                    insertChannelInfo = preparedStatement;\n                    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n                }), insertArticleInfoPrepFuture.compose(preparedStatement -> {\n                    insertArticleInfo = preparedStatement;\n                    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n                })\n        ).mapEmpty();\n    }\n")),Object(l.a)("h2",null,"Observing"),Object(l.a)("p",null,"After all these changes, you should en\xadsure that the first end\xadpoint is work\xading cor\xadrectly. You need to run the ap\xadpli\xadca\xadtion, go to lo\xadcal\xadhost:8080 in\xadsert a link to a rss feed there(",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://feeds.bbci.co.uk/news/uk/rss.xml"}),"BBC UK feed news")," for ex\xadam\xadple) and then click the ",Object(l.a)("em",{parentName:"p"},"ENTER")," but\xadton. Now you can con\xadnect to your local Cas\xadsan\xaddra in\xadstance, for in\xadstance with ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://docs.datastax.com/en/cql/3.3/cql/cql_reference/cqlsh.html"}),"cqlsh"),", and find out how RSS feed data had been saved in the rss_reader key\xadspace:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),"cqlsh> ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," * ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," rss_reader.rss_by_user ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"limit")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),"  ;\n\n login | rss_link\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"-------+-----------------------------------------"),"\n Pavel | http://feeds.bbci.co.uk/news/uk/rss.xml\n\n(1 rows)\ncqlsh> ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," description ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," rss_reader.articles_by_rss_link  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"limit")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),";\n\n description\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"-------------------------------------"),"\n BBC coverage of latest developments\n\n(1 rows)\n")),Object(l.a)("h2",null,"Conclusion"),Object(l.a)("p",null,"In this ar\xadti\xadcle we fig\xadured out how to im\xadple\xadment the first end\xadpoint of RSS-\u200breader app. If you have any prob\xadlems with com\xadplet\xading this step you can check\xadout to ",Object(l.a)("inlineCode",{parentName:"p"},"step_2"),", where you can find all changes made for com\xadplet\xading this step:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_2"),"\n")),Object(l.a)("p",null,"Thanks for read\xading this. I hope you en\xadjoyed read\xading this ar\xadti\xadcle. See you soon on our ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"Git\xadter chan\xadnel"),"!"))}b.isMDXComponent=!0},Em2t:function(e,a,t){var n=t("bahg"),s=t("quyA"),r=t("0JQy");e.exports=function(e){return s(e)?r(e):n(e)}},Ff2n:function(e,a,t){"use strict";function n(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}t.d(a,"a",(function(){return n}))},GOOg:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"The RSS reader tutorial (Step 2)",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"In this second installment of our Vert.x Cassandra Client tutorial, we will add an endpoint that produces an array of RSS channels for a given user ID."}),i=[{term:"endpoint",tf:8},{term:"rss",tf:7},{term:"implement",tf:7},{term:"step",tf:5},{term:"channel",tf:5},{term:"method",tf:4},{term:"reader",tf:3},{term:"app",tf:3},{term:"complet",tf:3},{term:"second",tf:3},{term:"given",tf:3},{term:"user",tf:3},{term:"successfulli",tf:2},{term:"articl",tf:2},{term:"fetch",tf:2},{term:"link",tf:2},{term:"allow",tf:2},{term:"list",tf:2},{term:"browser",tf:2},{term:"read",tf:2},{term:"tutori",tf:1},{term:"previou",tf:1},{term:"first",tf:1},{term:"exampl",tf:1},{term:"assum",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"The RSS reader tutorial (Step 2)"),Object(l.a)("p",null,"In ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/the-rss-reader-tutorial/"}),"the pre\xadvi\xadous step"),", we have suc\xadcess\xadfully im\xadple\xadmented the first end\xadpoint\nof the RSS reader app."),Object(l.a)("p",null,"The RSS reader ex\xadam\xadple as\xadsumes im\xadple\xadment\xading 3 end\xadpoints. This ar\xadti\xadcle is ded\xadi\xadcated to im\xadple\xadment\xading the ",Object(l.a)("inlineCode",{parentName:"p"},"GET /user/{user_id}/rss_channels")," end\xadpoint."),Object(l.a)("p",null,"Be\xadfore com\xadplet\xading this step, make sure your are in the ",Object(l.a)("inlineCode",{parentName:"p"},"step_2")," git branch:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_2"),"\n")),Object(l.a)("h2",null,"Implementing the second endpoint"),Object(l.a)("p",null,"The sec\xadond end\xadpoint pro\xadduces an array of RSS chan\xadnels by given ",Object(l.a)("inlineCode",{parentName:"p"},"user_id"),"."),Object(l.a)("p",null,"We need to ex\xade\xadcute the two fol\xadlow\xading queries to:"),Object(l.a)("ol",null,Object(l.a)("li",{parentName:"ol"},"Fetch RSS links for a given user:",Object(l.a)("pre",{parentName:"li"},Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," rss_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," rss_by_user ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"WHERE")," login = GIVEN_USER_ID ;\n"))),Object(l.a)("li",{parentName:"ol"},"Fetch RSS chan\xadnel de\xadtails for a given link:",Object(l.a)("pre",{parentName:"li"},Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," description, title, site_link, rss_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," channel_info_by_rss_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"WHERE")," rss_link = GIVEN_LINK ;\n")))),Object(l.a)("h2",null,"Implementation"),Object(l.a)("p",null,"The end\xadpoint al\xadlows the the front-\u200bend app to dis\xadplay the list of RSS feeds a user sub\xadscribed on. When the end\xadpoint is ac\xadcessed, the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle#getRssChannels")," method is called. We can im\xadple\xadment this method in this way:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getRssChannels"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    String userId = ctx.request().getParam(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"user_id"'),");\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (userId == ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n        responseWithInvalidRequest(ctx);\n    } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n        Future<List<Row>> future = Future.future();\n        client.executeWithFullFetch(selectRssLinksByLogin.bind(userId), future);\n        future.compose(rows -> {\n            List<String> links = rows.stream()\n                    .map(row -> row.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"))\n                    .collect(Collectors.toList());\n\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," CompositeFuture.all(\n                    links.stream().map(selectChannelInfo::bind).map(statement -> {\n                        Future<List<Row>> channelInfoRow = Future.future();\n                        client.executeWithFullFetch(statement, channelInfoRow);\n                        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," channelInfoRow;\n                    }).collect(Collectors.toList())\n            );\n        }).setHandler(h -> {\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (h.succeeded()) {\n                CompositeFuture result = h.result();\n                List<List<Row>> results = result.list();\n                List<Row> list = results.stream()\n                        .flatMap(List::stream)\n                        .collect(Collectors.toList());\n                JsonObject responseJson = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject();\n                JsonArray channels = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonArray();\n\n                list.forEach(eachRow -> channels.add(\n                        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()\n                                .put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),", eachRow.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"))\n                                .put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"title"'),", eachRow.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),"))\n                                .put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"link"'),", eachRow.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"2"),"))\n                                .put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"rss_link"'),", eachRow.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"3"),"))\n                ));\n\n                responseJson.put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"channels"'),", channels);\n                ctx.response().end(responseJson.toString());\n            } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n                log.error(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"failed to get rss channels"'),", h.cause());\n                ctx.response().setStatusCode(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"500"),").end(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Unable to retrieve the info from C*"'),");\n            }\n        });\n    }\n}\n")),Object(l.a)("p",null,"Also, this method uses ",Object(l.a)("inlineCode",{parentName:"p"},"selectChannelInfo")," and ",Object(l.a)("inlineCode",{parentName:"p"},"selectRssLinksByLogin")," fields, they should be ini\xadtial\xadized in the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle#prepareNecessaryQueries")," method:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Future<Void> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"prepareNecessaryQueries"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    Future<PreparedStatement> selectChannelInfoPrepFuture = Future.future();\n    client.prepare(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT description, title, site_link, rss_link FROM channel_info_by_rss_link WHERE rss_link = ? ;"'),", selectChannelInfoPrepFuture);\n\n    Future<PreparedStatement> selectRssLinkByLoginPrepFuture = Future.future();\n    client.prepare(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT rss_link FROM rss_by_user WHERE login = ? ;"'),", selectRssLinkByLoginPrepFuture);\n\n    Future<PreparedStatement> insertNewLinkForUserPrepFuture = Future.future();\n    client.prepare(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO rss_by_user (login , rss_link ) VALUES ( ?, ?);"'),", insertNewLinkForUserPrepFuture);\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," CompositeFuture.all(\n            selectChannelInfoPrepFuture.compose(preparedStatement -> {\n                selectChannelInfo = preparedStatement;\n                ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n            }),\n            selectRssLinkByLoginPrepFuture.compose(preparedStatement -> {\n                selectRssLinksByLogin = preparedStatement;\n                ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n            }),\n            insertNewLinkForUserPrepFuture.compose(preparedStatement -> {\n                insertNewLinkForUser = preparedStatement;\n                ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n            })\n    ).mapEmpty();\n}\n")),Object(l.a)("h2",null,"Conclusion"),Object(l.a)("p",null,"In this part, we have suc\xadcess\xadfully im\xadple\xadmented the sec\xadond end\xadpoint, which al\xadlows the browser app to ob\xadtain chan\xadnels in\xadfor\xadma\xadtion for a spe\xadcific user. To en\xadsure that it is work\xading fine, point your browser to ",Object(l.a)("inlineCode",{parentName:"p"},"localhost:8080")," and click to the re\xadfresh but\xadton. Chan\xadnel list should ap\xadpear im\xadme\xaddi\xadately."),Object(l.a)("p",null,"If you have any prob\xadlems with com\xadplet\xading this step you can check\xadout to ",Object(l.a)("inlineCode",{parentName:"p"},"step_3"),", where you can find all changes made for com\xadplet\xading this step:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_3"),"\n")),Object(l.a)("p",null,"Thanks for read\xading this. I hope you en\xadjoyed read\xading this ar\xadti\xadcle. See you soon on our ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"Git\xadter chan\xadnel"),"!"))}b.isMDXComponent=!0},HAnQ:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Easy SSO for Vert.x with Keycloak",category:"guides",authors:[{name:"Thomas Darimont",github_id:"thomasdarimont"}],summary:"In this blog post, you'll learn how to implement Single Sign-on with OpenID Connect and how to use Keycloak together with Eclipse Vert.x."}),i=[{term:"keycloak",tf:31},{term:"user",tf:23},{term:"app",tf:19},{term:"openid",tf:17},{term:"protect",tf:17},{term:"need",tf:16},{term:"via",tf:16},{term:"inform",tf:15},{term:"connect",tf:14},{term:"logout",tf:14},{term:"page",tf:14},{term:"call",tf:10},{term:"exampl",tf:10},{term:"us",tf:9},{term:"configur",tf:9},{term:"token",tf:9},{term:"handler",tf:9},{term:"access",tf:8},{term:"web",tf:8},{term:"show",tf:8},{term:"endpoint",tf:8},{term:"provid",tf:7},{term:"form",tf:7},{term:"current",tf:7},{term:"integr",tf:7}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Easy SSO for Vert.x with Keycloak"),Object(l.a)("h2",null,"TL;DR"),Object(l.a)("p",null,"In this blog post you\u2019ll learn:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"How to im\xadple\xadment Sin\xadgle Sign-\u200bon with OpenID Con\xadnect"),Object(l.a)("li",{parentName:"ul"},"How to use Key\xadcloak\u2019s OpenID Dis\xadcov\xadery to infer OpenID provider con\xadfig\xadu\xadra\xadtion"),Object(l.a)("li",{parentName:"ul"},"How to ob\xadtain user in\xadfor\xadma\xadtion"),Object(l.a)("li",{parentName:"ul"},"How to check for au\xadtho\xadriza\xadtion"),Object(l.a)("li",{parentName:"ul"},"How to call a Bearer pro\xadtected ser\xadvice with an Ac\xadcess Token"),Object(l.a)("li",{parentName:"ul"},"How to im\xadple\xadment a form based lo\xadgout")),Object(l.a)("h2",null,"Hello Blog"),Object(l.a)("p",null,"This is my first post in the Vert.x Blog and I must admit that up until now I have never used Vert.x in a real project.\n\u201cWhy are you here?\u201d, you might ask\u2026 Well I cur\xadrently have two main hob\xadbies, learn\xading new things and se\xadcur\xading apps with ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.keycloak.org/"}),"Key\xadcloak"),".\nSo a few days ago, I stum\xadbled upon the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=LsaXy7SRXMY&list=PLkeCJDaCC2ZsnySdg04Aq9D9FpAZY6K5D"}),"In\xadtro\xadduc\xadtion to Vert.x video se\xadries on youtube")," by ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://twitter.com/infosec812"}),"Deven Phillips")," and I was im\xadme\xaddi\xadately hooked. Vert.x was a new thing for me, so the next log\xadi\xadcal step was to fig\xadure out how to se\xadcure a Vert.x app with Key\xadcloak."),Object(l.a)("p",null,"For this ex\xadam\xadple I build a small web app with Vert.x that shows how to im\xadple\xadment Sin\xadgle Sign-\u200bon (SSO) with Key\xadcloak\nand OpenID Con\xadnect, ob\xadtain in\xadfor\xadma\xadtion about the cur\xadrent user, check for roles, call bearer pro\xadtected ser\xadvices and prop\xaderly han\xaddling lo\xadgout."),Object(l.a)("h2",null,"Keycloak"),Object(l.a)("p",null,Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.keycloak.org/"}),"Key\xadcloak")," is a Open Source Iden\xadtity and Ac\xadcess Man\xadage\xadment so\xadlu\xadtion which pro\xadvides sup\xadport for OpenID Con\xadnect\nbased Singe-\u200bSign on, among many other things. I briefly looked for ways to se\xadcur\xading a Vert.x app with Key\xadcloak\nand quickly found an ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/vertx-3-and-keycloak-tutorial/"}),"older Vert.x Key\xadcloak in\xadte\xadgra\xadtion ex\xadam\xadple")," in this very blog.\nWhilst this is a good start for be\xadgin\xadners, the ex\xadam\xadple con\xadtains a few is\xadsues, e.g.:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"It uses hard\xadcoded OpenID provider con\xadfig\xadu\xadra\xadtion"),Object(l.a)("li",{parentName:"ul"},"Fea\xadtures a very sim\xadplis\xadtic in\xadte\xadgra\xadtion (for the sake of sim\xadplic\xadity)"),Object(l.a)("li",{parentName:"ul"},"No user in\xadfor\xadma\xadtion used"),Object(l.a)("li",{parentName:"ul"},"No lo\xadgout func\xadtion\xadal\xadity is shown")),Object(l.a)("p",null,"That some\xadhow nerd\xadsniped me a bit and so it came that, after a long day of con\xadsult\xading work, I sat down to cre\xadate an ex\xadam\xadple for a com\xadplete Key\xadcloak in\xadte\xadgra\xadtion based on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-auth-oauth2/java/"}),"Vert.x OpenID Con\xadnect / OAuth2 Sup\xadport"),"."),Object(l.a)("p",null,"So let\u2019s get started!"),Object(l.a)("h3",null,"Keycloak Setup"),Object(l.a)("p",null,"To se\xadcure a Vert.x app with Key\xadcloak we of course need a Key\xadcloak in\xadstance. Al\xadthough ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.keycloak.org/docs/latest/getting_started/"}),"Key\xadcloak has a great get\xadting started guide")," I wanted to make it a bit eas\xadier to put every\xadthing to\xadgether, there\xadfore I pre\xadpared a local Key\xadcloak docker con\xadtainer ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/thomasdarimont/vertx-playground/tree/master/keycloak-vertx#start-keycloak-with-the-vertx-realm"}),"as de\xadscribed here")," that you can start eas\xadily, which comes with all the re\xadquired con\xadfig\xadu\xadra\xadtion in place."),Object(l.a)("p",null,"The pre\xadcon\xadfig\xadured Key\xadcloak realm named ",Object(l.a)("inlineCode",{parentName:"p"},"vertx")," con\xadtains a ",Object(l.a)("inlineCode",{parentName:"p"},"demo-client")," for our Vert.x web app and a set\nof users for test\xading."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-haml"}),"docker run \\\n  -",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"it \\\n"),"  -",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"-name vertx-keycloak \\\n"),"  -",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"-rm \\\n"),"  -",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"e KEYCLOAK_USER=admin \\\n"),"  -",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"e KEYCLOAK_PASSWORD=admin \\\n"),"  -",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"e KEYCLOAK_IMPORT=",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-regexp"}),"/tmp/vertx"),"-realm.json \\\n"),"  -",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"v $PWD/vertx-realm.",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-symbol"}),"json:"),"/tmp/vertx-realm.json \\\n"),"  -",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"p ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-number"}),"8080"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-symbol"}),":"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-number"}),"8080")," \\\n"),"  quay.io/keycloak/keycloak:9.0.0\n")),Object(l.a)("h2",null,"Vert.x Web App"),Object(l.a)("p",null,"The sim\xadple web app con\xadsists of a sin\xadgle ",Object(l.a)("inlineCode",{parentName:"p"},"Verticle"),", runs on ",Object(l.a)("inlineCode",{parentName:"p"},"http://localhost:8090")," and pro\xadvides a few routes with pro\xadtected re\xadsources. ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/thomasdarimont/vertx-playground/blob/master/keycloak-vertx/src/main/java/demo/MainVerticle.java"}),"You can find the com\xadplete ex\xadam\xadple here"),"."),Object(l.a)("p",null,"The web app con\xadtains the fol\xadlow\xading routes with han\xaddlers:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"/")," - The un\xadpro\xadtected index page"),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"/protected")," - The pro\xadtected page, which shows a greet\xading mes\xadsage, users need to login to ac\xadcess pages be\xadneath this path."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"/protected/user")," - The pro\xadtected user page, which shows some in\xadfor\xadma\xadtion about the user."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"/protected/admin")," - The pro\xadtected admin page, which shows some in\xadfor\xadma\xadtion about the admin, only users with role ",Object(l.a)("inlineCode",{parentName:"li"},"admin")," can ac\xadcess this page."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"/protected/userinfo")," - The pro\xadtected user\xadinfo page, ob\xadtains user in\xadfor\xadma\xadtion from the bearer token pro\xadtected user\xadinfo end\xadpoint in Key\xadcloak."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"/logout")," - The pro\xadtected lo\xadgout re\xadsource, which trig\xadgers the user lo\xadgout.")),Object(l.a)("h3",null,"Running the app"),Object(l.a)("p",null,"To run the app, we need to build our app via:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-ada"}),"cd keycloak-vertx\nmvn clean ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-title"})))),Object(l.a)("p",null,"This cre\xadates a runnable jar, which we can run via:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-mipsasm"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"java "),"-",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"jar "),"target",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"/*.jar\n"))),Object(l.a)("p",null,"Note, that you need to start Key\xadcloak, since our app will try to fetch con\xadfig\xadu\xadra\xadtion from Key\xadcloak."),Object(l.a)("p",null,"If the ap\xadpli\xadca\xadtion is run\xadning, just browse to: ",Object(l.a)("inlineCode",{parentName:"p"},"http://localhost:8090/"),"."),Object(l.a)("p",null,"An ex\xadam\xadple in\xadter\xadac\xadtion with the app can be seen in the fol\xadlow\xading gif:\n","![Vert.x Keycloak Integration Demo]","({{ site_url }}as\xadsets/blog/vertx-\u200bkeycloak-integration/2020-03-07-\u200bvertx-keycloak-integration.gif)"),Object(l.a)("h3",null,"Router, SessionStore and CSRF Protection"),Object(l.a)("p",null,"We start the con\xadfig\xadu\xadra\xadtion of our web app by cre\xadat\xading a ",Object(l.a)("inlineCode",{parentName:"p"},"Router")," where we can add cus\xadtom han\xaddler func\xadtions for our routes.\nTo prop\xaderly han\xaddle the au\xadthen\xadti\xadca\xadtion state we need to cre\xadate a ",Object(l.a)("inlineCode",{parentName:"p"},"SessionStore")," and at\xadtach it to the ",Object(l.a)("inlineCode",{parentName:"p"},"Router"),".\nThe ",Object(l.a)("inlineCode",{parentName:"p"},"SessionStore")," is used by our OAuth2/OpenID Con\xadnect in\xadfra\xadstruc\xadture to as\xadso\xadciate au\xadthen\xadti\xadca\xadtion in\xadfor\xadma\xadtion with a ses\xadsion.\nBy the way, the ",Object(l.a)("inlineCode",{parentName:"p"},"SessionStore")," can also be clus\xadtered if you need to dis\xadtrib\xadute the server-\u200bside state."),Object(l.a)("p",null,"Note that if you want to keep your server state\xadless but still want to sup\xadport clus\xadter\xading,\nthen you could pro\xadvide your own im\xadple\xadmen\xadta\xadtion of a ",Object(l.a)("inlineCode",{parentName:"p"},"SessionStore")," which stores the ses\xadsion in\xadfor\xadma\xadtion\nas an en\xadcrypted cookie on the Client."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Router router = Router.router(vertx);\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Store session information on the server side"),"\nSessionStore sessionStore = LocalSessionStore.create(vertx);\nSessionHandler sessionHandler = SessionHandler.create(sessionStore);\nrouter.route().handler(sessionHandler);\n")),Object(l.a)("p",null,"In order to pro\xadtected against CSRF at\xadtacks it is good prac\xadtice to pro\xadtect HTML forms with a CSRF token.\nWe need this for our lo\xadgout form that we\u2019ll see later."),Object(l.a)("p",null,"To do this we con\xadfig\xadure a ",Object(l.a)("inlineCode",{parentName:"p"},"CSRFHandler")," and add it to our ",Object(l.a)("inlineCode",{parentName:"p"},"Router"),":"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// CSRF handler setup required for logout form"),"\nString csrfSecret = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"zwiebelfische"'),";\nCSRFHandler csrfHandler = CSRFHandler.create(csrfSecret);\nrouter.route().handler(ctx -> {\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Ensures that the csrf token request parameter is available for the CsrfHandler"),"\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// after the logout form was submitted."),"\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// See "Handling HTML forms" https://vertx.io/docs/vertx-core/java/#_handling_requests'),"\n            ctx.request().setExpectMultipart(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\n            ctx.request().endHandler(v -> csrfHandler.handle(ctx));\n        }\n);\n")),Object(l.a)("h3",null,"Keycloak Setup via OpenID Connect Discovery"),Object(l.a)("p",null,"Our app is reg\xadis\xadtered as a con\xadfi\xadden\xadtial OpenID Con\xadnect client with Au\xadtho\xadriza\xadtion Code Flow in Key\xadcloak,\nthus we need to con\xadfig\xadure ",Object(l.a)("inlineCode",{parentName:"p"},"client_id")," and ",Object(l.a)("inlineCode",{parentName:"p"},"client_secret"),". Con\xadfi\xadden\xadtial clients are typ\xadi\xadcally used\nfor server-\u200bside web ap\xadpli\xadca\xadtions, where one can se\xadcurely store the ",Object(l.a)("inlineCode",{parentName:"p"},"client_secret"),". You can find out more\nabout",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.keycloak.org/docs/latest/server_admin/index.html#_access-type"}),"The dif\xadfer\xadent Client Ac\xadcess Types")," in the Key\xadcloak doc\xadu\xadmen\xadta\xadtion."),Object(l.a)("p",null,"Since we don\u2019t want to con\xadfig\xadure things like OAuth2 / OpenID Con\xadnect End\xadpoints our\xadselves, we use Key\xadcloak\u2019s OpenID Con\xadnect dis\xadcov\xadery end\xadpoint to infer the nec\xades\xadsary Oauth2 / OpenID Con\xadnect end\xadpoint URLs."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"String hostname = System.getProperty(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.host"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),");\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," port = Integer.getInteger(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8090"),");\nString baseUrl = String.format(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://%s:%d"'),", hostname, port);\nString oauthCallbackPath = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/callback"'),";\n\nOAuth2ClientOptions clientOptions = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," OAuth2ClientOptions()\n    .setFlow(OAuth2FlowType.AUTH_CODE)\n    .setSite(System.getProperty(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"oauth2.issuer"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://localhost:8080/auth/realms/vertx"'),"))\n    .setClientID(System.getProperty(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"oauth2.client_id"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"demo-client"'),"))\n    .setClientSecret(System.getProperty(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"oauth2.client_secret"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"1f88bd14-7e7f-45e7-be27-d680da6e48d8"'),"));\n\nKeycloakAuth.discover(vertx, clientOptions, asyncResult -> {\n\n    OAuth2Auth oauth2Auth = asyncResult.result();\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (oauth2Auth == ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"throw")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RuntimeException(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Could not configure Keycloak integration via OpenID Connect Discovery Endpoint. Is Keycloak running?"'),");\n    }\n\n    AuthHandler oauth2 = OAuth2AuthHandler.create(oauth2Auth, baseUrl + oauthCallbackPath)\n        .setupCallback(router.get(oauthCallbackPath))\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Additional scopes: openid for OpenID Connect"),"\n        .addAuthority(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"openid"'),");\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// session handler needs access to the authenticated user, otherwise we get an infinite redirect loop"),"\n    sessionHandler.setAuthProvider(oauth2Auth);\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// protect resources beneath /protected/* with oauth2 handler"),"\n    router.route(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected/*"'),").handler(oauth2);\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// configure route handlers"),"\n    configureRoutes(router, webClient, oauth2Auth);\n});\n\ngetVertx().createHttpServer().requestHandler(router).listen(port);\n")),Object(l.a)("h3",null,"Route handlers"),Object(l.a)("p",null,"We con\xadfig\xadure our route han\xaddlers via ",Object(l.a)("inlineCode",{parentName:"p"},"configureRoutes"),":"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"configureRoutes"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Router router, WebClient webClient, OAuth2Auth oauth2Auth)")," "),"{\n\n    router.get(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleIndex);\n\n    router.get(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected"'),").handler(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleGreet);\n    router.get(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected/user"'),").handler(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleUserPage);\n    router.get(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected/admin"'),").handler(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleAdminPage);\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// extract discovered userinfo endpoint url"),"\n    String userInfoUrl =  ((OAuth2AuthProviderImpl)oauth2Auth).getConfig().getUserInfoPath();\n    router.get(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected/userinfo"'),").handler(createUserInfoHandler(webClient, userInfoUrl));\n\n    router.post(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/logout"'),").handler(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleLogout);\n}\n")),Object(l.a)("p",null,"The index han\xaddler ex\xadposes an un\xadpro\xadtected re\xadsource:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleIndex"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    respondWithOk(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Welcome to Vert.x Keycloak Example</h1><br><a href=\\"/protected\\">Protected</a>"'),");\n}\n")),Object(l.a)("h3",null,"Extract User Information from the OpenID Connect ID Token"),Object(l.a)("p",null,"Our app ex\xadposes a sim\xadple greet\xading page which shows some in\xadfor\xadma\xadtion about the user and pro\xadvides links to other pages."),Object(l.a)("p",null,"The user greet\xading han\xaddler is pro\xadtected by the Key\xadcloak OAuth2 / OpenID Con\xadnect in\xadte\xadgra\xadtion. To show in\xadfor\xadma\xadtion about\nthe cur\xadrent user, we first need to call the ",Object(l.a)("inlineCode",{parentName:"p"},"ctx.user()")," method to get an user ob\xadject we can work with.\nTo ac\xadcess the OAuth2 token in\xadfor\xadma\xadtion, we need to cast it to ",Object(l.a)("inlineCode",{parentName:"p"},"OAuth2TokenImpl"),"."),Object(l.a)("p",null,"We can ex\xadtract the user in\xadfor\xadma\xadtion like the user\xadname from the ",Object(l.a)("inlineCode",{parentName:"p"},"IDToken")," ex\xadposed by the user ob\xadject via ",Object(l.a)("inlineCode",{parentName:"p"},'user.idToken().getString("preferred_username")'),".\nNote, there are many more claims like (name, email, give\xadnanme, fam\xadi\xadly\xadname etc.) avail\xadable. The ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://openid.net/specs/openid-connect-core-1_0.html#Claims"}),"OpenID Con\xadnect Core Spec\xadi\xadfi\xadca\xadtion")," con\xadtains a list of avail\xadable claims."),Object(l.a)("p",null,"We also gen\xader\xadate a list with links to the other pages which are sup\xadported:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleGreet"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    OAuth2TokenImpl oAuth2Token = (OAuth2TokenImpl) ctx.user();\n\n    String username = oAuth2Token.idToken().getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"preferred_username"'),");\n\n    String greeting = String.format(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Hi %s @%s</h1><ul>"')," +\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<li><a href=\\"/protected/user\\">User Area</a></li>"')," +\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<li><a href=\\"/protected/admin\\">Admin Area</a></li>"')," +\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<li><a href=\\"/protected/userinfo\\">User Info (Remote Call)</a></li>"')," +\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"</ul>"'),", username, Instant.now());\n\n    String logoutForm = createLogoutForm(ctx);\n\n    respondWithOk(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", greeting + logoutForm);\n}\n")),Object(l.a)("p",null,"The user page han\xaddler shows in\xadfor\xadma\xadtion about the cur\xadrent user:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleUserPage"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    OAuth2TokenImpl user = (OAuth2TokenImpl) ctx.user();\n\n    String username = user.idToken().getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"preferred_username"'),");\n    String displayName = oAuth2Token.idToken().getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),");\n\n    String content = String.format(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>User Page: %s (%s) @%s</h1><a href=\\"/protected\\">Protected Area</a>"'),",\n                                   username, displayName, Instant.now());\n    respondWithOk(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", content);\n}\n")),Object(l.a)("h3",null,"Authorization: Checking for Required Roles"),Object(l.a)("p",null,"Our app ex\xadposes a sim\xadple admin page which shows some in\xadfor\xadma\xadtion for ad\xadmins, which should only be vis\xadi\xadble for ad\xadmins. Thus we re\xadquire that users must have the ",Object(l.a)("inlineCode",{parentName:"p"},"admin")," realm role in Key\xadcloak to be able to ac\xadcess the admin page."),Object(l.a)("p",null,"This is done via a call to ",Object(l.a)("inlineCode",{parentName:"p"},'user.isAuthorized("realm:admin", cb)'),". The han\xaddler func\xadtion ",Object(l.a)("inlineCode",{parentName:"p"},"cb")," ex\xadposes\nthe re\xadsult of the au\xadtho\xadriza\xadtion check via the ",Object(l.a)("inlineCode",{parentName:"p"},"AsyncResult<Boolean> res"),". If the cur\xadrent user has the\n",Object(l.a)("inlineCode",{parentName:"p"},"admin")," role then the re\xadsult is ",Object(l.a)("inlineCode",{parentName:"p"},"true")," oth\xader\xadwise ",Object(l.a)("inlineCode",{parentName:"p"},"false"),":"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleAdminPage"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    OAuth2TokenImpl user = (OAuth2TokenImpl) ctx.user();\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// check for realm-role "admin"'),"\n    user.isAuthorized(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"realm:admin"'),", res -> {\n\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!res.succeeded() || !res.result()) {\n            respondWith(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"403"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Forbidden</h1>"'),");\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n        }\n\n        String username = user.idToken().getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"preferred_username"'),");\n\n        String content = String.format(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Admin Page: %s @%s</h1><a href=\\"/protected\\">Protected Area</a>"'),",\n                                        username, Instant.now());\n        respondWithOk(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", content);\n    });\n}\n")),Object(l.a)("h4",null,"Call Services protected with Bearer Token"),Object(l.a)("p",null,"Often we need to call other ser\xadvices from our web app that are pro\xadtected via Bearer Au\xadthen\xadti\xadca\xadtion. This means\nthat we need a valid ",Object(l.a)("inlineCode",{parentName:"p"},"access token")," to ac\xadcess a re\xadsource pro\xadvided on an\xadother server."),Object(l.a)("p",null,"To demon\xadstrate this we use Key\xadcloak\u2019s ",Object(l.a)("inlineCode",{parentName:"p"},"/userinfo")," end\xadpoint as a straw man to demon\xadstrate back\xadend calls with a bearer token."),Object(l.a)("p",null,"We can ob\xadtain the cur\xadrent valid ",Object(l.a)("inlineCode",{parentName:"p"},"access token")," via ",Object(l.a)("inlineCode",{parentName:"p"},"user.opaqueAccessToken()"),".\nSince we use a ",Object(l.a)("inlineCode",{parentName:"p"},"WebClient")," to call the pro\xadtected end\xadpoint, we need to pass the ",Object(l.a)("inlineCode",{parentName:"p"},"access token"),"\nvia the ",Object(l.a)("inlineCode",{parentName:"p"},"Authorization")," header by call\xading ",Object(l.a)("inlineCode",{parentName:"p"},"bearerTokenAuthentication(user.opaqueAccessToken())"),"\nin the cur\xadrent ",Object(l.a)("inlineCode",{parentName:"p"},"HttpRequest")," ob\xadject:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Handler<RoutingContext> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"createUserInfoHandler"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(WebClient webClient, String userInfoUrl)")," "),"{\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," (RoutingContext ctx) -> {\n\n        OAuth2TokenImpl user = (OAuth2TokenImpl) ctx.user();\n\n        URI userInfoEndpointUri = URI.create(userInfoUrl);\n        webClient\n            .get(userInfoEndpointUri.getPort(), userInfoEndpointUri.getHost(), userInfoEndpointUri.getPath())\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// use the access token for calls to other services protected via JWT Bearer authentication"),"\n            .bearerTokenAuthentication(user.opaqueAccessToken())\n            .as(BodyCodec.jsonObject())\n            .send(ar -> {\n\n                ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!ar.succeeded()) {\n                    respondWith(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"500"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"{}"'),");\n                    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n                }\n\n                JsonObject body = ar.result().body();\n                respondWithOk(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),", body.encode());\n            });\n    };\n}\n")),Object(l.a)("h3",null,"Handle logout"),Object(l.a)("p",null,"Now that we got a work\xading SSO login with au\xadtho\xadriza\xadtion, it would be great if we would allow users to lo\xadgout again.\nTo do this we can lever\xadage the built-\u200bin OpenID Con\xadnect lo\xadgout func\xadtion\xadal\xadity which can be called via ",Object(l.a)("inlineCode",{parentName:"p"},"oAuth2Token.logout(cb)"),"."),Object(l.a)("p",null,"The han\xaddler func\xadtion ",Object(l.a)("inlineCode",{parentName:"p"},"cb")," ex\xadposes the re\xadsult of the lo\xadgout ac\xadtion via the ",Object(l.a)("inlineCode",{parentName:"p"},"AsyncResult<Void> res"),".\nIf the lo\xadgout was suc\xadcess\xadfull we destory our ses\xadsion via ",Object(l.a)("inlineCode",{parentName:"p"},"ctx.session().destroy()")," and redi\xadrect the user to the index page."),Object(l.a)("p",null,"The lo\xadgout form is gen\xader\xadated via the ",Object(l.a)("inlineCode",{parentName:"p"},"createLogoutForm")," method."),Object(l.a)("p",null,"As men\xadtioned ear\xadlier, we need to pro\xadtect our lo\xadgout form with a CSRF token to pre\xadvent ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://owasp.org/www-community/attacks/csrf"}),"CSRF at\xadtacks"),"."),Object(l.a)("p",null,"Note: If we had end\xadpoints that would ac\xadcept data sent to the server, then we\u2019d need to guard those end\xadpoints with an CSRF token as well."),Object(l.a)("p",null,"We need to ob\xadtain the gen\xader\xadated ",Object(l.a)("inlineCode",{parentName:"p"},"CSRFToken")," and ren\xadder it into a hid\xadden form input field that\u2019s trans\xadfered via HTTP POST when the lo\xadgout form is sub\xadmit\xadted:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleLogout"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    OAuth2TokenImpl oAuth2Token = (OAuth2TokenImpl) ctx.user();\n    oAuth2Token.logout(res -> {\n\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!res.succeeded()) {\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// the user might not have been logged out, to know why:"),"\n            respondWith(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"500"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", String.format(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Logout failed %s</h1>"'),", res.cause()));\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n        }\n\n        ctx.session().destroy();\n        ctx.response().putHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"location"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/?logout=true"'),").setStatusCode(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"302"),").end();\n    });\n}\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," String ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"createLogoutForm"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    String csrfToken = ctx.get(CSRFHandler.DEFAULT_HEADER_NAME);\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<form action=\\"/logout\\" method=\\"post\\">"'),"\n            + String.format(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<input type=\\"hidden\\" name=\\"%s\\" value=\\"%s\\">"'),", CSRFHandler.DEFAULT_HEADER_NAME, csrfToken)\n            + ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<button>Logout</button></form>"'),";\n}\n")),Object(l.a)("p",null,"Some ad\xaddi\xadtional plumb\xading:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"respondWithOk"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx, String contentType, String content)")," "),"{\n    respondWith(ctx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),", contentType, content);\n}\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"respondWith"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx, ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," statusCode, String contentType, String content)")," "),"{\n    ctx.request().response() ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//"),"\n            .putHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", contentType) ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//"),"\n            .setStatusCode(statusCode)\n            .end(content);\n}\n")),Object(l.a)("h2",null,"More examples"),Object(l.a)("p",null,"This con\xadcludes the Key\xadcloak in\xadte\xadgra\xadtion ex\xadam\xadple."),Object(l.a)("p",null,"Check out the com\xadplete ex\xadam\xadple in ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/thomasdarimont/vertx-playground/tree/master/keycloak-vertx"}),"keycloak-\u200bvertx Ex\xadam\xadples Repo"),"."),Object(l.a)("p",null,"Thank you for your time, stay tuned for more up\xaddates! If you want to learn more about Key\xadcloak, feel free to reach out to me. You can find me via ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://twitter.com/thomasdarimont"}),"thomas\xadda\xadri\xadmont on twit\xadter"),"."),Object(l.a)("p",null,"Happy Hack\xading!"))}b.isMDXComponent=!0},KxBF:function(e,a){e.exports=function(e,a,t){var n=-1,s=e.length;a<0&&(a=-a>s?0:s+a),(t=t>s?s:t)<0&&(t+=s),s=a>t?0:t-a>>>0,a>>>=0;for(var r=Array(s);++n<s;)r[n]=e[n+a];return r}},NL1R:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x for Scala next steps",category:"guides",authors:[{name:"Jochen Mader",github_id:"codepitbull"}],summary:"This blog post gives an overview of the current plans for the vertx-lang-scala module, in particular with respect to the upcoming Vert.x 4."}),i=[{term:"scala",tf:26},{term:"support",tf:11},{term:"new",tf:11},{term:"will",tf:11},{term:"method",tf:11},{term:"13",tf:9},{term:"class",tf:9},{term:"approach",tf:8},{term:"version",tf:7},{term:"idea",tf:6},{term:"wrap",tf:6},{term:"base",tf:5},{term:"promis",tf:5},{term:"api",tf:5},{term:"us",tf:5},{term:"java",tf:5},{term:"valu",tf:4},{term:"receiv",tf:4},{term:"lang",tf:4},{term:"look",tf:4},{term:"current",tf:4},{term:"creat",tf:4},{term:"collect",tf:4},{term:"time",tf:4},{term:"futur",tf:4}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Scala for Eclipse Vert.x: The next steps"),Object(l.a)("h2",null,"TL;DR"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"No Scala 2.13 in Eclipse Vert.x 3.x due to in\xadcreased sup\xadport bur\xadden"),Object(l.a)("li",{parentName:"ul"},"New value classes based ap\xadproach for Vert.x 4")),Object(l.a)("h2",null,"Retrospective"),Object(l.a)("p",null,"It\u2019s been more than two years since the in\xadcep\xadtion of ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-lang-scala")," to the Vert.x ecosys\xadtem. And al\xadmost as long since I wrote my first ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/scala-is-here/"}),"blog post")," about it."),Object(l.a)("p",null,"A lot has hap\xadpened since March 2017:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"vertx-lang-scala")," kept up with new ver\xadsions of Scala"),Object(l.a)("li",{parentName:"ul"},"all Vert.x-\u200bmodules are sup\xadported (35 so far)"),Object(l.a)("li",{parentName:"ul"},"a Giter8 based ",Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-scala.g8"}),"tem\xadplate")," was added for eas\xadily boot\xadstrap\xadping a Vert.x-\u200bScala-project"),Object(l.a)("li",{parentName:"ul"},"Bugs were squashed")),Object(l.a)("p",null,"And most re\xadcently we re\xadceived a great con\xadtri\xadbu\xadtion by ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/NikolajLeischner"}),"Niko\xadlaj Leis\xadchner")," who was kind enough to port the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/TechEmpower/FrameworkBenchmarks/tree/master/frameworks/Scala/vertx-web-scala"}),"techempow\xadered")," bench\xadmark to vert-\u200blang-scala. Which will be part of the next steps."),Object(l.a)("p",null,"The num\xadbers pro\xadduced by this bench\xadmark were very promis\xading and and ad\xaddi\xadtional mo\xadti\xadva\xadtion to move to the next phase of Scala sup\xadport for Vert.x."),Object(l.a)("h2",null,"Old idea"),Object(l.a)("p",null,"Be\xadfore get\xadting to the new ideas I want to take a look at the \u201cold\u201d one."),Object(l.a)("p",null,"The cur\xadrent ver\xadsion of vert-\u200blang-scala is based around the idea of wrap\xadping the Vert.x-API with a ded\xadi\xadcated Scala-\u200blayer. That layer is cre\xadated using a Freemarker-\u200bbased code gen\xader\xada\xadtor. I took this idea from the first try by Tim Fox for build\xading that sup\xadport."),Object(l.a)("p",null,"Wrap\xadping the ex\xadist\xading Java-\u200bAPI was rather painful but gave me great flex\xadi\xadbil\xadity to cre\xadate an id\xadiomatic Scala-\u200bAPI."),Object(l.a)("p",null,"But an ap\xadproach like that comes with a price:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"There are a lot of in\xadter\xadme\xaddi\xadate ob\xadjects being cre\xadated."),Object(l.a)("li",{parentName:"ul"},"Many un\xadnec\xadces\xadsary con\xadver\xadsions be\xadtween Java/Scala types")),Object(l.a)("p",null,"Both in\xadcreased mem\xadory con\xadsump\xadtion and garbage col\xadlec\xadtion ac\xadtiv\xadity quite a bit and has been bug\xadging me from the be\xadgin\xadning."),Object(l.a)("h2",null,"New idea"),Object(l.a)("p",null,"With Vert.x 4 ap\xadproach\xading I was fi\xadnally able to in\xadvest time into the re\xadwork I had wanted to do for quite a while."),Object(l.a)("p",null,"The core idea is to re\xadplace the cur\xadrent wrap\xadping based ap\xadproach with some\xadthing more light\xadweight but na\xadtive to the Scala-\u200bworld."),Object(l.a)("p",null,"And that\u2019s where ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://docs.scala-lang.org/overviews/core/value-classes.html"}),"value classes")," come in."),Object(l.a)("p",null,"Value classes allow the ex\xadten\xadsion of ex\xadist\xading classes with ad\xaddi\xadtional meth\xadods. They make it easy to con\xadtrol ",Object(l.a)("strong",{parentName:"p"},"when")," meth\xadods be\xadcome vis\xadi\xadble and do that with a min\xadi\xadmum of over\xadhead. To be pre\xadcise: A wrap\xadping class is nor\xadmally ever only in\xadstan\xadti\xadated ",Object(l.a)("strong",{parentName:"p"},"once"),"."),Object(l.a)("p",null,"A good ex\xadam\xadple is the ad\xaddi\xadtion of meth\xadods for wrap\xadping the Vert.x ap\xadproach of Promises with Scala-\u200bFutures. Each method re\xadturn\xading a Vert.x-\u200bPromise needs to re\xadceive an al\xadter\xadna\xadtive ver\xadsion which re\xadturns a Scala-\u200bFuture."),Object(l.a)("p",null,"In Vert.x 3 I achieved that by adding meth\xadods to the wrap\xadper and giv\xading them a dis\xadtinct name. A method called ",Object(l.a)("strong",{parentName:"p"},"lis\xadten")," re\xadturn\xading a Promise would re\xadceive a com\xadpan\xadion called ",Object(l.a)("strong",{parentName:"p"},"lis\xadten\xadFu\xadture")," in the Scala layer."),Object(l.a)("p",null,"Let\u2019s look at how this looks in the new ap\xadproach:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-scala"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," io.vertx.scala\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"object")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"core")),"{\n   ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"implicit")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"HttpServerScala"),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"val asJava: io.vertx.core.http.",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-type"}),"HttpServer")),") ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AnyVal")," "),"{\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"def")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"listenFuture")),"(port: java.lang.",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Integer"),"): scala.concurrent.",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Future"),"[io.vertx.core.http.",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"HttpServer"),"] = {..}\n      ..\n}\n")),Object(l.a)("p",null,"The code above does the fol\xadlow\xading things:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"It cre\xadates a pack\xadage ob\xadject for ",Object(l.a)("strong",{parentName:"li"},"io.vertx.scala.core")),Object(l.a)("li",{parentName:"ul"},"it adds an im\xadplict class ",Object(l.a)("strong",{parentName:"li"},"HttpServer\xadScala")," to wrpa ",Object(l.a)("strong",{parentName:"li"},"HttpServer")),Object(l.a)("li",{parentName:"ul"},"it adds a ",Object(l.a)("strong",{parentName:"li"},"lis\xadten\xadFu\xadture")," method")),Object(l.a)("p",null,"Using this method in code looks like this:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-scala"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," io.vertx.scala.demo\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.lang.scala.",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"VertxExecutionContext"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.scala.core._\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," scala.util.{",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Failure"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Success"),"}\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"object")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Main")," "),"{\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"def")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"main")),"(args: ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Array"),"[",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"String"),"]): ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Unit")," = {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"val")," vertx = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Vertx"),".vertx()\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"implicit")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"val")," ec = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"VertxExecutionContext"),"(vertx.getOrCreateContext())\n    vertx\n      .createHttpServer()\n      .requestHandler(r => {\n        r.response().end(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"bye"'),")\n      })\n      .listenFuture(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"6667"),")\n      .onComplete {\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"case")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Success"),"(_) => println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Started"'),")\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"case")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Failure"),"(exception) => println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Failure"'),")\n      }\n  }\n}\n")),Object(l.a)("p",null,"Im\xadport\xading the pack\xadage ob\xadject using ",Object(l.a)("strong",{parentName:"p"},"im\xadport io.vertx.scala.core._")," brings the ex\xadten\xadsion method into scope and makes them avail\xadable on all in\xadstances of ",Object(l.a)("strong",{parentName:"p"},"HttpServer"),". In the ex\xadam\xadple above ",Object(l.a)("strong",{parentName:"p"},"cre\xadate\xadHttpServer()")," re\xadturn such an in\xadstance and we can now use the id\xadiomatic Scala way of han\xaddling a Fu\xadture."),Object(l.a)("h3",null,"Even more"),Object(l.a)("p",null,"Ex\xadtend\xading classes with Future-\u200bmethods is only one of the new things to come. On top of that the sup\xadport for DataOb\xadjects will be con\xadsid\xader\xadably im\xadproved, both through ex\xadtend\xading them and by pro\xadvid\xading type aliases."),Object(l.a)("p",null,"I also switched from doing all con\xadver\xadsions for col\xadlec\xadtions au\xadto\xadmat\xadi\xadcally to hand\xading the con\xadtrol back to the user. Some\xadthing which gets even more im\xadpor\xadtant for Scala 2.13 and the new col\xadlec\xadtion API."),Object(l.a)("h3",null,"The downside"),Object(l.a)("p",null,"The clear down\xadside of this ap\xadproach is that the Java-\u200bmethods will stay vis\xadi\xadble since the java-\u200bclasses won\u2019t be wrapped but ex\xadtended. This might lead to some con\xadfu\xadsion but I am pretty sure the ben\xade\xadfits out\xadweight this down\xadside."),Object(l.a)("p",null,"The big\xadger change will be the re\xadmoval of au\xadto\xadmatic von\xadver\xadsion be\xadtween Scala types (Long/Int/String and  Col\xadlec\xadtions) and their Java coun\xadter\xadparts. I spent con\xadsid\xader\xadable time try\xading to tune that part in the cur\xadrent ver\xadsion bbut al\xadways ended up hit\xadting some edge\xadcase. For now I\u2019ve de\xadcided to have the user pick the right time to con\xadvert."),Object(l.a)("p",null,"I might still add this fea\xadture in a later ver\xadsion if user feed\xadback points into that di\xadrec\xadtion."),Object(l.a)("h2",null,"When will I get it?"),Object(l.a)("p",null,"First for the good news: There is al\xadready a ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-lang-scala/tree/4.0"}),"branch")," with a full im\xadple\xadmen\xadta\xadtion."),Object(l.a)("p",null,"The bad news: It will break until Vert.x 4.0 is fi\xadnally re\xadleased."),Object(l.a)("p",null,"Vert.x 4 is in ac\xadtive de\xadvel\xadop\xadment with most APIs al\xadready fi\xadnal\xadized but break\xading changes still hap\xadpen. So use at your own risk!"),Object(l.a)("h2",null,"What about Scala 2.13?"),Object(l.a)("p",null,"Scala 2.13 has been re\xadleased re\xadcently which prompted ques\xadtions from the com\xadmu\xadnity about when it will be sup\xadported by Vert.x."),Object(l.a)("p",null,"I haven\u2019t done a good job pro\xadvid\xading the re\xadsults of our in\xadter\xadnal dis\xadcus\xadsions on that topic to the com\xadmu\xadnity. So here we go:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Vert.x 3 will stay on 2.12 for the fol\xadlow\xading rea\xadsons:",Object(l.a)("ul",{parentName:"li"},Object(l.a)("li",{parentName:"ul"},"Both are still ac\xadtively sup\xadported"),Object(l.a)("li",{parentName:"ul"},"Scala ecosys\xadtems takes some time to do the switch to 2.13"),Object(l.a)("li",{parentName:"ul"},"We sim\xadply don\u2019t have the ca\xadpac\xadity to sup\xadport both ver\xadsions ",Object(l.a)("strong",{parentName:"li"},"AND")," the up\xadcom\xading new ver\xadsion"))),Object(l.a)("li",{parentName:"ul"},"Vert.x 4 will re\xadceive 2.13 sup\xadport",Object(l.a)("ul",{parentName:"li"},Object(l.a)("li",{parentName:"ul"},"Scala ecosys\xadtem will have moved closer to 2.13 adop\xadtion when Vert.x 4 comes out")))),Object(l.a)("h2",null,"For the adventure seaker"),Object(l.a)("p",null,"I ac\xadtu\xadally did a port of vertx-\u200blang-scala 3.8 to Scala 2.13 and you can grab the work in this ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-lang-scala/tree/3.8_2.13"}),"branch"),"."),Object(l.a)("p",null,"Don\u2019t ex\xadpect ",Object(l.a)("strong",{parentName:"p"},"ANY")," sup\xadport for this branch. This was only an ex\xadper\xadi\xadment to see how much I had to change for ini\xadtial 2.13 sup\xadport."),Object(l.a)("h2",null,"Summary"),Object(l.a)("p",null,"Vert.x 4 will be an evo\xadlu\xadtion\xadary step for vertx-\u200blang-scala. Value classes promise to re\xadduce both com\xadplex\xadity and al\xadlo\xadca\xadtion rate, two things which have been bug\xadging me quite a bit with the cur\xadrent ap\xadproach."),Object(l.a)("p",null,"I am eager to hear from you all what you think about this new di\xadrec\xadtion."))}b.isMDXComponent=!0},OrTX:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 4 milestone 2 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"The new milestone release of Vert.x 4 includes progress on futurisation, tracing, and many other improvements."}),i=[{term:"client",tf:9},{term:"mileston",tf:6},{term:"releas",tf:6},{term:"trace",tf:5},{term:"applic",tf:5},{term:"featur",tf:3},{term:"provid",tf:3},{term:"distribut",tf:3},{term:"develop",tf:3},{term:"asynchron",tf:3},{term:"redi",tf:3},{term:"amqp",tf:3},{term:"not",tf:3},{term:"flow",tf:3},{term:"request",tf:3},{term:"http",tf:3},{term:"chang",tf:3},{term:"replac",tf:3},{term:"second",tf:2},{term:"seri",tf:2},{term:"aim",tf:2},{term:"futuris",tf:2},{term:"callback",tf:2},{term:"model",tf:2},{term:"first",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 4 milestone 2 released!"),Object(l.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce the sec\xadond 4.0 mile\xadstone re\xadlease of Eclipse Vert.x ."),Object(l.a)("p",null,"Vert.x 4 is the evo\xadlu\xadtion of the Vert.x 3.x se\xadries that will bring key fea\xadtures to Vert.x."),Object(l.a)("p",null,"This re\xadlease aims to pro\xadvide a re\xadli\xadable dis\xadtri\xadb\xadu\xadtion of the cur\xadrent de\xadvel\xadop\xadment of Vert.x 4 for peo\xadple who\nwant to try it and pro\xadvide feed\xadback."),Object(l.a)("h4",null,"Futurisation"),Object(l.a)("p",null,"Vert.x 4 ex\xadtends the 3.x call\xadback asyn\xadchro\xadnous model to a fu\xadture/call\xadback hy\xadbrid model."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"NetClient")," "),"{\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Since 3.0"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host, Handler<AsyncResult<NetSocket>> handler)")),";\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// New in 4.0"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Future<NetSocket> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host)")),";\n}\n")),Object(l.a)("p",null,"The first mile\xadstone, only cov\xadered ",Object(l.a)("em",{parentName:"p"},"Vert.x Core"),", this sec\xadond mile\xadstone has made sig\xadnif\xadi\xadcant progress with the fu\xadtur\xadi\xadsa\xadtion\nof the fol\xadlow\xading stack mod\xadules:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"vertx-\u200bauth"),Object(l.a)("li",{parentName:"ul"},"vertx-\u200bweb"),Object(l.a)("li",{parentName:"ul"},"vertx-\u200bmqtt"),Object(l.a)("li",{parentName:"ul"},"vertx-\u200bcassandra-client"),Object(l.a)("li",{parentName:"ul"},"vertx-\u200bredis-client"),Object(l.a)("li",{parentName:"ul"},"vertx-\u200bkakfa-client"),Object(l.a)("li",{parentName:"ul"},"vertx-\u200bamqp-client")),Object(l.a)("h4",null,"Tracing"),Object(l.a)("p",null,"In\xadstru\xadment\xading asyn\xadchro\xadnous ap\xadpli\xadca\xadtion for dis\xadtrib\xaduted trac\xading is quite chal\xadleng\xading be\xadcause most trac\xading li\xadbraries\nrely on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://fr.wikipedia.org/wiki/Thread_Local_Storage"}),"thread local stor\xadage"),". While it works rea\xadsonnably well\nin a block\xading ap\xadpli\xadca\xadtion, this does not work for an asyn\xadchro\xadnous ap\xadpli\xadca\xadtion."),Object(l.a)("p",null,"This sup\xadposes that the ap\xadpli\xadca\xadtion con\xadtrol flow mat\xadters (i.e threads) al\xadthough what re\xadally mat\xadters is the ap\xadpli\xadca\xadtion\nre\xadquest flow (e.g the in\xadcom\xading HTTP re\xadquest)."),Object(l.a)("p",null,"We im\xadproved Vert.x 4 to reify the re\xadquest flow, mak\xading it pos\xadsi\xadble to in\xadte\xadgrate pop\xadu\xadlar trac\xading tools such as ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://zipkin.io"}),"Zip\xadkin"),"\nor ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://opentracing.io"}),"Open\xadtrac\xading"),". Vert.x per\xadfor\xadmance is leg\xadendary and we made sure that this does not have\nany over\xadhead out of the box (dis\xadabled)."),Object(l.a)("p",null,"We pro\xadvide sup\xadport for these two pop\xadu\xadlar li\xadbraries under the ",Object(l.a)("em",{parentName:"p"},"Vert.x Trac\xading")," um\xadbrella."),Object(l.a)("h4",null,"Other changes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Groovy has been sim\xadpli\xadfied in Vert.x 4 to re\xadmove code gen\xader\xada\xadtion that was not re\xadally needed in prac\xadtice"),Object(l.a)("li",{parentName:"ul"},"The orig\xadi\xadnal Redis client dep\xadre\xadcated in 3.7 has been re\xadmoved re\xadplaced by the new Redis client"),Object(l.a)("li",{parentName:"ul"},"The fol\xadlow\xading com\xadpo\xadnents have reached their end of life and have been pruned",Object(l.a)("ul",{parentName:"li"},Object(l.a)("li",{parentName:"ul"},"MySQL / Post\xadgreSQL async client re\xadplaced by the Vert.x SQL Client (since 3.8)"),Object(l.a)("li",{parentName:"ul"},"AMQP bridge re\xadplaced by the Vert.x AMQP Client (since 3.7)")))),Object(l.a)("h4",null,"Ramping up to Vert.x 4"),Object(l.a)("p",null,"In\xadstead of de\xadvel\xadop\xading all new fea\xadtures ex\xadclu\xadsively in Vert.x 4, we in\xadtro\xadduce some of these fea\xadtures in the 3.x branch\nso the com\xadmu\xadnity can ben\xade\xadfit from them. The Vert.x 4 de\xadvel\xadop\xadment focus on more fun\xadda\xadmen\xadtal changes that can\xadnot be done\nin the 3.x se\xadries."),Object(l.a)("img",{src:"{{ site_url }}assets/blog/vertx-4-milestone2-release/vertx-4-timeline.png",alt:"Screenshot",class:"img-responsive"}),Object(l.a)("p",null,"This is the first mile\xadstone of Vert.x 4, we aim to re\xadlease Vert.x 4 by the end of this year and you can of course\nex\xadpect more mile\xadstones to out\xadline the progress of the ef\xadfort."),Object(l.a)("h4",null,"Finally"),Object(l.a)("p",null,"The ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes"),"\ncan be found on the wiki."),Object(l.a)("p",null,"For this re\xadlease there are no Docker im\xadages.,"),Object(l.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://search.maven.org/search?q=g:io.vertx%20AND%20v:4.0.0-milestone2"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://repo1.maven.org/maven2/io/vertx/vertx-stack-manager/4.0.0-milestone2/"}),"Maven Cen\xadtral"),"."),Object(l.a)("p",null,"You can boot\xadstrap a Vert.x 4.0.0-\u200bmilestone2 project using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(l.a)("p",null,"The doc\xadu\xadmen\xadta\xadtion has been de\xadployed on this pre\xadview web-\u200bsite ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx-ci.github.io/vertx-4-preview/docs/"}),"https://vertx-\u200bci.github.io/vertx-\u200b4-\u200bpreview/docs/")),Object(l.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},Pc3Q:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x RabbitMQ client gets a new consumer API!",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"In this blog post, we present the new consumer API of the RabbitMQ client that will be released with Eclipse Vert.x 3.6.0."}),i=[{term:"api",tf:12},{term:"queue",tf:10},{term:"messag",tf:9},{term:"new",tf:8},{term:"consum",tf:8},{term:"rabbitmq",tf:4},{term:"call",tf:4},{term:"client",tf:3},{term:"will",tf:3},{term:"limit",tf:3},{term:"provid",tf:3},{term:"type",tf:3},{term:"method",tf:3},{term:"stream",tf:3},{term:"go",tf:2},{term:"us",tf:2},{term:"let",tf:2},{term:"event",tf:2},{term:"control",tf:2},{term:"simpli",tf:2},{term:"handler",tf:2},{term:"idiomat",tf:2},{term:"arriv",tf:2},{term:"allow",tf:2},{term:"intern",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x RabbitMQ client gets a new consumer API!"),Object(l.a)("p",null,"In Eclipse Vert.x 3.6.0 the Rab\xadbitMQ client will get a new con\xadsumer API. In this post we are going to show\nthe im\xadprove\xadments since the pre\xadvi\xadous API and how easy it is to use now."),Object(l.a)("p",null,"Be\xadfore dig\xadging into the new API let\u2019s find out what were the lim\xadi\xadta\xadtions of the ac\xadtual one:"),Object(l.a)("ol",null,Object(l.a)("li",{parentName:"ol"},"The API uses the event bus in such lim\xadit\xading the con\xadtrol of the con\xadsumer over the Rab\xadbitMQ queue."),Object(l.a)("li",{parentName:"ol"},"The mes\xadsage API is based on ",Object(l.a)("inlineCode",{parentName:"li"},"JsonObject")," which does not pro\xadvide a typed API")),Object(l.a)("h2",null,"The new API at a glance"),Object(l.a)("p",null,"Here is how sim\xadple queue con\xadsump\xadtion looks like with the new API:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"RabbitMQClient client = RabbitMQClient.create(vertx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RabbitMQOptions());\n\nclient.basicConsumer(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my.queue"'),", res -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (res.succeeded()) {\n    System.out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"RabbitMQ consumer created !"'),");\n    RabbitMQConsumer mqConsumer = res.result();\n    mqConsumer.handler((RabbitMQMessage message) -> {\n        System.out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Got message: "')," + message.body().toString());\n    });\n  } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Oups something went wrong"),"\n    res.cause().printStackTrace();\n  }\n});\n")),Object(l.a)("p",null,"Now to cre\xadate a queue you sim\xadply call the ",Object(l.a)("inlineCode",{parentName:"p"},"basicConsumer")," method and you ob\xadtain asyn\xadchro\xadnously\na ",Object(l.a)("inlineCode",{parentName:"p"},"RabbitMQConsumer"),"."),Object(l.a)("p",null,"Then you need to pro\xadvide a han\xaddler called for each mes\xadsage con\xadsumed via ",Object(l.a)("em",{parentName:"p"},"Rab\xadbit\xadMQ\xadCon\xadsumer#han\xaddler")," which\nis the id\xadiomatic way to con\xadsumer stream in Vert.x"),Object(l.a)("p",null,"You may also note that when we a mes\xadsage ar\xadrives, it has the type of ",Object(l.a)("inlineCode",{parentName:"p"},"RabbitMQMessage"),", this is a typed\nmes\xadsage rep\xadre\xadsen\xadta\xadtion."),Object(l.a)("p",null,"Since ",Object(l.a)("inlineCode",{parentName:"p"},"RabbitMQConsumer")," is a stream, you also al\xadlowed to ",Object(l.a)("inlineCode",{parentName:"p"},"pause")," and ",Object(l.a)("inlineCode",{parentName:"p"},"resume")," the stream, sub\xadscribe to the\nend event, get no\xadti\xadfied when an ex\xadcep\xadtion oc\xadcurs."),Object(l.a)("p",null,"In ad\xaddi\xadtion, you can can\xadcel the sub\xadscrip\xadtion by call\xading ",Object(l.a)("inlineCode",{parentName:"p"},"RabbitMQConsumer#cancel")," method."),Object(l.a)("h2",null,"Backpressure"),Object(l.a)("p",null,"Some\xadtimes you can have more in\xadcom\xading mes\xadsages than you can han\xaddle."),Object(l.a)("p",null,"The new con\xadsumer API al\xadlows you to con\xadtrol this and lets you store ar\xadrived mes\xadsages in the in\xadter\xadnal queue\nbe\xadfore they are de\xadliv\xadered to the ap\xadpli\xadca\xadtion. In\xaddeed, you can con\xadfig\xadure the queue size."),Object(l.a)("p",null,"Here is how you can limit the in\xadter\xadnal queue size:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Limit to max 300 messages"),"\nQueueOptions options = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," QueueOptions()\n  .setMaxInternalQueueSize(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"300"),");\n\nRabbitMQClient client = RabbitMQClient.create(vertx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RabbitMQOptions());\n\nclient.basicConsumer(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my.queue"'),", options, res -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (res.succeeded()) {\n    System.out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"RabbitMQ consumer created !"'),");\n    RabbitMQConsumer mqConsumer = res.result();\n    mqConsumer.handler((RabbitMQMessage message) -> {\n      System.out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Got message: "')," + message.body().toString());\n    });\n  } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    res.cause().printStackTrace();\n  }\n});\n")),Object(l.a)("p",null,"When the in\xadten\xadral queue queue ca\xadpac\xadity is ex\xadceeded, the new mes\xadsage will be sim\xadply dropped."),Object(l.a)("p",null,"An al\xadter\xadna\xadtive op\xadtion is to drop the old\xadest mes\xadsage in the queue."),Object(l.a)("p",null,"In order to achieve this, you should spec\xadify the be\xadhav\xadior by call\xading ",Object(l.a)("inlineCode",{parentName:"p"},"QueueOptions#setKeepMostRecent")," method."),Object(l.a)("h2",null,"Finally"),Object(l.a)("p",null,"The new Vert.x Rab\xadbitMQ client con\xadsumer API is way more id\xadiomatic and mod\xadern way to con\xadsume mes\xadsages from a queue."),Object(l.a)("p",null,"This API is going to pro\xadvided in the 3.6.0 re\xadlease, while the old will be dep\xadre\xadcated."),Object(l.a)("p",null,"I hope you en\xadjoyed read\xading this ar\xadti\xadcle. See you soon on our ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"Git\xadter chan\xadnel"),"!"))}b.isMDXComponent=!0},S8sm:function(e,a,t){},Suba:function(e,a,t){var n={"./2018-04-09-eclipse-vert-x-metrics-now-with-micrometer-io.mdx":"pJo+","./2018-04-13-new-community-channels.mdx":"zj+8","./2018-04-23-eclipse-vert-x-rabbitmq-client-gets-a-new-consumer-api.mdx":"Pc3Q","./2018-06-04-eclipse-vert-x-goes-native.mdx":"WjdI","./2018-07-02-simplified-database-transaction-management-with-the-vert-x-rxjava-api.mdx":"wjlg","./2018-08-20-the-rss-reader-tutorial.mdx":"BuQJ","./2018-09-05-the-rss-reader-tutorial-step-2.mdx":"GOOg","./2018-12-06-the-rss-reader-tutorial-step-3.mdx":"lWra","./2018-12-10-http-response-validation-with-the-vert-x-web-client.mdx":"eHGC","./2018-12-13-vertx-web-api-service.mdx":"ZJXT","./2019-07-26-eclipse-vert-x-4-milestone-1-released.mdx":"i72n","./2019-08-23-eclipse-vert-x-3-8-1.mdx":"dRkU","./2019-08-26-eclipse-vert-x-4-milestone-2-released.mdx":"OrTX","./2019-08-30-eclipse-vert-x-for-scala-next-steps.mdx":"NL1R","./2019-09-19-eclipse-vert-x-4-milestone-3-released.mdx":"hkBy","./2019-10-07-eclipse-vert-x-3-8-2.mdx":"/pBu","./2019-10-18-eclipse-vert-x-3-8-3.mdx":"lybm","./2019-10-22-send-web-requests-and-assert-results-with-vertx-junit5-web-client.mdx":"4PoU","./2019-11-28-eclipse-vert-x-3-8-4.mdx":"AiqT","./2019-12-13-eclipse-vert-x-4-milestone-4-released.mdx":"4Sve","./2020-01-24-eclipse-vert-x-3-8-5.mdx":"xDq6","./2020-03-16-easy-sso-for-vert-x-with-keycloak.mdx":"HAnQ","./2020-04-02-eclipse-vert-x-3-9-0-released.mdx":"4nW3","./2020-05-22-eclipse-vert-x-3-9-1-released.mdx":"+/MD"};function s(e){var a=r(e);return t(a)}function r(e){if(!t.o(n,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=r,e.exports=s,s.id="Suba"},UMc4:function(e,a,t){"use strict";var n=t("q1tI"),s=t.n(n),r=t("TSYQ"),c=t.n(r),l=t("Cgje"),o=t("naWs"),i=(t("05nU"),s.a.createElement);a.a=function(e){var a=e.meta,t=void 0===a?{}:a,n=e.narrow,s=e.children;return i("main",{className:"page"},i(l.a,{title:t.title}),i("div",{className:"page-content"},i("div",{className:c()("container",{"container-narrow":n})},s)),i(o.a,null))}},WjdI:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x goes Native",category:"guides",authors:[{name:"Johannes Sch\xfcth",github_id:"jotschi"}],summary:"This blog post introduces native image generation of Vert.x applications with GraalVM. Generated executables can be run without a JVM."}),i=[{term:"nativ",tf:11},{term:"graalvm",tf:9},{term:"gener",tf:7},{term:"need",tf:7},{term:"substrat",tf:7},{term:"vm",tf:7},{term:"imag",tf:6},{term:"applic",tf:6},{term:"support",tf:6},{term:"netti",tf:6},{term:"us",tf:5},{term:"execut",tf:5},{term:"run",tf:5},{term:"will",tf:5},{term:"class",tf:5},{term:"no",tf:4},{term:"memori",tf:4},{term:"mb",tf:4},{term:"within",tf:4},{term:"patch",tf:4},{term:"ssl",tf:4},{term:"jvm",tf:3},{term:"requir",tf:3},{term:"contain",tf:3},{term:"build",tf:3}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x goes Native"),Object(l.a)("p",null,"I this blog post I would like to give you a pre\xadview on na\xadtive image gen\xader\xada\xadtion of Vert.x ap\xadpli\xadca\xadtions using GraalVM."),Object(l.a)("p",null,"With ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.graalvm.org/"}),"GraalVM")," it is pos\xadsi\xadble to gen\xader\xadate na\xadtive ex\xade\xadcuta\xadbles.\nThese ex\xade\xadcuta\xadbles can be di\xadrectly run with\xadout the need of an in\xadstalled JVM."),Object(l.a)("h2",null,"Benefits"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},"The start up time is way faster. It is no longer re\xadquired to wait for the start up of the JVM. The ap\xadpli\xadca\xadtion is usu\xadally up and run\xadning in a mat\xadter of mil\xadlisec\xadonds.")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},"Re\xadduced mem\xadory foot\xadprint. I mea\xadsured 40 MB mem\xadory usage (RSS) for the Vert.x Web ap\xadpli\xadca\xadtion which I\u2019m going to show\xadcase.")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},"Smaller Con\xadtain\xaders. No JVM means no over\xadhead. All the needed parts are al\xadready con\xadtained within the ex\xade\xadcutable. This can be very ben\xade\xadfi\xadcial when build\xading de\xadploy\xadable con\xadtainer im\xadages."))),Object(l.a)("h2",null,"Demo Project"),Object(l.a)("p",null,"For the demo ap\xadpli\xadca\xadtion I choose a very basic hello world ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web/java/"}),"Vert.x Web")," server."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," de.jotschi.examples;\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," java.io.File;\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.Vertx;\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.logging.Logger;\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.logging.LoggerFactory;\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.logging.SLF4JLogDelegateFactory;\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.web.Router;\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Runner")," "),"{\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"main"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String[] args)")," "),"{\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Use logback for logging"),"\n    File logbackFile = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," File(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"config"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"logback.xml"'),");\n    System.setProperty(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"logback.configurationFile"'),", logbackFile.getAbsolutePath());\n    System.setProperty(LoggerFactory.LOGGER_DELEGATE_FACTORY_CLASS_NAME, SLF4JLogDelegateFactory",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),".",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class"),".",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getName"),"())"),";\n    Logger log = LoggerFactory.getLogger(Runner",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),".",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class"),")"),";\n\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Setup the http server"),"\n    log.info(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Starting server for: http://localhost:8080/hello"'),");\n    Vertx vertx = Vertx.vertx();\n    Router router = Router.router(vertx);\n\n    router.route(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/hello"'),").handler(rc -> {\n      log.info(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Got hello request"'),");\n      rc.response().end(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"World"'),");\n    });\n\n    vertx.createHttpServer()\n      .requestHandler(router::accept)\n      .listen(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n\n  }\n\n}\n")),Object(l.a)("h2",null,"GraalVM"),Object(l.a)("p",null,Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.graalvm.org/"}),"GraalVM"),"runs a sta\xadtic analy\xadsis on the gen\xader\xadated ap\xadpli\xadca\xadtion in order to find the reach\xadable code.\nThis process which is run within the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/oracle/graal/tree/master/substratevm"}),"Sub\xadstrate VM")," will lead to the gen\xader\xada\xadtion of the na\xadtive image."),Object(l.a)("h3",null,"Limitations"),Object(l.a)("p",null,"Due to the na\xadture of the sta\xadtic analy\xadsis Sub\xadstrate VM also has some ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/oracle/graal/blob/master/substratevm/LIMITATIONS.md"}),"lim\xadi\xadta\xadtions"),"."),Object(l.a)("p",null,"Dy\xadnamic class load\xading and un\xadload\xading for ex\xadam\xadple is not sup\xadported be\xadcause this would in essence alter the avail\xadable code dur\xading run\xadtime. "),Object(l.a)("p",null,"Re\xadflec\xadtion is only par\xadtially sup\xadported and re\xadquires some man\xadual steps which we will cover later on."),Object(l.a)("h3",null,"Patches / Workarounds"),Object(l.a)("p",null,"[NOTE Work in progress | Next we need to apply some patches / workarounds. Keep in mind that na\xadtive image gen\xader\xada\xadtion is a fairly new topic and the these workarounds will hope\xadfully no longer be re\xadquired once the Sub\xadstrate VM and Netty have bet\xadter sup\xadport for each other.]"),Object(l.a)("p",null,"I did not man\xadage to get na\xadtive epoll, kqueue and SSL in\xadte\xadgra\xadtion to work with na\xadtive im\xadages.\nThese parts are heav\xadily op\xadti\xadmized within Netty and use JNI to di\xadrectly ac\xadcess the OS fea\xadtures.\nSub\xadstrate VM sup\xadports JNI and could in the\xadory in\xadte\xadgrate these na\xadtive li\xadbraries. "),Object(l.a)("p",null,"I cre\xadated a ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graalvm-native-image-test/tree/netty-native-epoll"}),"re\xadpro\xadducer"),"\nand an ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/oracle/graal/issues/442"}),"issue")," so hope\xadfully these prob\xadlems can be ad\xaddressed soon."),Object(l.a)("h3",null,"Vert.x Transport"),Object(l.a)("p",null,"First I needed to patch the ",Object(l.a)("inlineCode",{parentName:"p"},"io.vertx.core.net.impl.transport.Transport")," class in order to pre\xadvent the load\xading of EPoll and KQueue na\xadtive sup\xadport. Oth\xader\xadwise Sub\xadstrate VM will try to load these classes and fail."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Transport")," "),"{\n\u2026\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"/**\n   * The native transport, it may be {",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-doctag"}),"@code")," null} or failed.\n   */"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," Transport ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"nativeTransport"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Patched: I remove the native transport discovery. "),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// The imports would be picked up by substrate "),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// and cause further issues. "),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),";\n  }\n\u2026\n}\n")),Object(l.a)("h3",null,"Netty SSL"),Object(l.a)("p",null,"Na\xadtive SSL sup\xadport is an\xadother prob\xadlem\xadatic area. I cre\xadated a patched dummy ",Object(l.a)("inlineCode",{parentName:"p"},"io.netty.handler.ssl.ReferenceCountedOpenSslEngine")," class in order to pre\xadvent Sub\xadstrate VM from dig\xadging deeper into the SSL code of Netty."),Object(l.a)("p",null,"Next we need to set up the re\xadflec\xadtion con\xadfig\xadu\xadra\xadtion within ",Object(l.a)("inlineCode",{parentName:"p"},"reflectconfigs/netty.json"),"."),Object(l.a)("p",null,"Netty uses re\xadflec\xadtion to in\xadstan\xadti\xadate the socket chan\xadnels. This is done in the Re\xadflec\xadtiveChan\xadnelFac\xadtory. We need to tell Sub\xadstrate VM how classes of type NioServer\xadSock\xadetChan\xadnel  and NioSock\xadetChan\xadnel can be in\xadstan\xadti\xadated. "),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"[\n  {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"io.netty.channel.socket.nio.NioSocketChannel"'),",\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"methods"')," : [\n      { ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<init>"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"parameterTypes"')," : [] }\n    ]\n  },\n  {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"io.netty.channel.socket.nio.NioServerSocketChannel"'),",\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"methods"')," : [\n      { ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<init>"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"parameterTypes"')," : [] }\n    ]\n  }\n]\n")),Object(l.a)("p",null,"If you want to learn more about the state of Netty and GraalVM I can rec\xadom\xadmend this ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://medium.com/graalvm/instant-netty-startup-using-graalvm-native-image-generation-ed6f14ff7692"}),"GraalVM Blog\xadpost")," by Co\xaddrut Stancu."),Object(l.a)("h2",null,"Building"),Object(l.a)("p",null,"Fi\xadnally we can build our maven project to gen\xader\xadate a shaded jar."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean package\n")),Object(l.a)("p",null,"Next we need the GraalVM pack\xadage. You can down\xadload it from the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.graalvm.org/"}),"GraalVM web\xadsite"),"."),Object(l.a)("p",null,"We use the shaded jar as the input source for the ",Object(l.a)("inlineCode",{parentName:"p"},"native-image")," com\xadmand which will gen\xader\xadate the ex\xade\xadcutable."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-variable"}),"$GRAALVMDIR"),"/bin/native-image \\\n --verbose \\\n --no-server \\\n -Dio.netty.noUnsafe=",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"  \\\n -H:ReflectionConfigurationFiles=./reflectconfigs/netty.json \\\n -H:+ReportUnsupportedElementsAtRuntime \\\n -Dfile.encoding=UTF-8 \\\n -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar\n")),Object(l.a)("h2",null,"Result"),Object(l.a)("p",null,"Fi\xadnally we end up with an 27 MB ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-graalvm-native-image-test-0.0.1-SNAPSHOT")," ex\xade\xadcutable which we can run."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"$ ldd vertx-graalvm-native-image-test-0.0.1-SNAPSHOT \n  linux-vdso.so.1 (0x00007ffc65be8000)\n  libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f8e892f0000)\n  libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f8e890d3000)\n  libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007f8e88eb9000)\n  librt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007f8e88cb1000)\n  libcrypt.so.1 => /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007f8e88a79000)\n  libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f8e886da000)\n  /lib64/ld-linux-x86-64.so.2 (0x00007f8e8afb7000)\n")),Object(l.a)("h3",null,"Memory"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"/usr/bin/time -f ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"\\nmaxRSS\\t%MkB"')," java -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar \n/usr/bin/time -f ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"\\nmaxRSS\\t%MkB"')," ./vertx-graalvm-native-image-test-0.0.1-SNAPSHOT \n")),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Na\xadtive Image: 40 MB"),Object(l.a)("li",{parentName:"ul"},"Java 10: 125 MB")),Object(l.a)("p",null,"The full project can be found on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graalvm-native-image-test"}),"GitHub"),"."),Object(l.a)("p",null,"If you want to read more on the topic I can also rec\xadom\xadmend ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://sites.google.com/a/athaydes.com/renato-athaydes/posts/a7mbnative-imagejavaappthatrunsin30msandusesonly4mbofram"}),"this ar\xadti\xadcle")," by Re\xadnato Athay\xaddes in which he demon\xadstrates how to cre\xadate a very small light weight low mem\xadory ap\xadpli\xadca\xadtion using GraalVM."),Object(l.a)("p",null,"Thanks for read\xading. If you have any fur\xadther ques\xadtions or feed\xadback don\u2019t hes\xadi\xadtate to send me a tweet to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://twitter.com/Jotschi/"}),"@Jotschi"),"."))}b.isMDXComponent=!0},Z0cm:function(e,a){var t=Array.isArray;e.exports=t},ZJXT:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Vert.x Web API Service Introduction",category:"guides",authors:[{name:"Francesco Guardiani",github_id:"slinkydeveloper"}],summary:"This blog post teaches you how to use the new module vertx-web-api-service to combine the Web Router and the OpenAPI Router Factory with service proxies."}),i=[{term:"servic",tf:30},{term:"oper",tf:14},{term:"router",tf:10},{term:"handler",tf:10},{term:"web",tf:9},{term:"event",tf:8},{term:"bu",tf:8},{term:"api",tf:7},{term:"gener",tf:7},{term:"paramet",tf:7},{term:"interfac",tf:6},{term:"exampl",tf:6},{term:"request",tf:5},{term:"us",tf:5},{term:"will",tf:5},{term:"annot",tf:5},{term:"new",tf:4},{term:"factori",tf:4},{term:"let",tf:4},{term:"need",tf:4},{term:"implement",tf:4},{term:"mount",tf:4},{term:"method",tf:4},{term:"call",tf:3},{term:"openapi",tf:3}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Vert.x Web API Service Introduction"),Object(l.a)("p",null,"Vert.x 3.6 in\xadtro\xadduces a new mod\xadule called ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-web-api-service"),". With the new Web API Ser\xadvices you can eas\xadily com\xadbine the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web/java/"}),"Vert.x Web Router")," and the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web-api-contract/java/"}),"Vert.x Ope\xadnAPI Router Fac\xadtory")," fea\xadtures with ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-service-proxy/java/"}),"Vert.x Ser\xadvices on Event Bus"),"."),Object(l.a)("h2",null,"Small recap on OpenAPI and Vert.x Web API Contract"),Object(l.a)("p",null,"Let\u2019s start from this Ope\xadnAPI de\xadf\xadi\xadn\xadi\xadtion:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-yaml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"openapi:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"3.0"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),".0"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"paths:"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"/api/transactions:"),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"get:"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"operationId:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"getTransactionsList"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"description:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"Get")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"list")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"filtered")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"by")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"sender"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"x-vertx-event-bus:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions_manager.myapp"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"parameters:"),"\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"name:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"from"),"\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"in:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"query"),"\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"description:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"Matches")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"exactly")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"the")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"email")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"from"),"\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"style:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"form"),"\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"explode:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),"\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:"),"\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"type:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"array"),"\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"items:"),"\n              ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"type:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"string"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"post:"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"operationId:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"addTransaction"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"x-vertx-event-bus:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions_manager.myapp"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"requestBody:"),"\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"required:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"content:"),"\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"application/json:"),"\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:"),"\n              ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"$ref:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"#/components/schemas/Transaction"'),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"/api/transactions/{transactionId}:"),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"parameters:"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"name:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactionId"),"\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"in:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"path"),"\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"required:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:"),"\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"type:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"string"),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"put:"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"operationId:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"updateTransaction"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"x-vertx-event-bus:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions_manager.myapp"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"requestBody:"),"\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"required:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"content:"),"\n          ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"application/json:"),"\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:"),"\n              ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"$ref:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"#/components/schemas/Transaction"'),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"delete:"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"operationId:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"removeTransaction"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"x-vertx-event-bus:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions_manager.myapp"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"components:"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schemas:"),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"Transaction:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"Error:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n")),Object(l.a)("p",null,"We de\xadfined ",Object(l.a)("inlineCode",{parentName:"p"},"getTransactionsList"),", ",Object(l.a)("inlineCode",{parentName:"p"},"addTransaction"),", ",Object(l.a)("inlineCode",{parentName:"p"},"updateTransaction")," and ",Object(l.a)("inlineCode",{parentName:"p"},"removeTransaction")," op\xader\xada\xadtions. Now with ",Object(l.a)("inlineCode",{parentName:"p"},"OpenAPI3RouterFactory")," we cre\xadate a ",Object(l.a)("inlineCode",{parentName:"p"},"Router")," that ac\xadcepts this var\xadi\xadous op\xader\xada\xadtion re\xadquests:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"OpenAPI3RouterFactory.create(vertx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"src/main/resources/petstore.yaml"'),", ar -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.succeeded()) {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Spec loaded with success"),"\n    OpenAPI3RouterFactory routerFactory = ar.result();\n    routerFactory.addHandlerByOperationId(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"getTransactionsList"'),", routingContext -> {\n      RequestParameters params = routingContext.get(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"parsedParameters"'),");\n      RequestParameter from = params.queryParameter(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"from"'),");\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// getTransactionsList business logic"),"\n    });\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// add handlers for addTransaction, updateTransaction and removeTransaction"),"\n    Router router = routerFactory.getRouter();\n  } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Something went wrong during router factory initialization"),"\n    Throwable exception = ar.cause();\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Log exception, fail verticle deployment ... etc"),"\n  }\n});\n")),Object(l.a)("p",null,"The ",Object(l.a)("inlineCode",{parentName:"p"},"OpenAPI3RouterFactory")," pro\xadvides an easy way to cre\xadate a spec\xadi\xadfi\xadca\xadtion com\xadpli\xadant ",Object(l.a)("inlineCode",{parentName:"p"},"Router"),", but it doesn\u2019t pro\xadvide a mech\xada\xadnism to de\xadcou\xadple the busi\xadness logic from your op\xader\xada\xadtion han\xaddlers."),Object(l.a)("p",null,"In a typ\xadi\xadcal Vert.x ap\xadpli\xadca\xadtion, when you re\xadceive a re\xadquest to your router, you would for\xadward it to an event bus end\xadpoint that per\xadforms some ac\xadtions and sends the re\xadsult back to the op\xader\xada\xadtion han\xaddler."),Object(l.a)("p",null,"Vert.x Web API Ser\xadvice sim\xadpli\xadfies that in\xadte\xadgra\xadtion be\xadtween ",Object(l.a)("inlineCode",{parentName:"p"},"RouterFactory")," and ",Object(l.a)("inlineCode",{parentName:"p"},"EventBus")," with a new code gen\xader\xada\xadtor. The final re\xadsult is a ",Object(l.a)("em",{parentName:"p"},"loose cou\xadpling")," be\xadtween the Web Router logic and your busi\xadness logic."),Object(l.a)("h2",null,"Let\u2019s get started with Vert.x Web Api Services!"),Object(l.a)("p",null,"To use ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-web-api-service")," you need to add a cou\xadple of de\xadpen\xadden\xadcies to your project. In a Maven POM file that would be:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-codegen",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.6.0",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"classifier"),">"),"processor",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"classifier"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-web-api-service",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.6.0",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(l.a)("p",null,"We will pro\xadceed in this order:"),Object(l.a)("ol",null,Object(l.a)("li",{parentName:"ol"},"Model the ser\xadvice in\xadter\xadface"),Object(l.a)("li",{parentName:"ol"},"Rewrite it to work with Web Api Ser\xadvices"),Object(l.a)("li",{parentName:"ol"},"Im\xadple\xadment the ser\xadvice"),Object(l.a)("li",{parentName:"ol"},"Mount the ser\xadvice on the event bus"),Object(l.a)("li",{parentName:"ol"},"Use the router fac\xadtory to build a router with han\xaddlers that con\xadnects to our event bus ser\xadvices")),Object(l.a)("h2",null,"Model your service"),Object(l.a)("p",null,"Let\u2019s say that we want to model a ser\xadvice that man\xadages all op\xader\xada\xadtions re\xadgard\xading CRUD trans\xadac\xadtions. An ex\xadam\xadple in\xadter\xadface for this asyn\xadchro\xadnous ser\xadvice could be:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerService")," "),"{\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getTransactionsList"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(List<String> from, Handler<AsyncResult<List<Transaction>>> resultHandler)")),";\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"addTransaction"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Transaction transaction, Handler<AsyncResult<Transaction>> resultHandler)")),";\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"updateTransaction"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String transactionId, Transaction transaction, Handler<AsyncResult<Transaction>> resultHandler)")),";\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"removeTransaction"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String transactionId, Handler<AsyncResult<Integer>> resultHandler)")),";\n}\n")),Object(l.a)("p",null,"For each op\xader\xada\xadtion, we have some pa\xadra\xadme\xadters, de\xadpend\xading on the op\xader\xada\xadtion, and a call\xadback (",Object(l.a)("inlineCode",{parentName:"p"},"resultHandler"),") that should be called when the op\xader\xada\xadtion suc\xadceeds or fails."),Object(l.a)("p",null,"With ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-service-proxy/java/"}),"Vert.x Ser\xadvice Proxy"),", you can de\xadfine an event bus ser\xadvice with a Java in\xadter\xadface sim\xadi\xadlar to the one we just saw and then an\xadno\xadtate it with ",Object(l.a)("inlineCode",{parentName:"p"},"@ProxyGen"),". This an\xadno\xadta\xadtion will gen\xader\xadate a ",Object(l.a)("em",{parentName:"p"},"ser\xadvice han\xaddler")," for the de\xadfined ser\xadvice that can be plugged to the event bus with ",Object(l.a)("inlineCode",{parentName:"p"},"ServiceBinder"),". ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-web-api-service")," works in a very sim\xadi\xadlar way: you need to an\xadno\xadtate the Java in\xadter\xadface with ",Object(l.a)("inlineCode",{parentName:"p"},"@WebApiServiceGen")," and it will gen\xader\xadate the ser\xadvice han\xaddler for the event bus."),Object(l.a)("p",null,"Let\u2019s rewrite the ",Object(l.a)("inlineCode",{parentName:"p"},"TransactionsManagerService")," to work with Web API Ser\xadvice:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.web.api.*;\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.web.api.generator.WebApiServiceGen;\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@WebApiServiceGen"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerService")," "),"{\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getTransactionsList"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(List<String> from, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),";\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"addTransaction"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Transaction body, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),";\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"updateTransaction"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String transactionId, Transaction body, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),";\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"removeTransaction"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String transactionId, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),";\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Factory method to instantiate the implementation"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," TransactionsManagerService ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"create"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Vertx vertx)")," "),"{\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," TransactionsManagerServiceImpl(vertx);\n  }\n}\n\n")),Object(l.a)("p",null,"First of all, look at the an\xadno\xadta\xadtion ",Object(l.a)("inlineCode",{parentName:"p"},"@WebApiServiceGen"),". This an\xadno\xadta\xadtion will trig\xadger the code gen\xader\xada\xadtor that gen\xader\xadates the event bus han\xaddler for this ser\xadvice. Each method has the same two last pa\xadra\xadme\xadters:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"OperationRequest context"),": this data ob\xadject con\xadtains the head\xaders and the pa\xadra\xadme\xadters of the HTTP re\xadquest"),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"Handler<AsyncResult<OperationResponse>> resultHandler"),": this call\xadback ac\xadcepts an ",Object(l.a)("inlineCode",{parentName:"li"},"OperationResponse")," data ob\xadject that will en\xadcap\xadsu\xadlate the body of the re\xadsult, the sta\xadtus code, the sta\xadtus mes\xadsage and the head\xaders")),Object(l.a)("p",null,"The gen\xader\xadated han\xaddler re\xadceives only the ",Object(l.a)("inlineCode",{parentName:"p"},"OperationRequest")," data ob\xadject and ex\xadtracts from it all op\xader\xada\xadtion pa\xadra\xadme\xadters. For ex\xadam\xadple, when the router re\xadceives a re\xadquest at ",Object(l.a)("inlineCode",{parentName:"p"},"getTransactionsList"),", it sends to ",Object(l.a)("inlineCode",{parentName:"p"},"TransactionsManagerService")," the ",Object(l.a)("inlineCode",{parentName:"p"},"OperationRequest")," con\xadtain\xading the ",Object(l.a)("inlineCode",{parentName:"p"},"RequestParameters")," map. From this map, the ser\xadvice gen\xader\xadated han\xaddler ex\xadtracts the ",Object(l.a)("inlineCode",{parentName:"p"},"from")," pa\xadra\xadme\xadter. "),Object(l.a)("p",null,"There\xadfore ",Object(l.a)("strong",{parentName:"p"},"op\xader\xada\xadtion pa\xadra\xadme\xadters names should match method pa\xadra\xadme\xadter names"),"."),Object(l.a)("p",null,"When you want to ex\xadtract the body you must use ",Object(l.a)("inlineCode",{parentName:"p"},"body")," key\xadword. For more de\xadtails, please refer to the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web-api-service/java/"}),"doc\xadu\xadmen\xadta\xadtion"),"."),Object(l.a)("h2",null,"Implement the service"),Object(l.a)("p",null,"Now that you have your in\xadter\xadface, you can im\xadple\xadment the ser\xadvice:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerServiceImpl")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"implements")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerService")," "),"{\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," Vertx vertx;\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerServiceImpl"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Vertx vertx)")," "),"{  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".vertx = vertx;  }\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getTransactionsList"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(List<String> from, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),"{\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Write your business logic here"),"\n    resultHandler.handle(Future.succeededFuture(OperationResult.completedWithJson(resultJson)));\n  }\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Implement other operations"),"\n\n}\n")),Object(l.a)("p",null,"Check the ",Object(l.a)("inlineCode",{parentName:"p"},"OperationResult")," doc\xadu\xadmen\xadta\xadtion to look at var\xadi\xadous handy meth\xadods to cre\xadate a com\xadplete re\xadsponse."),Object(l.a)("h2",null,"Mount the Service"),Object(l.a)("p",null,"Now that you have your ser\xadvice in\xadter\xadface and im\xadple\xadmen\xadta\xadtion, you can mount your ser\xadvice with ",Object(l.a)("inlineCode",{parentName:"p"},"ServiceBinder"),":"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"ServiceBinder serviceBinder = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ServiceBinder(vertx);\n\nTransactionsManagerService transactionsManagerService = TransactionsManagerService.create(vertx);\nregisteredConsumers.add(\n  serviceBinder\n    .setAddress(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"transactions_manager.myapp"'),")\n    .register(TransactionsManagerService",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),".",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class"),", ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"transactionsManagerService"),")\n)"),";\n")),Object(l.a)("h2",null,"And the Router Factory?"),Object(l.a)("p",null,"The ser\xadvice is up and run\xadning, but we need to con\xadnect it to the ",Object(l.a)("inlineCode",{parentName:"p"},"Router")," built by ",Object(l.a)("inlineCode",{parentName:"p"},"OpenAPI3RouterFactory"),":"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"OpenAPI3RouterFactory.create(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".vertx, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my_spec.yaml"'),", openAPI3RouterFactoryAsyncResult -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (openAPI3RouterFactoryAsyncResult.succeeded()) {\n    OpenAPI3RouterFactory routerFactory = openAPI3RouterFactoryAsyncResult.result();\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Mount services on event bus based on extensions"),"\n    routerFactory.mountServicesFromExtensions(); ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// <- Pure magic happens!"),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Generate the router"),"\n    Router router = routerFactory.getRouter();\n    server = vertx.createHttpServer(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," HttpServerOptions().setPort(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),"));\n    server.requestHandler(router).listen();\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Initialization completed"),"\n  } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Something went wrong during router factory initialization"),"\n  }\n});\n")),Object(l.a)("p",null,"In our spec ex\xadam\xadple we added an ex\xadten\xadsion ",Object(l.a)("inlineCode",{parentName:"p"},"x-vertx-event-bus")," to each op\xader\xada\xadtion that spec\xadi\xadfies the ad\xaddress of the ser\xadvice. Using this ex\xadten\xadsion, you only need to call ",Object(l.a)("inlineCode",{parentName:"p"},"OpenAPI3RouterFactory.mountServicesFromExtensions()")," to trig\xadger a scan of all op\xader\xada\xadtions and mount all found ser\xadvice ad\xaddresses. For each op\xader\xada\xadtion that con\xadtains ",Object(l.a)("inlineCode",{parentName:"p"},"x-vertx-event-bus"),", the Router Fac\xadtory in\xadstan\xadti\xadates an han\xaddler that routes the in\xadcom\xading re\xadquests to the ad\xaddress you spec\xadi\xadfied."),Object(l.a)("p",null,"This is one of the meth\xadods you can use to match ser\xadvices with router op\xader\xada\xadtion han\xaddlers. Check the doc\xadu\xadmen\xadta\xadtion for all de\xadtails."),Object(l.a)("h2",null,"More examples"),Object(l.a)("p",null,"Check out the com\xadplete ex\xadam\xadple in ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/tree/master/web-api-service-example"}),"vertx-\u200bexamples repo"),"."),Object(l.a)("p",null,"Thanks you for your time, stay tuned for more up\xaddates! And please pro\xadvide feed\xadback about this new pack\xadage!"))}b.isMDXComponent=!0},ZKd4:function(e,a,t){},Zimk:function(e,a,t){"use strict";a.__esModule=!0,a.default=void 0;var n=r(t("q1tI")),s=r(t("17x9"));function r(e){return e&&e.__esModule?e:{default:e}}function c(){return(c=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var l=function(e){var a=e.color,t=e.size,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,["color","size"]);return n.default.createElement("svg",c({xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:a,viewBox:"0 0 24 24"},s),n.default.createElement("path",{d:"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"}))};l.propTypes={color:s.default.string,size:s.default.oneOfType([s.default.string,s.default.number])},l.defaultProps={color:"currentColor",size:"24"};var o=l;a.default=o},bahg:function(e,a){e.exports=function(e){return e.split("")}},beur:function(e,a,t){},cxZ6:function(e,a,t){"use strict";a.__esModule=!0,a.default=void 0;var n=r(t("q1tI")),s=r(t("17x9"));function r(e){return e&&e.__esModule?e:{default:e}}function c(){return(c=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var l=function(e){var a=e.color,t=e.size,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,["color","size"]);return n.default.createElement("svg",c({xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:a,viewBox:"0 0 24 24"},s),n.default.createElement("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"}))};l.propTypes={color:s.default.string,size:s.default.oneOfType([s.default.string,s.default.number])},l.defaultProps={color:"currentColor",size:"24"};var o=l;a.default=o},dRkU:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 3.8.1",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This new version is a bug fix release that addresses issues reported in Eclipse Vert.x 3.8.1. We also updated Netty to version 4.1.39.Final to fix some CVEs."}),i=[{term:"http",tf:7},{term:"releas",tf:5},{term:"cve",tf:5},{term:"2019",tf:4},{term:"flood",tf:4},{term:"com",tf:4},{term:"wiki",tf:4},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"fix",tf:2},{term:"report",tf:2},{term:"deprec",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"note",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 3.8.1"),Object(l.a)("p",null,"We have just re\xadleased Vert.x 3.8.1, a bug fix re\xadlease of Vert.x 3.8.x."),Object(l.a)("p",null,"This ver\xadsion up\xaddates to Netty 4.1.39.Final fix\xading the fol\xadlow\xading HTTP/2 re\xadlated CVEs:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"CVE-2019-9512: Ping Flood"),Object(l.a)("li",{parentName:"ul"},"CVE-2019-9514: Reset Flood"),Object(l.a)("li",{parentName:"ul"},"CVE-2019-9515: Set\xadtings Flood"),Object(l.a)("li",{parentName:"ul"},"CVE-2019-9518: Empty DATA frame flood\xading")),Object(l.a)("p",null,"Since the re\xadlease of Vert.x 3.8.0, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},"Vert.x 3.8.1 dep\xadre\xadca\xadtions and break\xading changes")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.1-Deprecations-and-breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.1-\u200bDeprecations-and-breaking-changes")))),Object(l.a)("p",null,"Vert.x 3.8.1 re\xadlease notes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.1-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.1-\u200bRelease-Notes"))),Object(l.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.1%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.1/view"}),"Bin\xadtray"),"."),Object(l.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.1 project using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(l.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(l.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(l.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},dt0z:function(e,a,t){var n=t("zoYe");e.exports=function(e){return null==e?"":n(e)}},eHGC:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"HTTP response validation with the Vert.x Web Client",category:"guides",authors:[{name:"Thomas Segismont",github_id:"tsegismont"}],summary:"Learn how to use response predicates from the Vert.x Web module to validate HTTP responses and to automatically generate error messages."}),i=[{term:"respons",tf:17},{term:"predic",tf:10},{term:"error",tf:7},{term:"web",tf:5},{term:"not",tf:4},{term:"us",tf:4},{term:"statu",tf:4},{term:"code",tf:4},{term:"bodi",tf:4},{term:"convert",tf:4},{term:"client",tf:3},{term:"content",tf:3},{term:"type",tf:3},{term:"check",tf:3},{term:"receiv",tf:3},{term:"gener",tf:3},{term:"except",tf:3},{term:"http",tf:2},{term:"valid",tf:2},{term:"default",tf:2},{term:"request",tf:2},{term:"wrong",tf:2},{term:"failur",tf:2},{term:"perform",tf:2},{term:"come",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"HTTP response validation with the Vert.x Web Client"),Object(l.a)("p",null,"By de\xadfault, a ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"/docs/vertx-web-client/java/"}),"Vert.x Web Client")," re\xadquest ends with an error only if some\xadthing wrong hap\xadpens at the net\xadwork level.\nIn other words, a ",Object(l.a)("inlineCode",{parentName:"p"},"404 Not Found")," re\xadsponse, or a re\xadsponse with the wrong con\xadtent type, are ",Object(l.a)("strong",{parentName:"p"},"not")," con\xadsid\xadered as fail\xadures."),Object(l.a)("p",null,"Hence, you would usu\xadally per\xadform san\xadity checks man\xadu\xadally after the re\xadsponse is re\xadceived:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-reasonml"}),"client\n  .get(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  .send(ar -> {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.succeeded",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"()"),") {\n      HttpResponse<Buffer> response = ar.result",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"()"),";\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (response.status",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Code()"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-operator"})," == "),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-operator"})," && "),"response.get",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Header(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"content-type"'),")"),".equals(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")) {\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Decode the body as a json object"),"\n        JsonObject body = response.body",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"AsJsonObject()"),";\n      } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-module-access"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-module"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-identifier"}),"System"),".")),"out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Something went wrong "')," + response.status",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Code()"),");\n      }\n    } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-module-access"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-module"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-identifier"}),"System"),".")),"out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Something went wrong "')," + ar.cause",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"()"),".get",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Message()"),");\n    }\n  });\n")),Object(l.a)("p",null,"Start\xading with ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"/blog/eclipse-vert-x-3-6-0-released/"}),"Vert.x 3.6"),", you can can trade flex\xadi\xadbil\xadity for clar\xadity and con\xadcise\xadness using ",Object(l.a)("em",{parentName:"p"},"re\xadsponse pred\xadi\xadcates"),"."),Object(l.a)("h2",null,"Response predicates"),Object(l.a)("p",null,Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"/docs/apidocs/io/vertx/ext/web/client/predicate/ResponsePredicate.html"}),"Re\xadsponse pred\xadi\xadcates")," can fail a re\xadquest when the re\xadsponse does not match cri\xadte\xadrion."),Object(l.a)("p",null,"The Web Client mod\xadule comes with a set of ready-\u200bto-use pred\xadi\xadcates:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-kotlin"}),"client\n  .",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"get"),"(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  .",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"expect"),"(ResponsePredicate.SC_SUCCESS)\n  .",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"expect"),"(ResponsePredicate.JSON)\n  .send(ar -> {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.succeeded()) {\n      HttpResponse<Buffer> response = ar.result();\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Safely decode the body as a json object"),"\n      JsonObject body = response.bodyAsJsonObject();\n    } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n      System.",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"out"),".println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Something went wrong "')," + ar.cause().getMessage());\n    }\n  });\n\n")),Object(l.a)("p",null,"The web is full of HTTP/JSON end\xadpoints, so there is no doubt the ",Object(l.a)("inlineCode",{parentName:"p"},"ResponsePredicate.SC_SUCCESS")," and ",Object(l.a)("inlineCode",{parentName:"p"},"ResponsePredicate.JSON")," can be handy."),Object(l.a)("p",null,"Nev\xader\xadthe\xadless, you might also need to check that the sta\xadtus code is whithin a spe\xadcific range:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-less"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"client"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".get"),"(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".expect"),"(ResponsePredicate.status(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"202"),"))\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".send"),"(ar -> {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// ...."),"\n  });\n")),Object(l.a)("p",null,"Or that the con\xadtent is of a spe\xadcific type: "),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-less"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"client"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".get"),"(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".expect"),"(ResponsePredicate.contentType(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"some/content-type"'),"))\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".send"),"(ar -> {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// ...."),"\n  });\n")),Object(l.a)("p",null,"Please refer to the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"/docs/apidocs/io/vertx/ext/web/client/predicate/ResponsePredicate.html"}),Object(l.a)("inlineCode",{parentName:"a"},"ResponsePredicate")," doc\xadu\xadmen\xadta\xadtion")," for a full list of pre\xadde\xadfined pred\xadi\xadcates."),Object(l.a)("h3",null,"Custom predicates"),Object(l.a)("p",null,"Even\xadtu\xadally, pred\xadi\xadcates were not de\xadsigned for sta\xadtus code and con\xadtent type check\xading only, so feel free to cre\xadate your own val\xadi\xadda\xadtion code:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-reasonml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Check CORS header allowing to do POST"),"\nFunction<HttpResponse<Void>, ResponsePredicateResult> methodsPredicate = resp -> {\n  String methods = resp.get",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Header(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"Access-Control-Allow-Methods"'),")"),";\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (methods != null) {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (methods.contains(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"POST"'),")) {\n      return ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-module-access"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-module"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-identifier"}),"ResponsePredicateResult"),".")),"success",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"()"),";\n    }\n  }\n  return ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-module-access"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-module"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-identifier"}),"ResponsePredicateResult"),".")),"failure(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Does not work"'),");\n};\n\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send pre-flight CORS request"),"\nclient\n  .request(HttpMethod.OPTIONS, ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  .put",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Header(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"Origin"'),", ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"Server-b.com"'),")"),"\n  .put",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Header(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"Access-Control-Request-Method"'),", ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"POST"'),")"),"\n  .expect(methodsPredicate)\n  .send(ar -> {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.succeeded",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"()"),") {\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Process the POST request now"),"\n    } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-module-access"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-module"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-identifier"}),"System"),".")),"out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Something went wrong "')," + ar.cause",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"()"),".get",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Message()"),");\n    }\n  });\n")),Object(l.a)("p",null,"Note that re\xadsponse pred\xadi\xadcates are eval\xadu\xadated ",Object(l.a)("em",{parentName:"p"},"be\xadfore")," the re\xadsponse body is re\xadceived.\nThere\xadfore ",Object(l.a)("strong",{parentName:"p"},"you can\u2019t in\xadspect the re\xadsponse body")," in a pred\xadi\xadcate test func\xadtion, only sta\xadtus code, sta\xadtus mes\xadsage and re\xadsponse head\xaders."),Object(l.a)("h2",null,"Dealing with failures"),Object(l.a)("p",null,"By de\xadfault, re\xadsponse pred\xadi\xadcates (in\xadclud\xading the pre\xadde\xadfined ones) use a generic error con\xadverter which dis\xadcards the re\xadsponse body and con\xadveys a sim\xadple mes\xadsage.\nYou can cus\xadtomize the ex\xadcep\xadtion class by chang\xading the error con\xadverter:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-reasonml"}),"ResponsePredicate predicate = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-module-access"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-module"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-identifier"}),"ResponsePredicate"),".")),"create(ResponsePredicate.SC_SUCCESS, result -> {\n  return ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"MyCustomException(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"result"),".",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"message"),"()"),");\n});\n")),Object(l.a)("p",null,"Be\xadware that cre\xadat\xading ex\xadcep\xadtions in Java comes with the ",Object(l.a)("strong",{parentName:"p"},"per\xadfor\xadmance cost")," of cap\xadtur\xading the call stack.\nThe generic error con\xadverter gen\xader\xadates ex\xadcep\xadtions that do not cap\xadture it."),Object(l.a)("h3",null,"Reading details in error responses"),Object(l.a)("p",null,"Many web APIs pro\xadvide de\xadtails in error re\xadsponses.\nFor ex\xadam\xadple, the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://developer.marvel.com/docs"}),"Mar\xadvel API")," uses this JSON ob\xadject for\xadmat:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"code"'),": ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"InvalidCredentials"'),",\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"message"'),": ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"The passed API key is invalid."'),"\n}\n")),Object(l.a)("p",null,"To avoid los\xading this in\xadfor\xadma\xadtion, it is pos\xadsi\xadble to wait for the re\xadsponse body to be fully re\xadceived be\xadfore the error con\xadverter is called:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-ada"}),"ErrorConverter converter = ErrorConverter.createFullBody(result -> {\n\n  // Invoked after the response ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"body")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"is")," fully received\n  HttpResponse<Buffer> response = result.response();\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (response.getHeader(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),").equals(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")) {\n    // Error ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"body")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"is")," JSON data\n    JsonObject ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"body")," = response.bodyAsJsonObject();\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MyCustomException(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"body"),".getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"code"'),"), ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"body"),".getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"message"'),"));\n  }\n\n  // Fallback to defaut message\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MyCustomException(result.message());\n});\n\nResponsePredicate predicate = ResponsePredicate.create(ResponsePredicate.SC_SUCCESS, converter);\n")),Object(l.a)("p",null,"That\u2019s it! Feel free to com\xadment here or ask ques\xadtions on our ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"/community"}),"com\xadmu\xadnity chan\xadnels"),"."))}b.isMDXComponent=!0},eUgh:function(e,a){e.exports=function(e,a){for(var t=-1,n=null==e?0:e.length,s=Array(n);++t<n;)s[t]=a(e[t],t,e);return s}},gQMU:function(e,a,t){var n=t("0ZTe")("toUpperCase");e.exports=n},hkBy:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 4 milestone 3 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"The next milestone release of Vert.x 4 aims to provide a reliable distribution of the current development for people who want to try it and provide feedback."}),i=[{term:"json",tf:10},{term:"client",tf:9},{term:"object",tf:7},{term:"releas",tf:6},{term:"servic",tf:6},{term:"mileston",tf:5},{term:"will",tf:5},{term:"data",tf:5},{term:"type",tf:5},{term:"respons",tf:5},{term:"us",tf:5},{term:"provid",tf:4},{term:"proxi",tf:4},{term:"third",tf:3},{term:"featur",tf:3},{term:"develop",tf:3},{term:"map",tf:3},{term:"request",tf:3},{term:"gener",tf:3},{term:"code",tf:3},{term:"seri",tf:2},{term:"aim",tf:2},{term:"distribut",tf:2},{term:"current",tf:2},{term:"extend",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 4 milestone 3 released!"),Object(l.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce the third 4.0 mile\xadstone re\xadlease of Eclipse Vert.x ."),Object(l.a)("p",null,"Vert.x 4 is the evo\xadlu\xadtion of the Vert.x 3.x se\xadries that will bring key fea\xadtures to Vert.x."),Object(l.a)("p",null,"This re\xadlease aims to pro\xadvide a re\xadli\xadable dis\xadtri\xadb\xadu\xadtion of the cur\xadrent de\xadvel\xadop\xadment of Vert.x 4 for peo\xadple who\nwant to try it and pro\xadvide feed\xadback."),Object(l.a)("h4",null,"Futurisation"),Object(l.a)("p",null,"Vert.x 4 ex\xadtends the 3.x call\xadback asyn\xadchro\xadnous model to a fu\xadture/call\xadback hy\xadbrid model."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"NetClient")," "),"{\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Since 3.0"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host, Handler<AsyncResult<NetSocket>> handler)")),";\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// New in 4.0"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Future<NetSocket> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host)")),";\n}\n")),Object(l.a)("p",null,"This third mile\xadstone makes progress and coverts the fol\xadlow\xading stack mod\xadules:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"vertx-\u200bservice-discovery"),Object(l.a)("li",{parentName:"ul"},"vertx-\u200bconfig"),Object(l.a)("li",{parentName:"ul"},"vertx-\u200bcircuit-breaker")),Object(l.a)("h4",null,"Data object mapping for service proxies"),Object(l.a)("p",null,"Vert.x 3 ser\xadvice prox\xadies is a light\xadweight layer on top of Vert.x Event-\u200bBus pro\xadvid\xading typed con\xadtracts."),Object(l.a)("p",null,"One can eas\xadily cre\xadate a ser\xadvice on top of the Event-\u200bBus."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@VertxGen"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"DateService")," "),"{\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// callback the handler with the current date"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"date"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Handler<AsyncResult<String>> handler)"),"\n}\n"))),Object(l.a)("p",null,"Ser\xadvice prox\xadies re\xadquest/re\xadsponse pay\xadload are of type JSON."),Object(l.a)("p",null,"Of course ser\xadvice prox\xadies allow to map beans to JSON using data ob\xadjects but this comes with two caveats"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"only JSON ob\xadject can be mapped"),Object(l.a)("li",{parentName:"ul"},"the data ob\xadject must be a ",Object(l.a)("inlineCode",{parentName:"li"},"@DataObject")," an\xadno\xadtated bean with a ",Object(l.a)("inlineCode",{parentName:"li"},"toJson()")," method and a JSON ob\xadject con\xadstruc\xadtor")),Object(l.a)("p",null,"In Vert.x 4 we ex\xadtend the data ob\xadject sup\xadport to any Java class and any JSON type, e.g in this ex\xadam\xadple"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@VertxGen"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"DateService")," "),"{\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// encode the date with iso date format"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Mapper")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," String ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"toJson"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(ZonedDateTime value)")," "),"{\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ZonedDateTime.format(value);\n  }\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// decode the date with iso date format"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Mapper")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ZonedDateTime ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"fromJson"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String value)")," "),"{\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ZonedDateTime.parse(value);\n  }\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// callback the handler with the current date"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"date"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Handler<AsyncResult<ZonedDateTime>> handler)"),"\n}\n"))),Object(l.a)("p",null,"The gen\xader\xadated code will then use these map\xadpers to en\xadcode and de\xadcode JSON val\xadues."),Object(l.a)("p",null,"For reusabil\xadity map\xadpers can also be ",Object(l.a)("inlineCode",{parentName:"p"},"java.util.function.Function")," in\xadstead, e.g"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Mapper")," Function<String, ZonedDateTime) fromJson = ZonedDateTime::parse;\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Mapper")," Function<ZonedDateTime, String> toJson = ZonedDateTime::toString;\n")),Object(l.a)("h4",null,"Mongo client GridFS"),Object(l.a)("p",null,"The client can store and re\xadtrieve files and bi\xadnary data using Mon\xadgoDB GridFS."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Future<String> fut = gridFsClient.uploadFile(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"file.name"'),");\n\nfut.setHandler(res -> {\n   ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (res.succeeded()) {\n     String id = res.result();\n     ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//The ID of the stored object in Grid FS"),"\n   } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n     res.cause().printStackTrace();\n   }\n });\n")),Object(l.a)("p",null,"The client can per\xadform the usual CRUD op\xader\xada\xadtions on files and also pro\xadvide bucket man\xadage\xadment."),Object(l.a)("h4",null,"Vert.x Web utilities"),Object(l.a)("p",null,"While the rout\xading con\xadtext will allow you to ac\xadcess the un\xadder\xadly\xading re\xadquest and re\xadsponse ob\xadjects, some\xadtimes it will be\nmore pro\xadduc\xadtive if a few short\xadcuts would be present to help with com\xadmon tasks. A few helpers are present in\nthe con\xadtext to fa\xadcil\xadi\xadtate with this task."),Object(l.a)("p",null,"Serve an \u201cat\xadtach\xadment\u201d, an at\xadtach\xadment is a re\xadsponse that will trig\xadger the browser to open the re\xadsponse on the OS ap\xadpli\xadca\xadtion\ncon\xadfig\xadured to han\xaddle a spe\xadcific mime type. Imag\xadine you\u2019re gen\xader\xadat\xading a PDF:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"routingContext\n  .attachment(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"weekly-report.pdf"'),")\n  .end(pdfBuffer);\n")),Object(l.a)("p",null,"Per\xadform a redi\xadrect to a dif\xadfer\xadent page or host. One ex\xadam\xadple is to redi\xadrect to an HTTPS vari\xadant of the ap\xadpli\xadca\xadtion:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"routingContext.redirect(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"https://securesite.com/"'),");\n")),Object(l.a)("p",null,"Send a JSON re\xadsponse to the client:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// no need to specify the content type headers"),"\nrc.json(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hello"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vert.x"'),"));\n")),Object(l.a)("p",null,"Sim\xadple con\xadtent type check:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (routingContext.is(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")) {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// ..."),"\n}\n")),Object(l.a)("p",null,"Ver\xadify if a re\xadquest is \u201cfresh\u201d with re\xadspect to the cache head\xaders and the cur\xadrent val\xadues of last mod\xadi\xadfied/ etag:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (rc.isFresh()) {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// client cache value is fresh perhaps we"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// can stop and return 304?"),"\n}\n")),Object(l.a)("h4",null,"Other changes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Groovy has been sim\xadpli\xadfied in Vert.x 4 to re\xadmove code gen\xader\xada\xadtion that was not re\xadally needed in prac\xadtice"),Object(l.a)("li",{parentName:"ul"},"The orig\xadi\xadnal Redis client dep\xadre\xadcated in 3.7 has been re\xadmoved re\xadplaced by the new Redis client"),Object(l.a)("li",{parentName:"ul"},"JSON changes",Object(l.a)("ul",{parentName:"li"},Object(l.a)("li",{parentName:"ul"},"Jack\xadson data\xadbind is now an op\xadtional Maven de\xadpen\xaddency which means that ap\xadpli\xadca\xadtions need to ex\xadplic\xaditly add this de\xadpen\xaddency to the class\xadpath"),Object(l.a)("li",{parentName:"ul"},"Spe\xadcific Jack\xadson util\xadity meth\xadods are moved to spe\xadcific Jack\xadson classes"),Object(l.a)("li",{parentName:"ul"},"Vert.x can use an al\xadter\xadna\xadtive im\xadple\xadmen\xadta\xadtion than Jack\xadson for JSON en\xadcod\xading and JSON de\xadcod\xading"))),Object(l.a)("li",{parentName:"ul"},"The fol\xadlow\xading com\xadpo\xadnents have reached their end of life and have been pruned",Object(l.a)("ul",{parentName:"li"},Object(l.a)("li",{parentName:"ul"},"MySQL / Post\xadgreSQL async client re\xadplaced by the Vert.x SQL Client (since 3.8)"),Object(l.a)("li",{parentName:"ul"},"AMQP bridge re\xadplaced by the Vert.x AMQP Client (since 3.7)")))),Object(l.a)("h4",null,"Ramping up to Vert.x 4"),Object(l.a)("p",null,"In\xadstead of de\xadvel\xadop\xading all new fea\xadtures ex\xadclu\xadsively in Vert.x 4, we in\xadtro\xadduce some of these fea\xadtures in the 3.x branch\nso the com\xadmu\xadnity can ben\xade\xadfit from them. The Vert.x 4 de\xadvel\xadop\xadment focus on more fun\xadda\xadmen\xadtal changes that can\xadnot be done\nin the 3.x se\xadries."),Object(l.a)("img",{src:"{{ site_url }}assets/blog/vertx-4-milestone3-release/vertx-4-timeline.png",alt:"Screenshot",className:"img-responsive"}),Object(l.a)("p",null,"This is the third mile\xadstone of Vert.x 4, we aim to re\xadlease Vert.x 4 by the end of this year and you can of course\nex\xadpect more mile\xadstones to out\xadline the progress of the ef\xadfort."),Object(l.a)("h4",null,"Finally"),Object(l.a)("p",null,"The ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes"),"\ncan be found on the wiki."),Object(l.a)("p",null,"For this re\xadlease there are no Docker im\xadages.,"),Object(l.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://search.maven.org/search?q=g:io.vertx%20AND%20v:4.0.0-milestone3"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://repo1.maven.org/maven2/io/vertx/vertx-stack-manager/4.0.0-milestone3/"}),"Maven Cen\xadtral"),"."),Object(l.a)("p",null,"You can boot\xadstrap a Vert.x 4.0.0-\u200bmilestone3 project using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(l.a)("p",null,"The doc\xadu\xadmen\xadta\xadtion has been de\xadployed on this pre\xadview web-\u200bsite ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx-ci.github.io/vertx-4-preview/docs/"}),"https://vertx-\u200bci.github.io/vertx-\u200b4-\u200bpreview/docs/")),Object(l.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},i72n:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 4 milestone 1 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This is the first milestone of the upcoming Vert.x 4. It extends the 3.x callback asynchronous model to a future/callback hybrid model and introduces a Tracing API."}),i=[{term:"mileston",tf:6},{term:"releas",tf:6},{term:"trace",tf:5},{term:"applic",tf:5},{term:"client",tf:5},{term:"first",tf:3},{term:"will",tf:3},{term:"featur",tf:3},{term:"provid",tf:3},{term:"distribut",tf:3},{term:"develop",tf:3},{term:"asynchron",tf:3},{term:"model",tf:3},{term:"librari",tf:3},{term:"not",tf:3},{term:"flow",tf:3},{term:"request",tf:3},{term:"chang",tf:3},{term:"replac",tf:3},{term:"seri",tf:2},{term:"aim",tf:2},{term:"try",tf:2},{term:"core",tf:2},{term:"callback",tf:2},{term:"futur",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 4 milestone 1 released!"),Object(l.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce the first 4.0 mile\xadstone re\xadlease of Eclipse Vert.x ."),Object(l.a)("p",null,"Vert.x 4 is the evo\xadlu\xadtion of the Vert.x 3.x se\xadries that will bring key fea\xadtures to Vert.x."),Object(l.a)("p",null,"This re\xadlease aims to pro\xadvide a re\xadli\xadable dis\xadtri\xadb\xadu\xadtion of the cur\xadrent de\xadvel\xadop\xadment of Vert.x 4 for peo\xadple that\nwant to try it and pro\xadvide feed\xadback."),Object(l.a)("h4",null,"Core futurisation"),Object(l.a)("p",null,"Vert.x 4 ex\xadtends the 3.x call\xadback asyn\xadchro\xadnous model to a fu\xadture/call\xadback hy\xadbrid model."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"NetClient")," "),"{\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Since 3.0"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host, Handler<AsyncResult<NetSocket>> handler)")),";\n\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// New in 4.0"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Future<NetSocket> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host)")),";\n}\n")),Object(l.a)("p",null,"In this first mile\xadstone, only the ",Object(l.a)("em",{parentName:"p"},"Vert.x Core")," li\xadbrary con\xadtains the hy\xadbrid model. More Vert.x com\xadpo\xadnents\nwill be fu\xadtur\xadized soon and you will be able to try them in the next mile\xadstones."),Object(l.a)("h4",null,"Tracing"),Object(l.a)("p",null,"In\xadstru\xadment\xading asyn\xadchro\xadnous ap\xadpli\xadca\xadtion for dis\xadtrib\xaduted trac\xading is quite chal\xadleng\xading be\xadcause most trac\xading li\xadbraries\nrely on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://fr.wikipedia.org/wiki/Thread_Local_Storage"}),"thread local stor\xadage"),". While it works rea\xadson\xadably well\nin a block\xading ap\xadpli\xadca\xadtion, this does not work for an asyn\xadchro\xadnous ap\xadpli\xadca\xadtion."),Object(l.a)("p",null,"This sup\xadposes that the ap\xadpli\xadca\xadtion con\xadtrol flow mat\xadters (i.e threads) al\xadthough what re\xadally mat\xadters is the ap\xadpli\xadca\xadtion\nre\xadquest flow (e.g the in\xadcom\xading HTTP re\xadquest)."),Object(l.a)("p",null,"We im\xadproved Vert.x 4 to reify the re\xadquest flow, mak\xading it pos\xadsi\xadble to in\xadte\xadgrate pop\xadu\xadlar trac\xading tools such as ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://zipkin.io"}),"Zip\xadkin"),"\nor ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://opentracing.io"}),"Open\xadtrac\xading"),". Vert.x per\xadfor\xadmance is leg\xadendary and we made sure that this does not have\nany over\xadhead out of the box (dis\xadabled)."),Object(l.a)("p",null,"We pro\xadvide sup\xadport for these two pop\xadu\xadlar li\xadbraries under the ",Object(l.a)("em",{parentName:"p"},"Vert.x Trac\xading")," um\xadbrella."),Object(l.a)("h4",null,"Other changes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Groovy has been sim\xadpli\xadfied in Vert.x 4 to re\xadmove code gen\xader\xada\xadtion that was not re\xadally needed in prac\xadtice"),Object(l.a)("li",{parentName:"ul"},"The orig\xadi\xadnal Redis client dep\xadre\xadcated in 3.7 has been re\xadmoved re\xadplaced by the new Redis client"),Object(l.a)("li",{parentName:"ul"},"The fol\xadlow\xading com\xadpo\xadnents have reached their end of life and have been pruned",Object(l.a)("ul",{parentName:"li"},Object(l.a)("li",{parentName:"ul"},"MySQL / Post\xadgreSQL async client re\xadplaced by the Vert.x SQL Client (since 3.8)"),Object(l.a)("li",{parentName:"ul"},"AMQP bridge re\xadplaced by the Vert.x AMQP Client (since 3.7)")))),Object(l.a)("h4",null,"Ramping up to Vert.x 4"),Object(l.a)("p",null,"In\xadstead of de\xadvel\xadop\xading all new fea\xadtures ex\xadclu\xadsively in Vert.x 4, we in\xadtro\xadduce some of these fea\xadtures in the 3.x branch\nso the com\xadmu\xadnity can ben\xade\xadfit from them. The Vert.x 4 de\xadvel\xadop\xadment focus on more fun\xadda\xadmen\xadtal changes that can\xadnot be done\nin the 3.x se\xadries."),Object(l.a)("img",{src:"{{ site_url }}assets/blog/vertx-4-milestone1-release/vertx-4-timeline.png",alt:"Screenshot",class:"img-responsive"}),Object(l.a)("p",null,"This is the first mile\xadstone of Vert.x 4, we aim to re\xadlease Vert.x 4 by the end of this year and you can of course\nex\xadpect more mile\xadstones to out\xadline the progress of the ef\xadfort."),Object(l.a)("h4",null,"Finally"),Object(l.a)("p",null,"The ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes"),"\ncan be found on the wiki."),Object(l.a)("p",null,"For this re\xadlease there are no Docker im\xadages.,"),Object(l.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://search.maven.org/search?q=g:io.vertx%20AND%20v:4.0.0-milestone1"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://repo1.maven.org/maven2/io/vertx/vertx-stack-manager/4.0.0-milestone1/"}),"Maven Cen\xadtral"),"."),Object(l.a)("p",null,"Most im\xadpor\xadtantly the doc\xadu\xadmen\xadta\xadtion has been de\xadployed on this pre\xadview web-\u200bsite ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx-ci.github.io/vertx-4-preview/docs/"}),"https://vertx-\u200bci.github.io/vertx-\u200b4-\u200bpreview/docs/")),Object(l.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},lWra:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"The RSS reader tutorial (Step 3)",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"This is the third installment of our Vert.x Cassandra Client tutorial. We will implement the last RSS endpoint serving a list of articles related to a specific channel."}),i=[{term:"implement",tf:8},{term:"rss",tf:7},{term:"endpoint",tf:5},{term:"reader",tf:4},{term:"articl",tf:4},{term:"step",tf:3},{term:"channel",tf:3},{term:"link",tf:3},{term:"tutori",tf:2},{term:"cassandra",tf:2},{term:"client",tf:2},{term:"app",tf:2},{term:"3rd",tf:2},{term:"relat",tf:2},{term:"request",tf:2},{term:"statement",tf:2},{term:"seri",tf:2},{term:"releas",tf:1},{term:"perfect",tf:1},{term:"time",tf:1},{term:"conclud",tf:1},{term:"previou",tf:1},{term:"successfulli",tf:1},{term:"second",tf:1},{term:"exampl",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"The RSS reader tutorial (Step 3)"),Object(l.a)("p",null,"Now that ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/eclipse-vert-x-3-6-0-released/"}),"Vert.x 3.6.0 has been re\xadleased"),", it\u2019s the per\xadfect time to con\xadclude our ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-cassandra-client/java/"}),"Vert.x Cas\xadsan\xaddra Client")," tu\xadto\xadr\xadial!"),Object(l.a)("p",null,"In ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/the-rss-reader-tutorial-step-2/"}),"the pre\xadvi\xadous step"),", we have suc\xadcess\xadfully im\xadple\xadmented the sec\xadond end\xadpoint\nof the RSS reader app."),Object(l.a)("p",null,"The RSS reader ex\xadam\xadple as\xadsumes im\xadple\xadment\xading three end\xadpoints. This ar\xadti\xadcle is ded\xadi\xadcated to im\xadple\xadment\xading the last ",Object(l.a)("inlineCode",{parentName:"p"},"GET /articles/by_rss_link?link={rss_link}")," end\xadpoint."),Object(l.a)("p",null,"Be\xadfore com\xadplet\xading this step, make sure your are in the ",Object(l.a)("inlineCode",{parentName:"p"},"step_3")," git branch:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_3"),"\n")),Object(l.a)("h2",null,"Implementing the 3rd endpoint"),Object(l.a)("p",null,"The 3rd end\xadpoint serves a list of ar\xadti\xadcles re\xadlated to a spe\xadcific RSS chan\xadnel. In a re\xadquest, we spec\xadify RSS chan\xadnel by pro\xadvid\xading a link. On the ap\xadpli\xadca\xadtion side, after re\xadceiv\xading a re\xadquest we ex\xade\xadcute the fol\xadlow\xading query:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," title, article_link, description, pubDate ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," articles_by_rss_link ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"WHERE")," rss_link = RSS_LINK_FROM_REQUEST ;\n")),Object(l.a)("h2",null,"Implementation"),Object(l.a)("p",null,"For ob\xadtain\xading ar\xadti\xadcles by RSS link we need to pre\xadpare a re\xadlated state\xadment first. Change ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle#prepareSelectArticlesByRssLink")," in this way:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Future<Void> ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"prepareSelectArticlesByRssLink"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Util.prepareQueryAndSetReference(client,\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT title, article_link, description, pubDate FROM articles_by_rss_link WHERE rss_link = ? ;"'),",\n            selectArticlesByRssLink\n    );\n}\n")),Object(l.a)("p",null,"And now, we can im\xadple\xadment the ",Object(l.a)("inlineCode",{parentName:"p"},"AppVerticle#getArticles")," method. Ba\xadsi\xadcally, it will use the ",Object(l.a)("inlineCode",{parentName:"p"},"selectArticlesByRssLink")," state\xadment for find\xading ar\xadti\xadcles by the given link. Here\u2019s the im\xadple\xadmen\xadta\xadtion:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getArticles"),Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    String link = ctx.request().getParam(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"link"'),");\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (link == ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n        responseWithInvalidRequest(ctx);\n    } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n        client.executeWithFullFetch(selectArticlesByRssLink.bind(link), handler -> {\n            ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (handler.succeeded()) {\n                List<Row> rows = handler.result();\n\n                JsonObject responseJson = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject();\n                JsonArray articles = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonArray();\n\n                rows.forEach(eachRow -> articles.add(\n                        ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()\n                                .put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"title"'),", eachRow.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"))\n                                .put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"link"'),", eachRow.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),"))\n                                .put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),", eachRow.getString(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"2"),"))\n                                .put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"pub_date"'),", eachRow.getTimestamp(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"3"),").getTime())\n                ));\n\n                responseJson.put(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"articles"'),", articles);\n                ctx.response().end(responseJson.toString());\n            } ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n                log.error(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"failed to get articles for "')," + link, handler.cause());\n                ctx.response().setStatusCode(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"500"),").end(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Unable to retrieve the info from C*"'),");\n            }\n        });\n    }\n}\n")),Object(l.a)("h2",null,"Conclusion"),Object(l.a)("p",null,"Dur\xading the se\xadries, we have shown how the RSS reader app can be im\xadple\xadmented with the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-cassandra-client"}),"Vert.x Cas\xadsan\xaddra client"),"."),Object(l.a)("p",null,"Thanks for read\xading this. I hope you en\xadjoyed this se\xadries. See you soon on our ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"Git\xadter chan\xadnel"),"!"))}b.isMDXComponent=!0},lybm:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 3.8.3",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This new version is a minor bug fix release that addresses issues reported in Eclipse Vert.x 3.8.2. We would like to thank you all for reporting these bugs."}),i=[{term:"http",tf:6},{term:"releas",tf:5},{term:"com",tf:4},{term:"wiki",tf:4},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"deprec",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"note",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 3.8.3"),Object(l.a)("p",null,"We have just re\xadleased Vert.x 3.8.3, a bug fix re\xadlease of Vert.x 3.8.x."),Object(l.a)("p",null,"Since the re\xadlease of Vert.x 3.8.2, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},"Vert.x 3.8.3 dep\xadre\xadca\xadtions and break\xading changes")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("p",{parentName:"li"},Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.3-Deprecations-and-breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.3-\u200bDeprecations-and-breaking-changes")))),Object(l.a)("p",null,"Vert.x 3.8.3 re\xadlease notes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.3-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.3-\u200bRelease-Notes"))),Object(l.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.3%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.3/view"}),"Bin\xadtray"),"."),Object(l.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.3 project using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(l.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(l.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(l.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},o3oe:function(e,a,t){"use strict";a.__esModule=!0,a.default=void 0;var n=r(t("q1tI")),s=r(t("17x9"));function r(e){return e&&e.__esModule?e:{default:e}}function c(){return(c=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var l=function(e){var a=e.color,t=e.size,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,["color","size"]);return n.default.createElement("svg",c({xmlns:"http://www.w3.org/2000/svg",width:t,height:t,fill:a,viewBox:"0 0 24 24"},s),n.default.createElement("path",{d:"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"}))};l.propTypes={color:s.default.string,size:s.default.oneOfType([s.default.string,s.default.number])},l.defaultProps={color:"currentColor",size:"24"};var o=l;a.default=o},"pJo+":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x metrics now with Micrometer.io",category:"guides",authors:[{name:"Joel Takvorian",github_id:"jotak"}],summary:"The new vertx-micrometer-metrics module provides support for collecting metrics with Micrometer.io and storing them in backends such as Graphite or InfluxDB."}),i=[{term:"metric",tf:37},{term:"prometheu",tf:14},{term:"micromet",tf:13},{term:"backend",tf:13},{term:"will",tf:11},{term:"time",tf:10},{term:"influxdb",tf:10},{term:"configur",tf:10},{term:"us",tf:9},{term:"http",tf:9},{term:"exampl",tf:8},{term:"server",tf:8},{term:"provid",tf:7},{term:"sever",tf:7},{term:"etc",tf:7},{term:"registri",tf:6},{term:"queri",tf:6},{term:"modul",tf:5},{term:"implement",tf:5},{term:"collect",tf:5},{term:"support",tf:5},{term:"jmx",tf:5},{term:"dimens",tf:5},{term:"sent",tf:5},{term:"maven",tf:5}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x metrics now with Micrometer.io"),Object(l.a)("p",null,"Vert.x has al\xadready been pro\xadvid\xading met\xadrics for some time, through the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-dropwizard-metrics/java/"}),"vertx-\u200bdropwizard-metrics")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-hawkular-metrics/java/"}),"vertx-\u200bhawkular-metrics")," mod\xadules. Both of them im\xadple\xadment a ser\xadvice provider in\xadter\xadface (SPI) to col\xadlect the Vert.x met\xadrics and make them avail\xadable to their re\xadspec\xadtive back\xadends."),Object(l.a)("p",null,"A new mod\xadule, ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-micrometer-metrics/java/"}),"vertx-\u200bmicrometer-metrics"),", is now added to the fam\xadily. It im\xadple\xadments the same SPI, which means that it is able to pro\xadvide the same met\xadrics.\n",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://micrometer.io/"}),Object(l.a)("em",{parentName:"a"},"Mi\xadcrom\xade\xadter.io"))," is a pretty new met\xadrics li\xadbrary, quite com\xadpa\xadra\xadble to ",Object(l.a)("em",{parentName:"p"},"drop\xadwiz\xadard met\xadrics")," in that it col\xadlects met\xadrics in a local, in-\u200bmemory reg\xadistry and is able to store them in var\xadi\xadous back\xadends such as ",Object(l.a)("em",{parentName:"p"},"Graphite")," or ",Object(l.a)("em",{parentName:"p"},"In\xadfluxDB"),". It has sev\xaderal ad\xadvan\xadtages as we will see below."),Object(l.a)("h2",null,"Tell me more about Micrometer"),Object(l.a)("p",null,Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://micrometer.io/"}),Object(l.a)("em",{parentName:"a"},"Mi\xadcrom\xade\xadter.io"))," de\xadscribes it\xadself as a a vendor-\u200bneutral ap\xadpli\xadca\xadtion met\xadrics fa\xadcade.\nIt pro\xadvides a well de\xadsigned API, in Java, to de\xadfine ",Object(l.a)("em",{parentName:"p"},"gauges"),", ",Object(l.a)("em",{parentName:"p"},"coun\xadters"),", ",Object(l.a)("em",{parentName:"p"},"timers")," and ",Object(l.a)("em",{parentName:"p"},"dis\xadtri\xadb\xadu\xadtion sum\xadmaries"),"."),Object(l.a)("p",null,"Among the avail\xadable back\xadends, Mi\xadcrom\xade\xadter na\xadtively sup\xadports ",Object(l.a)("em",{parentName:"p"},"Graphite"),", ",Object(l.a)("em",{parentName:"p"},"In\xadfluxDB"),", ",Object(l.a)("em",{parentName:"p"},"JMX"),", ",Object(l.a)("em",{parentName:"p"},"Prometheus")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://micrometer.io/docs"}),"sev\xaderal oth\xaders"),". Prometheus is very pop\xadu\xadlar in the Ku\xadber\xadnetes and mi\xadcroser\xadvices ecosys\xadtems, so its sup\xadport by Mi\xadcrom\xade\xadter was a strong mo\xadti\xadva\xadtion for im\xadple\xadment\xading it in Vert.x."),Object(l.a)("p",null,"For the the mo\xadment, our im\xadple\xadmen\xadta\xadtion in Vert.x sup\xadports ",Object(l.a)("em",{parentName:"p"},"Prometheus"),", ",Object(l.a)("em",{parentName:"p"},"In\xadfluxDB")," and ",Object(l.a)("em",{parentName:"p"},"JMX"),". More should quickly come in the near fu\xadture."),Object(l.a)("h3",null,"Dimensionality"),Object(l.a)("p",null,"An\xadother in\xadter\xadest\xading as\xadpect in Mi\xadcrom\xade\xadter is that it han\xaddles met\xadrics ",Object(l.a)("em",{parentName:"p"},"di\xadmen\xadsion\xadal\xadity"),": met\xadrics can be as\xadso\xadci\xadated with a set of key/value pairs (some\xadtimes ref\xadered as ",Object(l.a)("em",{parentName:"p"},"tags"),", some\xadtimes as ",Object(l.a)("em",{parentName:"p"},"la\xadbels"),"). Every value brings a new di\xadmen\xadsion to the met\xadric, so that in Prometheus or any other back\xadend that sup\xadports di\xadmen\xadsion\xadal\xadity, we can query for dat\xada\xadpoints of one or sev\xaderal di\xadmen\xadsions, or query for dat\xada\xadpoints ag\xadgre\xadgated over sev\xaderal di\xadmen\xadsions."),Object(l.a)("p",null,"  ",Object(l.a)("em",{parentName:"p"},"Ex\xadam\xadple: our met\xadric ",Object(l.a)("inlineCode",{parentName:"em"},"vertx_http_server_connections")," ac\xadcepts la\xadbels ",Object(l.a)("inlineCode",{parentName:"em"},"local")," and ",Object(l.a)("inlineCode",{parentName:"em"},"remote"),", that are used to store ad\xaddresses on HTTP con\xadnec\xadtions")),Object(l.a)("p",null,"[NOTE | Prometheus is used in the fol\xadlow\xading ex\xadam\xadples, but equiv\xada\xadlent queries can be per\xadformed with ",Object(l.a)("em",{parentName:"p"},"In\xadfluxDB"),".]"),Object(l.a)("p",null,"In Prometheus, the query ",Object(l.a)("inlineCode",{parentName:"p"},"vertx_http_server_connections")," will re\xadturn as many time\xadseries as there are com\xadbi\xadna\xadtions of ",Object(l.a)("inlineCode",{parentName:"p"},"local")," and ",Object(l.a)("inlineCode",{parentName:"p"},"remote")," val\xadues. Ex\xadam\xadple:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-applescript"}),"vertx_http_server_connections{",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"local"),"=",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0.0.0.0:8080"'),",remote=",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"1.1.1.1"'),"}\nvertx_http_server_connections{",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"local"),"=",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0.0.0.0:8080"'),",remote=",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"2.2.2.2"'),"}\nvertx_http_server_connections{",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"local"),"=",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0.0.0.0:8080"'),",remote=",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"3.3.3.3"'),"}\n")),Object(l.a)("p",null,"To query on a sin\xadgle di\xadmen\xadsion, we must pro\xadvide the la\xadbels:"),Object(l.a)("p",null,Object(l.a)("inlineCode",{parentName:"p"},'vertx_http_server_connections{local="0.0.0.0:8080",remote="1.1.1.1"}'),". It will re\xadturn a sin\xadgle time\xadseries."),Object(l.a)("p",null,"To get an ag\xadgre\xadgate, Prometheus (PromQL) pro\xadvides sev\xaderal ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators"}),"ag\xadgre\xadga\xadtion op\xader\xada\xadtors"),":"),Object(l.a)("p",null,Object(l.a)("inlineCode",{parentName:"p"},"sum(vertx_http_server_connections)")," will re\xadturn the sum across all di\xadmen\xadsions."),Object(l.a)("h2",null,"So what are the Vert.x metrics?"),Object(l.a)("p",null,"Peo\xadple al\xadready fa\xadmil\xadiar with the ex\xadist\xading met\xadrics mod\xadules (",Object(l.a)("em",{parentName:"p"},"drop\xadwiz\xadard")," or ",Object(l.a)("em",{parentName:"p"},"hawku\xadlar"),") will not be too dis\xadori\xadented. They are roughly the same. The main dif\xadfer\xadence is where pre\xadvi\xadously, some met\xadric names could have a vari\xadable part within - such as ",Object(l.a)("inlineCode",{parentName:"p"},"vertx.eventbus.handlers.myaddress")," - here we take ad\xadvan\xadtage of di\xadmen\xadsion\xadal\xadity and we will have ",Object(l.a)("inlineCode",{parentName:"p"},'vertx_eventbus_handlers{address="myaddress"}'),"."),Object(l.a)("p",null,"Some other met\xadrics are no longer use\xadful, for in\xadstance the drop\xadwiz\xadard\u2019s ",Object(l.a)("inlineCode",{parentName:"p"},"vertx.eventbus.messages.pending"),", ",Object(l.a)("inlineCode",{parentName:"p"},"vertx.eventbus.messages.pending-local")," and ",Object(l.a)("inlineCode",{parentName:"p"},"vertx.eventbus.messages.pending-remote")," are now just ",Object(l.a)("inlineCode",{parentName:"p"},"vertx_eventbus_pending{side=local}")," and ",Object(l.a)("inlineCode",{parentName:"p"},"vertx_eventbus_pending{side=remote}")," in mi\xadcrom\xade\xadter. The sum of them can eas\xadily be com\xadputed at query time."),Object(l.a)("p",null,"The met\xadrics pro\xadvided by Vert.x are dis\xadpatched into eight big fam\xadi\xadlies:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("strong",{parentName:"li"},"Net client"),": dis\xadtri\xadb\xadu\xadtion sum\xadmaries of bytes sent and re\xadceived, num\xadber of con\xadnec\xadtions, etc."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("strong",{parentName:"li"},"Net server"),": dis\xadtri\xadb\xadu\xadtion sum\xadmaries of bytes sent and re\xadceived, num\xadber of con\xadnec\xadtions, etc."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("strong",{parentName:"li"},"HTTP client"),": counter of re\xadquests, re\xadsponse times, etc."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("strong",{parentName:"li"},"HTTP server"),": counter of re\xadquests, pro\xadcess\xading times, etc."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("strong",{parentName:"li"},"Event bus"),": counter of han\xaddlers, mes\xadsages sent and re\xadceived, etc."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("strong",{parentName:"li"},"Pool"),": for worker pools and some data\xadsource pools, queue size and wait\xading time, pro\xadcess\xading time, etc."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("strong",{parentName:"li"},"Ver\xadti\xadcles"),": num\xadber of ver\xadti\xadcles de\xadployed.")),Object(l.a)("p",null,"The full list of col\xadlected met\xadrics is ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-micrometer-metrics/java/#_vert_x_core_tools_metrics"}),"avail\xadable here"),"."),Object(l.a)("h2",null,"Getting started"),Object(l.a)("p",null,"This sec\xadtion will guide you through a quick setup to run a Vert.x ap\xadpli\xadca\xadtion with Mi\xadcrom\xade\xadter. The code ex\xadam\xadples used here are taken from the ",Object(l.a)("inlineCode",{parentName:"p"},"micrometer-metrics-example")," in ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-examples")," repos\xadi\xadtory, in Java, using ",Object(l.a)("em",{parentName:"p"},"maven"),". But the same could be done with other Vert.x sup\xadported lan\xadguages, as well as ",Object(l.a)("em",{parentName:"p"},"gra\xaddle")," in\xadstead of ",Object(l.a)("em",{parentName:"p"},"maven"),"."),Object(l.a)("h3",null,"Maven configuration"),Object(l.a)("p",null,"The con\xadfig\xadu\xadra\xadtion and the maven im\xadports will vary ac\xadcord\xading to the back\xadend stor\xadage that will be used. For maven, the com\xadmon part is al\xadways:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-micrometer-metrics",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.5.1",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Then, to re\xadport to In\xadfluxDB:")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.micrometer",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"micrometer-registry-influx",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.0.0",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Or Prometheus:")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.micrometer",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"micrometer-registry-prometheus",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.0.0",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-web",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.5.1",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(l.a)("p",null,"Re\xadmark that, since Prometheus pulls met\xadrics from their source, they must be ex\xadposed on an HTTP end\xadpoint. That\u2019s why ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-web")," is im\xadported here. It is not ",Object(l.a)("em",{parentName:"p"},"ab\xadsolutely")," nec\xades\xadsary (it\u2019s pos\xadsi\xadble to get the met\xadrics reg\xadistry con\xadtent and ex\xadpose it in any other way) but it\u2019s prob\xada\xadbly the eas\xadi\xadest way to do."),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Or JMX:")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.micrometer",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"micrometer-registry-jmx",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.0.0",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(l.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(l.a)("p",null,"[NOTE Note | At the mo\xadment, it is not pos\xadsi\xadble to re\xadport met\xadrics to sev\xaderal back\xadends at the same time. ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16"}),"It might be soon im\xadple\xadmented"),"]."),Object(l.a)("h3",null,"Setting up Vert.x options"),Object(l.a)("p",null,"A ",Object(l.a)("inlineCode",{parentName:"p"},"MicrometerMetricsOptions")," ob\xadject must be cre\xadated and passed to ",Object(l.a)("inlineCode",{parentName:"p"},"VertxOptions"),", with one back\xadend con\xadfig\xadured (though hav\xading no back\xadend is pos\xadsi\xadble: you would get met\xadrics sent to a de\xadfault Mi\xadcrom\xade\xadter reg\xadistry, but with\xadout any per\xadsis\xadtent stor\xadage)."),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"In\xadfluxDB ex\xadam\xadple:")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// Default InfluxDB options will push metrics to localhost:8086, db "default"'),"\nMicrometerMetricsOptions options = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MicrometerMetricsOptions()\n  .setInfluxDbOptions(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxInfluxDbOptions().setEnabled(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"))\n  .setEnabled(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\nVertx vertx = Vertx.vertx(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxOptions().setMetricsOptions(options));\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Then deploy verticles with this vertx instance"),"\n")),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Prometheus ex\xadam\xadple:")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Deploy with embedded server: prometheus metrics will be automatically exposed,"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// independently from any other HTTP server defined"),"\nMicrometerMetricsOptions options = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MicrometerMetricsOptions()\n  .setPrometheusOptions(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxPrometheusOptions()\n    .setStartEmbeddedServer(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),")\n    .setEmbeddedServerOptions(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," HttpServerOptions().setPort(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8081"),"))\n    .setEnabled(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"))\n  .setEnabled(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\nVertx vertx = Vertx.vertx(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxOptions().setMetricsOptions(options));\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Then deploy verticles with this vertx instance"),"\n")),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"Or Prometheus with the ",Object(l.a)("inlineCode",{parentName:"li"},"/metrics")," end\xadpoint bound to an ex\xadist\xading HTTP server:")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// Deploy without embedded server: we need to "manually" expose the prometheus metrics'),"\nMicrometerMetricsOptions options = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MicrometerMetricsOptions()\n  .setPrometheusOptions(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxPrometheusOptions().setEnabled(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"))\n  .setEnabled(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\nVertx vertx = Vertx.vertx(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxOptions().setMetricsOptions(options));\n\nRouter router = Router.router(vertx);\nPrometheusMeterRegistry registry = (PrometheusMeterRegistry) BackendRegistries.getDefaultNow();\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Setup a route for metrics"),"\nrouter.route(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/metrics"'),").handler(ctx -> {\n  String response = registry.scrape();\n  ctx.response().end(response);\n});\nvertx.createHttpServer().requestHandler(router::accept).listen(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"JMX ex\xadam\xadple:")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// Default JMX options will publish MBeans under domain "metrics"'),"\nMicrometerMetricsOptions options = ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MicrometerMetricsOptions()\n  .setJmxMetricsOptions(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxJmxMetricsOptions().setEnabled(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"))\n  .setEnabled(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\nVertx vertx = Vertx.vertx(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxOptions().setMetricsOptions(options));\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Then deploy verticles with this vertx instance"),"\n")),Object(l.a)("h3",null,"Setup the backend server"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.influxdata.com/"}),"In\xadfluxDB"),", by de\xadfault, is ex\xadpected to run on ",Object(l.a)("inlineCode",{parentName:"li"},"localhost:8086")," with\xadout au\xadthen\xadti\xadca\xadtion, data\xadbase \u201cde\xadfault\u201d. It is con\xadfig\xadurable in ",Object(l.a)("inlineCode",{parentName:"li"},"VertxInfluxDbOptions"),".\nIf you don\u2019t have a run\xadning in\xadstance of In\xadfluxDB, the short\xadest way to start is cer\xadtainly with docker, just run:")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"docker run -p 8086:8086 influxdb\n")),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://prometheus.io/docs/prometheus/latest/getting_started/"}),"Prometheus")," needs some con\xadfig\xadu\xadra\xadtion since it pulls met\xadrics from the sources. Once it is in\xadstalled, con\xadfig\xadure the scrape end\xadpoints in ",Object(l.a)("inlineCode",{parentName:"li"},"prometheus.yml"),":")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-yaml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"job_name:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'vertx-8081'"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"static_configs:"),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"targets:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"['localhost:8081']"),"\n")),Object(l.a)("p",null,"or, when using ",Object(l.a)("inlineCode",{parentName:"p"},"/metrics")," end\xadpoint bound to an ex\xadist\xading HTTP server:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-yaml"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"job_name:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'vertx-8080'"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"static_configs:"),"\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"targets:")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"['localhost:8080']"),"\n")),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"For JMX there is noth\xading spe\xadcial to con\xadfig\xadure.")),Object(l.a)("h3",null,"Collecting Vert.x metrics"),Object(l.a)("p",null,"From now on, all Vert.x met\xadrics will be col\xadlected and sent to the con\xadfig\xadured back\xadend. In our Vert.x ex\xadam\xadple, we setup an HTTP server met\xadrics:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Router router = Router.router(vertx);\nrouter.get(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(ctx -> {\n  ctx.response().end(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello Micrometer from HTTP!"'),");\n});\nvertx.createHttpServer().requestHandler(router::accept).listen(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(l.a)("p",null," And some event bus ping-\u200bpong:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Producer side"),"\nvertx.setPeriodic(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1000"),", x -> {\n  vertx.eventBus().send(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"greeting"'),", ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello Micrometer from event bus!"'),");\n});\n")),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Consumer side"),"\nvertx.eventBus().<String>consumer(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"greeting"'),", message -> {\n  String greeting = message.body();\n  System.out.println(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Received: "')," + greeting);\n  message.reply(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello back!"'),");\n});\n")),Object(l.a)("p",null,"To trig\xadger some ac\xadtiv\xadity on the HTTP server, we can write a small bash script:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"while")," ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"do")," curl http://localhost:8080/\n    sleep .8\n",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"done"),"\n")),Object(l.a)("h3",null,"Viewing the results"),Object(l.a)("p",null,Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://grafana.com/"}),"Grafana")," can be used to dis\xadplay the In\xadfluxDB and Prometheus met\xadrics. The ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-examples")," repos\xadi\xadtory con\xadtains two dash\xadboards for that: ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-InfluxDB.json"}),"for In\xadfluxDB")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-Prometheus.json"}),"for Prometheus"),"."),Object(l.a)("h5",null,"HTTP server metrics"),Object(l.a)("img",{alt:"HTTP server metrics",className:"img-fluid",src:"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/http-server-metrics.png"}),Object(l.a)("h5",null,"Event bus metrics"),Object(l.a)("img",{alt:"Event bus metrics",className:"img-fluid",src:"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/eventbus-metrics.png"}),Object(l.a)("h2",null,"Going further"),Object(l.a)("p",null,"We\u2019ve seen the basic setup. There is a good bunch of op\xadtions avail\xadable, de\xadtailed ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-micrometer-metrics/java/"}),"in the doc\xadu\xadmen\xadta\xadtion"),": how to dis\xadable some met\xadrics do\xadmains, how to fil\xadter or re\xadarrange la\xadbels, how to ex\xadport met\xadrics snap\xadshots to Json ob\xadjects, how to add JVM or proces\xadsor in\xadstru\xadmen\xadta\xadtion, etc."),Object(l.a)("p",null,"Be\xadfore we fin\xadish, there is one im\xadpor\xadtant point that we can cover here: defin\xading cus\xadtom met\xadrics.\nBe\xadcause the mod\xadule gives you ac\xadcess to its Mi\xadcrom\xade\xadter reg\xadistry, you can add your cus\xadtom met\xadrics there."),Object(l.a)("p",null,"Get\xadting the de\xadfault reg\xadistry is straight\xadfor\xadward:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"MeterRegistry registry = BackendRegistries.getDefaultNow();\n")),Object(l.a)("p",null,"Then you have plain ac\xadcess to the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://micrometer.io/docs/concepts"}),"Mi\xadcrom\xade\xadter API"),"."),Object(l.a)("p",null,"For in\xadstance, here is how you can track the ex\xade\xadcu\xadtion time of a piece of code that is reg\xadu\xadlarly called:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"MeterRegistry registry = BackendRegistries.getDefaultNow();\nTimer timer = Timer\n  .builder(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my.timer"'),")\n  .description(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Time tracker for my extremely sophisticated algorithm"'),")\n  .register(registry);\n\nvertx.setPeriodic(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1000"),", l -> {\n  timer.record(() -> myExtremelySophisticatedAlgorithm());\n});\n")),Object(l.a)("p",null,"Since it is using the same reg\xadistry, there is no extra back\xadend con\xadfig\xadu\xadra\xadtion to do."),Object(l.a)("h2",null,"What\u2019s next?"),Object(l.a)("p",null,"The ",Object(l.a)("inlineCode",{parentName:"p"},"vertx-micrometer-metrics")," mod\xadule will con\xadtinue to be im\xadproved, with al\xadready two planned en\xadhance\xadments:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-micrometer-metrics/issues/15"}),"Adding more back\xadends"),", like Graphite."),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16"}),"Allow to con\xadfig\xadure sev\xaderal back\xadends"),", and not only one at the same time.")),Object(l.a)("p",null,"Would you miss any fea\xadture, please ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-micrometer-metrics/issues"}),"ask on GitHub"),". Con\xadtri\xadbu\xadtions and bug fixes are also wel\xadcome!"),Object(l.a)("p",null,"Now is time to enter the Met\xadrics."))}b.isMDXComponent=!0},quyA:function(e,a){var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},uYRw:function(e,a,t){var n={"./2018-04-09-eclipse-vert-x-metrics-now-with-micrometer-io.mdx":"pJo+","./2018-04-13-new-community-channels.mdx":"zj+8","./2018-04-23-eclipse-vert-x-rabbitmq-client-gets-a-new-consumer-api.mdx":"Pc3Q","./2018-06-04-eclipse-vert-x-goes-native.mdx":"WjdI","./2018-07-02-simplified-database-transaction-management-with-the-vert-x-rxjava-api.mdx":"wjlg","./2018-08-20-the-rss-reader-tutorial.mdx":"BuQJ","./2018-09-05-the-rss-reader-tutorial-step-2.mdx":"GOOg","./2018-12-06-the-rss-reader-tutorial-step-3.mdx":"lWra","./2018-12-10-http-response-validation-with-the-vert-x-web-client.mdx":"eHGC","./2018-12-13-vertx-web-api-service.mdx":"ZJXT","./2019-07-26-eclipse-vert-x-4-milestone-1-released.mdx":"i72n","./2019-08-23-eclipse-vert-x-3-8-1.mdx":"dRkU","./2019-08-26-eclipse-vert-x-4-milestone-2-released.mdx":"OrTX","./2019-08-30-eclipse-vert-x-for-scala-next-steps.mdx":"NL1R","./2019-09-19-eclipse-vert-x-4-milestone-3-released.mdx":"hkBy","./2019-10-07-eclipse-vert-x-3-8-2.mdx":"/pBu","./2019-10-18-eclipse-vert-x-3-8-3.mdx":"lybm","./2019-10-22-send-web-requests-and-assert-results-with-vertx-junit5-web-client.mdx":"4PoU","./2019-11-28-eclipse-vert-x-3-8-4.mdx":"AiqT","./2019-12-13-eclipse-vert-x-4-milestone-4-released.mdx":"4Sve","./2020-01-24-eclipse-vert-x-3-8-5.mdx":"xDq6","./2020-03-16-easy-sso-for-vert-x-with-keycloak.mdx":"HAnQ","./2020-04-02-eclipse-vert-x-3-9-0-released.mdx":"4nW3","./2020-05-22-eclipse-vert-x-3-9-1-released.mdx":"+/MD"};function s(e){var a=r(e);return t(a)}function r(e){if(!t.o(n,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=r,e.exports=s,s.id="uYRw"},w6x9:function(e,a,t){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var a=0,t=new Array(e.length);a<e.length;a++)t[a]=e[a];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.r(a),t.d(a,"__N_SSG",(function(){return B}));var s=t("q1tI"),r=t.n(s),c=t("UMc4"),l=t("YFqc"),o=t.n(l),i=(t("ZKd4"),r.a.createElement),p=function(e){var a=e.categories;return i("div",{className:"blog-navbar"},i("h2",null,"Blog"),i("ul",null,i("li",null,i(o.a,{href:"/blog/"},i("a",null,"All posts"))),a.map((function(e){return i("li",{key:e},i(o.a,{href:"/blog/[...slug]",as:"/blog/category/".concat(e,"/")},i("a",null,e)))}))))},m=(t("yodW"),r.a.createElement),b=function(e){return m(c.a,e,m("div",{className:"blog"},m(p,{categories:e.categories}),e.children))},j=(t("S8sm"),r.a.createElement),u=function(e){return j(c.a,e,j("div",{className:"blog-post"},j(p,{categories:e.categories}),e.children))},d=r.a.createElement,h=function(e){var a=e.date,t=new Intl.DateTimeFormat("en",{year:"numeric",month:"long",day:"numeric"}).formatToParts(new Date(a)),n=t.find((function(e){return"day"===e.type})).value+" "+t.find((function(e){return"month"===e.type})).value+" "+t.find((function(e){return"year"===e.type})).value;return d(r.a.Fragment,null,n)},O=t("ACoj"),N=(t("beur"),r.a.createElement),f=function(e){var a=e.post,n=t("uYRw")("./".concat(a.filename)),s=n.meta.authors.map((function(e){return N("li",{key:e.github_id},N("img",{src:"https://github.com/".concat(e.github_id,".png?size=50")}),N("a",{href:"https://github.com/".concat(e.github_id),target:"_blank",rel:"noopener noreferrer"},e.name))}));return N("div",{className:"blog-entry"},N("div",{className:"blog-entry-meta"},N("span",{className:"blog-entry-date"},N(h,{date:a.date})),N(o.a,{href:"/blog/[...slug]",as:"/blog/category/".concat(n.meta.category,"/")},N("a",{className:"blog-entry-category"},n.meta.category))),N("h3",null,N(o.a,{href:"/blog/[...slug]",as:"/blog/".concat(a.slug,"/")},N("a",null,n.meta.title))),N("span",{className:"blog-entry-authors"},N("ul",null,s)),N("p",{className:"blog-entry-summary"},n.meta.summary||"Lorem ipsum dolor sit amet, con\xadsectetuer adip\xadisc\xading elit, sed diam non\xadummy nibh eu\xadis\xadmod tin\xadcidunt ut laoreet do\xadlore magna ali\xadquam erat vo\xadlut\xadpat. Ut wisi enim ad."),N(O.a,{href:"/blog/[...slug]",as:"/blog/".concat(a.slug,"/")}))},g=t("TSYQ"),v=t.n(g),w=(t("4Nad"),r.a.createElement);function y(e,a){return 1===e&&void 0===a?"/blog/":"/blog/[...slug]"}function x(e,a){var t="/blog/";return void 0!==a&&(t+="category/".concat(a,"/")),1===e?t:"".concat(t,"page/").concat(e,"/")}var k=function(e){var a=e.currentPage,t=void 0===a?1:a,n=e.numPages,s=void 0===n?1:n,c=e.category;if(s<=1)return w(r.a.Fragment,null);var l=function(e,a){var t=e-2,n=e+3;t<0&&(t=0,n=5),n>a&&(n=a,t=Math.max(0,a-5));for(var s=[],r=t;r<n;++r)s.push(r+1);return s[0]>2&&s.unshift({text:"\u2026",id:"left-hellip"}),s[s.length-1]<a-1&&s.push({text:"\u2026",id:"right-hellip"}),1!==s[0]&&s.unshift(1),s[s.length-1]!==a&&s.push(a),s}(t,s);return l=l.map((function(e){var a=e===t,n=e.id||e,s=e.text||e;return Number.isInteger(s)?w("div",{className:v()("pagination-page",{active:a}),key:n},w(o.a,{href:y(e,c),as:x(e,c)},w("a",null,s))):w("div",{className:"pagination-page disabled",key:n},s)})),t>1?l.unshift(w("div",{className:"pagination-page",key:"prev-page"},w(o.a,{href:y(t-1,c),as:x(t-1,c)},w("a",null,"\xab")))):l.unshift(w("div",{className:"pagination-page disabled",key:"prev-page"},"\xab")),t<s?l.push(w("div",{className:"pagination-page",key:"next-page"},w(o.a,{href:y(t+1,c),as:x(t+1,c)},w("a",null,"\xbb")))):l.push(w("div",{className:"pagination-page disabled",key:"next-page"},"\xbb")),w("div",{className:"pagination"},l)},S=t("Suba").keys().map((function(e){var a=e.match(/.\/([0-9]+-[0-9]+-[0-9]+)-(.*)\.mdx/);if(a[2].indexOf(".")>=0)throw"Invalid blog post filename: ".concat(e,". Dots '.' are not allowed.");var n=e.substring(2),s=t("uYRw")("./".concat(n));return{filename:n,date:a[1],slug:a[2],meta:s.meta,tfIdfTerms:s.__tfidf__terms}}));S.sort((function(e,a){return new Date(a.date)-new Date(e.date)}));var C=S,T=t("6acW"),_=t.n(T),I=t("17x9"),R=t.n(I);function V(){return(V=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function A(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var E=function(e){var a=e.color,t=e.size,n=A(e,["color","size"]);return r.a.createElement("svg",V({xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},n),r.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.a.createElement("polyline",{points:"12 6 12 12 16 14"}))};E.propTypes={color:R.a.string,size:R.a.oneOfType([R.a.string,R.a.number])},E.defaultProps={color:"currentColor",size:"24"};var M=E,P=t("Zimk"),F=t.n(P),q=t("cxZ6"),D=t.n(q),H=t("o3oe"),L=t.n(H),W=r.a.createElement,J=function(){var e=new Set,a=!0,t=!1,s=void 0;try{for(var r,c=C[Symbol.iterator]();!(a=(r=c.next()).done);a=!0){var l=r.value;void 0!==l.meta.category&&e.add(l.meta.category)}}catch(o){t=!0,s=o}finally{try{a||null==c.return||c.return()}finally{if(t)throw s}}return n(e)}(),B=!0;a.default=function(e){var a=e.filename,n=e.date,s=e.slug,c=e.readingTime,l=e.relatedPosts,i=e.category,p=e.page,m=void 0===p?1:p;if(void 0===a){var j=C;void 0!==i&&(j=j.filter((function(e){return e.meta.category===i})));var d=Math.ceil(j.length/6),O=(j=j.slice(6*(m-1),6*m)).map((function(e){return W(f,{key:e.slug,post:e})})),N="Blog";return void 0!==i&&(N="".concat(_()(i)," | ").concat(N)),m>1&&(N="Page ".concat(m," | ").concat(N)),W(b,{meta:{title:N},categories:J},W("div",{className:"blog-entries"},O),W(k,{currentPage:m,numPages:d,category:i}))}var g,v,w=t("uYRw")("./".concat(a)),y=w.default,x=C.findIndex((function(e){return e.slug===s}));x>0&&(g=C[x-1]),x<C.length-1&&(v=C[x+1]);var S="".concat("https://vertx-web-site.github.io","/blog/").concat(s);return W(u,{meta:{title:"".concat(w.meta.title," | Blog")},categories:J},W("div",{className:"blog-post-main"},W("div",{className:"blog-post-content"},W(y,null)),W("div",{className:"blog-post-sidebar"},w.meta.authors.map((function(e){return W("div",{className:"blog-post-author",key:e.github_id},W("img",{className:"blog-post-author-avatar",src:"https://github.com/".concat(e.github_id,".png?size=160")}),W("div",{className:"blog-post-author-name"},1===w.meta.authors.length&&"by ",W("a",{href:"https://github.com/".concat(e.github_id),target:"_blank",rel:"noopener noreferrer"},e.name)))})),W("div",{className:"blog-post-sidebar-date"},"Posted on ",W(h,{date:n})),"in ",W(o.a,{href:"/blog/[...slug]",as:"/blog/category/".concat(w.meta.category,"/")},W("a",{className:"blog-post-sidebar-category"},w.meta.category)),W("div",{className:"blog-post-sidebar-reading-time"},W(M,{className:"feather"})," ",c.text),W("div",{className:"blog-post-sidebar-share-icons"},W("a",{href:"https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(w.meta.title),"&url=").concat(encodeURIComponent(S),"&via=vertx_project"),target:"_blank",rel:"noopener noreferrer"},W(L.a,null)),W("a",{href:"https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(S)),target:"_blank",rel:"noopener noreferrer"},W(D.a,null)),W("a",{href:"https://www.facebook.com/sharer.php?u=".concat(encodeURIComponent(S)),target:"_blank",rel:"noopener noreferrer"},W(F.a,null))))),W("div",{className:"blog-post-next-prev"},W("div",{className:"blog-post-next-prev-entry"},g&&W(r.a.Fragment,null,W("h5",null,"Next post"),W(f,{post:g}))),W("div",{className:"blog-post-next-prev-entry"},v&&W(r.a.Fragment,null,W("h5",null,"Previous post"),W(f,{post:v})))),W("div",{className:"blog-post-related"},W("h5",null,"Related posts"),W("div",{className:"blog-post-related-posts"},l.map((function(e){return W(f,{key:e,post:C[e]})})))))}},wjlg:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Simplified database transaction management with the Vert.x RxJava API",category:"guides",authors:[{name:"Thomas Segismont",github_id:"tsegismont"}],summary:"As of Vert.x 3.5, managing database transactions requires a lot of boilerplate code. Vert.x 3.6 provides helpers to easily make a reactive flow transactional."}),i=[{term:"transact",tf:12},{term:"databas",tf:5},{term:"manag",tf:5},{term:"api",tf:4},{term:"provid",tf:4},{term:"transform",tf:4},{term:"queri",tf:4},{term:"code",tf:3},{term:"connect",tf:3},{term:"sourc",tf:3},{term:"rxjava",tf:2},{term:"lot",tf:2},{term:"boilerpl",tf:2},{term:"will",tf:2},{term:"helper",tf:2},{term:"reactiv",tf:2},{term:"flow",tf:2},{term:"rxifi",tf:2},{term:"on",tf:2},{term:"develop",tf:2},{term:"implement",tf:2},{term:"execut",tf:2},{term:"commit",tf:2},{term:"rollback",tf:2},{term:"chang",tf:2}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Simplified database transaction management with the Vert.x RxJava API"),Object(l.a)("p",null,Object(l.a)("em",{parentName:"p"},"TL;DR As of 3.5, man\xadag\xading data\xadbase trans\xadac\xadtions with Vert.x re\xadquires a lot of boil\xader\xadplate code."),"\n",Object(l.a)("em",{parentName:"p"},"Vert.x 3.6 will pro\xadvide helpers and ",Object(l.a)("inlineCode",{parentName:"em"},"Observable")," trans\xadform\xaders to eas\xadily make a re\xadac\xadtive flow trans\xadac\xadtional.")),Object(l.a)("h2",null,"Simple queries with the ",Object(l.a)("em",{parentName:"h2"},"\u201cRxified\u201d")," API"),Object(l.a)("p",null,"The ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-rx/java2/"}),"Vert.x API for Rx\xadJava")," is one of the most pop\xadu\xadlar mod\xadules in the Vert.x stack."),Object(l.a)("p",null,"So we make sure the ",Object(l.a)("em",{parentName:"p"},"\u201cRx\xadi\xadfied\u201d")," API is easy to use for com\xadmon pro\xadgram\xadming tasks, such as read\xading rows from a re\xadla\xadtional data\xadbase and send\xading the re\xadsult to the client:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"dbClient.rxQuery(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"SELECT name, duration FROM tracks WHERE album = 'The Israelites'\""),")\n  .map(ResultSet::getResults)\n  .map(rows -> {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Transform DB rows into a client-friendly JSON object"),"\n  })\n  .subscribe(json -> {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send JSON to the client"),"\n  }, t -> {\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send error to the client"),"\n  });\n")),Object(l.a)("h2",null,"Managing transactions with Vert.x 3.5"),Object(l.a)("p",null,"But very often, de\xadvel\xadop\xaders have to im\xadple\xadment com\xadplex in\xadter\xadac\xadtions with the data\xadbase, run\xadning in\xadside a sin\xadgle trans\xadac\xadtion.\nTo do so, the im\xadple\xadmen\xadta\xadtion must fol\xadlow this process:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"get a con\xadnec\xadtion from the pool,"),Object(l.a)("li",{parentName:"ul"},"start a trans\xadac\xadtion,"),Object(l.a)("li",{parentName:"ul"},"ex\xade\xadcute queries,"),Object(l.a)("li",{parentName:"ul"},"if all queries suc\xadceed, com\xadmit the trans\xadac\xadtion,"),Object(l.a)("li",{parentName:"ul"},"oth\xader\xadwise, roll\xadback the changes.")),Object(l.a)("p",null,"How does that trans\xadlate to code?"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Get a connection from the pool"),"\ndbClient.rxGetConnection().flatMap(sqlConnection -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Setting auto-commit mode to false implicitely starts a transaction"),"\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," sqlConnection.rxSetAutoCommit(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"false"),")\n    .andThen(\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Database queries"),"\n      sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO albums (name) VALUES ('The Israelites')\""),")\n        .andThen(sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Israelites')\""),"))\n        .andThen(sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Too Much Too Soon')\""),"))\n        .andThen(sqlConnection.rxQuery(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"SELECT name FROM tracks WHERE album = 'The Israelites'\""),").map(ResultSet::getResults))\n    )\n    ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Commit if all queries succeed"),"\n    .flatMap(rows -> sqlConnection.rxCommit().andThen(Single.just(rows)))\n    .onErrorResumeNext(throwable -> {\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// On error, rollback the changes"),"\n      ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," sqlConnection.rxRollback().onErrorComplete()\n        .andThen(sqlConnection.rxSetAutoCommit(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),").onErrorComplete())\n        .andThen(Single.error(throwable));\n    }).flatMap(rows -> sqlConnection.rxSetAutoCommit(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),").andThen(Single.just(rows)))\n    .doFinally(sqlConnection::close);\n}).map(rows -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Transform DB rows into a client-friendly JSON object"),"\n}).subscribe(json -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send JSON to the client"),"\n}, t -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send error to the client"),"\n});\n")),Object(l.a)("p",null,"That is a lot of boil\xader\xadplate around the spe\xadcific data\xadbase queries\u2026\nIt would be bet\xadter to re\xadlieve the de\xadvel\xadoper from main\xadtain\xading it."),Object(l.a)("h2",null,"Vert.x 3.6 tools for transaction management"),Object(l.a)("p",null,"That is why Vert.x 3.6 will pro\xadvide ",Object(l.a)("em",{parentName:"p"},Object(l.a)("inlineCode",{parentName:"em"},"Observable")," trans\xadform\xaders")," that can be ap\xadplied to re\xadac\xadtive flows with ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://reactivex.io/RxJava/javadoc/io/reactivex/Flowable.html#compose-io.reactivex.FlowableTransformer-"}),Object(l.a)("inlineCode",{parentName:"a"},"compose"))," to make them trans\xadac\xadtional:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txFlowableTransformer")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txObservableTransformer")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txSingleTransformer")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txMaybeTransformer")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txCompletableTransformer"))),Object(l.a)("p",null,"These ",Object(l.a)("em",{parentName:"p"},"trans\xadform\xaders")," wrap the cor\xadre\xadspond\xading source of events with SQL trans\xadac\xadtion man\xadage\xadment."),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"dbClient.rxGetConnection().flatMap(sqlConnection -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO albums (name) VALUES ('The Israelites')\""),")\n    .andThen(sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Israelites')\""),"))\n    .andThen(sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Too Much Too Soon')\""),"))\n    .andThen(sqlConnection.rxQuery(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"SELECT name FROM tracks WHERE album = 'The Israelites'\""),").map(ResultSet::getResults))\n    .compose(SQLClientHelper.txSingleTransformer(sqlConnection))\n    .doFinally(sqlConnection::close);\n}).map(rows -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Transform DB rows into a client-friendly JSON object"),"\n}).subscribe(json -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send JSON to the client"),"\n}, t -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send error to the client"),"\n});\n")),Object(l.a)("p",null,"Source ",Object(l.a)("em",{parentName:"p"},"trans\xadform\xaders")," pro\xadvide max\xadi\xadmum flex\xadi\xadbil\xadity: you are still able to ex\xade\xadcute op\xader\xada\xadtions with the con\xadnec\xadtion after the trans\xadac\xadtion com\xadpletes."),Object(l.a)("p",null,"How\xadever, you usu\xadally do not need the con\xadnec\xadtion after the changes are ",Object(l.a)("em",{parentName:"p"},"com\xadmited")," or ",Object(l.a)("em",{parentName:"p"},"roll\xadbacked"),".\nIn this case, you may sim\xadply cre\xadate you source ob\xadserv\xadable with one of the trans\xadac\xadtional helper meth\xadods in ",Object(l.a)("inlineCode",{parentName:"p"},"io.vertx.reactivex.ext.sql.SQLClientHelper"),"."),Object(l.a)("p",null,"Let\u2019s rewrite the pre\xadvi\xadous ex\xadam\xadple:"),Object(l.a)("pre",null,Object(l.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"SQLClientHelper.inTransactionSingle(client, sqlConnection -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO albums (name) VALUES ('The Israelites')\""),")\n    .andThen(sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Israelites')\""),"))\n    .andThen(sqlConnection.rxExecute(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Too Much Too Soon')\""),"))\n    .andThen(sqlConnection.rxQuery(",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"SELECT name FROM tracks WHERE album = 'The Israelites'\""),").map(ResultSet::getResults))\n}).map(rows -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Transform DB rows into a client-friendly JSON object"),"\n}).subscribe(json -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send JSON to the client"),"\n}, t -> {\n  ",Object(l.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send error to the client"),"\n});\n")),Object(l.a)("h2",null,"Give it a try"),Object(l.a)("p",null,"Vert.x 3.6 is ex\xadpected around fall, but the code is al\xadready in mas\xadter and ",Object(l.a)("em",{parentName:"p"},"snap\xadshots")," are reg\xadu\xadlarly pub\xadlished to Sonatype\u2019s OSS repos."),Object(l.a)("p",null,"So give it a try and feel free to pro\xadvide your fee\xadback on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},wx14:function(e,a,t){"use strict";function n(){return(n=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}t.d(a,"a",(function(){return n}))},wy8a:function(e,a,t){var n=t("KxBF");e.exports=function(e,a,t){var s=e.length;return t=void 0===t?s:t,!a&&t>=s?e:n(e,a,t)}},xDq6:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"Eclipse Vert.x 3.8.5",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This version is a minor bug fix release addressing issues found in Vert.x 3.8.4. We would like to thank you all for reporting these issues."}),i=[{term:"http",tf:6},{term:"releas",tf:5},{term:"com",tf:4},{term:"wiki",tf:4},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"deprec",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"note",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"Eclipse Vert.x 3.8.5"),Object(l.a)("p",null,"We have just re\xadleased Vert.x 3.8.5, a bug fix re\xadlease of Vert.x 3.8.x."),Object(l.a)("p",null,"Since the re\xadlease of Vert.x 3.8.4, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(l.a)("p",null,"Vert.x 3.8.5 dep\xadre\xadca\xadtions and break\xading changes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.5-Deprecations-and-breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.5-\u200bDeprecations-and-breaking-changes"))),Object(l.a)("p",null,"Vert.x 3.8.5 re\xadlease notes"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.5-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.5-\u200bRelease-Notes"))),Object(l.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.4/view"}),"Bin\xadtray"),"."),Object(l.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.5 project using ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(l.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(l.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(l.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}b.isMDXComponent=!0},yodW:function(e,a,t){},"zj+8":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return o})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),r=t("q1tI"),c=t.n(r),l=t("7ljp"),o=(c.a.createElement,{title:"New community channels",category:"releases",authors:[{name:"Thomas Segismont",github_id:"tsegismont"}],summary:"In order to better support the community, we (the core team and module maintainers) now also provide help on Stack Overflow and Gitter."}),i=[{term:"user",tf:6},{term:"channel",tf:5},{term:"question",tf:5},{term:"commun",tf:4},{term:"gitter",tf:4},{term:"github",tf:4},{term:"new",tf:3},{term:"ask",tf:3},{term:"not",tf:3},{term:"websit",tf:2},{term:"stack",tf:2},{term:"overflow",tf:2},{term:"chat",tf:2},{term:"modul",tf:2},{term:"maintain",tf:2},{term:"answer",tf:2},{term:"wherev",tf:2},{term:"support",tf:2},{term:"rule",tf:2},{term:"group",tf:2},{term:"irc",tf:2},{term:"issu",tf:2},{term:"peopl",tf:2},{term:"74",tf:1},{term:"visit",tf:1}],p={meta:o,__tfidf__terms:i},m="wrapper";function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(l.a)(m,Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(l.a)("h1",null,"New community channels"),Object(l.a)("p",null,"If you vis\xadited the Eclipse Vert.x web\xadsite re\xadcently, you might have no\xadticed a cou\xadple of nov\xadel\xadties on the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"com\xadmu\xadnity")," page:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"the Stack Over\xadflow ",Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://stackoverflow.com/questions/tagged/vert.x?sort=newest&pageSize=15"}),"vert.x")," tag for user ques\xadtions"),Object(l.a)("li",{parentName:"ul"},"the ",Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"vertx-\u200busers")," Git\xadter chan\xadnel to chat with other users and mod\xadule main\xadtain\xaders")),Object(l.a)("p",null,"Won\xadder\xading why?"),Object(l.a)("h2",null,"Answering questions wherever they are asked"),Object(l.a)("p",null,"In order to help us sup\xadport the com\xadmu\xadnity, we (the core team and mod\xadule main\xadtain\xaders) have tried so far to stick to a few rules:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},Object(l.a)("a",Object(n.a)({parentName:"li"},{href:"https://groups.google.com/forum/?fromgroups#!forum/vertx"}),"user group")," for ques\xadtions"),Object(l.a)("li",{parentName:"ul"},"IRC to chat"),Object(l.a)("li",{parentName:"ul"},"bugs and is\xadsues re\xadported on GitHub")),Object(l.a)("p",null,"These rules were doc\xadu\xadmented on the web\xadsite, but ad\xadmit\xadtedly they are hard (if pos\xadsi\xadble at all) to en\xadforce.\nAnd let\u2019s face it: many new users like to ask ques\xadtions on Stack\xadover\xadflow and GitHub."),Object(l.a)("p",null,"So we now an\xadswer ques\xadtions wher\xadever they are asked.\nWe keep the user group as the main chan\xadnel though: some con\xadver\xadsa\xadtions just don\u2019t fit the Stack Over\xadflow model, and not every\xadone in the com\xadmu\xadnity watches the GitHub repos\xadi\xadto\xadries."),Object(l.a)("h2",null,"Moving from IRC to Gitter"),Object(l.a)("p",null,"The ",Object(l.a)("inlineCode",{parentName:"p"},"#vertx")," chan\xadnel is recorded on ",Object(l.a)("inlineCode",{parentName:"p"},"echelog")," but it\u2019s not con\xadve\xadnient to search or browse.\nAnd shar\xading code, logs, is\xadsues is sim\xadply awful com\xadpared to mod\xadern al\xadter\xadna\xadtives like Git\xadter or Slack."),Object(l.a)("p",null,"Git\xadter got our pref\xader\xadence be\xadcause:"),Object(l.a)("ul",null,Object(l.a)("li",{parentName:"ul"},"it\u2019s free, with\xadout lim\xadits"),Object(l.a)("li",{parentName:"ul"},"it\u2019s not re\xadsource hun\xadgry (on a browser at least)"),Object(l.a)("li",{parentName:"ul"},"it\u2019s well in\xadte\xadgrated with GitHub"),Object(l.a)("li",{parentName:"ul"},"it sup\xadports ad\xadvanced for\xadmat\xadting")),Object(l.a)("p",null,"Since the ",Object(l.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"chan\xadnel")," was opened, new peo\xadple are join\xading every day.\nAt the time of writ\xading, there are 74 peo\xadple reg\xadis\xadtered al\xadready.\nWe hope you will be the next one!"),Object(l.a)("p",null,"See you soon on\xadline."))}b.isMDXComponent=!0},zoYe:function(e,a,t){var n=t("nmnc"),s=t("eUgh"),r=t("Z0cm"),c=t("/9aa"),l=1/0,o=n?n.prototype:void 0,i=o?o.toString:void 0;e.exports=function e(a){if("string"==typeof a)return a;if(r(a))return s(a,e)+"";if(c(a))return i?i.call(a):"";var t=a+"";return"0"==t&&1/a==-l?"-0":t}}}]);