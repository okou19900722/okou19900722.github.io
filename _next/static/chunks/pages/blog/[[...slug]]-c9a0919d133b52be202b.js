_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[8],{"+/MD":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 3.9.1 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"The new version comes with many enhancements including an SQL client for DB2 and out-of-the-box support for HTTP/2 on JDK 8."}),i=[{term:"jdk",tf:5},{term:"support",tf:4},{term:"releas",tf:3},{term:"client",tf:3},{term:"http",tf:3},{term:"us",tf:3},{term:"avail",tf:3},{term:"version",tf:2},{term:"sql",tf:2},{term:"db2",tf:2},{term:"port",tf:2},{term:"alpn",tf:2},{term:"recent",tf:2},{term:"docker",tf:2},{term:"distribut",tf:2},{term:"extrem",tf:1},{term:"pleas",tf:1},{term:"announc",tf:1},{term:"among",tf:1},{term:"bug",tf:1},{term:"fix",tf:1},{term:"find",tf:1},{term:"enhanc",tf:1},{term:"databas",tf:1},{term:"nativ",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce that the Eclipse Vert.x ver\xadsion 3.9.1 has been re\xadleased."),Object(o.a)("p",null,"Among all bug fixes you can find in 3.9.1 these en\xadhance\xadments:"),Object(o.a)("h2",{id:"sql-client-for-db2"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#sql-client-for-db2"})),"SQL Client for DB2"),Object(o.a)("p",null,"Vert.x SQL Client now sup\xadports the DB2 data\xadbase na\xadtively, this fea\xadture has been ported to Vert.x 3.9 in tech\npre\xadview"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"DB2ConnectOptions connectOptions = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," DB2ConnectOptions()\n  .setPort(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"50000"),")\n  .setHost(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"the-host"'),")\n  .setDatabase(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"the-db"'),")\n  .setUser(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"user"'),")\n  .setPassword(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"secret"'),");\n\nDB2Pool client = DB2Pool.pool(connectOptions);\n\nclient\n  .query(sql)\n  .execute(ar -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.succeeded()) {\n    RowSet<Row> result = ar.result();\n    System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Got "')," + result.size() + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'" rows "'),");\n  } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Failure: "')," + ar.cause().getMessage());\n  }\n});\n")),Object(o.a)("h2",{id:"jdk-8-http2-support"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#jdk-8-http2-support"})),"JDK 8 HTTP/2 support"),Object(o.a)("p",null,"Pre\xadvi\xadously using the Jetty ALPN agent or netty-\u200btcnative was re\xadquired to use HTTP/2 on JDK 8."),Object(o.a)("p",null,"TLS ALPN sup\xadport has been back-\u200bported to JDK 8 re\xadcently and Vert.x has been up\xadgraded to sup\xadport it, which means now you\ncan have HTTP/2 on JDK 8 out of the box. You need to most re\xadcent ver\xadsion of Open\xadJDK 8 or Or\xada\xadcle JDK 8."),Object(o.a)("h2",{id:"finally"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finally"})),"Finally"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.1-Release-Notes"}),"3.9.1 re\xadlease notes")," can be found on the wiki, as well as the\nlist of ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.1-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes")),Object(o.a)("p",null,"Docker im\xadages are avail\xadable on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),"."),Object(o.a)("p",null,"The Vert.x dis\xadtri\xadb\xadu\xadtion can be down\xadloaded on the web\xadsite but is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"The event bus client using the SockJS bridge is avail\xadable from:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"NPM")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"Bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"We\xadb\xadJars"))),Object(o.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.9.1%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.9.1/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},"+Vjl":function(e,a,t){"use strict";var n=t("q1tI"),s=t.n(n),c=t("17x9"),r=t.n(c);function o(){return(o=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var l=Object(n.forwardRef)((function(e,a){var t=e.color,n=void 0===t?"currentColor":t,c=e.size,r=void 0===c?24:c,l=e.title,i=void 0===l?"Twitter":l,p=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,["color","size","title"]);return s.a.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:r,height:r,fill:n,viewBox:"0 0 24 24",ref:a},p),s.a.createElement("title",null,i),s.a.createElement("path",{d:"M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"}))}));l.propTypes={color:r.a.string,size:r.a.oneOfType([r.a.string,r.a.number]),title:r.a.string},a.a=l},"+dJJ":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Google Summer of Code 2018",category:"guides",authors:[{name:"Usman Saleem",github_id:"usmansaleem"}],summary:"In this blog post, I demonstrate how to write a very simple TCP client that keeps a connection open to a custom-written server in cloud."}),i=[{term:"project",tf:23},{term:"us",tf:19},{term:"gradl",tf:16},{term:"will",tf:12},{term:"file",tf:12},{term:"follow",tf:11},{term:"server",tf:8},{term:"directori",tf:8},{term:"command",tf:8},{term:"client",tf:6},{term:"kotlin",tf:6},{term:"creat",tf:6},{term:"system",tf:6},{term:"run",tf:6},{term:"method",tf:6},{term:"log",tf:5},{term:"build",tf:5},{term:"call",tf:5},{term:"connect",tf:4},{term:"post",tf:4},{term:"requir",tf:4},{term:"add",tf:4},{term:"exampl",tf:4},{term:"distribut",tf:4},{term:"allow",tf:3}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"As part of my hobby project to con\xadtrol Rasp\xadber\xadryPi using Google Home Mini and/or Alexa, I wanted to write a very sim\xadple TCP client that keeps a con\xadnec\xadtion open to one of my cus\xadtom writ\xadten server in cloud (I will write an\xadother blog post to cover the server side on a later date). The re\xadquire\xadment of the client is to send a shared se\xadcret upon con\xadnect\xading and then keep wait\xading for mes\xadsage from server. Vert.x, Kotlin and Gra\xaddle allow rapid de\xadvel\xadop\xadment of such project. The gen\xader\xadated jar can be ex\xade\xadcuted on Rasp\xadberry Pi. These steps out\xadline the project setup and re\xadlated source code to show\xadcase a Vert.x and Kotlin project with Gra\xaddle."),Object(o.a)("h2",{id:"project-directory-structure"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#project-directory-structure"})),"Project Directory Structure"),Object(o.a)("p",null,"From com\xadmand line (or via Win\xaddows Ex\xadplorer, what\xadever you pre\xadfer to use) cre\xadate a di\xadrec\xadtory for project,for in\xadstance ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-net-client"),". Since we are using Kotlin, we will place all Kotlin files in ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/kotlin")," folder. The ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/resources")," folder will con\xadtain our log\xadging con\xadfig\xadu\xadra\xadtion re\xadlated files."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-awk"}),"cd vertx-net-client\nmkdir -p src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"kotlin\nmkdir -p src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"resources\n")),Object(o.a)("h3",{id:"project-files"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#project-files"})),"Project Files"),Object(o.a)("p",null,"We need to add fol\xadlow\xading files in the project"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},".gitignore"),"\nIf you want to check your project into git, you may con\xadsider adding fol\xadlow\xading ",Object(o.a)("inlineCode",{parentName:"li"},".gitignore")," file at root of your project")),Object(o.a)("script",{src:"https://gist.github.com/usmansaleem/b5838484a20cb8b08f236f2265ad7a8e.js"}),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"logback.xml"),"\nThis ex\xadam\xadple is using slf4j and log\xadback for log\xadging. If you de\xadcide to use it in your project, you may also add fol\xadlow\xading log\xadback.xml file in ",Object(o.a)("inlineCode",{parentName:"li"},"src/main/resources"),". Mod\xadify it as per your re\xadquire\xadments. This ex\xadam\xadple will\nlog on con\xadsole.")),Object(o.a)("script",{src:"https://gist.github.com/usmansaleem/750c6d1cad0721b52be2ff00f758fb9f.js"}),Object(o.a)("h2",{id:"gradle-setup"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#gradle-setup"})),"Gradle Setup"),Object(o.a)("p",null,"We will use Gra\xaddle build sys\xadtem for this project. If you don\u2019t al\xadready have Gra\xaddle avail\xadable on your sys\xadtem, down\xadload and unzip gra\xaddle in a di\xadrec\xadtory of your choice (",Object(o.a)("inlineCode",{parentName:"p"},"$GRADLE_HOME")," is used here to rep\xadre\xadsent this di\xadrec\xadtory). This gra\xaddle dis\xadtri\xadb\xadu\xadtion will be used as a start\xading point to cre\xadate Gra\xaddle wrap\xadper scripts for our project. These scripts will allow our project to down\xadload and use cor\xadrect ver\xadsion of gra\xaddle dis\xadtri\xadb\xadu\xadtion au\xadto\xadmat\xadi\xadcally with\xadout mess\xading up sys\xadtem. Re\xadally use\xadful when build\xading your project on CI tool or on any other de\xadvel\xadoper\u2019s ma\xadchine."),Object(o.a)("p",null,"Run fol\xadlow\xading com\xadmand in project\u2019s di\xadrec\xadtory"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-pgsql"}),"$GRADLE_HOME/bin/gradle ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"wrapper"),"\n")),Object(o.a)("p",null,"The above com\xadmands will gen\xader\xadate fol\xadlow\xading files and di\xadrec\xadto\xadries."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-css"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"gradle"),"/  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"gradlew"),"  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"gradlew"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".bat"),"\n")),Object(o.a)("h3",{id:"gradle-build-file-buildgradle"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#gradle-build-file-buildgradle"})),"Gradle build file ",Object(o.a)("inlineCode",{parentName:"h3"},"build.gradle")),Object(o.a)("p",null,"Cre\xadate (and/or copy and mod\xadify) fol\xadlow\xading ",Object(o.a)("inlineCode",{parentName:"p"},"build.gradle")," in your project\u2019s root di\xadrec\xadtory. Our ex\xadam\xadple gra\xaddle build file is using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/jponge/vertx-gradle-plugin/"}),"vertx-\u200bgradle-plugin"),"."),Object(o.a)("script",{src:"https://gist.github.com/usmansaleem/e723f25b827e0a925eaef2957a80132d.js"}),Object(o.a)("p",null,"In the project di\xadrec\xadtory, run fol\xadlow\xading com\xadmand to down\xadload local gra\xaddle dis\xadtri\xadb\xadu\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-jboss-cli"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"./gradlew"),"\n")),Object(o.a)("p",null,"(or ",Object(o.a)("inlineCode",{parentName:"p"},".\\gradlew.bat")," if in Win\xaddows)"),Object(o.a)("p",null,"At this stage we should have fol\xadlow\xading file struc\xadture. This is also a good time to com\xadmit changes if you are work\xading with git."),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},".gitignore"),"                              "),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"build.gradle"),"                            "),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"gradle/wrapper/gradle-wrapper.jar"),"       "),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"gradle/wrapper/gradle-wrapper.properties")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"gradlew"),"                                 "),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"gradlew.bat")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"src/main/resources/logback.xml"))),Object(o.a)("p",null,"Now that our project struc\xadture is ready, time to add the meat of the project. You may use any IDE of your choice. My pref\xader\xadence is In\xadtel\xadliJ IDEA."),Object(o.a)("p",null,"Cre\xadate a new pack\xadage under ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/kotlin"),". The pack\xadage name should be adapted from the fol\xadlow\xading sec\xadtion of ",Object(o.a)("inlineCode",{parentName:"p"},"build.gradle")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-ebnf"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"vertx")," {\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"    mainVerticle")," = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"info.usmans.blog.vertx.NetClientVerticle"'),"\n}\n")),Object(o.a)("p",null,"From the above ex\xadam\xadple, the pack\xadage name is ",Object(o.a)("inlineCode",{parentName:"p"},"info.usmans.blog.vertx")),Object(o.a)("p",null,"Add a new Kotlin Class/file in ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/kotlin/info/usmans/blog/vertx")," as ",Object(o.a)("inlineCode",{parentName:"p"},"NetClientVerticle.kt")),Object(o.a)("p",null,"The con\xadtents of this class is as fol\xadlows"),Object(o.a)("script",{src:"https://gist.github.com/usmansaleem/2a176a7b752fcb72f7f31964809696fe.js"}),Object(o.a)("h2",{id:"explaining-the-code"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#explaining-the-code"})),"Explaining the Code"),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"fun main(args: Array<String>)")," is not strictly re\xadquired, it quickly al\xadlows run\xadning the Vert.x ver\xadti\xadcle from within IDE. You will also no\xadtice a small hack in the method for set\xadting sys\xadtem prop\xaderty ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.disableDnsResolver")," which is to avoid a Netty bug that I ob\xadserved when run\xadning on Win\xaddows ma\xadchine and re\xadmote server is down. Of course, since we are using vertx-\u200bgradle-plugin, we can also use ",Object(o.a)("inlineCode",{parentName:"p"},"gradle vertxRun")," to run our ver\xadti\xadcle. In this case the ",Object(o.a)("inlineCode",{parentName:"p"},"main")," method will not get called."),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"override fun start()")," method calls ",Object(o.a)("inlineCode",{parentName:"p"},"fireReconnectTimer")," which in turn calls ",Object(o.a)("inlineCode",{parentName:"p"},"reconnect")," method. ",Object(o.a)("inlineCode",{parentName:"p"},"reconnect")," method con\xadtains the con\xadnec\xadtion logic to server as well as it calls ",Object(o.a)("inlineCode",{parentName:"p"},"fireReconnectTimer")," if it is un\xadable to con\xadnect to server or dis\xadcon\xadnects from server. In ",Object(o.a)("inlineCode",{parentName:"p"},"reconnect")," method the ",Object(o.a)("inlineCode",{parentName:"p"},"socket.handler")," gets called when server send mes\xadsage to client."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xl"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"socket"),".handler({ ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"data")," ->"),"\n                        logger.info(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Data received: ${data}"'),")\n                        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-doctag"}),"TODO:")," Do the work here ..."),"\n               })\n")),Object(o.a)("h2",{id:"distributing-the-project"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#distributing-the-project"})),"Distributing the project"),Object(o.a)("p",null,"To cre\xadate re\xaddis\xadtrib\xadutable jar, use ",Object(o.a)("inlineCode",{parentName:"p"},"./gradlew shadowJar")," com\xadmand. Or if using In\xadtel\xadliJ: from Gra\xaddle projects, Tasks, shadow, shad\xadow\xadJar (right click run). This com\xadmand will gen\xader\xadate ",Object(o.a)("inlineCode",{parentName:"p"},"./build/libs/vertx-net-client-fat.jar"),"."),Object(o.a)("h3",{id:"executing-the-client"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#executing-the-client"})),"Executing the client"),Object(o.a)("p",null,"The client jar can be ex\xade\xadcuted using fol\xadlow\xading com\xadmand:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-routeros"})," java ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"-DserverHost"),"=127.0.0.1 ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"-DserverPort"),"=8888 ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"-DconnectMessage"),"=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hello"')," -jar vertx-net-client-full.jar\n")),Object(o.a)("p",null,"If you wish to use SLF4J for Vert.x in\xadter\xadnal log\xadging, you need to pass sys\xadtem prop\xaderty ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.logger-delegate-factory-class-name")," with value of ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.core.logging.SLF4JLogDelegateFactory"),". The final com\xadmand would look like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-angelscript"}),"java -DserverHost=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"127.0"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),".0"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),".1")," -DserverPort=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8888")," -DconnectMessage=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hello"')," -Dvertx.logger-delegate-factory-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class"),"-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"name"),'="',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"io"),".",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"vertx"),".",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"core"),".",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"logging"),".",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"SLF4JLogDelegateFactory"),'" -',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"jar")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"vertx"),"-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"net"),"-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"client"),"-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"full"),".",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"jar"),"\n")),Object(o.a)("p",null,"You can con\xadfig\xadure Vert.x log\xadging lev\xadels in log\xadback.xml file if re\xadquired."),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"This post de\xadscribes how easy it is to cre\xadate a sim\xadple TCP client using Vert.x, Kotlin and Gra\xaddle build sys\xadtem. Hope\xadfully the tech\xadniques shown here will serve as a start\xading point for your next DIY project."),Object(o.a)("p",null,"[INFO Info | This post is adapted and re\xadpro\xadduced from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://usmans.info/usmansaleem/blog/tcp_client_using_vertx_kotlin_gradle"}),"au\xadthor\u2019s blog post"),"]"))}m.isMDXComponent=!0},"+g7z":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Real-time bidding with Websockets and Vert.x",category:"guides",authors:[{name:"Marcin Warczyglowa",github_id:"mwarc"}],summary:"The expectations of users for interactivity with web applications have changed over the past few years.\n    Users during bidding in auction no longer want to press the refresh button."}),i=[{term:"handler",tf:28},{term:"auction",tf:20},{term:"request",tf:20},{term:"us",tf:17},{term:"bid",tf:15},{term:"sockj",tf:15},{term:"method",tf:15},{term:"creat",tf:13},{term:"event",tf:13},{term:"provid",tf:12},{term:"websocket",tf:12},{term:"data",tf:12},{term:"match",tf:12},{term:"applic",tf:11},{term:"rout",tf:11},{term:"share",tf:10},{term:"server",tf:9},{term:"bu",tf:9},{term:"client",tf:9},{term:"web",tf:8},{term:"will",tf:8},{term:"servic",tf:8},{term:"http",tf:8},{term:"instanc",tf:8},{term:"bodi",tf:8}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"The ex\xadpec\xadta\xadtions of users for in\xadter\xadac\xadtiv\xadity with web ap\xadpli\xadca\xadtions have changed over the past few years.\nUsers dur\xading bid\xadding in auc\xadtion no longer want to press the re\xadfresh but\xadton to check if the price\nhas changed or the auc\xadtion is over. This made bid\xadding dif\xadfi\xadcult and less fun.\nIn\xadstead, they ex\xadpect to see the up\xaddates in ap\xadpli\xadca\xadtion in real-\u200btime."),Object(o.a)("p",null,"In this ar\xadti\xadcle I want to show how to cre\xadate a sim\xadple ap\xadpli\xadca\xadtion that pro\xadvides real-\u200btime bid\xadding.\nWe will use Web\xadSock\xadets, ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/sockjs/sockjs-client"}),"SockJS")," and Vert.x."),Object(o.a)("p",null,"We will cre\xadate a front-\u200bend for fast bid\xadding that com\xadmu\xadni\xadcates with a micro-\u200bservice writ\xadten in Java and based on Vert.x."),Object(o.a)("h2",{id:"what-are-websockets"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#what-are-websockets"})),"What are Websockets?"),Object(o.a)("p",null,"Web\xadSocket is asyn\xadchro\xadnous, bidi\xadrec\xadtional, full-\u200bduplex pro\xadto\xadcol that pro\xadvides a com\xadmu\xadni\xadca\xadtion chan\xadnel over a sin\xadgle TCP con\xadnec\xadtion.\nWith the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://www.w3.org/TR/websockets/"}),"Web\xadSocket API")," it pro\xadvides bidi\xadrec\xadtional com\xadmu\xadni\xadca\xadtion be\xadtween the web\xadsite and a re\xadmote server."),Object(o.a)("p",null,"Web\xadSock\xadets solve many prob\xadlems which pre\xadvented the HTTP pro\xadto\xadcol from being suit\xadable for use in mod\xadern,\nreal-\u200btime ap\xadpli\xadca\xadtions. Workarounds like polling are no longer needed, which sim\xadpli\xadfies ap\xadpli\xadca\xadtion ar\xadchi\xadtec\xadture.\nWeb\xadSock\xadets do not need to open mul\xadti\xadple HTTP con\xadnec\xadtions, they pro\xadvide a re\xadduc\xadtion of un\xadnec\xades\xadsary net\xadwork traf\xadfic and re\xadduce la\xadtency."),Object(o.a)("h2",{id:"websocket-api-vs-sockjs"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#websocket-api-vs-sockjs"})),"Websocket API vs SockJS"),Object(o.a)("p",null,"Un\xadfor\xadtu\xadnately, Web\xadSock\xadets are not sup\xadported by all web browsers. How\xadever, there are li\xadbraries that pro\xadvide a fall\xadback\nwhen Web\xadSock\xadets are not avail\xadable. One such li\xadbrary is ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/sockjs/sockjs-client"}),"SockJS"),".\nSockJS starts from try\xading to use the Web\xadSocket pro\xadto\xadcol. How\xadever, if this is not pos\xadsi\xadble,\nit uses  a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/sockjs/sockjs-client#supported-transports-by-browser-html-served-from-http-or-https"}),"va\xadri\xadety of browser-\u200bspecific trans\xadport pro\xadto\xadcols"),".\nSockJS is a li\xadbrary de\xadsigned to work in all mod\xadern browsers and in en\xadvi\xadron\xadments that do not sup\xadport Web\xadSocket pro\xadto\xadcol,\nfor in\xadstance be\xadhind re\xadstric\xadtive cor\xadpo\xadrate proxy. SockJS pro\xadvides an API sim\xadi\xadlar to the stan\xaddard Web\xadSocket API."),Object(o.a)("h2",{id:"frontend-to-fast-bidding"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#frontend-to-fast-bidding"})),"Frontend to fast bidding"),Object(o.a)("p",null,"Auc\xadtion web page con\xadtains the bid\xadding form and some sim\xadple JavaScript which loads cur\xadrent price from the ser\xadvice,\nopens an event bus con\xadnec\xadtion to the SockJS server and of\xadfers bid\xadding.\nHTML source code of sam\xadple web page on which we bid might look like this:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-html"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"h3"),">"),"Auction 1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"h3"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"div")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"id"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"error_message"'),">"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"div"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"form"),">"),"\n    Current price:\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"span")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"id"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"current_price"'),">"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"span"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"div"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"label")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"for"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"my_bid_value"'),">"),"Your offer:",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"label"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"input")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"id"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"my_bid_value"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"type"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"text"'),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"input")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"type"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"button"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"onclick"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"bid();"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"Bid"'),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"div"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"div"),">"),"\n        Feed:\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"textarea")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"id"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"feed"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"rows"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"4"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"cols"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"50"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"readonly"),">"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"textarea"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"div"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"form"),">"),"\n")),Object(o.a)("p",null,"We use the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-eventbus.js")," li\xadbrary to cre\xadate a con\xadnec\xadtion to the event bus.\n",Object(o.a)("inlineCode",{parentName:"p"},"vertx-eventbus.js")," li\xadbrary is a part of the Vert.x dis\xadtri\xadb\xadu\xadtion. ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-eventbus.js")," in\xadter\xadnally uses SockJS li\xadbrary\nto send the data to the SockJS server. In the code snip\xadpet below we cre\xadate an in\xadstance of the event bus.\nThe pa\xadra\xadme\xadter to the con\xadstruc\xadtor is the URI where to con\xadnect to the event bus.\nThen we reg\xadis\xadter the han\xaddler lis\xadten\xading on ad\xaddress ",Object(o.a)("inlineCode",{parentName:"p"},"auction.<auction_id>"),". Each client has a pos\xadsi\xadbil\xadity of reg\xadis\xadter\xading\nat mul\xadti\xadple ad\xaddresses e.g. when bid\xadding in the auc\xadtion 1234, they reg\xadis\xadter on the ad\xaddress ",Object(o.a)("inlineCode",{parentName:"p"},"auction.1234")," etc.\nWhen data ar\xadrives in the han\xaddler, we change the cur\xadrent price and the bid\xadding feed on the auc\xadtion\u2019s web page."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"registerHandlerForUpdateCurrentPriceAndFeed"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," eventBus = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," EventBus(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'http://localhost:8080/eventbus'"),");\n    eventBus.onopen = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n        eventBus.registerHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'auction.'")," + auction_id, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"error, message"),") "),"{\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"document"),".getElementById(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'current_price'"),").innerHTML = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"JSON"),".parse(message.body).price;\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"document"),".getElementById(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'feed'"),").value += ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'New offer: '")," + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"JSON"),".parse(message.body).price + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'\\n'"),";\n        });\n    }\n};\n")),Object(o.a)("p",null,"Any user at\xadtempt to bid gen\xader\xadates a PATCH Ajax re\xadquest\nto the ser\xadvice with in\xadfor\xadma\xadtion about the new offer made at auc\xadtion (see ",Object(o.a)("inlineCode",{parentName:"p"},"bid()")," func\xadtion).\nOn the server side we pub\xadlish this in\xadfor\xadma\xadtion on the event bus to all clients reg\xadis\xadtered to an ad\xaddress.\nIf you re\xadceive an HTTP re\xadsponse sta\xadtus code other than ",Object(o.a)("inlineCode",{parentName:"p"},"200 (OK)"),", an error mes\xadsage is dis\xadplayed on the web page."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"bid"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," newPrice = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"document"),".getElementById(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'my_bid_value'"),").value;\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," xmlhttp = (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"window"),".XMLHttpRequest) ? ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," XMLHttpRequest() : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ActiveXObject(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Microsoft.XMLHTTP"'),");\n    xmlhttp.onreadystatechange = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (xmlhttp.readyState == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"4"),") {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (xmlhttp.status != ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),") {\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"document"),".getElementById(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'error_message'"),").innerHTML = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'Sorry, something went wrong.'"),";\n            }\n        }\n    };\n    xmlhttp.open(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"PATCH"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://localhost:8080/api/auctions/"')," + auction_id);\n    xmlhttp.setRequestHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Content-Type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),");\n    xmlhttp.send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"JSON"),".stringify({",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"price"),": newPrice}));\n};\n")),Object(o.a)("h2",{id:"auction-service"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#auction-service"})),"Auction Service"),Object(o.a)("p",null,"SockJS client re\xadquires the server-\u200bside part. Now we are going to cre\xadate a light-\u200bweight REST\xadful auc\xadtion ser\xadvice.\nWe will send and re\xadtrieve data in JSON for\xadmat. Let\u2019s start by cre\xadat\xading a ver\xadti\xadcle.\nFirst we need to in\xadherit from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/core/AbstractVerticle.html"}),Object(o.a)("inlineCode",{parentName:"a"},"AbstractVerticle")),"\nand over\xadride the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method.\nEach ver\xadti\xadcle in\xadstance has a mem\xadber vari\xadable called ",Object(o.a)("inlineCode",{parentName:"p"},"vertx"),". This pro\xadvides ac\xadcess to the Vert.x core API.\nFor ex\xadam\xadple, to cre\xadate an HTTP server you call the ",Object(o.a)("inlineCode",{parentName:"p"},"createHttpServer")," method on ",Object(o.a)("inlineCode",{parentName:"p"},"vertx")," in\xadstance.\nTo tell the server to lis\xadten on port 8080 for in\xadcom\xading re\xadquests you use the ",Object(o.a)("inlineCode",{parentName:"p"},"listen")," method."),Object(o.a)("p",null,"We need a router with routes. A router takes an HTTP re\xadquest and finds the first match\xading route.\nThe route can have a han\xaddler as\xadso\xadci\xadated with it, which re\xadceives the re\xadquest\n(e.g. route that matches path ",Object(o.a)("inlineCode",{parentName:"p"},"/eventbus/*")," is  as\xadso\xadci\xadated with ",Object(o.a)("inlineCode",{parentName:"p"},"eventBusHandler"),")."),Object(o.a)("p",null,"We can do some\xadthing with the re\xadquest, and then, end it or pass it to the next match\xading han\xaddler."),Object(o.a)("p",null,"If you have a lot of han\xaddlers it makes sense to split them up into mul\xadti\xadple routers."),Object(o.a)("p",null,"You can do this by mount\xading a router at a mount point in an\xadother router\n(see ",Object(o.a)("inlineCode",{parentName:"p"},"auctionApiRouter")," that cor\xadre\xadsponds to ",Object(o.a)("inlineCode",{parentName:"p"},"/api")," mount point in code snip\xadpet below)."),Object(o.a)("p",null,"Here\u2019s an ex\xadam\xadple ver\xadti\xadcle:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AuctionServiceVerticle")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n        Router router = Router.router(vertx);\n\n        router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/eventbus/*"'),").handler(eventBusHandler());\n        router.mountSubRouter(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api"'),", auctionApiRouter());\n        router.route().failureHandler(errorHandler());\n        router.route().handler(staticHandler());\n\n        vertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n    }\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//\u2026"),"\n}\n")),Object(o.a)("p",null,"Now we\u2019ll look at things in more de\xadtail. We\u2019ll dis\xadcuss Vert.x fea\xadtures used in ver\xadti\xadcle:\nerror han\xaddler, SockJS han\xaddler, body han\xaddler, shared data, sta\xadtic han\xaddler and rout\xading based on method, path etc."),Object(o.a)("h3",{id:"error-handler"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#error-handler"})),"Error handler"),Object(o.a)("p",null,"As well as set\xadting han\xaddlers to han\xaddle re\xadquests you can also set a han\xaddler for fail\xadures in rout\xading.\nFail\xadure in rout\xading oc\xadcurs if a han\xaddler throws an ex\xadcep\xadtion, or if a han\xaddler calls ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/RoutingContext.html#fail-int-"}),Object(o.a)("inlineCode",{parentName:"a"},"fail"))," method.\nTo ren\xadder error pages we use error han\xaddler pro\xadvides by Vert.x:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ErrorHandler ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"errorHandler"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ErrorHandler.create();\n}\n")),Object(o.a)("h3",{id:"sockjs-handler"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#sockjs-handler"})),"SockJS handler"),Object(o.a)("p",null,"Vert.x pro\xadvides SockJS han\xaddler with the event bus bridge which ex\xadtends\nthe server-\u200bside Vert.x event bus into client side JavaScript."),Object(o.a)("p",null,"Con\xadfig\xadur\xading the bridge to tell it which mes\xadsages should pass through is easy.\nYou can spec\xadify which matches you want to allow for in\xadbound and out\xadbound traf\xadfic\nusing the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/handler/sockjs/BridgeOptions.html"}),Object(o.a)("inlineCode",{parentName:"a"},"BridgeOptions")),".\nIf a mes\xadsage is out\xadbound, be\xadfore send\xading it from the server to the client side JavaScript,\nVert.x will look through any out\xadbound per\xadmit\xadted matches. In code snip\xadpet below we allow any mes\xadsages\nfrom ad\xaddresses start\xading with \u201cauc\xadtion.\u201d and end\xading with dig\xadits (e.g. ",Object(o.a)("inlineCode",{parentName:"p"},"auction.1"),", ",Object(o.a)("inlineCode",{parentName:"p"},"auction.100")," etc)."),Object(o.a)("p",null,"If you want to be no\xadti\xadfied when an event oc\xadcurs on the bridge you can pro\xadvide a han\xaddler when call\xading the bridge.\nFor ex\xadam\xadple, ",Object(o.a)("inlineCode",{parentName:"p"},"SOCKET_CREATED")," event will occur when a new SockJS socket is cre\xadated.\nThe event is an in\xadstance of ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/core/Future.html"}),Object(o.a)("inlineCode",{parentName:"a"},"Future")),".\nWhen you are fin\xadished han\xaddling the event you can com\xadplete the fu\xadture with \u201ctrue\u201d to en\xadable fur\xadther pro\xadcess\xading."),Object(o.a)("p",null,"To start the bridge sim\xadply call ",Object(o.a)("inlineCode",{parentName:"p"},"bridge")," method on the SockJS han\xaddler:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," SockJSHandler ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"eventBusHandler"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    BridgeOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," BridgeOptions()\n            .addOutboundPermitted(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," PermittedOptions().setAddressRegex(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"auction\\\\.[0-9]+"'),"));\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," SockJSHandler.create(vertx).bridge(options, event -> {\n         ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (event.type() == BridgeEventType.SOCKET_CREATED) {\n            logger.info(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"A socket was created"'),");\n        }\n        event.complete(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\n    });\n}\n")),Object(o.a)("h3",{id:"body-handler"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#body-handler"})),"Body handler"),Object(o.a)("p",null,"The Body\xadHan\xaddler al\xadlows you to re\xadtrieve the re\xadquest body, limit the body size and to han\xaddle the file up\xadload.\nBody han\xaddler should be on a match\xading route for any re\xadquests that re\xadquire this func\xadtion\xadal\xadity.\nWe need Body\xadHan\xaddler dur\xading the bid\xadding process (PATCH method re\xadquest ",Object(o.a)("inlineCode",{parentName:"p"},"/auctions/<auction_id>")," con\xadtains re\xadquest body\nwith in\xadfor\xadma\xadtion about a new offer made at auc\xadtion). Cre\xadat\xading a new body han\xaddler is sim\xadple:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"BodyHandler.create();\n")),Object(o.a)("p",null,"If re\xadquest body is in JSON for\xadmat, you can get it with\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/RoutingContext.html#getBodyAsJson--"}),Object(o.a)("inlineCode",{parentName:"a"},"getBodyAsJson"))," method."),Object(o.a)("h3",{id:"shared-data"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#shared-data"})),"Shared data"),Object(o.a)("p",null,"Shared data con\xadtains func\xadtion\xadal\xadity that al\xadlows you to safely share the data be\xadtween dif\xadfer\xadent ap\xadpli\xadca\xadtions\nin the same Vert.x in\xadstance or across a clus\xadter of Vert.x in\xadstances.\nShared data in\xadcludes local shared maps, dis\xadtrib\xaduted, cluster-\u200bwide maps, asyn\xadchro\xadnous cluster-\u200bwide locks\nand asyn\xadchro\xadnous cluster-\u200bwide coun\xadters."),Object(o.a)("p",null,"To sim\xadplify the ap\xadpli\xadca\xadtion we use the local shared map to save in\xadfor\xadma\xadtion about auc\xadtions.\nThe local shared map al\xadlows you to share data be\xadtween dif\xadfer\xadent ver\xadti\xadcles in the same Vert.x in\xadstance.\nHere\u2019s an ex\xadam\xadple of using a shared local map in an auc\xadtion ser\xadvice:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AuctionRepository")," "),"{\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//\u2026"),"\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," Optional<Auction> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getById"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String auctionId)")," "),"{\n        LocalMap<String, String> auctionSharedData = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".sharedData.getLocalMap(auctionId);\n\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Optional.of(auctionSharedData)\n            .filter(m -> !m.isEmpty())\n            .map(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::convertToAuction);\n    }\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"save"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Auction auction)")," "),"{\n        LocalMap<String, String> auctionSharedData = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".sharedData.getLocalMap(auction.getId());\n\n        auctionSharedData.put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"id"'),", auction.getId());\n        auctionSharedData.put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"price"'),", auction.getPrice());\n    }\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//\u2026"),"\n}\n")),Object(o.a)("p",null,"If you want to store auc\xadtion data in a data\xadbase, Vert.x pro\xadvides a few dif\xadfer\xadent asyn\xadchro\xadnous clients\nfor ac\xadcess\xading var\xadi\xadous data stor\xadages (Mon\xadgoDB, Redis or JDBC client)."),Object(o.a)("h3",{id:"auction-api"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#auction-api"})),"Auction API"),Object(o.a)("p",null,"Vert.x lets you route HTTP re\xadquests to dif\xadfer\xadent han\xaddlers based on pat\xadtern match\xading on the re\xadquest path.\nIt also en\xadables you to ex\xadtract val\xadues from the path and use them as pa\xadra\xadme\xadters in the re\xadquest.\nCor\xadre\xadspond\xading meth\xadods exist for each HTTP method. The first match\xading one will re\xadceive the re\xadquest.\nThis func\xadtion\xadal\xadity is par\xadtic\xadu\xadlarly use\xadful when de\xadvel\xadop\xading REST-\u200bstyle web ap\xadpli\xadca\xadtions."),Object(o.a)("p",null,"To ex\xadtract pa\xadra\xadme\xadters from the path, you can use the colon char\xadac\xadter to de\xadnote the name of a pa\xadra\xadme\xadter.\nReg\xadu\xadlar ex\xadpres\xadsions can also be used to ex\xadtract more com\xadplex matches.\nAny pa\xadra\xadme\xadters ex\xadtracted by pat\xadtern match\xading are added to the map of re\xadquest pa\xadra\xadme\xadters."),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/Route.html#consumes-java.lang.String-"}),Object(o.a)("inlineCode",{parentName:"a"},"Consumes")),"\nde\xadscribes which MIME types the han\xaddler can con\xadsume.\nBy using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/Route.html#produces-java.lang.String-"}),Object(o.a)("inlineCode",{parentName:"a"},"produces")),"\nyou de\xadfine which MIME types the route pro\xadduces.\nIn the code below the routes will match any re\xadquest with ",Object(o.a)("inlineCode",{parentName:"p"},"content-type")," header\nand ",Object(o.a)("inlineCode",{parentName:"p"},"accept")," header that matches ",Object(o.a)("inlineCode",{parentName:"p"},"application/json"),"."),Object(o.a)("p",null,"Let\u2019s look at an ex\xadam\xadple of a sub\xadrouter mounted on the main router which was cre\xadated in ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method in ver\xadti\xadcle:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Router ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"auctionApiRouter"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    AuctionRepository repository = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," AuctionRepository(vertx.sharedData());\n    AuctionValidator validator = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," AuctionValidator(repository);\n    AuctionHandler handler = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," AuctionHandler(repository, validator);\n\n    Router router = Router.router(vertx);\n    router.route().handler(BodyHandler.create());\n\n    router.route().consumes(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),");\n    router.route().produces(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),");\n\n    router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/auctions/:id"'),").handler(handler::handleGetAuction);\n    router.patch(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/auctions/:id"'),").handler(handler::handleChangeAuctionPrice);\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," router;\n}\n")),Object(o.a)("p",null,"The GET re\xadquest re\xadturns auc\xadtion data, while the PATCH method re\xadquest al\xadlows you to bid up in the auc\xadtion.\nLet\u2019s focus on the more in\xadter\xadest\xading method, namely ",Object(o.a)("inlineCode",{parentName:"p"},"handleChangeAuctionPrice"),".\nIn the sim\xadplest terms, the method might look like this:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleChangeAuctionPrice"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext context)")," "),"{\n    String auctionId = context.request().getParam(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"id"'),");\n    Auction auction = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Auction(\n        auctionId,\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," BigDecimal(context.getBodyAsJson().getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"price"'),"))\n    );\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".repository.save(auction);\n    context.vertx().eventBus().publish(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"auction."')," + auctionId, context.getBodyAsString());\n\n    context.response()\n        .setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),")\n        .end();\n}\n")),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"PATCH")," re\xadquest to ",Object(o.a)("inlineCode",{parentName:"p"},"/auctions/1")," would re\xadsult in vari\xadable ",Object(o.a)("inlineCode",{parentName:"p"},"auctionId")," get\xadting the value 1.\nWe save a new offer in the auc\xadtion and then pub\xadlish this in\xadfor\xadma\xadtion on the event bus to all clients\nreg\xadis\xadtered on the ad\xaddress on the client side JavaScript.\nAfter you have fin\xadished with the HTTP re\xadsponse you must call the ",Object(o.a)("inlineCode",{parentName:"p"},"end")," func\xadtion on it."),Object(o.a)("h3",{id:"static-handler"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#static-handler"})),"Static handler"),Object(o.a)("p",null,"Vert.x pro\xadvides the han\xaddler for serv\xading sta\xadtic web re\xadsources.\nThe de\xadfault di\xadrec\xadtory from which sta\xadtic files are served is ",Object(o.a)("inlineCode",{parentName:"p"},"webroot"),", but this can be con\xadfig\xadured.\nBy de\xadfault the sta\xadtic han\xaddler will set cache head\xaders to en\xadable browsers to cache files.\nSet\xadting cache head\xaders can be dis\xadabled with\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/handler/StaticHandler.html#setCachingEnabled-boolean-"}),Object(o.a)("inlineCode",{parentName:"a"},"setCachingEnabled"))," method.\nTo serve the auc\xadtion HTML page, JS files (and other sta\xadtic files) from auc\xadtion ser\xadvice, you can cre\xadate a sta\xadtic han\xaddler like this:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," StaticHandler ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"staticHandler"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," StaticHandler.create()\n        .setCachingEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"false"),");\n}\n")),Object(o.a)("h2",{id:"lets-run"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#lets-run"})),"Let\u2019s run!"),Object(o.a)("p",null,"Full ap\xadpli\xadca\xadtion code is avail\xadable on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/mwarc/simple-realtime-auctions-vertx3-example"}),"github"),"."),Object(o.a)("p",null,"Clone the repos\xadi\xadtory and run ",Object(o.a)("inlineCode",{parentName:"p"},"./gradlew run"),"."),Object(o.a)("p",null,"Open one or more browsers and point them to ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8080"),". Now you can bid in auc\xadtion:"),Object(o.a)("img",{src:t("Yekb"),alt:"Real time bidding in application"}),Object(o.a)("h2",{id:"summary"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#summary"})),"Summary"),Object(o.a)("p",null,"This ar\xadti\xadcle presents the out\xadline of a sim\xadple ap\xadpli\xadca\xadtion that al\xadlows real-\u200btime bid\xadding.\nWe cre\xadated a light\xadweight, high-\u200bperformance and scal\xadable micro-\u200bservice writ\xadten in Java and based on Vert.x.\nWe dis\xadcussed what Vert.x of\xadfers, among oth\xaders, a dis\xadtrib\xaduted event bus and an el\xade\xadgant API that al\xadlows you to cre\xadate ap\xadpli\xadca\xadtions in no time."))}m.isMDXComponent=!0},"/93W":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Google Summer of Code 2018",category:"news",authors:[{name:"Thomas Segismont",github_id:"tsegismont"}],summary:"It's this time of year again! Google Summer of Code 2018 submission period has just started!"}),i=[{term:"year",tf:4},{term:"submit",tf:4},{term:"assess",tf:3},{term:"applic",tf:3},{term:"propos",tf:3},{term:"2018",tf:2},{term:"googl",tf:2},{term:"submiss",tf:2},{term:"period",tf:2},{term:"organ",tf:2},{term:"sure",tf:2},{term:"review",tf:2},{term:"gsoc",tf:2},{term:"idea",tf:2},{term:"ask",tf:2},{term:"candid",tf:2},{term:"not",tf:2},{term:"question",tf:2},{term:"27",tf:1},{term:"time",tf:1},{term:"summer",tf:1},{term:"code",tf:1},{term:"just",tf:1},{term:"start",tf:1},{term:"project",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"It\u2019s this time of year again!\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://summerofcode.withgoogle.com/"}),"Google Sum\xadmer of Code")," 2018 sub\xadmis\xadsion pe\xadriod has just started!"),Object(o.a)("h2",{id:"submit-through-the-eclipse-organization"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#submit-through-the-eclipse-organization"})),"Submit through the Eclipse organization"),Object(o.a)("p",null,"This year, the Eclipse Vert.x project par\xadtic\xadi\xadpates through the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://summerofcode.withgoogle.com/organizations/6364590460370944/"}),"Eclipse or\xadga\xadni\xadza\xadtion"),".\nMake sure to re\xadview our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://wiki.eclipse.org/Google_Summer_of_Code_2018_Ideas#Eclipse_Vert.x"}),"GSoC 2018 ideas")," and to sub\xadmit be\xadfore March, 27!"),Object(o.a)("h2",{id:"assessment-application"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#assessment-application"})),"Assessment application"),Object(o.a)("p",null,"As we did be\xadfore, we ask can\xaddi\xaddates to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/tsegismont/vertx-gsoc-2018-qotd"}),"im\xadple\xadment a sim\xadple Vert.x ap\xadpli\xadca\xadtion"),".\nThis helps us make sure can\xaddi\xaddates have a basic un\xadder\xadstand\xading of asyn\xadchro\xadnous pro\xadgram\xadming and the Vert.x toolkit.\n",Object(o.a)("strong",{parentName:"p"},"But sub\xadmit your pro\xadposal even if not done with the as\xadsess\xadment ap\xadpli\xadca\xadtion!"),"\nGoogle will not ex\xadtend the sub\xadmis\xadsion pe\xadriod but we can con\xadtinue re\xadview\xading as\xadsess\xadments while eval\xadu\xadat\xading the sub\xadmit\xadted pro\xadpos\xadals."),Object(o.a)("h2",{id:"questions"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#questions"})),"Questions?"),Object(o.a)("p",null,"If you have ques\xadtions, feel free to ask pos\xadsi\xadble men\xadtors via email or on our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"/community"}),"com\xadmu\xadnity chan\xadnels"),"."),Object(o.a)("p",null,"All the de\xadtails for this year (and ideas from past years) can be found on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"/gsoc"}),"Vert.x GSoC page"),"."),Object(o.a)("p",null,"Look\xading for\xadward to your pro\xadpos\xadals!"))}m.isMDXComponent=!0},"/V1q":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return i})),t.d(a,"__tfidf__terms",(function(){return p})),t.d(a,"default",(function(){return j}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("280p"),i=(r.a.createElement,{title:"Vert.x 3 and PostgreSQL JSON type",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"One of the interesting features of NoSQL databases is their schema-less mode of operation. This feature is very useful during project prototyping and early development since at early the stages of development of projects all data structures are not clear or have been defined yet."}),p=[{term:"us",tf:4},{term:"featur",tf:2},{term:"nosql",tf:2},{term:"databas",tf:2},{term:"project",tf:2},{term:"earli",tf:2},{term:"develop",tf:2},{term:"not",tf:2},{term:"show",tf:2},{term:"version",tf:2},{term:"support",tf:2},{term:"json",tf:2},{term:"new",tf:2},{term:"type",tf:2},{term:"rest",tf:2},{term:"on",tf:1},{term:"interest",tf:1},{term:"schema",tf:1},{term:"less",tf:1},{term:"mode",tf:1},{term:"oper",tf:1},{term:"prototyp",tf:1},{term:"stage",tf:1},{term:"data",tf:1},{term:"structur",tf:1}],m={meta:i,__tfidf__terms:p};function j(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},m,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"One of the in\xadter\xadest\xading fea\xadtures of NoSQL data\xadbases is their schema-\u200bless mode of op\xader\xada\xadtion. This fea\xadture is very use\xadful\ndur\xading project pro\xadto\xadtyp\xading and early de\xadvel\xadop\xadment since at early the stages of de\xadvel\xadop\xadment of projects all data\nstruc\xadtures are not clear or have been de\xadfined yet. The rea\xadson of this post is not to dis\xadcuss about that sub\xadject, but to\nshow that some\xadtimes you can also use NoSQL with a more tra\xaddi\xadtional data\xadbase en\xadgine like ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://www.postgresql.org/"}),"Post\xadgreSQL"),"."),Object(o.a)("p",null,"Since ver\xadsion ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://www.postgresql.org/docs/9.3/static/datatype-json.html"}),"9.3")," there is sup\xadport for JSON how\xadever with\nver\xadsion ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://www.postgresql.org/docs/9.4/static/datatype-json.html"}),"9.4")," there is even bet\xadter sup\xadport with the new type\nJSONB. I will now show how to use the basic JSON type in a sim\xadple REST ap\xadpli\xadca\xadtion writ\xadten with Vert.x3:"),Object(o.a)(l.a,{url:"https://gist.github.com/pmlopes/47f7f02b0b102b5e68d8",mdxType:"Gist"}),Object(o.a)("p",null,"Now all you need to do is play with this REST ser\xadvice, for this you can use curl to cre\xadate a sale:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"$ curl \\\n    -i \\\n    -H ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Content-Type: application/json"')," \\\n    -X POST \\\n    -d ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'\'{"id": 1, "customer_name": "John", "items": {"description": "milk", "quantity": 4}}\'')," \\\n    http://localhost:8080/sales\n\nHTTP/1.1 201 Created\nContent-Length: 0\n")),Object(o.a)("p",null,"And if you want to read that new doc\xadu\xadment:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"$ curl -i -H ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Accept: application/json"')," -X GET http://localhost:8080/sales/1\nHTTP/1.1 200 OK\ncontent-type: application/json\nContent-Length: 75\n\n{",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"id"'),":1,",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"customer_name"'),":",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"John"'),",",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"items"'),":{",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),":",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"milk"'),",",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"quantity"'),":4}}\n")))}j.isMDXComponent=!0},"/pBu":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 3.8.2",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This version is a bug fix release of Vert.x 3.8.3, which addresses quite a few bugs reported by the community."}),i=[{term:"http",tf:6},{term:"releas",tf:5},{term:"com",tf:4},{term:"wiki",tf:4},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"deprec",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"note",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We have just re\xadleased Vert.x 3.8.2, a bug fix re\xadlease of Vert.x 3.8.x."),Object(o.a)("p",null,"Since the re\xadlease of Vert.x 3.8.1, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"Vert.x 3.8.2 dep\xadre\xadca\xadtions and break\xading changes")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.2-Deprecations-and-breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.2-\u200bDeprecations-and-breaking-changes")))),Object(o.a)("p",null,"Vert.x 3.8.2 re\xadlease notes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.2-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.2-\u200bRelease-Notes"))),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.2%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.2/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.2 project using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},"00pu":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Building a real-time web app with Angular/Ngrx and Vert.x",category:"guides",authors:[{name:"Benoit Hediard",github_id:"benorama"}],summary:"There are multiple tech stacks to build a real-time web app. What are the best choices to build Angular client apps, connected to a JVM-based backend?"}),i=[{term:"app",tf:21},{term:"client",tf:20},{term:"action",tf:15},{term:"event",tf:14},{term:"time",tf:12},{term:"angular",tf:12},{term:"bu",tf:12},{term:"base",tf:11},{term:"state",tf:11},{term:"build",tf:10},{term:"real",tf:10},{term:"connect",tf:10},{term:"counter",tf:10},{term:"us",tf:9},{term:"platform",tf:8},{term:"js",tf:8},{term:"ngrx",tf:8},{term:"http",tf:7},{term:"reactiv",tf:7},{term:"jvm",tf:6},{term:"publish",tf:6},{term:"server",tf:6},{term:"distribut",tf:6},{term:"web",tf:5},{term:"backend",tf:5}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Nowa\xaddays, there are mul\xadti\xadple tech stacks to build a real-\u200btime web app. What are the best choices to build real-\u200btime An\xadgu\xadlar client apps, con\xadnected to a JVM-\u200bbased back\xadend? This ar\xadti\xadcle de\xadscribes an An\xadgu\xadlar+Vertx real-\u200btime ar\xadchi\xadtec\xadture with a Proof of Con\xadcept demo app."),Object(o.a)("p",null,"[NOTE this is a re-\u200bpublication of the fol\xadlow\xading ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://medium.com/@benorama/building-a-realtime-web-app-with-angular-ngrx-and-vert-x-a5381c0397a1"}),"Medium post"),"]"),Object(o.a)("h2",{id:"intro"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#intro"})),"Intro"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Wel\xadcome to the real-\u200btime web!")," It\u2019s time to move on from tra\xaddi\xadtional syn\xadchro\xadnous HTTP re\xadquest/re\xadsponse ar\xadchi\xadtec\xadtures to re\xadac\xadtive apps with con\xadnected clients (ouch\u2026 that\u2019s a lot of buzz\xadwords in just one sen\xadtence)!"),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"/assets/blog/vertx-realtime-angular-ngrx/data-in-motion.jpg",alt:"Real-time app"}))),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Image source: ",Object(o.a)("a",Object(n.a)({parentName:"em"},{href:"https://www.voxxed.com"}),"https://www.voxxed.com"))),Object(o.a)("p",null,"To build this kind of app, ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.meteor.com"}),"Me\xadte\xadorJS")," is the new cool kid on the block (v1.0 re\xadleased in oc\xadto\xadber 2014): ",Object(o.a)("strong",{parentName:"p"},"a full stack Javascript plat\xadform to build connected-\u200bclient re\xadac\xadtive ap\xadpli\xadca\xadtions"),". It al\xadlows JS de\xadvel\xadop\xaders to build and de\xadploy amaz\xading mod\xadern web and mo\xadbile apps (iOS/An\xaddroid) in no time, using a uni\xadfied back\xadend+fron\xadtend code within a sin\xadgle app repo. That\u2019s a pretty am\xadbi\xadtious ap\xadproach but it re\xadquires a very opin\xadion\xadated and highly cou\xadpled JS tech stack and it\u2019s still a pretty niche frame\xadwork."),Object(o.a)("p",null,"More\xadover, we are a Java shop on the back\xadend. At Ago\xadra\xadPulse, we rely heav\xadily on :"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://angular.io"}),"An\xadgu\xadlar")," and ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://ionicframework.com"}),"Ionic")," for the JS fron\xadtend (with a shared busi\xadness/data ar\xadchi\xadtec\xadture based on ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/ngrx/store"}),"Ngrx"),"),"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.groovy-lang.org"}),"Groovy")," and ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://grails.org"}),"Grails")," ecosys\xadtem for the JVM back\xadend.")),Object(o.a)("p",null,"So my ques\xadtion is:"),Object(o.a)("blockquote",null,Object(o.a)("p",{parentName:"blockquote"},"What are the best choices to build real-\u200btime An\xadgu\xadlar client apps, con\xadnected to a JVM-\u200bbased back\xadend these days?")),Object(o.a)("p",null,"Our re\xadquire\xadments are pretty basic. We don\u2019t need full Me\xadteor\u2019s end-\u200bto-end ap\xadpli\xadca\xadtion model.\nWe just want to be able to :"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"build a re\xadac\xadtive app with an event bus on the JVM, and"),Object(o.a)("li",{parentName:"ol"},"ex\xadtend the event bus down to the browser to be able to pub\xadlish/sub\xadscribe to real-\u200btime events from an An\xadgu\xadlar app.")),Object(o.a)("h3",{id:"server-side-jvm"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#server-side-jvm"})),"Server side (JVM)"),Object(o.a)("p",null,"Re\xadac\xadtive apps is a hot topic nowa\xaddays and there are many great libs/plat\xadforms to build this type of event-\u200bdriven ar\xadchi\xadtec\xadture on the JVM:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io"}),"Vert.x"),","),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.lightbend.com"}),"Light\xadbend")," plat\xadform (Play, Akka, Scala),"),Object(o.a)("li",{parentName:"ul"},"Spring ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://projectreactor.io"}),"Project Re\xadac\xadtor")," (in\xadte\xadgrated into Grails 3.0).")),Object(o.a)("h3",{id:"client-side"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#client-side"})),"Client side"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://facebook.github.io/react/"}),"Re\xadac\xadtJS")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://angular.io"}),"An\xadgu\xadlar")," are the two most pop\xadu\xadlar frame\xadwork right now to build mod\xadern JS apps. Most plat\xadforms use ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/sockjs/sockjs-client"}),"SockJS")," to han\xaddle real-\u200btime con\xadnec\xadtions:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-web/groovy/"}),"Vertx-\u200bweb")," pro\xadvides a SockJS server im\xadple\xadmen\xadta\xadtion with an event bus bridge and a ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-web/groovy/#_sockjs_event_bus_bridge"}),"vertx-\u200bevenbus.js")," client li\xadbrary (very easy to use),"),Object(o.a)("li",{parentName:"ul"},"Spring pro\xadvides web\xadsocket SockJS sup\xadport though Spring Mes\xadsag\xading and Web\xadsocket libs (see an ex\xadam\xadple ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://spring.io/guides/gs/messaging-stomp-websocket/"}),"here"),")")),Object(o.a)("h3",{id:"final-choice-vertx--angular"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#final-choice-vertx--angular"})),"Final choice: Vert.x + Angular"),Object(o.a)("p",null,"In the end, I\u2019ve cho\xadsen to ex\xadper\xadi\xadment with Vert.x for its ex\xadcel\xadlent Groovy sup\xadport, dis\xadtrib\xaduted event bus, scal\xada\xadbil\xadity and ease of use."),Object(o.a)("p",null,"I en\xadjoyed it very much. Let me show you the re\xadsult of my ex\xadper\xadi\xadmen\xadta\xadtion which is the root of our real-\u200btime fea\xadtures com\xading very soon in Ago\xadra\xadPulse v6.0!"),Object(o.a)("h2",{id:"why-vertx"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#why-vertx"})),"Why Vert.x?"),Object(o.a)("p",null,"Like other re\xadac\xadtive plat\xadform, Vert.x is event dri\xadven and non block\xading. It scales very well (even more that Node.js)."),Object(o.a)("p",null,"Un\xadlike other re\xadac\xadtive plat\xadforms, Vert.x is poly\xadglot: you can use Vert.x with mul\xadti\xadple lan\xadguages in\xadclud\xading Java, JavaScript, Groovy, Ruby, Cey\xadlon, Scala and Kotlin."),Object(o.a)("p",null,"Un\xadlike Node.js, Vert.x is a gen\xaderal pur\xadpose tool-\u200bkit and un\xadopin\xadion\xadated. It\u2019s a ver\xadsa\xadtile plat\xadform suit\xadable for many things: from sim\xadple net\xadwork util\xadi\xadties, so\xadphis\xadti\xadcated mod\xadern web ap\xadpli\xadca\xadtions, HTTP/REST mi\xadcroser\xadvices or a full blown back-\u200bend message-\u200bbus ap\xadpli\xadca\xadtion."),Object(o.a)("p",null,"Like other re\xadac\xadtive plat\xadforms, it looks scary in the be\xadgin\xading when you read the doc\xadu\xadmen\xadta\xadtion\u2026 ;) But once you start play\xading with it, it re\xadmains fun and sim\xadple to use, es\xadpe\xadcially with Groovy! Vert.x re\xadally al\xadlows you to build sub\xadstan\xadtial sys\xadtems with\xadout get\xadting tan\xadgled in com\xadplex\xadity."),Object(o.a)("p",null,"In my case, I was mainly in\xadter\xadested by the dis\xadtrib\xaduted event-\u200bbus pro\xadvided (a core fea\xadture of Vert.x)."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"To val\xadi\xaddate our ap\xadproach, we built pro\xadto\xadtypes with the fol\xadlow\xading goals:")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"share and syn\xadchro\xadnize a com\xadmon (Ngrx-\u200bbased) state be\xadtween mul\xadti\xadple con\xadnected clients, and")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"dis\xadtrib\xadute real-\u200btime (Ngrx-\u200bbased) ac\xadtions across mul\xadti\xadple con\xadnected clients, which im\xadpact local states/re\xadduc\xaders."))),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Note: ",Object(o.a)("a",Object(n.a)({parentName:"em"},{href:"https://github.com/ngrx/store"}),"@ngrx/store")," is a RxJS pow\xadered state man\xadage\xadment in\xadspired by Redux for An\xadgu\xadlar apps. It\u2019s cur\xadrently the most pop\xadu\xadlar way to struc\xadture com\xadplex busi\xadness logic in An\xadgu\xadlar apps.")),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"/assets/blog/vertx-realtime-angular-ngrx/redux.png",alt:"Redux"}))),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Source: ",Object(o.a)("a",Object(n.a)({parentName:"em"},{href:"https://www.smashingmagazine.com/2016/06/an-introduction-to-redux/"}),"https://www.smash\xading\xadmagazine.com/2016/06/an-\u200bintroduction-to-redux/"))),Object(o.a)("h2",{id:"proof-of-concept"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#proof-of-concept"})),"PROOF OF CONCEPT"),Object(o.a)("p",null,"Here is the repo of our ini\xadtial proof of con\xadcept:"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://github.com/benorama/ngrx-realtime-app"}),"http://github.com/beno\xadrama/ngrx-\u200brealtime-app")),Object(o.a)("p",null,"The repo is di\xadvided into two sep\xada\xadrate projects:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"Vert.x server app"),", based on ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io"}),"Vert.x")," (ver\xadsion 3.3), man\xadaged by ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://gradle.org"}),"Gra\xaddle"),", with a main ver\xadti\xadcle de\xadvel\xadoped in ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://groovy-lang.org"}),"Groovy")," lang."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"An\xadgu\xadlar client app"),", based on An\xadgu\xadlar (ver\xadsion 4.0.1), man\xadaged by ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://angular.io"}),"An\xadgu\xadlar")," CLI with state, re\xadduc\xaders and ac\xadtions logic based on ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/ngrx/store"}),"@ngrx/store")," (ver\xadsion 2.2.1)")),Object(o.a)("p",null,"For the demo, we are using the counter ex\xadam\xadple code (ac\xadtions and re\xadduc\xaders) from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ngrx/store"}),"@ngrx/store"),"."),Object(o.a)("p",null,"The counter client busi\xadness logic is based on:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"CounterState")," in\xadter\xadface, counter state model,"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"counterReducer")," re\xadducer, counter state man\xadage\xadment based on dis\xadpatched ac\xadtions, and"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("em",{parentName:"li"},"In\xadcre\xadment"),", ",Object(o.a)("em",{parentName:"li"},"decre\xadment")," and ",Object(o.a)("em",{parentName:"li"},"reset")," counter ac\xadtions.")),Object(o.a)("p",null,"State is main\xadtained server-\u200bside with a sim\xadple sin\xadgle\xadton ",Object(o.a)("inlineCode",{parentName:"p"},"CounterService"),"."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-groovy"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"CounterService")," {"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," INCREMENT = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'[Counter] Increment'"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," DECREMENT = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'[Counter] Decrement'"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," RESET = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'[Counter] Reset'"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," total = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"void")," handleEvent(event) {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"switch"),"(event.type) {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"case")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"INCREMENT:"),"\n                total++\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"break"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"case")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"DECREMENT:"),"\n                total--\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"break"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"case")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"RESET:"),"\n                total = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"break"),"\n        }\n    }\n}\n")),Object(o.a)("h3",{id:"client-state-initialization-through-requestresponse"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#client-state-initialization-through-requestresponse"})),"Client state initialization through Request/Response"),Object(o.a)("p",null,"Ini\xadtial state is ini\xadtial\xadized with sim\xadple ",Object(o.a)("strong",{parentName:"p"},"re\xadquest/re\xadsponse")," (or send/reply) on the event bus.\nOnce the client is con\xadnected, it sends a re\xadquest to the event bus at the ad\xaddress ",Object(o.a)("strong",{parentName:"p"},"counter::total"),". The server replies di\xadrectly with the value of ",Object(o.a)("inlineCode",{parentName:"p"},"CounterService")," total and the client dis\xadpatches lo\xadcally a ",Object(o.a)("em",{parentName:"p"},"reset")," ac\xadtion with the total value from the reply."),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"/assets/blog/vertx-realtime-angular-ngrx/vertx-request-response.png",alt:"Vertx Request Response"}))),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Source: ",Object(o.a)("a",Object(n.a)({parentName:"em"},{href:"https://www.slideshare.net/RedHatDevelopers/vertx-microservices-were-never-so-easy-clement-escoffier"}),"https://www.slideshare.net/Red\xadHat\xadDe\xadvel\xadop\xaders/vertx-\u200bmicroservices-were-never-so-easy-clement-escoffier"))),Object(o.a)("p",null,"Here is an ex\xadtract of the cor\xadre\xadspond\xading code (from ",Object(o.a)("inlineCode",{parentName:"p"},"AppEventBusService"),"):"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-typescript"}),"initializeCounter() {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".eventBusService.send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'counter::total'"),", body, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"error, message"),") =>")," {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Handle reply"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (message && message.body) {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"let")," localAction = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," CounterActions.ResetAction();\n            localAction.payload = message.body; ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Total value"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".store.dispatch(localAction);\n        }\n    });\n}\n")),Object(o.a)("h3",{id:"actions-distribution-through-publishsubscribe"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#actions-distribution-through-publishsubscribe"})),"Actions distribution through Publish/Subscribe"),Object(o.a)("p",null,"Ac\xadtion dis\xadtri\xadb\xadu\xadtion/sync uses the ",Object(o.a)("strong",{parentName:"p"},"pub\xadlish/sub\xadscribe")," pat\xadtern."),Object(o.a)("p",null,"Counter ac\xadtions are pub\xadlished from the client to the event bus at the ad\xaddress ",Object(o.a)("strong",{parentName:"p"},"counter::ac\xadtions"),"."),Object(o.a)("p",null,"Any client that have sub\xadscribed to ",Object(o.a)("strong",{parentName:"p"},"counter::ac\xadtions")," ad\xaddress will re\xadceive the ac\xadtions and re\xaddis\xadpatch them lo\xadcally to im\xadpact app states/re\xadduc\xaders."),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"/assets/blog/vertx-realtime-angular-ngrx/vertx-publish-subscribe.png",alt:"Vertx Publish Subscribe"}))),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Source: ",Object(o.a)("a",Object(n.a)({parentName:"em"},{href:"https://www.slideshare.net/RedHatDevelopers/vertx-microservices-were-never-so-easy-clement-escoffier"}),"https://www.slideshare.net/Red\xadHat\xadDe\xadvel\xadop\xaders/vertx-\u200bmicroservices-were-never-so-easy-clement-escoffier"))),Object(o.a)("p",null,"Here is an ex\xadtract of the cor\xadre\xadspond\xading code (from ",Object(o.a)("inlineCode",{parentName:"p"},"AppEventBusService"),"):"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-typescript"}),"publishAction(action: RemoteAction) {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (action.publishedByUser) {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"console"),".error(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"This action has already been published"'),");\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n    }\n    action.publishedByUser = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".currentUser;\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".eventBusService.publish(action.eventBusAddress, action);\n}\nsubscribeToActions(eventBusAddress: ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"string"),") {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".eventBusService.registerHandler(eventBusAddress, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"error, message"),") =>")," {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Handle message from subscription"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (message.body.publishedByUser === ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".currentUser) {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Ignore action sent by current manager"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n        }\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"let")," localAction = message.body;\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".store.dispatch(localAction);\n    });\n}\n")),Object(o.a)("p",null,"The event bus pub\xadlish\xading logic is achieved through a sim\xadple Ngrx Ef\xadfects. Any ac\xadtions that ex\xadtend ",Object(o.a)("inlineCode",{parentName:"p"},"RemoteAction")," class will be pub\xadlished to the event bus."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-typescript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Injectable"),"()\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"export")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class")," AppEventBusEffects {\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"constructor"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-params"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," actions$: Actions, ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," appEventBusService: AppEventBusService"),") {}\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Listen to all actions and publish remote actions to account event bus"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Effect"),"({dispatch: ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),"}) remoteAction$ = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".actions$\n        .filter(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"action")," =>")," action ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"instanceof")," RemoteAction && action.publishedByUser == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"undefined"),")\n        .do(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"action: RemoteAction"),") =>")," {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".appEventBusService.publishAction(action);\n        });\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Effect"),"({dispatch: ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),"}) login$ = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".actions$\n        .ofType(UserActionTypes.LOGIN)\n        .do(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"() =>")," {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"this"),".appEventBusService.connect();\n        });\n}\n")),Object(o.a)("p",null,"You can see all of this in ac\xadtion by lo\xadcally launch\xading the server and the client app in two sep\xada\xadrate browser win\xaddows."),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"/assets/blog/vertx-realtime-angular-ngrx/demo-app-screen.png",alt:"Demo app screen"}))),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Bonus: the demo app also in\xadcludes user sta\xadtus (of\xadfline/on\xadline), based of the event bus con\xadnec\xadtion sta\xadtus.")),Object(o.a)("p",null,"The counter state is shared and syn\xadchro\xadnized be\xadtween con\xadnected clients and each local ac\xadtion is dis\xadtrib\xaduted in real-\u200btime to other clients."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Mis\xadsion ac\xadcom\xadplished!")),Object(o.a)("p",null,"[NOTE Type\xadscript ver\xadsion of Vertx Event\xadBus Client |\xa0The app uses our own Type\xadscript ver\xadsion of the of\xadfi\xadcial JS ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"Vertx Event\xadBus Client"),". It can be found ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gist.github.com/benorama/93373c3c1c3574732d6cc1b4754aab9f"}),"here"),", any feed\xadback, im\xadprove\xadment sug\xadges\xadtions are wel\xadcome!]"))}m.isMDXComponent=!0},"0JQy":function(e,a){var t="[\\ud800-\\udfff]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",s="\\ud83c[\\udffb-\\udfff]",c="[^\\ud800-\\udfff]",r="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+n+"|"+s+")"+"?",i="[\\ufe0e\\ufe0f]?"+l+("(?:\\u200d(?:"+[c,r,o].join("|")+")[\\ufe0e\\ufe0f]?"+l+")*"),p="(?:"+[c+n+"?",n,r,o,t].join("|")+")",m=RegExp(s+"(?="+s+")|"+p+i,"g");e.exports=function(e){return e.match(m)||[]}},"0ZTe":function(e,a,t){var n=t("wy8a"),s=t("quyA"),c=t("Em2t"),r=t("dt0z");e.exports=function(e){return function(a){a=r(a);var t=s(a)?c(a):void 0,o=t?t[0]:a.charAt(0),l=t?n(t,1).join(""):a.slice(1);return o[e]()+l}}},"280p":function(e,a,t){"use strict";var n,s,c=t("q1tI"),r=t.n(c);t("17x9");var o=(s=n=function(e){function a(t){!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,a);var n=function(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?e:a}(this,e.call(this,t));return n.url=t.url,n.file=t.file,n.stylesheetAdded=!1,n.state={loading:!0,gistContent:""},n}return function(e,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}(a,e),a.__nextGist=function(){return"embed_gist_callback_"+a.__gistCallbackId++},a.__addStylesheet=function(e){if(!this.stylesheetAdded){var a=document.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=e,document.head.appendChild(a),this.stylesheetAdded=!0}},a.prototype.componentDidMount=function(){this._buildGist()},a.prototype._getID=function(){return this.url.match(/(\.com\/)(.*?)([^#]+)/).pop()},a.prototype._getFile=function(){if(null!=this.file)return"&file="+this.file;var e=this.url.split("#").pop();return null!=e.match(/file*/)?"&file="+e.replace("file-","").replace("-","."):""},a.prototype._tranformedURL=function(e){return"https://gist.github.com/"+this._getID()+".json?callback="+e+this._getFile()},a.prototype._buildGist=function(){var e=this,t=a.__nextGist();window[t]=function(t){a.__addStylesheet(t.stylesheet),e.setState({loading:!1,gistContent:t.div})};var n=document.createElement("script");n.type="text/javascript",n.src=this._tranformedURL(t),document.head.appendChild(n)},a.prototype.render=function(){return this.state.loading?r.a.createElement("div",null,"...waiting for Gist..."):r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.gistContent}})},a}(r.a.PureComponent),n.__gistCallbackId=0,s);o.propTypes={},a.a=o},"2Ici":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3.3.2 is released !",category:"releases",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"We have just released Vert.x 3.3.2, the first bug fix release of Vert.x 3.3.x."}),i=[{term:"releas",tf:9},{term:"bug",tf:5},{term:"http",tf:5},{term:"note",tf:4},{term:"com",tf:4},{term:"wiki",tf:4},{term:"fix",tf:3},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"first",tf:2},{term:"discov",tf:2},{term:"not",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"distribut",tf:2},{term:"just",tf:1},{term:"coupl",tf:1},{term:"new",tf:1},{term:"tag",tf:1},{term:"announc",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We have just re\xadleased Vert.x 3.3.2, the first bug fix re\xadlease of Vert.x 3.3.x."),Object(o.a)("p",null,"We have first re\xadleased 3.3.1 that fixed a few bugs, but a cou\xadple of new bugs were dis\xadcov\xadered after 3.3.1 was tagged but not an\xadnounced, we de\xadcided to re\xadlease a 3.3.2 to fix the dis\xadcov\xadered bugs, as these bugs were pre\xadvent\xading usage of Vert.x."),Object(o.a)("p",null,"Vert.x 3.3.1 re\xadlease notes:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.3.1---Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.3.1-\u200b\u2014Release-Notes"))),Object(o.a)("p",null,"Vert.x 3.3.2 re\xadlease notes:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.3.2-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.3.2-\u200bRelease-Notes"))),Object(o.a)("p",null,"These re\xadleases do not con\xadtain break\xading changes."),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.3.2%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.3.2/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"Happy cod\xading !"))}m.isMDXComponent=!0},"34c/":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x fall conferences",category:"guides",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"A lot of Vert.x conferences are planned this fall around the world, here is a quick recap of these events."}),i=[{term:"reactiv",tf:8},{term:"30",tf:5},{term:"sep",tf:4},{term:"00",tf:4},{term:"12",tf:3},{term:"microservic",tf:3},{term:"clement",tf:3},{term:"escoffi",tf:3},{term:"11",tf:2},{term:"19",tf:2},{term:"20",tf:2},{term:"22",tf:2},{term:"confer",tf:2},{term:"wednesdai",tf:2},{term:"julien",tf:2},{term:"viet",tf:2},{term:"burr",tf:2},{term:"sutter",tf:2},{term:"thursdai",tf:2},{term:"applic",tf:2},{term:"go",tf:2},{term:"yanaga",tf:2},{term:"18",tf:1},{term:"21",tf:1},{term:"45",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"A lot of Vert.x con\xadfer\xadences are planned this fall around the world, here is a quick recap of these events:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Java\xadZone",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://2016.javazone.no/program/lets-build-a-scalable-async-vert-x-app-in-60-min"}),"Let\u2019s build a scal\xadable async Vert.x app in < 60 min")," - Paulo Lopes (Wednes\xadday, 18:20 - 19:20)"))),Object(o.a)("li",{parentName:"ul"},"Geecon Re\xadac\xadtive in Sopot",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://2016.reactive.geecon.org/#bio"}),"Re\xadac\xadtive back-\u200bpressure with Vert.x")," - Julien Viet (9th of Sep\xadtem\xadber, 11:45 - 12:30)"))),Object(o.a)("li",{parentName:"ul"},"JavaOne",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"Re\xadac\xadtive Mi\xadcroser\xadvices with Vert.x - Burr Sut\xadter (Thurs\xadday, Sep 22, 4:00 p.m. - 5:00 p.m.)"),Object(o.a)("li",{parentName:"ul"},"Re\xadac\xadtive Dis\xadtrib\xaduted Ap\xadpli\xadca\xadtions with Vert.x - Clement Es\xadcoffier (Wednes\xadday, Sep 21, 8:30 a.m. - 9:30 a.m.)"),Object(o.a)("li",{parentName:"ul"},"Vert.x: From Zero to (Micro-\u200b) Hero (Hands-\u200bon Lab) - Clement Es\xadcoffier (Thurs\xadday, Sep 22, 12:00 p.m. - 2:00 p.m.)"),Object(o.a)("li",{parentName:"ul"},"Go Re\xadac\xadtive with Vert.x in Or\xada\xadcle Ap\xadpli\xadca\xadtion Con\xadtainer Cloud - Edson Yanaga (Mon\xadday, Sep 19, 5:30 p.m. - 6:30 p.m.)"))),Object(o.a)("li",{parentName:"ul"},"Re\xadac\xadtive Sum\xadmit",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://reactivesummit2016.sched.org/event/7emt/reactive-polyglot-microservices-with-openshift-and-vertx"}),"Re\xadac\xadtive Poly\xadglot Mi\xadcroser\xadvices with Open\xadShift and Vert.x")," - Clement Es\xadcoffier (Tues\xadday, Oc\xadto\xadber 4, 11:20am - 12:10pm)"))),Object(o.a)("li",{parentName:"ul"},"De\xadvoxx BE",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://cfp.devoxx.be/2016/talk/BED-6160/Better_performance_with_HTTP%2F2"}),"Bet\xadter per\xadfor\xadmance with HTTP/2")," - Julien Viet"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://cfp.devoxx.be/2016/talk/HKC-9910/Reactive_Microservices_with_Vert.x"}),"Re\xadac\xadtive Mi\xadcroser\xadvices with Vert.x")," - Edi\xadson Yanaga and Burr Sut\xadter")))),Object(o.a)("p",null,"If you are going at one of these con\xadfer\xadences, don\u2019t miss the op\xadpor\xadtu\xadnity to learn more about Vert.x!"))}m.isMDXComponent=!0},"4CLo":function(e,a){e.exports="/_next/static/images/async-data-c780b9683ec86dccca771696e6a63318.png"},"4PoU":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Send web requests and assert results with vertx-junit5-web-client",category:"guides",authors:[{name:"Francesco Guardiani",github_id:"slinkydeveloper"}],summary:"In this blog post, you'll learn how to use the new vertx-junit5-web-client module to send web requests in your unit tests and to make assertions."}),i=[{term:"web",tf:3},{term:"client",tf:3},{term:"request",tf:3},{term:"call",tf:2},{term:"test",tf:2},{term:"assert",tf:2},{term:"us",tf:2},{term:"send",tf:2},{term:"last",tf:1},{term:"releas",tf:1},{term:"ad",tf:1},{term:"new",tf:1},{term:"modul",tf:1},{term:"bring",tf:1},{term:"inject",tf:1},{term:"provid",tf:1},{term:"api",tf:1},{term:"simplifi",tf:1},{term:"creation",tf:1},{term:"will",tf:1},{term:"respons",tf:1},{term:"receiv",tf:1},{term:"suc",tf:1},{term:"correctli",tf:1},{term:"propag",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"In the last Vert.x 3.8 re\xadlease, we added a new mod\xadule called ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-junit5-web-client"),", that brings ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web-client/java/"}),"Vert.x Web Client")," in\xadjec\xadtion\ninto tests and pro\xadvides an API called ",Object(o.a)("inlineCode",{parentName:"p"},"TestRequest")," to sim\xadplify the cre\xadation and as\xadser\xadtions on ",Object(o.a)("inlineCode",{parentName:"p"},"WebClient")," re\xadquests:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-reasonml"}),"import static io.vertx.junit5.web.TestRequest.*;\n\n@",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"ExtendWith({\n  VertxExtension.",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"class"),", ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-operator"}),"/"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-operator"}),"/")," VertxExtension MUST ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"be")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"configured")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"before")," VertxWebClientExtension\n  VertxWebClientExtension.",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"class"),"\n})"),"\npublic ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class")," TestRequestExample {\n\n  @Test\n  public void test1(WebClient client, VertxTestContext testContext) {\n    test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Request(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"client"),", HttpMethod.GET, ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"/hello"'),")")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Build the request"),"\n      .",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"with"),"(\n        query",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Param(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"name"'),", ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"francesco"'),")"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Add query param"),"\n        request",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Header(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"x-my"'),", ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"foo"'),")")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Add request header"),"\n      )\n      .expect(\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Assert that response is a JSON with a specific body"),"\n        json",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"BodyResponse(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"new")," JsonObject()"),".put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"value"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello Francesco!"'),")),\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Assert that response contains a particular header"),"\n        response",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Header(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"x-my"'),", ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"bar"'),")"),"\n      )\n      .send(testContext); ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Complete (or fail) the VertxTestContext"),"\n  }\n\n}\n")),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"testRequest()")," will use Vert.x Web Client to send the re\xadquest. When the re\xadsponse is re\xadceived, It suc\xadceds the test or it cor\xadrectly prop\xada\xadgates as\xadser\xadtion fail\xadures, if any."),Object(o.a)("p",null,"You can also send mul\xadti\xadple re\xadquests using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/apidocs/io/vertx/junit5/Checkpoint.html"}),Object(o.a)("inlineCode",{parentName:"a"},"Checkpoint")),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-pgsql"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," static io.vertx.junit5.web.TestRequest.*;\n\n@ExtendWith({\n  VertxExtension.",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class"),", // VertxExtension MUST be configured ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"before")," VertxWebClientExtension\n  VertxWebClientExtension.",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class"),"\n})\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"class")," MultiTestRequestExample {\n\n  @Test\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"void")," test2(WebClient client, VertxTestContext testContext) {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"Checkpoint")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"checkpoint")," = testContext.",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"checkpoint"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"2"),"); // ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"Create")," the ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"Checkpoint")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"to")," flag ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"when")," request succeds\n\n    testRequest(\n        client    // ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"Create")," the test request ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"using")," WebClient APIs\n          .",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"get"),'("/hello")\n          .addQueryParam("name", "francesco")\n          .putHeader("x-my", "foo")\n      )\n      .expect(\n        jsonBodyResponse(',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"new"),' JsonObject().put("value", "Hello Francesco!")),\n        responseHeader("x-my", "bar")\n      )\n      .send(testContext, ',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"checkpoint"),"); // Pass the ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"checkpoint")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"to")," flag\n\n    testRequest(\n        client\n          .",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"get"),'("/hello")\n          .addQueryParam("name", "julien")\n          .putHeader("x-my", "foo")\n      )\n      .expect(\n        jsonBodyResponse(',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"new"),' JsonObject().put("value", "Hello Julien!")),\n        responseHeader("x-my", "bar")\n      )\n      .send(testContext, ',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"checkpoint"),");\n  }\n\n}\n")),Object(o.a)("p",null,"Look at ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-junit5-web-client/java/"}),"Vert.x JUnit 5 Web Client doc\xadu\xadmen\xadta\xadtion")," for more de\xadtails"))}m.isMDXComponent=!0},"4Sve":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 4 milestone 4 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"The new milestone of Vert.x 4 makes progress in futurisation and includes improvements on the mail client, general clients, and security."}),i=[{term:"client",tf:12},{term:"mileston",tf:8},{term:"releas",tf:7},{term:"http",tf:5},{term:"io",tf:5},{term:"improv",tf:4},{term:"us",tf:4},{term:"verticl",tf:4},{term:"auth",tf:4},{term:"featur",tf:3},{term:"develop",tf:3},{term:"mail",tf:3},{term:"blog",tf:3},{term:"announc",tf:2},{term:"seri",tf:2},{term:"provid",tf:2},{term:"distribut",tf:2},{term:"callback",tf:2},{term:"model",tf:2},{term:"progress",tf:2},{term:"modul",tf:2},{term:"support",tf:2},{term:"within",tf:2},{term:"share",tf:2},{term:"limit",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce the fourth 4.0 mile\xadstone re\xadlease of Eclipse Vert.x ."),Object(o.a)("p",null,"Vert.x 4 is the evo\xadlu\xadtion of the Vert.x 3.x se\xadries that will bring key fea\xadtures to Vert.x."),Object(o.a)("p",null,"This re\xadlease aims to pro\xadvide a re\xadli\xadable dis\xadtri\xadb\xadu\xadtion of the cur\xadrent de\xadvel\xadop\xadment of Vert.x 4 for peo\xadple that\nwant to try it and pro\xadvide feed\xadback."),Object(o.a)("h2",{id:"futurisation"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#futurisation"})),"Futurisation"),Object(o.a)("p",null,"Vert.x 4 ex\xadtends the 3.x call\xadback asyn\xadchro\xadnous model to a fu\xadture/call\xadback hy\xadbrid model."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"NetClient")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Since 3.0"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host, Handler<AsyncResult<NetSocket>> handler)")),";\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// New in 4.0"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Future<NetSocket> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host)")),";\n}\n")),Object(o.a)("p",null,"This third mile\xadstone makes progress and fully cov\xaders with the fol\xadlow\xading stack mod\xadules:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Vert.x Shell"),Object(o.a)("li",{parentName:"ul"},"Vert.x Mail Client"),Object(o.a)("li",{parentName:"ul"},"Vert.x Con\xadsul Client"),Object(o.a)("li",{parentName:"ul"},"Vert.x Rab\xadbitMQ Client"),Object(o.a)("li",{parentName:"ul"},"Vert.x Stomp"),Object(o.a)("li",{parentName:"ul"},"Vert.x Mongo Client")),Object(o.a)("h2",{id:"mail-client-improvements"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#mail-client-improvements"})),"Mail client improvements"),Object(o.a)("p",null,"Our mail clients had nice con\xadtri\xadbu\xadtion with the abil\xadity to use stream\xading pay\xadload for at\xadtache\xadments and the\nsup\xadport for DKIM sig\xadna\xadtures."),Object(o.a)("h2",{id:"general-client-improvements"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#general-client-improvements"})),"General client improvements"),Object(o.a)("p",null,"Some Vert.x clients are de\xadsigned to be used within the ver\xadti\xadcle that cre\xadated it while some can be shared be\xadtween\nver\xadti\xadcles. This is a tech\xadni\xadcal lim\xadi\xadta\xadtion that stems from the fact that client are im\xadple\xadmented using Vert.x or Netty\n(such as ",Object(o.a)("inlineCode",{parentName:"p"},"HttpClient"),") and are bound to the un\xadder\xadly\xading event-\u200bloop that pow\xaders them."),Object(o.a)("p",null,"In Vert.x 4 we de\xadcided to get away of this lim\xadi\xadta\xadtion to sim\xadplify the usage and the con\xadfig\xadu\xadra\xadtion of the clients. Of course\nit is pos\xadsi\xadble to con\xadtinue con\xadfin\xading clients within a ver\xadti\xadcle (for best per\xadfor\xadmance) but clients can be now shared be\xadtween\nver\xadti\xadcles when de\xadsired with a ne\xadglectible im\xadpact on per\xadfor\xadmance (re\xadquir\xading mes\xadsage pass\xading)."),Object(o.a)("h2",{id:"security-improvements"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#security-improvements"})),"Security improvements"),Object(o.a)("p",null,"Fi\xadnally here are a few im\xadprove\xadments done in our se\xadcu\xadrity layer:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Vertx Auth is now de\xadcou\xadpled to han\xaddle authn/authz as 2 in\xadde\xadpen\xaddent func\xadtions thanks to @sbas\xadtian\xaddev"),Object(o.a)("li",{parentName:"ul"},"Auth Shiro is dep\xadre\xadcated in favour of the new \u201cauth prop\xader\xadties\u201d mod\xadule and \u201cauth ldap\u201d"),Object(o.a)("li",{parentName:"ul"},"Web CSRF to\xadkens are ses\xadsion aware to allow mul\xadti\xadple re\xadquests from the same user"),Object(o.a)("li",{parentName:"ul"},"Ini\xadtial sup\xadport for we\xadbau\xadthn")),Object(o.a)("h2",{id:"ramping-up-to-vertx-4"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#ramping-up-to-vertx-4"})),"Ramping up to Vert.x 4"),Object(o.a)("p",null,"In\xadstead of de\xadvel\xadop\xading all new fea\xadtures ex\xadclu\xadsively in Vert.x 4, we in\xadtro\xadduce some of these fea\xadtures in the 3.x branch\nso the com\xadmu\xadnity can ben\xade\xadfit from them. The Vert.x 4 de\xadvel\xadop\xadment focus on more fun\xadda\xadmen\xadtal changes that can\xadnot be done\nin the 3.x se\xadries."),Object(o.a)("img",{src:"{{ site_url }}assets/blog/vertx-4-milestone4-release/vertx-4-timeline.png",alt:"Screenshot",class:"img-responsive"}),Object(o.a)("p",null,"This is the forth mile\xadstone of Vert.x 4, you can of course ex\xadpect more mile\xadstones to out\xadline the progress of the ef\xadfort."),Object(o.a)("p",null,"You can also read the pre\xadvi\xadous mile\xadstone an\xadnounces:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://vertx.io/blog/eclipse-vert-x-4-milestone-3-released"}),"https://vertx.io/blog/eclipse-\u200bvert-x-4-\u200bmilestone-3-\u200breleased")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://vertx.io/blog/eclipse-vert-x-4-milestone-2-released"}),"https://vertx.io/blog/eclipse-\u200bvert-x-4-\u200bmilestone-2-\u200breleased")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://vertx.io/blog/eclipse-vert-x-4-milestone-1-released"}),"https://vertx.io/blog/eclipse-\u200bvert-x-4-\u200bmilestone-1-\u200breleased"))),Object(o.a)("h2",{id:"finally"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finally"})),"Finally"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes"),"\ncan be found on the wiki."),Object(o.a)("p",null,"For this re\xadlease there are no Docker im\xadages.,"),Object(o.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://search.maven.org/search?q=g:io.vertx%20AND%20v:4.0.0-milestone4"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://repo1.maven.org/maven2/io/vertx/vertx-stack-manager/4.0.0-milestone4/"}),"Maven Cen\xadtral"),"."),Object(o.a)("p",null,"You can boot\xadstrap a Vert.x 4.0.0-\u200bmilestone4 project using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(o.a)("p",null,"The doc\xadu\xadmen\xadta\xadtion has been de\xadployed on this pre\xadview web-\u200bsite ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx-ci.github.io/vertx-4-preview/docs/"}),"https://vertx-\u200bci.github.io/vertx-\u200b4-\u200bpreview/docs/")),Object(o.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},"4hdO":function(e,a,t){"use strict";function n(e){document.body.scrollTop=document.documentElement.scrollTop=e}function s(e,a){requestAnimationFrame||n(e);var t=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop);if(t!==e){var s=e-t,c=void 0;requestAnimationFrame((function e(r){c||(c=r);var o=r-c,l=Math.min(1,o/a);n(t+s*(l*(2-l))),l<1&&requestAnimationFrame(e)}))}}t.d(a,"a",(function(){return s}))},"4nW3":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 3.9.0 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"New features include fluent queries in SQL clients, a new Redis client, an updated Kafka client, an improved Future API, and many more things."}),i=[{term:"client",tf:11},{term:"api",tf:11},{term:"chang",tf:7},{term:"cooki",tf:7},{term:"kafka",tf:6},{term:"site",tf:5},{term:"deprec",tf:5},{term:"releas",tf:4},{term:"queri",tf:4},{term:"break",tf:4},{term:"new",tf:4},{term:"user",tf:4},{term:"version",tf:3},{term:"redi",tf:3},{term:"upcom",tf:3},{term:"will",tf:3},{term:"upgrad",tf:3},{term:"admin",tf:3},{term:"edn",tf:3},{term:"disabl",tf:3},{term:"default",tf:3},{term:"warn",tf:3},{term:"avail",tf:3},{term:"sql",tf:2},{term:"fluent",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce that the Eclipse Vert.x ver\xadsion 3.9.0 has been re\xadleased."),Object(o.a)("h2",{id:"sql-client-fluent-queries"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#sql-client-fluent-queries"})),"SQL Client fluent queries"),Object(o.a)("p",null,"The query API be\xadcomes flu\xadent with the ad\xaddi\xadtion of a ",Object(o.a)("inlineCode",{parentName:"p"},"Query")," API for queries cre\xadation and con\xadfig\xadu\xadra\xadtion."),Object(o.a)("p",null,"Col\xadlec\xadtors query now be\xadcomes part of the ",Object(o.a)("inlineCode",{parentName:"p"},"Query")," in\xadter\xadface."),Object(o.a)("p",null,"This is a break\xading API change done under the tech pre\xadview sta\xadtus given that SQL client is a Vert.x 4 fea\xadture back-\u200bported to Vert.x 3."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"client.prepareQuery(sql).execute(tuple, ar -> ...);\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// With a collector"),"\nclient.preparedQuery(sql).collecting(Collectors.toList()).execute(tuple, ar -> ...);\n")),Object(o.a)("p",null,"You can read more about this new fea\xadture ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.0-Deprecations-and-breaking-changes#fluent-query-api"}),"here"),"."),Object(o.a)("h2",{id:"redis-client-backport"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#redis-client-backport"})),"Redis client backport"),Object(o.a)("p",null,"For Vert.x 4.0 we are doing a full re\xadboot to the redis client. The func\xadtion\xadal\xadity for the new client is ready to test on the mas\xadter branch. In order to give users the op\xadpor\xadtu\xadnity to test and make the up\xadcom\xading client even bet\xadter it has been back\xadported to the 3.9.0 re\xadlease. The new client will allow users to con\xadnect to a sin\xadgle node, sen\xadtinel or clus\xadter of redis nodes. The eas\xadi\xadest way to start is:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Redis.createClient(\n      vertx,\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RedisOptions()\n        .setConnectionString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"redis://localhost:7006"'),"))\n      .send(Request.cmd(Command.PING), send -> {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (send.succeeded()) {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Should have received a pong..."),"\n        }\n      });\n")),Object(o.a)("h2",{id:"same-site-cookies"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#same-site-cookies"})),"Same-site cookies"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://tools.ietf.org/html/draft-west-first-party-cookies-07"}),Object(o.a)("inlineCode",{parentName:"a"},"SameSite")," Cookie")," pol\xadicy has been added to the HTTP Server Cook\xadies."),Object(o.a)("p",null,"This is also ap\xadplic\xada\xadble to web which al\xadlows cookie ses\xadsions to use ",Object(o.a)("inlineCode",{parentName:"p"},"SameSite")," cook\xadies:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"SessionHandler.create(store)\n  .setCookieSameSite(CookieSameSite.STRICT);\n")),Object(o.a)("p",null,"Same-\u200bsite cook\xadies let servers re\xadquire that a cookie shouldn\u2019t be sent with cross-\u200bsite (where Site is de\xadfined by the reg\xadis\xadtra\xadble do\xadmain) re\xadquests,\nwhich pro\xadvides some pro\xadtec\xadtion against cross-\u200bsite re\xadquest forgery at\xadtacks (CSRF)."),Object(o.a)("h2",{id:"kafka-client-upgrade"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#kafka-client-upgrade"})),"Kafka client upgrade"),Object(o.a)("p",null,"The Kafka client has been up\xadgraded to Kafka 2.4.0 ."),Object(o.a)("p",null,"Our re\xadac\xadtive client ex\xadposes the Kafka Admin API. As of 2.4.0 this API has been re\xadplaced by a new Kafka Admin API and there\xadfore\nthe Vert.x Kafka Admin API changes, e.g list\xading con\xadsumers groups"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"adminClient.listConsumerGroups(ar -> {\n    System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"ConsumerGroups= "')," + ar.result());\n});\n")),Object(o.a)("h2",{id:"future-api"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#future-api"})),"Future API"),Object(o.a)("p",null,"With the re\xadcent ad\xaddi\xadtion of ",Object(o.a)("inlineCode",{parentName:"p"},"Future#onComplete(...)")," sup\xadport\xading sev\xaderal han\xaddlers per ",Object(o.a)("inlineCode",{parentName:"p"},"Future")," in 3.9 made the\n",Object(o.a)("inlineCode",{parentName:"p"},"Future#setHandler(...)")," method feel awk\xadward. In\xaddeed ",Object(o.a)("inlineCode",{parentName:"p"},"setHandler")," con\xadveys the mean\xading that the ",Object(o.a)("inlineCode",{parentName:"p"},"Future")," man\xadages\na sin\xadgle han\xaddler. In 3.9 we dep\xadre\xadcate ",Object(o.a)("inlineCode",{parentName:"p"},"Future#setHandler")," in favor of ",Object(o.a)("inlineCode",{parentName:"p"},"Future#onComplete"),"."),Object(o.a)("h2",{id:"edns-disabled-by-default"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#edns-disabled-by-default"})),"EDNS disabled by default"),Object(o.a)("p",null,"EDNS is an ex\xadten\xadsion mech\xada\xadnism for DNS (",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://fr.wikipedia.org/wiki/EDNS"}),"https://fr.wikipedia.org/wiki/EDNS"),") that should be dis\xadabled by de\xadfault. It might\ncause un\xadwanted issue and should be dis\xadabled by de\xadfault."),Object(o.a)("h2",{id:"auth-deprecation-warnings"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#auth-deprecation-warnings"})),"Auth Deprecation warnings"),Object(o.a)("p",null,"As of 3.9.0 many APIs will be start warn\xading about dep\xadre\xadca\xadtions. There is a big refac\xadtor\xading and some break\xading API changes com\xading\non 4.0.0 and these warn\xadings are just to give users a heads up that API will change on the up\xadcom\xading ver\xadsion."),Object(o.a)("p",null,"For more in\xadfor\xadma\xadtion about the up\xadcom\xading 4.0 changes you can read ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"4.0.0-\u200bDeprecations-and-breaking-changes")),Object(o.a)("h2",{id:"dependency-upgrades"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#dependency-upgrades"})),"Dependency upgrades"),Object(o.a)("p",null,"In 3.9 we up\xaddate a few ver\xadsions:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Netty 4.1.48.Final"),Object(o.a)("li",{parentName:"ul"},"Jack\xadson 2.10.2"),Object(o.a)("li",{parentName:"ul"},"Guava 25.1-jre"),Object(o.a)("li",{parentName:"ul"},"GraphQL Java 14")),Object(o.a)("h2",{id:"finally"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finally"})),"Finally"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.0-Release-Notes"}),"3.9.0 re\xadlease notes")," can be found on the wiki, as well as the\nlist of ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.9.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes")),Object(o.a)("p",null,"Docker im\xadages are avail\xadable on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),"."),Object(o.a)("p",null,"The Vert.x dis\xadtri\xadb\xadu\xadtion can be down\xadloaded on the web\xadsite but is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"The event bus client using the SockJS bridge is avail\xadable from:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"NPM")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"Bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"We\xadb\xadJars"))),Object(o.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.9.0%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.9.0/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},"5B1d":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Writing secure Vert.x Web apps",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"This is a starting guide for securing Vert.x web applications. Standard rules and practices apply to Vert.x apps as if they would to any other web framework."}),i=[{term:"will",tf:8},{term:"run",tf:8},{term:"applic",tf:6},{term:"secur",tf:5},{term:"start",tf:4},{term:"web",tf:4},{term:"no",tf:4},{term:"just",tf:4},{term:"server",tf:4},{term:"us",tf:4},{term:"session",tf:4},{term:"csrf",tf:4},{term:"upload",tf:4},{term:"alwai",tf:3},{term:"on",tf:3},{term:"privileg",tf:3},{term:"try",tf:3},{term:"code",tf:3},{term:"set",tf:3},{term:"browser",tf:3},{term:"request",tf:3},{term:"cooki",tf:3},{term:"header",tf:3},{term:"protect",tf:3},{term:"handler",tf:3}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"This is a start\xading guide for se\xadcur\xading vert.x web ap\xadpli\xadca\xadtions. It is by no means a com\xadpre\xadhen\xadsive guide on web ap\xadpli\xadca\xadtion se\xadcu\xadrity such as ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.owasp.org"}),"OWASP"),". Stan\xaddard rules and prac\xadtices apply to vert.x apps as if they would to any other web frame\xadwork."),Object(o.a)("p",null,"The post will cover the items that al\xadways seem to come up on fo\xadrums."),Object(o.a)("h2",{id:"dont-run-as-root"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#dont-run-as-root"})),"Don\u2019t run as root"),Object(o.a)("p",null,"It is a com\xadmon prac\xadtise that your de\xadvops team mem\xadber will con\xadstantly say, one shall run a ser\xadvice with the least amount of priv\xadi\xadleges nec\xades\xadsary and no more. Al\xadthough this might sound like folk\xadlore to less ex\xadpe\xadri\xadenced de\xadvel\xadop\xaders that hit an issue when try\xading to run on priv\xadi\xadleged ports 80, 443, run\xadning as root solves it quickly but open a door to big\xadger prob\xadlems. Lets look at this code:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"App")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n\n    Router router = Router.router(vertx);\n\n    router.route().handler(StaticHandler.create(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'""'),"));\n\n    vertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"80"),");\n  }\n}\n\n")),Object(o.a)("p",null,"When started with the ",Object(o.a)("inlineCode",{parentName:"p"},"CWD")," set to ",Object(o.a)("inlineCode",{parentName:"p"},"/")," (",Object(o.a)("inlineCode",{parentName:"p"},"java -Dvertx.cwd=/ ..."),") you just cre\xadated a sim\xadple file server for all your server stor\xadage. Now imag\xadine that you want to start this ap\xadpli\xadca\xadtion you will hit the error:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),"Aug 26, 2015 2:02:18 PM io.vertx.core.http.impl.HttpServerImpl\nSEVERE: java.net.SocketException: Permission denied\n")),Object(o.a)("p",null,"So if you do now run as ",Object(o.a)("inlineCode",{parentName:"p"},"root")," it will start, how\xadever in your browser now try to nav\xadi\xadgate to: ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost/etc/shadow")," con\xadgrat\xadu\xadla\xadtions you just ex\xadposed your server ",Object(o.a)("inlineCode",{parentName:"p"},"logins")," ",Object(o.a)("strong",{parentName:"p"},"and")," ",Object(o.a)("inlineCode",{parentName:"p"},"passwords"),"!"),Object(o.a)("p",null,"There are sev\xaderal ways to run as a under priv\xadi\xadleged user, you can use ",Object(o.a)("inlineCode",{parentName:"p"},"iptables")," to for\xadward re\xadquests to higher ports, use ",Object(o.a)("inlineCode",{parentName:"p"},"authbind"),", run be\xadhind a proxy like ",Object(o.a)("inlineCode",{parentName:"p"},"ngnix"),", etc\u2026"),Object(o.a)("h2",{id:"sessions"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#sessions"})),"Sessions"),Object(o.a)("p",null,"Many ap\xadpli\xadca\xadtions are going to deal with user ses\xadsions at some point."),Object(o.a)("p",null,"Ses\xadsion cook\xadies should have the ",Object(o.a)("inlineCode",{parentName:"p"},"SECURE")," and ",Object(o.a)("inlineCode",{parentName:"p"},"HTTPOnly")," flags set. This en\xadsures that they can only be sent over ",Object(o.a)("inlineCode",{parentName:"p"},"HTTPS")," (you are using ",Object(o.a)("inlineCode",{parentName:"p"},"HTTPS")," right?) and there is no script ac\xadcess to the cookie client side:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Router router = Router.router(vertx);\n\nrouter.route().handler(CookieHandler.create());\nrouter.route().handler(SessionHandler\n    .create(LocalSessionStore.create(vertx))\n    .setCookieHttpOnlyFlag(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),")\n    .setCookieSecureFlag(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),")\n);\n\nrouter.route().handler(routingContext -> {\n\n  Session session = routingContext.session();\n\n  Integer cnt = session.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hitcount"'),");\n  cnt = (cnt == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null")," ? ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0")," : cnt) + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),";\n\n  session.put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hitcount"'),", cnt);\n\n  routingContext.response().end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hitcount: "')," + cnt);\n});\n\nvertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(o.a)("p",null,"And in this case when in\xadspect\xading your browser you should see:"),Object(o.a)("img",{src:t("zTRB"),alt:"nocookie"}),Object(o.a)("p",null,"Of course if you do not do that any script on your browser has the ca\xadpa\xadbil\xadity of read\xading, sniff\xading hi\xadjack\xading or tam\xadper\xading your ses\xadsions."),Object(o.a)("h2",{id:"security-headers"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#security-headers"})),"Security Headers"),Object(o.a)("p",null,"There are plenty of se\xadcu\xadrity head\xaders that help im\xadprove se\xadcu\xadrity with just a cou\xadple of lines of code. There is no need to ex\xadplain them here since there are good ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://recxltd.blogspot.nl/2012/03/seven-web-server-http-headers-that.html"}),"ar\xadti\xadcles")," on\xadline that will prob\xada\xadbly do it bet\xadter than me."),Object(o.a)("p",null,"Here is how one could im\xadple\xadment a cou\xadple of them:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"App")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n\n    Router router = Router.router(vertx);\n    router.route().handler(ctx -> {\n      ctx.response()\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// do not allow proxies to cache the data"),"\n          .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Cache-Control"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"no-store, no-cache"'),")\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// prevents Internet Explorer from MIME - sniffing a"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// response away from the declared content-type"),"\n          .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"X-Content-Type-Options"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"nosniff"'),")\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Strict HTTPS (for about ~6Months)"),"\n          .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Strict-Transport-Security"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"max-age="')," + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"15768000"),")\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// IE8+ do not allow opening of attachments in the context of this resource"),"\n          .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"X-Download-Options"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"noopen"'),")\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// enable XSS for IE"),"\n          .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"X-XSS-Protection"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"1; mode=block"'),")\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// deny frames"),"\n          .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"X-FRAME-OPTIONS"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"DENY"'),");\n    });\n\n    vertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n  }\n}\n")),Object(o.a)("h2",{id:"cross-site-request-forgery-csrf-protection"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#cross-site-request-forgery-csrf-protection"})),"Cross-Site Request Forgery (CSRF) Protection"),Object(o.a)("p",null,"Vert.x web pro\xadvides CSRF pro\xadtec\xadtion using an in\xadcluded han\xaddler. To en\xadable CSRF pro\xadtec\xadtions you need to add it to your router as you would add any other han\xaddler:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"App")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n\n    Router router = Router.router(vertx);\n\n    router.route().handler(CookieHandler.create());\n    router.route().handler(SessionHandler\n        .create(LocalSessionStore.create(vertx))\n        .setCookieSecureFlag(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),")\n    );\n    router.route().handler(CSRFHandler.create(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"not a good secret"'),"));\n\n    router.route().handler(ctx -> {\n      ...\n    });\n")),Object(o.a)("p",null,"The han\xaddler adds a CSRF token to re\xadquests which mu\xadtate state. In order change the state a (",Object(o.a)("inlineCode",{parentName:"p"},"XSRF-TOKEN"),") cookie is set with a unique token, that is ex\xadpected to be sent back in a (",Object(o.a)("inlineCode",{parentName:"p"},"X-XSRF-TOKEN"),") header."),Object(o.a)("h2",{id:"limit-uploads"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#limit-uploads"})),"Limit uploads"),Object(o.a)("p",null,"When deal\xading with up\xadloads ",Object(o.a)("strong",{parentName:"p"},"al\xadways")," de\xadfine a upper bound, oth\xader\xadwise you will be vul\xadner\xada\xadble to ",Object(o.a)("inlineCode",{parentName:"p"},"DDoS")," at\xadtacks. For ex\xadam\xadple lets say that you have the fol\xadlow\xading code:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"App")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n\n    Router router = Router.router(vertx);\n\n    router.route().handler(BodyHandler.create());\n\n    router.route().handler(ctx -> {\n      ...\n")),Object(o.a)("p",null,"Now a bad in\xadten\xadtioned per\xadson could gen\xader\xadate a ran\xaddom file with 1GB of trash:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-routeros"}),"dd ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"if"),"=/dev/urandom ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"of"),"=ddos ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"bs"),"=1G ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"count"),"=1\n")),Object(o.a)("p",null,"And then up\xadload it to your server:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-nginx"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"curl")," --data-binary ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"',Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-variable"}),"@ddos"),'"')," -H ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Content-Type: application/octet-stream"')," -X POST http://localhost:8080/\n")),Object(o.a)("p",null,"Your ap\xadpli\xadca\xadtion will hap\xadpily try to han\xaddle this until one of 2 things hap\xadpens, it will run out of disk space or mem\xadory. In order to mit\xadi\xadgate these kind of at\xadtacks al\xadways spec\xadify the max\xadi\xadmum al\xadlowed up\xadload size:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"App")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," KB = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1024"),";\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," MB = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1024")," * KB;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n\n    Router router = Router.router(vertx);\n    router.route().handler(BodyHandler.create().setBodyLimit(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"50")," * MB));\n")),Object(o.a)("h2",{id:"final-words"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#final-words"})),"Final Words"),Object(o.a)("p",null,"Al\xadthough this is just a small list of things you should re\xadmem\xadber when im\xadple\xadment\xading your ap\xadpli\xadca\xadtion there are more com\xadpre\xadhen\xadsive check\xadlists to check:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project"}),"OWASP Top Ten Project")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.owasp.org/index.php/Preventing_SQL_Injection_in_Java"}),"Pre\xadvent\xading SQL In\xadjec\xadtion in Java")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.owasp.org/index.php/Testing_for_NoSQL_injection"}),"Test\xading for NoSQL in\xadjec\xadtion"))))}m.isMDXComponent=!0},"6acW":function(e,a,t){var n=t("dt0z"),s=t("gQMU");e.exports=function(e){return s(n(e).toLowerCase())}},"7ljp":function(e,a,t){"use strict";t.d(a,"a",(function(){return b}));var n=t("q1tI"),s=t.n(n);function c(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){c(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var i=s.a.createContext({}),p=function(e){var a=s.a.useContext(i),t=a;return e&&(t="function"===typeof e?e(a):o(o({},a),e)),t},m={inlineCode:"code",wrapper:function(e){var a=e.children;return s.a.createElement(s.a.Fragment,{},a)}},j=s.a.forwardRef((function(e,a){var t=e.components,n=e.mdxType,c=e.originalType,r=e.parentName,i=l(e,["components","mdxType","originalType","parentName"]),j=p(t),b=n,h=j["".concat(r,".").concat(b)]||j[b]||m[b]||c;return t?s.a.createElement(h,o(o({ref:a},i),{},{components:t})):s.a.createElement(h,o({ref:a},i))}));function b(e,a){var t=arguments,n=a&&a.mdxType;if("string"===typeof e||n){var c=t.length,r=new Array(c);r[0]=j;var o={};for(var l in a)hasOwnProperty.call(a,l)&&(o[l]=a[l]);o.originalType=e,o.mdxType="string"===typeof e?e:n,r[1]=o;for(var i=2;i<c;i++)r[i]=t[i];return s.a.createElement.apply(null,r)}return s.a.createElement.apply(null,t)}j.displayName="MDXCreateElement"},"8HTu":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Intro to Vert.x Shell",category:"guides",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"Vert.x Shell provides an extensible command line for Vert.x, accessible via SSH, Telnet or a nice Web interface. Vert.x Shell comes out of the box with plenty of commands."}),i=[{term:"command",tf:16},{term:"shell",tf:13},{term:"http",tf:6},{term:"client",tf:6},{term:"us",tf:4},{term:"deploi",tf:3},{term:"on",tf:3},{term:"configur",tf:3},{term:"will",tf:3},{term:"just",tf:3},{term:"argument",tf:3},{term:"implement",tf:3},{term:"support",tf:3},{term:"provid",tf:2},{term:"extens",tf:2},{term:"line",tf:2},{term:"telnet",tf:2},{term:"simpl",tf:2},{term:"verticl",tf:2},{term:"list",tf:2},{term:"start",tf:2},{term:"document",tf:2},{term:"servic",tf:2},{term:"test",tf:2},{term:"easi",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Vert.x Shell pro\xadvides an ex\xadten\xadsi\xadble com\xadmand line for Vert.x, ac\xadces\xadsi\xadble via SSH, Tel\xadnet or a nice Web in\xadter\xadface. Vert.x Shell comes out of the box with plenty of com\xadmands for Vert.x which makes it very handy for doing sim\xadple man\xadage\xadment op\xader\xada\xadtions like de\xadploy\xading a Ver\xadti\xadcle or get\xadting the list of de\xadployed Ver\xadti\xadcles. One power fea\xadture of Vert.x Shell is its ex\xadten\xadsi\xadbil\xadity: one can eas\xadily aug\xadment Vert.x Shell with its own com\xadmands. Let\u2019s build an ",Object(o.a)("em",{parentName:"p"},"http-\u200bclient")," in JavaScript!"),Object(o.a)("h2",{id:"booting-the-shell"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#booting-the-shell"})),"Booting the Shell"),Object(o.a)("p",null,"Vert.x Shell can be started in a cou\xadple of lines de\xadpend\xading on the con\xadnec\xadtors you con\xadfig\xadure. The doc\xadu\xadmen\xadta\xadtion pro\xadvides sev\xaderal ex\xadam\xadples show\xading the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-shell/js/#_programmatic_service"}),"Shell Ser\xadvice con\xadfig\xadu\xadra\xadtion"),". For test\xading our com\xadmand, we will use the Tel\xadnet pro\xadto\xadcol be\xadcause it is easy to con\xadfig\xadure and use, so we just need to copy the cor\xadre\xadspond\xading sec\xadtion in ",Object(o.a)("em",{parentName:"p"},"vertx-\u200bhttp-client.js"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," ShellService = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"require"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-shell-js/shell_service"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," service = ShellService.create(vertx, {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"telnetOptions"')," : {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"host"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),",\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"port"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"4000"),"\n  }\n});\nservice.start();\n")),Object(o.a)("p",null,"We can run it:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),"Juliens-MacBook-Pro:java julien$ vertx run vertx-http-client.js\nSucceeded in deploying verticle\n")),Object(o.a)("p",null,"And con\xadnect to the shell:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),"Juliens-MacBook-Pro:~ julien$ telnet localhost 4000\nTrying ::1...\ntelnet: connect to address ::1: Connection refused\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\n__      __ ______  _____  _______  __   __\n\\ \\    / /|  ____||  _  \\|__   __| \\ \\ / /\n \\ \\  / / | |____ | :_) |   | |     \\   /\n  \\ \\/ /  |  ____||   __/   | |      > /\n   \\  /   | |____ | |\\ \\    | |     / //\\\n    \\/    |______||_| \\_\\   |_| o  /_/ \\_\\\n\n\n%\n")),Object(o.a)("p",null,"You can now al\xadready use the shell, the ",Object(o.a)("em",{parentName:"p"},"help")," com\xadmand lists the avail\xadable com\xadmands."),Object(o.a)("h2",{id:"creating-a-command"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#creating-a-command"})),"Creating a command"),Object(o.a)("p",null,"For the sake of sim\xadplic\xadity we will write a sin\xadgle script that starts the Shell ser\xadvice and de\xadploys our com\xadmand. In the real world you would prob\xada\xadbly have the com\xadmand in one file and the de\xadploy\xadment in an\xadother."),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-shell/js/#_extending_vert_x_shell"}),"doc\xadu\xadmen\xadta\xadtion")," ex\xadplains how to add a new com\xadmand to Vert.x shell, we can just copy this sec\xadtion and ap\xadpend it to the ",Object(o.a)("em",{parentName:"p"},"vertx-\u200bhttp-client.js")," script:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," CommandBuilder = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"require"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-shell-js/command_builder"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," CommandRegistry = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"require"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-shell-js/command_registry"'),");\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," builder = CommandBuilder.command(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http-client"'),");\nbuilder.processHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"process"),") "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Write a message to the console"),"\n  process.write(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Implement the client\\n"'),");\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// End the process"),"\n  process.end();\n});\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Register the command"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," registry = CommandRegistry.getShared(vertx);\nregistry.registerCommand(builder.build(vertx));\n")),Object(o.a)("p",null,"Now you can use the com\xadmand just to see it in ac\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"% http-client\nImplement the client\n%\n")),Object(o.a)("h2",{id:"checking-arguments"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#checking-arguments"})),"Checking arguments"),Object(o.a)("p",null,"The ",Object(o.a)("em",{parentName:"p"},"http-\u200bclient")," re\xadquires an ",Object(o.a)("inlineCode",{parentName:"p"},"url")," ar\xadgu\xadment, an ar\xadgu\xadment check is per\xadformed at the be\xadgin\xadning of the process han\xaddler:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Check the url argument"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (process.args().length < ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),") {\n  process.write(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Missing URL\\n"'),").end();\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n}\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," url = process.args()[",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"];\n")),Object(o.a)("h2",{id:"implementing-the-command"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implementing-the-command"})),"Implementing the command"),Object(o.a)("p",null,"The final step of this tu\xadto\xadr\xadial is the ac\xadtual im\xadple\xadmen\xadta\xadtion of the client logic based on Vert.x Http\xadClient:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Create the client request"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," request = client.getAbs(url, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"response"),") "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Print the response in the shell console"),"\n  response.handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"buffer"),") "),"{\n    process.write(buffer.toString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"UTF-8"'),"));\n  });\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// End the command when the response ends"),"\n  response.endHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n    process.end();\n  });\n});\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Set a request handler to end the command with error"),"\nrequest.exceptionHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"err"),") "),"{\n  process.write(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Error: "')," + err.getMessage());\n  process.end();\n});\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// End the http request"),"\nrequest.end();\n")),Object(o.a)("p",null,"And we can test the com\xadmand in the shell:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"% http-client http://vertx.io\nhttp-client http://vertx.io\n<!DOCTYPE html><html lang=en><head><title>Vert.x</title>...\n...\n/javascripts/sticky_header.js><\/script></body></html>%\n")),Object(o.a)("h2",{id:"finally"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finally"})),"Finally"),Object(o.a)("p",null,"We have seen how easy it is to ex\xadtend Vert.x with a shell and cre\xadate an ",Object(o.a)("em",{parentName:"p"},"http-\u200bclient")," cus\xadtom com\xadmand, you can get the full source code ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gist.github.com/vietj/51ff223bfb7cfcbc97ce"}),"here"),"."),Object(o.a)("p",null,"Our com\xadmand is very sim\xadple, it only im\xadple\xadments the very min\xadi\xadmum, in fu\xadture posts we will im\xadprove the com\xadmand with sup\xadport with more HTTP meth\xadods, SSL sup\xadport or header sup\xadport with the the Vert.x CLI API."))}m.isMDXComponent=!0},"9LB0":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3 Web easy as Pi",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"Vert.x Web distinguishes itself from traditional application servers like JavaEE by just being a simple extension toolkit to Vert.x, which makes it quite lightweight and small but nevertheless very powerful."}),i=[{term:"applic",tf:7},{term:"server",tf:7},{term:"messag",tf:6},{term:"start",tf:6},{term:"code",tf:5},{term:"creat",tf:4},{term:"let",tf:4},{term:"address",tf:4},{term:"web",tf:3},{term:"simpl",tf:3},{term:"on",tf:3},{term:"exampl",tf:3},{term:"realtim",tf:3},{term:"app",tf:3},{term:"static",tf:3},{term:"sockj",tf:3},{term:"bridg",tf:3},{term:"data",tf:3},{term:"make",tf:2},{term:"small",tf:2},{term:"cpu",tf:2},{term:"load",tf:2},{term:"visual",tf:2},{term:"need",tf:2},{term:"collect",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/#web"}),"Vert.x Web")," dis\xadtin\xadguishes it\xadself from tra\xaddi\xadtional ap\xadpli\xadca\xadtion servers like JavaEE by just\nbeing a sim\xadple ex\xadten\xadsion toolkit to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/#core"}),"Vert.x"),", which makes it quite light\xadweight and small but\nnev\xader\xadthe\xadless very pow\xader\xadful."),Object(o.a)("p",null,"One can cre\xadate sim\xadple ap\xadpli\xadca\xadtions tar\xadget\xading ",Object(o.a)("em",{parentName:"p"},"small")," de\xadvices such as Rasp\xadberry Pi with\xadout hav\xading to write much code but\nstill very fast as it is ex\xadpected from any Vert.x ap\xadpli\xadca\xadtion."),Object(o.a)("p",null,"Let\u2019s for ex\xadam\xadple think of mak\xading a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pmlopes/vert-x3-experiments/archive/experiments/rpi-cpuload.zip"}),"re\xadal\xadtime cpu load vi\xadsu\xadal\xadiza\xadtion web app"),".\nFor this ex\xadam\xadple we need a few things:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"a ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://docs.oracle.com/javase/7/docs/api/java/lang/management/OperatingSystemMXBean.html"}),"MXBean")," to col\xadlect CPU load"),Object(o.a)("li",{parentName:"ul"},"a ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-core/java/#_writing_http_servers_and_clients"}),"HTTP server")," (to serve the sta\xadtic re\xadsources and host our app)"),Object(o.a)("li",{parentName:"ul"},"a ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-web/java/#_sockjs"}),"SockJS server")," to pro\xadvide re\xadal\xadtime up\xaddates"),Object(o.a)("li",{parentName:"ul"},"a SockJS to ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-web/java/#_sockjs_event_bus_bridge"}),"Event\xadBus bridge")," to pass mes\xadsages around"),Object(o.a)("li",{parentName:"ul"},"some ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://d3js.org/"}),"vi\xadsu\xadal\xadiza\xadtion")," JS li\xadbrary"),Object(o.a)("li",{parentName:"ul"},"a bit of cod\xading")),Object(o.a)("p",null,"To boot\xadstrap this project we start by cre\xadat\xading the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pmlopes/vert-x3-experiments/blob/experiments/rpi-cpuload/pom.xml"}),"pom.xml"),"\nfile. A good start is al\xadways to con\xadsult the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples"}),"ex\xadam\xadples"),",\nand you should end up with some\xadthing like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),"...\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx.blog",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"rpi",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependencies"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-core",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-web",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependencies"),">"),"\n...\n")),Object(o.a)("p",null,"At this mo\xadment you can start cod\xading the ap\xadpli\xadca\xadtion using the stan\xaddard maven source ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/java")," and re\xadsource\n",Object(o.a)("inlineCode",{parentName:"p"},"src/main/resouces")," lo\xadca\xadtions. And add a the class ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pmlopes/vert-x3-experiments/blob/experiments/rpi-cpuload/src/main/java/io/vertx/blog/RPiVerticle.java"}),"io.vertx.blog.RpiVer\xadti\xadcle"),"\nto the project:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"RPiVerticle")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," OperatingSystemMXBean osMBean;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"try")," {\n      osMBean = ManagementFactory.newPlatformMXBeanProxy(ManagementFactory.getPlatformMBeanServer(),\n          ManagementFactory.OPERATING_SYSTEM_MXBEAN_NAME, OperatingSystemMXBean.class);\n    } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"catch")," (IOException e) {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"throw")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RuntimeException(e);\n    }\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n\n    Router router = Router.router(vertx);\n\n    router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/eventbus/*"'),").handler(SockJSHandler.create(vertx)\n        .bridge(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," BridgeOptions().addOutboundPermitted(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," PermittedOptions().setAddress(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"load"'),"))));\n\n    router.route().handler(StaticHandler.create());\n\n    vertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n\n    vertx.setPeriodic(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1000"),", t -> vertx.eventBus().publish(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"load"'),",\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()\n            .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"creatTime"'),", System.currentTimeMillis())\n            .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"cpuTime"'),", osMBean.getSystemLoadAverage())));\n  }\n}\n")),Object(o.a)("p",null,"So let\u2019s go through the code, first in the sta\xadtic con\xadstruc\xadtor we ini\xadtial\xadize the ",Object(o.a)("inlineCode",{parentName:"p"},"MXBean")," that will allow us to col\xadlect\nthe cur\xadrent ",Object(o.a)("inlineCode",{parentName:"p"},"System Load Average"),", then on the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method we cre\xadate a ",Object(o.a)("inlineCode",{parentName:"p"},"Vert.x Web Router")," and de\xadfine that for all\nre\xadquests start\xading with ",Object(o.a)("inlineCode",{parentName:"p"},"/eventbus")," should be han\xaddled by the SockJS server, which we then bridge to the Vert.x\n",Object(o.a)("inlineCode",{parentName:"p"},"EventBus")," and allow out\xadbound mes\xadsages ad\xaddressed to the ",Object(o.a)("inlineCode",{parentName:"p"},"load")," ad\xaddress."),Object(o.a)("p",null,"Since our ap\xadpli\xadca\xadtion is a web ap\xadpli\xadca\xadtion we will also server some sta\xadtic con\xadtent with the ",Object(o.a)("inlineCode",{parentName:"p"},"StaticHandler")," and we\nfi\xadnally start a ",Object(o.a)("inlineCode",{parentName:"p"},"HTTP server")," lis\xadten\xading on port ",Object(o.a)("inlineCode",{parentName:"p"},"8080"),"."),Object(o.a)("p",null,"So now all we are miss\xading is a way to push real time data to the client so we end up cre\xadat\xading a ",Object(o.a)("inlineCode",{parentName:"p"},"Periodic")," task that\nre\xadpeats every 1000 mil\xadlisec\xadonds and sends some ",Object(o.a)("inlineCode",{parentName:"p"},"JSON")," pay\xadload to the ad\xaddress ",Object(o.a)("inlineCode",{parentName:"p"},'"load"'),"."),Object(o.a)("p",null,"If you run this ap\xadpli\xadca\xadtion right now you won\u2019t see much since there is no fron\xadtend yet, so let\u2019s build a very basic\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pmlopes/vert-x3-experiments/blob/experiments/rpi-cpuload/src/main/resources/webroot/index.html"}),"index.html"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"...\nvar eb = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," vertx.EventBus(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"window"),".location + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"eventbus"'),");\n\neb.onopen = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n  eb.registerHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"load"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"msg"),") "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (data.length === ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"25"),") {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// when length of data equal 25 then pop data[0]"),"\n      data.shift();\n    }\n    data.push({\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"creatTime"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"Date"),"(msg.creatTime),\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"cpuTime"'),": msg.cpuTime\n    });\n    render();\n  });\n};\n...\n")),Object(o.a)("p",null,"Let\u2019s walk again the code, we start by open\xading a ",Object(o.a)("inlineCode",{parentName:"p"},"EventBus")," bridge over ",Object(o.a)("inlineCode",{parentName:"p"},"SockJS")," and reg\xadis\xadter a han\xaddler ",Object(o.a)("inlineCode",{parentName:"p"},"data")," to con\xadsume\nmes\xadsages sent to that ad\xaddress. Once such a mes\xadsage ar\xadrives we do some house keep\xading to avoid fill\xading our browser mem\xadory\nand then add the in\xadcom\xading mes\xadsage to the data queue and triger a ren\xadder\xading of the data. There is how\xadever one in\xadter\xadest\xading\nissue here, since the mes\xadsage pay\xadload is ",Object(o.a)("inlineCode",{parentName:"p"},"JSON")," there is no na\xadtive sup\xadport for ",Object(o.a)("inlineCode",{parentName:"p"},"Date")," ob\xadjects so we need to do some\npars\xading from what ar\xadrives from the server. In this case the server sends a sim\xadple time since epoch num\xadber, but one can\nchoose any for\xadmat he likes."),Object(o.a)("p",null,"At this mo\xadment you can build and pack\xadage your app like ",Object(o.a)("inlineCode",{parentName:"p"},"mvn clean package"),", then de\xadploy it to your rasp\xadber\xadrypi like:\n",Object(o.a)("inlineCode",{parentName:"p"},"scp target/rpi-1.0-fat.jar pi@raspberrypi:~/")," and fi\xadnally run it: ",Object(o.a)("inlineCode",{parentName:"p"},"java -jar rpi-1.0-fat.jar"),"."),Object(o.a)("p",null,"Open a browser to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://raspberrypi:8080"}),"see")," the re\xadal\xadtime graph!"),Object(o.a)("p",null,Object(o.a)("img",{src:t("odkl"),alt:"Screenshot"})))}m.isMDXComponent=!0},"9Sms":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3.3.3 is released !",category:"releases",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"We have just released Vert.x 3.3.3, a bug fix release of Vert.x 3.3.x."}),i=[{term:"releas",tf:5},{term:"http",tf:4},{term:"com",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"note",tf:2},{term:"github",tf:2},{term:"x3",tf:2},{term:"wiki",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"distribut",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1},{term:"issu",tf:1},{term:"event",tf:1},{term:"us",tf:1},{term:"sockj",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We have just re\xadleased Vert.x 3.3.3, a bug fix re\xadlease of Vert.x 3.3.x."),Object(o.a)("p",null,"Since the re\xadlease of Vert.x 3.3.2, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(o.a)("p",null,"Vert.x 3.3.3 re\xadlease notes:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.3.3---Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.3.3-\u200b\u2014Release-Notes"))),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.3.3%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.3.3/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"Happy cod\xading !"))}m.isMDXComponent=!0},ACoj:function(e,a,t){"use strict";var n=t("q1tI"),s=t.n(n),c=t("YFqc"),r=t.n(c),o=(t("Agq3"),s.a.createElement);a.a=function(e){var a=e.href,t=e.as,n=e.children,s=void 0===n?o("a",null,"Read more"):n;return o("span",{className:"read-more-link"},o(r.a,{href:a,as:t},s))}},AiqT:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 3.8.4",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This version is a bug fix release of Vert.x 3.8.3, which addresses quite a few bugs reported by the community."}),i=[{term:"releas",tf:5},{term:"http",tf:5},{term:"com",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"note",tf:2},{term:"github",tf:2},{term:"x3",tf:2},{term:"wiki",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1},{term:"issu",tf:1},{term:"artifact",tf:1},{term:"deploi",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We have just re\xadleased Vert.x 3.8.4, a bug fix re\xadlease of Vert.x 3.8.x."),Object(o.a)("p",null,"Since the re\xadlease of Vert.x 3.8.3, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(o.a)("p",null,"Vert.x 3.8.4 re\xadlease notes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.4-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.4-\u200bRelease-Notes"))),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.4/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.4 project using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},BuQJ:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"The RSS reader tutorial",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"In this tutorial, you will learn how to use the Eclipse Vert.x Cassandra client in practice. We will develop an RSS reader with three HTTP endpoints."}),i=[{term:"feed",tf:12},{term:"rss",tf:11},{term:"cassandra",tf:8},{term:"endpoint",tf:8},{term:"run",tf:7},{term:"first",tf:7},{term:"method",tf:7},{term:"start",tf:6},{term:"link",tf:6},{term:"will",tf:6},{term:"implement",tf:6},{term:"user",tf:5},{term:"not",tf:5},{term:"step",tf:5},{term:"schema",tf:5},{term:"initi",tf:5},{term:"read",tf:4},{term:"app",tf:4},{term:"storag",tf:4},{term:"articl",tf:4},{term:"fetch",tf:4},{term:"complet",tf:4},{term:"tutori",tf:3},{term:"find",tf:3},{term:"look",tf:3}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"This tu\xadto\xadr\xadial is ded\xadi\xadcated for users who\u2019d like to know how to use the Eclipse Vert.x Cas\xadsan\xaddra client in prac\xadtice."),Object(o.a)("h2",{id:"before-you-start-this-tutorial"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#before-you-start-this-tutorial"})),"Before you start this tutorial"),Object(o.a)("p",null,"Be\xadfore start\xading, you should"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"be fa\xadmil\xadiar with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/"}),"Eclipse Vert.x"),". If you are not, here is the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/guide-for-java-devs/"}),"guide for Java de\xadvel\xadop\xaders"),".")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"have some basic un\xadder\xadstand\xading of data\xadbases. Ex\xadtended knowl\xadedge of Cas\xadsan\xaddra is not re\xadquired."))),Object(o.a)("p",null,"You also may find it use\xadful to read ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://validator.w3.org/feed/docs/rss2.html"}),"the RSS 2.0")," spec\xadi\xadfi\xadca\xadtion, be\xadcause the re\xadsulted app is, ba\xadsi\xadcally, a stor\xadage of RSS 2.0 feeds."),Object(o.a)("p",null,"To give you an idea of what the App is about, here is how it looks like from the fronted side:"),Object(o.a)("img",{src:"https://i.imgur.com/2V954zx.png",alt:"see how it looks",className:"img-fluid"}),Object(o.a)("p",null,"In the image, we see that browser space is split into 2 parts:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"Saved feed names"),Object(o.a)("li",{parentName:"ol"},"List of ar\xadti\xadcles for the se\xadlected feed")),Object(o.a)("p",null,"Here you also can enter a link to a new feed, so the App will fetch and parse the feed.\nAfter that, it will ap\xadpear in the left col\xadumn along with other saved feeds."),Object(o.a)("h2",{id:"requirements"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#requirements"})),"Requirements"),Object(o.a)("p",null,"For com\xadplet\xading this tu\xadto\xadr\xadial you need:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Java 8 or higher"),Object(o.a)("li",{parentName:"ul"},"Git"),Object(o.a)("li",{parentName:"ul"},"1 hour of your time"),Object(o.a)("li",{parentName:"ul"},"You fa\xadvorite code ed\xadi\xadtor")),Object(o.a)("p",null,"For run\xadning the ex\xadam\xadple you should en\xadsure that Cas\xadsan\xaddra ser\xadvice is run\xadning lo\xadcally on port 9042.\nAs an op\xadtion, you can run Cas\xadsan\xaddra with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/riptano/ccm#installation"}),"ccm"),"(Cas\xadsan\xaddra Clus\xadter Man\xadager).\nFol\xadlow ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/riptano/ccm#installation"}),"this")," in\xadstruc\xadtions for in\xadstalling ccm.\nAfter in\xadstalling you will be able to run a sin\xadgle node clus\xadter:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," ccm create rss_reader -v 3.11.2 -n 1 -s"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," ccm start"),"\n")),Object(o.a)("p",null,"Be\xadfore com\xadplet\xading this step make sure that you have suc\xadcess\xadfully cloned the RSS reader repos\xadi\xadtory and checked out the ",Object(o.a)("inlineCode",{parentName:"p"},"step_1")," branch:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-built_in"}),"clone")," https://github.com/Sammers21/rss-reader"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-built_in"}),"cd")," rss-reader"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_1"),"\n")),Object(o.a)("p",null,"Now you can try to tun this ex\xadam\xadple and see if it works:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," ./gradlew vertxRun"),"\n")),Object(o.a)("h2",{id:"schema"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#schema"})),"Schema"),Object(o.a)("p",null,"If you are fa\xadmil\xadiar with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://cassandra.apache.org/"}),"Apache Cas\xadsan\xaddra"),", you\nshould know that the way your data is stored in Cas\xadsan\xaddra is de\xadpen\xaddent on queries\nyou are run\xadning. It means that you need first to fig\xadure out what kind of queries\nyou will be run\xadning, and then you can pro\xadduce a stor\xadage scheme."),Object(o.a)("p",null,"In our case, we\u2019d like our ap\xadpli\xadca\xadtion to have 3 end\xadpoints:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"POST /user/{user_id}/rss_link")," - for adding links to a user\u2019s feed"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"GET /user/{user_id}/rss_channels")," - for re\xadtriev\xading in\xadfor\xadma\xadtion about RSS chan\xadnels a user sub\xadscribed on"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"GET /articles/by_rss_link?link={rss_link}")," - for re\xadtriev\xading in\xadfor\xadma\xadtion about ar\xadti\xadcles on a spe\xadcific RSS chan\xadnel")),Object(o.a)("p",null,"For im\xadple\xadment\xading this end\xadpoints, the schema should look as fol\xadlows:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"CREATE")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"TABLE")," rss_by_user (login ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text")," , rss_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", PRIMARY ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"KEY")," (login, rss_link));\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"CREATE")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"TABLE")," articles_by_rss_link(rss_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", pubDate ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"timestamp"),", title ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", article_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", description ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", PRIMARY ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"KEY")," ( rss_link , pubDate , article_link));\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"CREATE")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"TABLE")," channel_info_by_rss_link(rss_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", last_fetch_time ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"timestamp"),",title ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", site_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", description ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"text"),", PRIMARY ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"KEY"),"(rss_link));\n")),Object(o.a)("h2",{id:"what-to-do-in-this-step"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#what-to-do-in-this-step"})),"What to do in this step"),Object(o.a)("p",null,"In this step, we will im\xadple\xadment only the first end\xadpoint"),Object(o.a)("h2",{id:"project-overview"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#project-overview"})),"Project overview"),Object(o.a)("p",null,"There are two no\xadtable classes in the project: ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle")," and ",Object(o.a)("inlineCode",{parentName:"p"},"FetchVerticle"),". The first one is a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-core/java/#_verticles"}),"Ver\xadti\xadcle")," re\xadspon\xadsi\xadble for HTTP re\xadquest han\xaddling and stor\xadage schema ini\xadtial\xadiza\xadtion. The sec\xadond one is a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-core/java/#_verticles"}),"Ver\xadti\xadcle")," as well, but re\xadspon\xadsi\xadble for RSS feeds fetch\xading."),Object(o.a)("p",null,"The idea is sim\xadple. When the ap\xadpli\xadca\xadtion is start\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle")," is de\xadployed, then it tries to ini\xadtial\xadize stor\xadage schema, de\xadscribed in ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/resources/schema.cql")," file by read\xading it and ex\xade\xadcut\xading listed queries line by line. After the schema ini\xadtial\xadiza\xadtion the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle")," de\xadploys ",Object(o.a)("inlineCode",{parentName:"p"},"FetchVerticle")," and starts a HTTP server."),Object(o.a)("h2",{id:"implementing-the-endpoint"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implementing-the-endpoint"})),"Implementing the endpoint"),Object(o.a)("p",null,"Now, it is time to im\xadple\xadment the first end\xadpoint. Pay at\xadten\xadtion to ",Object(o.a)("inlineCode",{parentName:"p"},"TODO"),"s, they are for point\xading you out about where changes should be made."),Object(o.a)("p",null,"Now, let\u2019s have a look at the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle#postRssLink")," method. This method is called each time the first end\xadpoint is called, so we can fig\xadure out what is the posted body and id of the user, who per\xadformed the re\xadquest, di\xadrectly there. There are 2 main things we want to do in this method:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"No\xadti\xadfy\xading via the ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://vertx.io/docs/vertx-core/java/#event_bus"}),"Event Bus")," the ",Object(o.a)("inlineCode",{parentName:"li"},"FetchVerticle")," to fetch given by user link link to an RSS feed."),Object(o.a)("li",{parentName:"ol"},"In\xadsert\xading an entry to the ",Object(o.a)("inlineCode",{parentName:"li"},"rss_by_user")," table.")),Object(o.a)("p",null,"This is how the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle#postRssLink")," method should be im\xadple\xadmented:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"postRssLink"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    ctx.request().bodyHandler(body -> {\n        JsonObject bodyAsJson = body.toJsonObject();\n        String link = bodyAsJson.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"link"'),");\n        String userId = ctx.request().getParam(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"user_id"'),");\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (link == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null")," || userId == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n            responseWithInvalidRequest(ctx);\n        } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            vertx.eventBus().send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"fetch.rss.link"'),", link);\n            Future<ResultSet> future = Future.future();\n            BoundStatement query = insertNewLinkForUser.bind(userId, link);\n            client.execute(query, future);\n            future.setHandler(result -> {\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (result.succeeded()) {\n                    ctx.response().end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"message"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"The feed just added"'),").toString());\n                } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n                    ctx.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"400"),").end(result.cause().getMessage());\n                }\n            });\n        }\n    });\n}\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"responseWithInvalidRequest"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    ctx.response()\n            .setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"400"),")\n            .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json; charset=utf-8"'),")\n            .end(invalidRequest().toString());\n}\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," JsonObject ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"invalidRequest"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"message"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Invalid request"'),");\n}\n")),Object(o.a)("p",null,"You may no\xadtice that ",Object(o.a)("inlineCode",{parentName:"p"},"insertNewLinkForUser")," is a ",Object(o.a)("inlineCode",{parentName:"p"},"PreparedStatement"),", and should be ini\xadtial\xadized be\xadfore the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle")," start. Let\u2019s do it in the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle#prepareNecessaryQueries")," method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Future<Void> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"prepareNecessaryQueries"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    Future<PreparedStatement> insertNewLinkForUserPrepFuture = Future.future();\n    client.prepare(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO rss_by_user (login , rss_link ) VALUES ( ?, ?);"'),", insertNewLinkForUserPrepFuture);\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," insertNewLinkForUserPrepFuture.compose(preparedStatement -> {\n        insertNewLinkForUser = preparedStatement;\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n    });\n}\n")),Object(o.a)("p",null,"Also, we should not for\xadget to fetch a RSS by the link sent to ",Object(o.a)("inlineCode",{parentName:"p"},"FetchVerticle")," via the Event Bus. We can do it in the ",Object(o.a)("inlineCode",{parentName:"p"},"FetchVerticle#startFetchEventBusConsumer")," method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"vertx.eventBus().localConsumer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"fetch.rss.link"'),", message -> {\n    String rssLink = (String) message.body();\n    log.info(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"fetching "')," + rssLink);\n    webClient.getAbs(rssLink).send(response -> {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (response.succeeded()) {\n            String bodyAsString = response.result().bodyAsString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"UTF-8"'),");\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"try")," {\n                RssChannel rssChannel = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RssChannel(bodyAsString);\n\n                BatchStatement batchStatement = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," BatchStatement();\n                BoundStatement channelInfoInsertQuery = insertChannelInfo.bind(\n                        rssLink, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Date(System.currentTimeMillis()), rssChannel.description, rssChannel.link, rssChannel.title\n                );\n                batchStatement.add(channelInfoInsertQuery);\n\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"for")," (Article article : rssChannel.articles) {\n                    batchStatement.add(insertArticleInfo.bind(rssLink, article.pubDate, article.link, article.description, article.title));\n                }\n                Future<ResultSet> insertArticlesFuture = Future.future();\n                cassandraClient.execute(batchStatement, insertArticlesFuture);\n\n                insertArticlesFuture.compose(insertDone -> Future.succeededFuture());\n            } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"catch")," (Exception e) {\n                log.error(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Unable to fetch: "')," + rssLink, e);\n            }\n        } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            log.error(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Unable to fetch: "')," + rssLink);\n        }\n    });\n});\n")),Object(o.a)("p",null,"And, fi\xadnally, this code would not work if ",Object(o.a)("inlineCode",{parentName:"p"},"insertChannelInfo")," and ",Object(o.a)("inlineCode",{parentName:"p"},"insertArticleInfo")," state\xadments will not be ini\xadtial\xadized at ver\xadti\xadcle start. Let\u2019s to this in the ",Object(o.a)("inlineCode",{parentName:"p"},"FetchVerticle#prepareNecessaryQueries")," method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"})," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Future<Void> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"prepareNecessaryQueries"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n        Future<PreparedStatement> insertChannelInfoPrepFuture = Future.future();\n        cassandraClient.prepare(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO channel_info_by_rss_link ( rss_link , last_fetch_time, description , site_link , title ) VALUES (?, ?, ?, ?, ?);"'),", insertChannelInfoPrepFuture);\n\n        Future<PreparedStatement> insertArticleInfoPrepFuture = Future.future();\n        cassandraClient.prepare(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO articles_by_rss_link ( rss_link , pubdate , article_link , description , title ) VALUES ( ?, ?, ?, ?, ?);"'),", insertArticleInfoPrepFuture);\n\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," CompositeFuture.all(\n                insertChannelInfoPrepFuture.compose(preparedStatement -> {\n                    insertChannelInfo = preparedStatement;\n                    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n                }), insertArticleInfoPrepFuture.compose(preparedStatement -> {\n                    insertArticleInfo = preparedStatement;\n                    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n                })\n        ).mapEmpty();\n    }\n")),Object(o.a)("h2",{id:"observing"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#observing"})),"Observing"),Object(o.a)("p",null,"After all these changes, you should en\xadsure that the first end\xadpoint is work\xading cor\xadrectly. You need to run the ap\xadpli\xadca\xadtion, go to lo\xadcal\xadhost:8080 in\xadsert a link to a rss feed there(",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://feeds.bbci.co.uk/news/uk/rss.xml"}),"BBC UK feed news")," for ex\xadam\xadple) and then click the ",Object(o.a)("em",{parentName:"p"},"ENTER")," but\xadton. Now you can con\xadnect to your local Cas\xadsan\xaddra in\xadstance, for in\xadstance with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://docs.datastax.com/en/cql/3.3/cql/cql_reference/cqlsh.html"}),"cqlsh"),", and find out how RSS feed data had been saved in the rss_reader key\xadspace:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),"cqlsh> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," * ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," rss_reader.rss_by_user ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"limit")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),"  ;\n\n login | rss_link\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"-------+-----------------------------------------"),"\n Pavel | http://feeds.bbci.co.uk/news/uk/rss.xml\n\n(1 rows)\ncqlsh> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," description ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," rss_reader.articles_by_rss_link  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"limit")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),";\n\n description\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"-------------------------------------"),"\n BBC coverage of latest developments\n\n(1 rows)\n")),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"In this ar\xadti\xadcle we fig\xadured out how to im\xadple\xadment the first end\xadpoint of RSS-\u200breader app. If you have any prob\xadlems with com\xadplet\xading this step you can check\xadout to ",Object(o.a)("inlineCode",{parentName:"p"},"step_2"),", where you can find all changes made for com\xadplet\xading this step:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_2"),"\n")),Object(o.a)("p",null,"Thanks for read\xading this. I hope you en\xadjoyed read\xading this ar\xadti\xadcle. See you soon on our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"Git\xadter chan\xadnel"),"!"))}m.isMDXComponent=!0},Dc8p:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return m})),t.d(a,"__tfidf__terms",(function(){return j})),t.d(a,"default",(function(){return h}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("a1bP"),i=t("YFqc"),p=t.n(i),m=(r.a.createElement,{title:"Some Rest with Vert.x",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"This post is part of the Introduction to Vert.x series. Let\u2019s go a bit further this time and develop a CRUD-ish application"}),j=[{term:"let",tf:30},{term:"method",tf:22},{term:"creat",tf:19},{term:"handler",tf:18},{term:"web",tf:17},{term:"bottl",tf:17},{term:"us",tf:16},{term:"api",tf:16},{term:"page",tf:14},{term:"request",tf:14},{term:"post",tf:13},{term:"applic",tf:13},{term:"code",tf:13},{term:"rest",tf:12},{term:"go",tf:10},{term:"just",tf:10},{term:"line",tf:10},{term:"not",tf:9},{term:"implement",tf:9},{term:"set",tf:9},{term:"html",tf:8},{term:"add",tf:8},{term:"object",tf:8},{term:"content",tf:7},{term:"start",tf:7}],b={meta:m,__tfidf__terms:j};function h(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},b,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"This post is part of the ",Object(o.a)("em",{parentName:"p"},"In\xadtro\xadduc\xadtion to Vert.x")," se\xadries. So, let\u2019s have a quick look about the con\xadtent of the pre\xadvi\xadous posts. In ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/my-first-vert-x-3-application",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"the first post")),", we de\xadvel\xadoped a very sim\xadple Vert.x 3 ap\xadpli\xadca\xadtion, and saw how this ap\xadpli\xadca\xadtion can be tested, pack\xadaged and ex\xade\xadcuted. In ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/vert-x-application-configuration",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"the last post")),", we saw how this ap\xadpli\xadca\xadtion be\xadcame con\xadfig\xadurable and how we can use a ran\xaddom port in test."),Object(o.a)("p",null,"Well, noth\xading fancy\u2026 Let\u2019s go a bit fur\xadther this time and de\xadvelop a ",Object(o.a)("em",{parentName:"p"},"CRUD-\u200bish")," ap\xadpli\xadca\xadtion. So an ap\xadpli\xadca\xadtion ex\xadpos\xading an HTML page in\xadter\xadact\xading with the back\xadend using a REST API. The level of ",Object(o.a)("em",{parentName:"p"},"REST\xadfull\xadness")," of the API is not the topic of this post, I let you de\xadcide as it\u2019s a very slip\xadpery topic."),Object(o.a)("p",null,"So, in other words we are going to see:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Vert.x Web - a frame\xadwork that let you cre\xadate Web ap\xadpli\xadca\xadtions eas\xadily using Vert.x"),Object(o.a)("li",{parentName:"ul"},"How to ex\xadpose sta\xadtic re\xadsources"),Object(o.a)("li",{parentName:"ul"},"How to de\xadvelop a REST API")),Object(o.a)("p",null,"The code de\xadvel\xadoped in this post is avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-3"}),"post-3")," branch of this ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app"}),"Github")," project. We are going to start from the  ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-2"}),"post-2")," code\xadbase."),Object(o.a)("p",null,"So, let\u2019s start."),Object(o.a)("h2",{id:"vertx-web"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-web"})),"Vert.x Web"),Object(o.a)("p",null,"As you may have no\xadtices in the pre\xadvi\xadous posts, deal\xading with com\xadplex HTTP ap\xadpli\xadca\xadtion using only Vert.x Core would be kind of cum\xadber\xadsome. That\u2019s the main rea\xadson be\xadhind ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-web/java/"}),"Vert.x Web"),". It makes the de\xadvel\xadop\xadment of Vert.x base web ap\xadpli\xadca\xadtions re\xadally easy, with\xadout chang\xading the phi\xadlos\xado\xadphy."),Object(o.a)("p",null,"To use Vert.x Web, you need to up\xaddate the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file to add the fol\xadlow\xading de\xadpen\xaddency:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-web",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"That\u2019s the only thing you need to use Vert.x Web. Sweet, no ?"),Object(o.a)("p",null,"Let\u2019s now use it. Re\xadmem\xadber, in the pre\xadvi\xadous post, when we re\xadquested http://lo\xadcal\xadhost:8080, we reply a nice ",Object(o.a)("em",{parentName:"p"},"Hello World")," mes\xadsage. Let\u2019s do the same with Vert.x Web.  Open the ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.blog.first.MyFirstVerticle")," class and change the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method to be:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Future<Void> fut)")," "),"{\n ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Create a router object."),"\n Router router = Router.router(vertx);\n\n ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// Bind "/" to our hello message - so we are still compatible.'),"\n router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(routingContext -> {\n   HttpServerResponse response = routingContext.response();\n   response\n       .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),")\n       .end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Hello from my first Vert.x 3 application</h1>"'),");\n });\n\n ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// Create the HTTP server and pass the "accept" method to the request handler.'),"\n vertx\n     .createHttpServer()\n     .requestHandler(router::accept)\n     .listen(\n         ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Retrieve the port from the configuration,"),"\n         ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// default to 8080."),"\n         config().getInteger(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),"),\n         result -> {\n           ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (result.succeeded()) {\n             fut.complete();\n           } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n             fut.fail(result.cause());\n           }\n         }\n     );\n}\n")),Object(o.a)("p",null,"You may be sur\xadprise by the length of this snip\xadpet (in com\xadpar\xadi\xadson to the pre\xadvi\xadous code). But as we are going to see, it will make our app on steroids, just be pa\xadtient."),Object(o.a)("p",null,"As you can see, we start by cre\xadat\xading a ",Object(o.a)("inlineCode",{parentName:"p"},"Router")," ob\xadject. The router is the cor\xadner\xadstone of Vert.x Web. This ob\xadject is re\xadspon\xadsi\xadble for dis\xadpatch\xading the HTTP re\xadquests to the right ",Object(o.a)("em",{parentName:"p"},"han\xaddler"),". Two other con\xadcepts are very im\xadpor\xadtant in Vert.x Web:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Routes - which let you de\xadfine how re\xadquest are dis\xadpatched"),Object(o.a)("li",{parentName:"ul"},"Han\xaddlers - which are the ac\xadtual ac\xadtion pro\xadcess\xading the re\xadquests and writ\xading the re\xadsult. Han\xaddlers can be chained.")),Object(o.a)("p",null,"If you un\xadder\xadstand these 3 con\xadcepts, you have un\xadder\xadstood every\xadthing in Vert.x Web."),Object(o.a)("p",null,"Let\u2019s focus on this code first:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(routingContext -> {\n  HttpServerResponse response = routingContext.response();\n  response\n      .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),")\n      .end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Hello from my first Vert.x 3 application</h1>"'),");\n});\n")),Object(o.a)("p",null,"It ",Object(o.a)("em",{parentName:"p"},"routes")," re\xadquests ar\xadriv\xading on \u201d/\u201d to the given ",Object(o.a)("em",{parentName:"p"},"han\xaddler"),". Han\xaddlers re\xadceive a ",Object(o.a)("inlineCode",{parentName:"p"},"RoutingContext")," ob\xadject. This han\xaddler is quite sim\xadi\xadlar to the code we had be\xadfore, and it\u2019s quite nor\xadmal as it ma\xadnip\xadu\xadlates the same type of ob\xadject: ",Object(o.a)("inlineCode",{parentName:"p"},"HttpServerResponse"),"."),Object(o.a)("p",null,"Let\u2019s now have a look to the rest of the code:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"vertx\n    .createHttpServer()\n    .requestHandler(router::accept)\n    .listen(\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Retrieve the port from the configuration,"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// default to 8080."),"\n        config().getInteger(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),"),\n        result -> {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (result.succeeded()) {\n            fut.complete();\n          } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            fut.fail(result.cause());\n          }\n        }\n    );\n}\n")),Object(o.a)("p",null,"It\u2019s ba\xadsi\xadcally the same code as be\xadfore, ex\xadcept that we change the re\xadquest han\xaddler. We pass ",Object(o.a)("inlineCode",{parentName:"p"},"router::accept")," to the han\xaddler. You may not be fa\xadmil\xadiar with this no\xadta\xadtion. It\u2019s a ref\xader\xadence to a method (here the method ",Object(o.a)("inlineCode",{parentName:"p"},"accept")," from the ",Object(o.a)("inlineCode",{parentName:"p"},"router")," ob\xadject). In other worlds, it in\xadstructs vert.x to call the ",Object(o.a)("inlineCode",{parentName:"p"},"accept")," method of the ",Object(o.a)("inlineCode",{parentName:"p"},"router")," when it re\xadceives a re\xadquest."),Object(o.a)("p",null,"Let\u2019s try to see if this work:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean package\njava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar\n")),Object(o.a)("p",null,"By open\xading ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8080")," in your browser you should see the ",Object(o.a)("em",{parentName:"p"},"Hello")," mes\xadsage. As we didn\u2019t change the be\xadhav\xadior of the ap\xadpli\xadca\xadtion, our tests are still valid."),Object(o.a)("h2",{id:"exposing-static-resources"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#exposing-static-resources"})),"Exposing static resources"),Object(o.a)("p",null,"Ok, so we have a first ap\xadpli\xadca\xadtion using vert.x web. Let\u2019s see some of the ben\xade\xadfits. Let\u2019s start with serv\xading sta\xadtic re\xadsources, such as an ",Object(o.a)("inlineCode",{parentName:"p"},"index.html")," page. Be\xadfore we go fur\xadther, I should start with a dis\xadclaimer: \u201cthe HTML page we are going to see here is ugly like hell : I\u2019m not a UI guy\u201d. I should also add that there are prob\xada\xadbly plenty of bet\xadter ways to im\xadple\xadment this and a myr\xadiad of frame\xadworks I should try, but that\u2019s not the point. I tried to keep things sim\xadple and just re\xadly\xading on JQuery and Twit\xadter Boot\xadstrap, so if you know a bit of JavaScript you can un\xadder\xadstand and edit the page."),Object(o.a)("p",null,"Let\u2019s cre\xadate the HTML page that will be the entry point of our ap\xadpli\xadca\xadtion. Cre\xadate an ",Object(o.a)("inlineCode",{parentName:"p"},"index.html")," page in ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/resources/assets")," with the con\xadtent from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/blob/post-3/src/main/resources/assets/index.html"}),"here"),". As it\u2019s just a HTML page with a bit of JavaScript, we won\u2019t de\xadtail the file here. If you have ques\xadtions, just post com\xadments."),Object(o.a)("p",null,"Ba\xadsi\xadcally, the page is a sim\xadple ",Object(o.a)("em",{parentName:"p"},"CRUD")," UI to man\xadage my col\xadlec\xadtion of ",Object(o.a)("em",{parentName:"p"},"not-\u200byet-finished")," bot\xadtles of Whisky. It was made in a generic way, so you can trans\xadpose it to your own col\xadlec\xadtion. The list of prod\xaduct is dis\xadplayed in the main table. You can cre\xadate a new prod\xaduct, edit one or delete one. These ac\xadtions are re\xadly\xading on a REST API (that we are going to im\xadple\xadment) through AJAX calls. That\u2019s all."),Object(o.a)("p",null,"Once this page is cre\xadated, edit the ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.blog.first.MyFirstVerticle")," class and change the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method to be:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Future<Void> fut)")," "),"{\n Router router = Router.router(vertx);\n router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(routingContext -> {\n   HttpServerResponse response = routingContext.response();\n   response\n       .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),")\n       .end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Hello from my first Vert.x 3 application</h1>"'),");\n });\n\n ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Serve static resources from the /assets directory"),"\n router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/assets/*"'),").handler(StaticHandler.create(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"assets"'),"));\n\n vertx\n     .createHttpServer()\n     .requestHandler(router::accept)\n     .listen(\n         ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Retrieve the port from the configuration,"),"\n         ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// default to 8080."),"\n         config().getInteger(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),"),\n         result -> {\n           ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (result.succeeded()) {\n             fut.complete();\n           } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n             fut.fail(result.cause());\n           }\n         }\n     );\n}\n")),Object(o.a)("p",null,"The only dif\xadfer\xadence with the pre\xadvi\xadous code is the ",Object(o.a)("inlineCode",{parentName:"p"},'router.route("/assets/*").handler(StaticHandler.create("assets"));')," line. So, what does this line mean? It\u2019s ac\xadtu\xadally quite sim\xadple. It ",Object(o.a)("em",{parentName:"p"},"routes")," re\xadquests on \u201c/as\xadsets/*\u201d to re\xadsources stored in the \u201cas\xadsets\u201d di\xadrec\xadtory. So our ",Object(o.a)("inlineCode",{parentName:"p"},"index.html")," page is going to be served using ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8080/assets/index.html"),"."),Object(o.a)("p",null,"Be\xadfore test\xading this, let\u2019s take a few sec\xadonds on the han\xaddler cre\xadation. All pro\xadcess\xading ac\xadtions in Vert.x web are im\xadple\xadmented as ",Object(o.a)("em",{parentName:"p"},"han\xaddler"),". To cre\xadate a han\xaddler you al\xadways call the ",Object(o.a)("inlineCode",{parentName:"p"},"create")," method."),Object(o.a)("p",null,"So, I\u2019m sure you are im\xadpa\xadtient to see our beau\xadti\xadful HTML page. Let\u2019s build and run the ap\xadpli\xadca\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean package\njava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar\n")),Object(o.a)("p",null,"Now, open your browser to ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8080/assets/index.html"),". Here it is\u2026 Ugly right? I told you."),Object(o.a)("p",null,"As you may no\xadtice too\u2026 the table is empty, this is be\xadcause we didn\u2019t im\xadple\xadment the REST API yet. Let\u2019s do that now."),Object(o.a)("h2",{id:"rest-api-with-vertx-web"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#rest-api-with-vertx-web"})),"REST API with Vert.x Web"),Object(o.a)("p",null,"Vert.x Web makes the im\xadple\xadmen\xadta\xadtion of REST API re\xadally easy, as it ba\xadsi\xadcally ",Object(o.a)("em",{parentName:"p"},"routes")," your URL to the right han\xaddler. The API is very sim\xadple, and will be struc\xadtured as fol\xadlows:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"GET /api/whiskies")," => get all bot\xadtles (",Object(o.a)("inlineCode",{parentName:"li"},"getAll"),")"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"GET /api/whiskies/:id")," => get the bot\xadtle with the cor\xadre\xadspond\xading id (",Object(o.a)("inlineCode",{parentName:"li"},"getOne"),")"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"POST /api/whiskies")," => add a new bot\xadtle (",Object(o.a)("inlineCode",{parentName:"li"},"addOne"),")"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"PUT /api/whiskies/:id")," => up\xaddate a bot\xadtle (",Object(o.a)("inlineCode",{parentName:"li"},"updateOne"),")"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"DELETE /api/whiskies/id")," => delete a bot\xadtle (",Object(o.a)("inlineCode",{parentName:"li"},"deleteOne"),")")),Object(o.a)("h3",{id:"we-need-some-data"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#we-need-some-data"})),"We need some data\u2026"),Object(o.a)("p",null,"But be\xadfore going fur\xadther, let\u2019s cre\xadate our ",Object(o.a)("em",{parentName:"p"},"data")," ob\xadject. Cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/java/io/vertx/blog/first/Whisky.java")," with the fol\xadlow\xading con\xadtent:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," io.vertx.blog.first;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," java.util.concurrent.atomic.AtomicInteger;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Whisky")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," AtomicInteger COUNTER = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," AtomicInteger();\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," id;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," String name;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," String origin;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Whisky"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String name, String origin)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".id = COUNTER.getAndIncrement();\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".name = name;\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".origin = origin;\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Whisky"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".id = COUNTER.getAndIncrement();\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," String ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getName"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," name;\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," String ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getOrigin"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," origin;\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getId"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," id;\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"setName"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String name)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".name = name;\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"setOrigin"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String origin)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".origin = origin;\n  }\n}\n")),Object(o.a)("p",null,"It\u2019s a very sim\xadple ",Object(o.a)("em",{parentName:"p"},"bean")," class (so with get\xadters and set\xadters). We choose this for\xadmat be\xadcause Vert.x is re\xadly\xading on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://wiki.fasterxml.com/JacksonHome"}),"Jack\xadson")," to han\xaddle the JSON for\xadmat. Jack\xadson au\xadto\xadmates the se\xadri\xadal\xadiza\xadtion and de\xadse\xadri\xadal\xadiza\xadtion of ",Object(o.a)("em",{parentName:"p"},"bean")," classes, mak\xading our code much sim\xadpler."),Object(o.a)("p",null,"Now, let\u2019s cre\xadate a cou\xadple of bot\xadtles. In the ",Object(o.a)("inlineCode",{parentName:"p"},"MyFirstVerticle")," class, add the fol\xadlow\xading code:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Store our product"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," Map<Integer, Whisky> products = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," LinkedHashMap<>();\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Create some product"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"createSomeData"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n  Whisky bowmore = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Bowmore 15 Years Laimrig"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Islay"'),");\n  products.put(bowmore.getId(), bowmore);\n  Whisky talisker = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Talisker 57\xb0 North"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Island"'),");\n  products.put(talisker.getId(), talisker);\n}\n")),Object(o.a)("p",null,"Then, in the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method, call the ",Object(o.a)("inlineCode",{parentName:"p"},"createSomeData")," method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Future<Void> fut)")," "),"{\n\n  createSomeData();\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Create a router object."),"\n  Router router = Router.router(vertx);\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Rest of the method"),"\n}\n")),Object(o.a)("p",null,"As you have no\xadticed, we don\u2019t re\xadally have a ",Object(o.a)("em",{parentName:"p"},"back\xadend")," here, it\u2019s just a (in-\u200bmemory) map. Adding a back\xadend will be cov\xadered by an\xadother post."),Object(o.a)("h3",{id:"get-our-products"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#get-our-products"})),"Get our products"),Object(o.a)("p",null,"Enough dec\xado\xadra\xadtion, let\u2019s im\xadple\xadment the REST API. We are going to start with ",Object(o.a)("inlineCode",{parentName:"p"},"GET /api/whiskies"),". It re\xadturns the list of bot\xadtles in a JSON Array."),Object(o.a)("p",null,"In the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method, add this line just below the sta\xadtic han\xaddler line:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::getAll);\n")),Object(o.a)("p",null,"This line in\xadstructs the ",Object(o.a)("inlineCode",{parentName:"p"},"router")," to han\xaddle the ",Object(o.a)("inlineCode",{parentName:"p"},"GET")," re\xadquests on \u201c/api/whiskies\u201d by call\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"getAll")," method. We could have in\xadlined the han\xaddler code, but for clar\xadity rea\xadsons let\u2019s cre\xadate an\xadother  method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getAll"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext routingContext)")," "),"{\n  routingContext.response()\n      .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json; charset=utf-8"'),")\n      .end(Json.encodePrettily(products.values()));\n}\n")),Object(o.a)("p",null,"As every ",Object(o.a)("em",{parentName:"p"},"han\xaddler")," our method re\xadceives a ",Object(o.a)("inlineCode",{parentName:"p"},"RoutingContext"),". It pop\xadu\xadlates the ",Object(o.a)("inlineCode",{parentName:"p"},"response")," by set\xadting the ",Object(o.a)("inlineCode",{parentName:"p"},"content-type")," and the ac\xadtual con\xadtent. Be\xadcause our con\xadtent may con\xadtain ",Object(o.a)("em",{parentName:"p"},"weird")," char\xadac\xadters, we force the charset to UTF-8. To cre\xadate the ac\xadtual con\xadtent, no need to com\xadpute the JSON string our\xadself. Vert.x lets us use the ",Object(o.a)("inlineCode",{parentName:"p"},"Json")," API. So ",Object(o.a)("inlineCode",{parentName:"p"},"Json.encodePrettily(products.values())")," com\xadputes the JSON string rep\xadre\xadsent\xading the set of bot\xadtles."),Object(o.a)("p",null,"We could have used ",Object(o.a)("inlineCode",{parentName:"p"},"Json.encodePrettily(products)"),", but to make the JavaScript code sim\xadpler, we just re\xadturn the set of bot\xadtles and not an ob\xadject con\xadtain\xading ",Object(o.a)("inlineCode",{parentName:"p"},"ID => Bottle")," en\xadtries."),Object(o.a)("p",null,"With this in place, we should be able to re\xadtrieve the set of bot\xadtle from our HTML page. Let\u2019s try it:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean package\njava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar\n")),Object(o.a)("p",null,"Then open the HTML page in your browser (",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8080/assets/index.html"),"), and should should see:"),Object(o.a)("img",{src:t("YnlU")}),Object(o.a)("p",null,"I\u2019m sure you are cu\xadri\xadous, and want to ac\xadtu\xadally see what is re\xadturned by our REST API. Let\u2019s open a browser to ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8080/api/whiskies"),". You should get:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"[ {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"id"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Bowmore 15 Years Laimrig"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"origin"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Islay"'),"\n}, {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"id"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Talisker 57\xb0 North"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"origin"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Island"'),"\n} ]\n")),Object(o.a)("h2",{id:"create-a-product"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#create-a-product"})),"Create a product"),Object(o.a)("p",null,"Now we can re\xadtrieve the set of bot\xadtles, let\u2019s cre\xadate a new one. Un\xadlike the pre\xadvi\xadous REST API end\xadpoint, this one need to read the re\xadquest\u2019s body. For per\xadfor\xadmance rea\xadson, it should be ex\xadplic\xaditly en\xadabled. Don\u2019t be scared\u2026 it\u2019s just a han\xaddler."),Object(o.a)("p",null,"In the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method, add these lines just below the line end\xading by ",Object(o.a)("inlineCode",{parentName:"p"},"getAll"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies*"'),").handler(BodyHandler.create());\nrouter.post(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::addOne);\n")),Object(o.a)("p",null,"The first line en\xadables the read\xading of the re\xadquest body for all routes under \u201c/api/whiskies\u201d. We could have en\xadabled it glob\xadally with ",Object(o.a)("inlineCode",{parentName:"p"},"router.route().handler(BodyHandler.create())"),"."),Object(o.a)("p",null,"The sec\xadond line maps ",Object(o.a)("inlineCode",{parentName:"p"},"POST")," re\xadquests on ",Object(o.a)("inlineCode",{parentName:"p"},"/api/whiskies")," to the ",Object(o.a)("inlineCode",{parentName:"p"},"addOne")," method. Let\u2019s cre\xadate this method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"addOne"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext routingContext)")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," Whisky whisky = Json.decodeValue(routingContext.getBodyAsString(),\n      Whisky.class);\n  products.put(whisky.getId(), whisky);\n  routingContext.response()\n      .setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"201"),")\n      .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json; charset=utf-8"'),")\n      .end(Json.encodePrettily(whisky));\n}\n")),Object(o.a)("p",null,"The method starts by re\xadtriev\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"Whisky")," ob\xadject from the re\xadquest body. It just reads the body into a String and passes it to the ",Object(o.a)("inlineCode",{parentName:"p"},"Json.decodeValue")," method. Once cre\xadated it adds it to the ",Object(o.a)("em",{parentName:"p"},"back\xadend")," map and re\xadturns the cre\xadated bot\xadtle as JSON."),Object(o.a)("p",null,"Let\u2019s try this. Re\xadbuild and restart the ap\xadpli\xadca\xadtion with:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-mipsasm"}),"mvn clean package\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"java "),"-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"jar "),"target/my-first-app",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"-1"),".",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"-SNAPSHOT-fat.",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"jar\n"))),Object(o.a)("p",null,"Then, re\xadfresh the HTML page and click on the ",Object(o.a)("inlineCode",{parentName:"p"},"Add a new bottle")," but\xadton. Enter the data such as: \u201cJame\xadson\u201d as name and \u201cIre\xadland\u201d as ori\xadgin (purists would have no\xadticed that this is ac\xadtu\xadally a Whiskey and not a Whisky). The bot\xadtle should be added to the table."),Object(o.a)(l.a,{info:!0,title:"Status 201?",mdxType:"Alert"},Object(o.a)("p",null,"As you can see, we have set the re\xadsponse sta\xadtus to ",Object(o.a)("inlineCode",{parentName:"p"},"201"),". It means ",Object(o.a)("inlineCode",{parentName:"p"},"CREATED"),", and is the gen\xader\xadally used in REST API that cre\xadate an en\xadtity. By de\xadfault vert.x web is set\xadting the sta\xadtus to ",Object(o.a)("inlineCode",{parentName:"p"},"200")," mean\xading ",Object(o.a)("inlineCode",{parentName:"p"},"OK"),".")),Object(o.a)("h3",{id:"finishing-a-bottle"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finishing-a-bottle"})),"Finishing a bottle"),Object(o.a)("p",null,"Well, bot\xadtles do not last for\xadever, so we should be able to delete a bot\xadtle. In the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method, add this line:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"router.delete(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies/:id"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::deleteOne);\n")),Object(o.a)("p",null,"In the URL, we de\xadfine a ",Object(o.a)("em",{parentName:"p"},"path pa\xadra\xadme\xadter")," ",Object(o.a)("inlineCode",{parentName:"p"},":id"),". So, when han\xaddling a match\xading re\xadquest, Vert.x ex\xadtracts the path seg\xadment cor\xadre\xadspond\xading to the pa\xadra\xadme\xadter and let us ac\xadcess it in the han\xaddler method. For in\xadstance, ",Object(o.a)("inlineCode",{parentName:"p"},"/api/whiskies/0")," maps ",Object(o.a)("inlineCode",{parentName:"p"},"id")," to ",Object(o.a)("inlineCode",{parentName:"p"},"0"),"."),Object(o.a)("p",null,"Let\u2019s see how the pa\xadra\xadme\xadter can be used in the han\xaddler method. Cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"deleteOne")," method as fol\xadlows:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"deleteOne"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext routingContext)")," "),"{\n  String id = routingContext.request().getParam(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"id"'),");\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (id == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n    routingContext.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"400"),").end();\n  } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    Integer idAsInteger = Integer.valueOf(id);\n    products.remove(idAsInteger);\n  }\n  routingContext.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"204"),").end();\n}\n")),Object(o.a)("p",null,"The ",Object(o.a)("em",{parentName:"p"},"path pa\xadra\xadme\xadter")," is re\xadtrieved using ",Object(o.a)("inlineCode",{parentName:"p"},'routingContext.request().getParam("id")'),".  It checks whether it\u2019s ",Object(o.a)("inlineCode",{parentName:"p"},"null")," (not set), and in this case re\xadturns a ",Object(o.a)("inlineCode",{parentName:"p"},"Bad Request")," re\xadsponse (sta\xadtus code 400). Oth\xader\xadwise, it re\xadmoves it from the ",Object(o.a)("em",{parentName:"p"},"back\xadend")," map."),Object(o.a)(l.a,{info:!0,title:"Status 204?",mdxType:"Alert"},Object(o.a)("p",null,"As you can see, we have set the re\xadsponse sta\xadtus to ",Object(o.a)("inlineCode",{parentName:"p"},"204 - NO CONTENT"),". Re\xadsponse to the HTTP Verb ",Object(o.a)("inlineCode",{parentName:"p"},"delete")," have gen\xader\xadally no con\xadtent.")),Object(o.a)("h3",{id:"the-other-methods"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#the-other-methods"})),"The other methods"),Object(o.a)("p",null,"We won\u2019t de\xadtail ",Object(o.a)("inlineCode",{parentName:"p"},"getOne")," and ",Object(o.a)("inlineCode",{parentName:"p"},"updateOne")," as the im\xadple\xadmen\xadta\xadtions are straight\xadfor\xadward and very sim\xadi\xadlar. Their im\xadple\xadmen\xadta\xadtions are avail\xadable on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/blob/post-3/src/main/java/io/vertx/blog/first/MyFirstVerticle.java"}),"GitHub"),"."),Object(o.a)("h3",{id:"cheers"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#cheers"})),"Cheers!"),Object(o.a)("p",null,"It\u2019s time to con\xadclude this post. We have seen how Vert.x Web lets you im\xadple\xadment a REST API eas\xadily and how it can serve sta\xadtic re\xadsources. A bit more fancy than be\xadfore, but still pretty easy."),Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/unit-and-integration-tests/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"In the next post")),", we are going to improve our tests to cover the REST API.",Object(o.a)("p",null,"Say Tuned ","&"," Happy Cod\xading !"))}h.isMDXComponent=!0},Em2t:function(e,a,t){var n=t("bahg"),s=t("quyA"),c=t("0JQy");e.exports=function(e){return s(e)?c(e):n(e)}},EomW:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3.1.0 is released !",category:"releases",authors:[{name:"Tim Fox",github_id:"purplefox"}],summary:"I'm pleased to announce the release of Vert.x 3.1!"}),i=[{term:"stomp",tf:6},{term:"client",tf:6},{term:"server",tf:5},{term:"releas",tf:4},{term:"us",tf:4},{term:"wiki",tf:4},{term:"event",tf:3},{term:"http",tf:3},{term:"com",tf:3},{term:"implement",tf:2},{term:"protocol",tf:2},{term:"bu",tf:2},{term:"full",tf:2},{term:"note",tf:2},{term:"github",tf:2},{term:"x3",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"thank",tf:2},{term:"pleas",tf:1},{term:"announc",tf:1},{term:"highlight",tf:1},{term:"includ",tf:1},{term:"sync",tf:1},{term:"set",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"I\u2019m pleased to an\xadnounce the re\xadlease of Vert.x 3.1!"),Object(o.a)("p",null,"Some of the high\xadlights of this re\xadlease in\xadclude:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-sync/java/"}),"Vertx-\u200bsync")," is a set of util\xadi\xadties that allow you to per\xadform asyn\xadchro\xadnous\nop\xader\xada\xadtions and re\xadceive events in a syn\xadchro\xadnous way, but with\xadout block\xading ker\xadnel threads.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-stomp/java/"}),"Vertx-\u200bstomp")," is an im\xadple\xadmen\xadta\xadtion of a STOMP server and client.\nYou can use the STOMP server with other clients and use the STOMP client with other servers.\nThe server and the client sup\xadports the ver\xadsion 1.0, 1.1 and 1.2 of the STOMP pro\xadto\xadcol.\nThe STOMP server can also be used as a bridge with the\nvert.x event bus.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-shell/java/"}),"Vertx-\u200bshell")," is a com\xadmand line in\xadter\xadface for the Vert.x run\xadtime avail\xadable from\nreg\xadu\xadlar ter\xadmi\xadnals using dif\xadfer\xadent pro\xadto\xadcols.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"Re-\u200bimplementation of the Starter class and re\xadlated func\xadtion\xadal\xadity. And now re\xadde\xadploy is back!"))),Object(o.a)("p",null,"Full re\xadlease notes can be found here:"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.1-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.1-\u200bRelease-Notes")),Object(o.a)("p",null,"Break\xading changes here:"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.1.0---Breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.1.0-\u200b\u2014Breaking-changes")),Object(o.a)("p",null,"NPM for the event-\u200bbus client here:"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("p",null,"Many thanks to all the com\xadmit\xadters and com\xadmu\xadnity whose con\xadtri\xadbu\xadtions made this pos\xadsi\xadble."),Object(o.a)("p",null,"A spe\xadcial thanks to the full-\u200btime team - Clement, Julien and Paulo who put in a lot of work to get this out :)"),Object(o.a)("p",null,"Next stop is Vert.x 3.2 which we hope to have out be\xadfore Christ\xadmas."),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.1.0%22"}),"Maven Cen\xadtral"),"\nand you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.1.0/view"}),"Bin\xadtray"),"."))}m.isMDXComponent=!0},Ff2n:function(e,a,t){"use strict";function n(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}t.d(a,"a",(function(){return n}))},GOOg:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"The RSS reader tutorial (Step 2)",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"In this second installment of our Vert.x Cassandra Client tutorial, we will add an endpoint that produces an array of RSS channels for a given user ID."}),i=[{term:"endpoint",tf:8},{term:"implement",tf:7},{term:"rss",tf:6},{term:"channel",tf:5},{term:"step",tf:4},{term:"method",tf:4},{term:"app",tf:3},{term:"complet",tf:3},{term:"second",tf:3},{term:"given",tf:3},{term:"user",tf:3},{term:"successfulli",tf:2},{term:"reader",tf:2},{term:"articl",tf:2},{term:"fetch",tf:2},{term:"link",tf:2},{term:"allow",tf:2},{term:"list",tf:2},{term:"browser",tf:2},{term:"read",tf:2},{term:"previou",tf:1},{term:"first",tf:1},{term:"exampl",tf:1},{term:"assum",tf:1},{term:"dedic",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"In ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/the-rss-reader-tutorial/"}),"the pre\xadvi\xadous step"),", we have suc\xadcess\xadfully im\xadple\xadmented the first end\xadpoint\nof the RSS reader app."),Object(o.a)("p",null,"The RSS reader ex\xadam\xadple as\xadsumes im\xadple\xadment\xading 3 end\xadpoints. This ar\xadti\xadcle is ded\xadi\xadcated to im\xadple\xadment\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"GET /user/{user_id}/rss_channels")," end\xadpoint."),Object(o.a)("p",null,"Be\xadfore com\xadplet\xading this step, make sure your are in the ",Object(o.a)("inlineCode",{parentName:"p"},"step_2")," git branch:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_2"),"\n")),Object(o.a)("h2",{id:"implementing-the-second-endpoint"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implementing-the-second-endpoint"})),"Implementing the second endpoint"),Object(o.a)("p",null,"The sec\xadond end\xadpoint pro\xadduces an array of RSS chan\xadnels by given ",Object(o.a)("inlineCode",{parentName:"p"},"user_id"),"."),Object(o.a)("p",null,"We need to ex\xade\xadcute the two fol\xadlow\xading queries to:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"Fetch RSS links for a given user:",Object(o.a)("pre",{parentName:"li"},Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," rss_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," rss_by_user ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"WHERE")," login = GIVEN_USER_ID ;\n"))),Object(o.a)("li",{parentName:"ol"},"Fetch RSS chan\xadnel de\xadtails for a given link:",Object(o.a)("pre",{parentName:"li"},Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," description, title, site_link, rss_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," channel_info_by_rss_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"WHERE")," rss_link = GIVEN_LINK ;\n")))),Object(o.a)("h2",{id:"implementation"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implementation"})),"Implementation"),Object(o.a)("p",null,"The end\xadpoint al\xadlows the the front-\u200bend app to dis\xadplay the list of RSS feeds a user sub\xadscribed on. When the end\xadpoint is ac\xadcessed, the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle#getRssChannels")," method is called. We can im\xadple\xadment this method in this way:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getRssChannels"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    String userId = ctx.request().getParam(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"user_id"'),");\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (userId == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n        responseWithInvalidRequest(ctx);\n    } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n        Future<List<Row>> future = Future.future();\n        client.executeWithFullFetch(selectRssLinksByLogin.bind(userId), future);\n        future.compose(rows -> {\n            List<String> links = rows.stream()\n                    .map(row -> row.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"))\n                    .collect(Collectors.toList());\n\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," CompositeFuture.all(\n                    links.stream().map(selectChannelInfo::bind).map(statement -> {\n                        Future<List<Row>> channelInfoRow = Future.future();\n                        client.executeWithFullFetch(statement, channelInfoRow);\n                        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," channelInfoRow;\n                    }).collect(Collectors.toList())\n            );\n        }).setHandler(h -> {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (h.succeeded()) {\n                CompositeFuture result = h.result();\n                List<List<Row>> results = result.list();\n                List<Row> list = results.stream()\n                        .flatMap(List::stream)\n                        .collect(Collectors.toList());\n                JsonObject responseJson = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject();\n                JsonArray channels = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonArray();\n\n                list.forEach(eachRow -> channels.add(\n                        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()\n                                .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),", eachRow.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"))\n                                .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"title"'),", eachRow.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),"))\n                                .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"link"'),", eachRow.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"2"),"))\n                                .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"rss_link"'),", eachRow.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"3"),"))\n                ));\n\n                responseJson.put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"channels"'),", channels);\n                ctx.response().end(responseJson.toString());\n            } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n                log.error(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"failed to get rss channels"'),", h.cause());\n                ctx.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"500"),").end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Unable to retrieve the info from C*"'),");\n            }\n        });\n    }\n}\n")),Object(o.a)("p",null,"Also, this method uses ",Object(o.a)("inlineCode",{parentName:"p"},"selectChannelInfo")," and ",Object(o.a)("inlineCode",{parentName:"p"},"selectRssLinksByLogin")," fields, they should be ini\xadtial\xadized in the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle#prepareNecessaryQueries")," method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Future<Void> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"prepareNecessaryQueries"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    Future<PreparedStatement> selectChannelInfoPrepFuture = Future.future();\n    client.prepare(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT description, title, site_link, rss_link FROM channel_info_by_rss_link WHERE rss_link = ? ;"'),", selectChannelInfoPrepFuture);\n\n    Future<PreparedStatement> selectRssLinkByLoginPrepFuture = Future.future();\n    client.prepare(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT rss_link FROM rss_by_user WHERE login = ? ;"'),", selectRssLinkByLoginPrepFuture);\n\n    Future<PreparedStatement> insertNewLinkForUserPrepFuture = Future.future();\n    client.prepare(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO rss_by_user (login , rss_link ) VALUES ( ?, ?);"'),", insertNewLinkForUserPrepFuture);\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," CompositeFuture.all(\n            selectChannelInfoPrepFuture.compose(preparedStatement -> {\n                selectChannelInfo = preparedStatement;\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n            }),\n            selectRssLinkByLoginPrepFuture.compose(preparedStatement -> {\n                selectRssLinksByLogin = preparedStatement;\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n            }),\n            insertNewLinkForUserPrepFuture.compose(preparedStatement -> {\n                insertNewLinkForUser = preparedStatement;\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Future.succeededFuture();\n            })\n    ).mapEmpty();\n}\n")),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"In this part, we have suc\xadcess\xadfully im\xadple\xadmented the sec\xadond end\xadpoint, which al\xadlows the browser app to ob\xadtain chan\xadnels in\xadfor\xadma\xadtion for a spe\xadcific user. To en\xadsure that it is work\xading fine, point your browser to ",Object(o.a)("inlineCode",{parentName:"p"},"localhost:8080")," and click to the re\xadfresh but\xadton. Chan\xadnel list should ap\xadpear im\xadme\xaddi\xadately."),Object(o.a)("p",null,"If you have any prob\xadlems with com\xadplet\xading this step you can check\xadout to ",Object(o.a)("inlineCode",{parentName:"p"},"step_3"),", where you can find all changes made for com\xadplet\xading this step:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_3"),"\n")),Object(o.a)("p",null,"Thanks for read\xading this. I hope you en\xadjoyed read\xading this ar\xadti\xadcle. See you soon on our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"Git\xadter chan\xadnel"),"!"))}m.isMDXComponent=!0},GoqC:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"An Eclipse Vert.x Gradle Plugin",category:"news",authors:[{name:"Julien Ponge",github_id:"jponge"}],summary:"The new Vert.x Gradle plugin offers an opinionated plugin for building Vert.x applications with Gradle."}),i=[{term:"plugin",tf:16},{term:"gradl",tf:12},{term:"task",tf:11},{term:"us",tf:5},{term:"build",tf:5},{term:"automat",tf:5},{term:"integr",tf:5},{term:"webpack",tf:5},{term:"project",tf:4},{term:"jar",tf:4},{term:"depend",tf:4},{term:"file",tf:4},{term:"tool",tf:3},{term:"call",tf:3},{term:"fat",tf:3},{term:"applic",tf:3},{term:"add",tf:3},{term:"provid",tf:3},{term:"reload",tf:3},{term:"code",tf:3},{term:"not",tf:2},{term:"opinion",tf:2},{term:"popular",tf:2},{term:"on",tf:2},{term:"produc",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Eclipse Vert.x is a ver\xadsa\xadtile toolkit, and as such it does not have any strong opin\xadion on the tools that you should be using."),Object(o.a)("p",null,"Gra\xaddle is a pop\xadu\xadlar build tool in the JVM ecosys\xadtem, and it is quite easy to use for build\xading Vert.x project as ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/blob/master/gradle-verticles/gradle-verticle/build.gradle"}),"show in one of the ",Object(o.a)("inlineCode",{parentName:"a"},"vertx-examples")," sam\xadples")," where a so-\u200bcalled ",Object(o.a)("em",{parentName:"p"},"fat Jar")," is being pro\xadduced."),Object(o.a)("p",null,"The new ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://plugins.gradle.org/plugin/io.vertx.vertx-plugin"}),"Vert.x Gra\xaddle plugin")," of\xadfers an ",Object(o.a)("em",{parentName:"p"},"opin\xadion\xadated")," plug\xadin for build\xading Vert.x ap\xadpli\xadca\xadtions with Gra\xaddle."),Object(o.a)("p",null,"It au\xadto\xadmat\xadi\xadcally ap\xadplies the fol\xadlow\xading plu\xadg\xadins:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"java")," (and sets the source com\xadpat\xadi\xadbil\xadity to Java 8),"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"application")," + ",Object(o.a)("inlineCode",{parentName:"li"},"shadow")," to gen\xader\xadate fat Jars with all de\xadpen\xadden\xadcies bun\xaddled,"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"nebula-dependency-recommender-plugin")," so that you can omit ver\xadsions from mod\xadules from the the Vert.x stack.")),Object(o.a)("p",null,"The plug\xadin au\xadto\xadmat\xadi\xadcally adds ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx:vertx-core")," as a ",Object(o.a)("inlineCode",{parentName:"p"},"compile")," de\xadpen\xaddency, so you don\u2019t need to do it."),Object(o.a)("p",null,"The plug\xadin pro\xadvides a ",Object(o.a)("inlineCode",{parentName:"p"},"vertxRun")," task that can take ad\xadvan\xadtage of the Vert.x auto-\u200breloading ca\xadpa\xadbil\xadi\xadties, so you can just run it then have your code being au\xadto\xadmat\xadi\xadcally com\xadpiled and re\xadloaded as you make changes."),Object(o.a)("h2",{id:"getting-started"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#getting-started"})),"Getting started"),Object(o.a)("p",null,"A min\xadi\xadmal ",Object(o.a)("inlineCode",{parentName:"p"},"build.gradle")," looks like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-groovy"}),"plugins {\n  id ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'io.vertx.vertx-plugin'")," version ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'0.0.4'"),"\n}\n\nrepositories {\n  jcenter()\n}\n\nvertx {\n  mainVerticle = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'sample.App'"),"\n}\n")),Object(o.a)("p",null,"Pro\xadvided ",Object(o.a)("inlineCode",{parentName:"p"},"sample.App")," is a Vert.x ver\xadti\xadcle, then:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"gradle shadowJar")," builds an ex\xade\xadcutable Jar with all de\xadpen\xadden\xadcies: ",Object(o.a)("inlineCode",{parentName:"li"},"java -jar build/libs/simple-project-fat.jar"),", and"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"gradle vertxRun")," starts the ap\xadpli\xadca\xadtion and au\xadto\xadmat\xadi\xadcally re\xadcom\xadpiles (",Object(o.a)("inlineCode",{parentName:"li"},"gradle classes"),") and re\xadloads the code when any file under ",Object(o.a)("inlineCode",{parentName:"li"},"src/")," is being added, mod\xadi\xadfied or deleted.")),Object(o.a)("h2",{id:"using-with-kotlin-or-groovy-or"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#using-with-kotlin-or-groovy-or"})),"Using with Kotlin (or Groovy, or\u2026)"),Object(o.a)("p",null,"The plug\xadin in\xadte\xadgrates well with plu\xadg\xadins that add con\xadfig\xadu\xadra\xadtions and tasks trig\xadgered by the ",Object(o.a)("inlineCode",{parentName:"p"},"classes")," task."),Object(o.a)("p",null,"Here is how to use the plug\xadin with Kotlin (re\xadplace the ver\xadsion num\xadbers with the lat\xadest ones\u2026):"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-groovy"}),"plugins {\n  id ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'io.vertx.vertx-plugin'")," version ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'x.y.z'"),"\n  id ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'org.jetbrains.kotlin.jvm'")," version ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'a.b.c'"),"\n}\n\nrepositories {\n  jcenter()\n}\n\ndependencies {\n  compile ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'io.vertx:vertx-lang-kotlin'"),"\n  compile ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'org.jetbrains.kotlin:kotlin-stdlib-jre8'"),"\n}\n\nvertx {\n  mainVerticle = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"sample.MainVerticle"'),"\n}\n\ntasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).all {\n  kotlinOptions {\n    jvmTarget = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"1.8"'),"\n  }\n}\n")),Object(o.a)("h2",{id:"using-with-webpack-or-any-other-custom-task"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#using-with-webpack-or-any-other-custom-task"})),"Using with WebPack (or any other custom task)"),Object(o.a)("p",null,"Web\xadPack is pop\xadu\xadlar to bun\xaddle web as\xadsets, and there is even ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://guides.gradle.org/running-webpack-with-gradle/"}),"a guide for its in\xadte\xadgra\xadtion with Gra\xaddle"),"."),Object(o.a)("p",null,"Mix\xading the Vert.x Gra\xaddle plug\xadin with Web\xadPack is very sim\xadple, es\xadpe\xadcially in com\xadbi\xadna\xadtion with the ",Object(o.a)("inlineCode",{parentName:"p"},"com.moowork.node")," plug\xadin that in\xadte\xadgrates Node into Gra\xaddle."),Object(o.a)("p",null,"Sup\xadpose we want to mix Vert.x code and JavaScript with Gra\xaddle and Web\xadPack.\nWe as\xadsume a ",Object(o.a)("inlineCode",{parentName:"p"},"package.json")," as:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"webpack-sample"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"version"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0.0.1"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"A sample with Vert.x, Gradle and Webpack"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"main"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"src/main/webapp/index.js"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scripts"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"test"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"echo \\"Error: no test specified\\" && exit 1"'),"\n  },\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"author"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'""'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"license"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"ISC"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"devDependencies"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"webpack"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"^2.7.0"'),"\n  },\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"dependencies"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"axios"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"^0.16.2"'),"\n  }\n}\n")),Object(o.a)("p",null,"and ",Object(o.a)("inlineCode",{parentName:"p"},"webpack.config.js")," as:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"module"),".exports = {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"entry"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'./src/main/webapp/index.js'"),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"output"),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"filename"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'./build/resources/main/webroot/bundle.js'"),"\n  }\n}\n")),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"build.gradle")," file is the fol\xadlow\xading:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-groovy"}),"plugins {\n  id ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'io.vertx.vertx-plugin'")," version ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'0.0.4'"),"\n  id ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'com.moowork.node'")," version ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'1.2.0'"),"\n}\n\nrepositories {\n  jcenter()\n}\n\ndependencies {\n  compile ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"io.vertx:vertx-web"'),"\n}\n\nvertx {\n  mainVerticle = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"sample.MainVerticle"'),"\n  watch = [",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"src/**/*"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"build.gradle"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"yarn.lock"'),"]\n  onRedeploy = [",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"classes"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"webpack"'),"]\n}\n\ntask webpack(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"type:")," Exec) {\n  inputs.file(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"$projectDir/yarn.lock"'),")\n  inputs.file(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"$projectDir/webpack.config.js"'),")\n  inputs.dir(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"$projectDir/src/main/webapp"'),")\n  outputs.dir(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"$buildDir/resources/main/webroot"'),")\n  commandLine ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"$projectDir/node_modules/.bin/webpack"'),"\n}\n")),Object(o.a)("p",null,"This cus\xadtom build ex\xadposes a ",Object(o.a)("inlineCode",{parentName:"p"},"webpack")," task that in\xadvokes Web\xadPack, with proper file track\xading so that Gra\xaddle knows when the task is up-\u200bto-date or not."),Object(o.a)("p",null,"The Node plug\xadin adds many tasks, and in\xadte\xadgrates fine with ",Object(o.a)("inlineCode",{parentName:"p"},"npm")," or ",Object(o.a)("inlineCode",{parentName:"p"},"yarn"),", so fetch\xading all NPM de\xadpen\xadden\xadcies is done by call\xading ",Object(o.a)("inlineCode",{parentName:"p"},"./gradlew yarn"),"."),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"vertxRun")," task now re\xadde\xadploys on mod\xadi\xadfi\xadca\xadtions to files in ",Object(o.a)("inlineCode",{parentName:"p"},"src/")," (and sub-\u200bfolders), ",Object(o.a)("inlineCode",{parentName:"p"},"build.gradle")," and ",Object(o.a)("inlineCode",{parentName:"p"},"yarn.lock"),", call\xading both the ",Object(o.a)("inlineCode",{parentName:"p"},"classes")," and ",Object(o.a)("inlineCode",{parentName:"p"},"webpack")," tasks:"),Object(o.a)("iframe",{width:"872",height:"602",src:"https://www.youtube.com/embed/OGy-1w8Z6Dc?rel=0",frameBorder:"0",allowFullScreen:!0}),Object(o.a)("h2",{id:"summary"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#summary"})),"Summary"),Object(o.a)("p",null,"The Vert.x Gra\xaddle plug\xadin pro\xadvides lots of de\xadfaults to con\xadfig\xadure a Gra\xaddle project for Vert.x ap\xadpli\xadca\xadtions, pro\xadduc\xading ",Object(o.a)("em",{parentName:"p"},"fat Jars")," and of\xadfer\xading a run\xadning task with au\xadto\xadmatic re\xadde\xadploy\xadment.\nThe plug\xadin also in\xadte\xadgrates well with other plu\xadg\xadins and ex\xadter\xadnal tools for which a Gra\xaddle task is avail\xadable."),Object(o.a)("p",null,"The project is still in its early stages and we are look\xading for\xadward to hear\xading from you!"),Object(o.a)("h3",{id:"links"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#links"})),"Links"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/jponge/vertx-gradle-plugin"}),"The project on GitHub")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://plugins.gradle.org/plugin/io.vertx.vertx-plugin"}),"The plug\xadin on the Gra\xaddle plu\xadg\xadins por\xadtal"))))}m.isMDXComponent=!0},HAnQ:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Easy SSO for Vert.x with Keycloak",category:"guides",authors:[{name:"Thomas Darimont",github_id:"thomasdarimont"}],summary:"In this blog post, you'll learn how to implement Single Sign-on with OpenID Connect and how to use Keycloak together with Eclipse Vert.x."}),i=[{term:"keycloak",tf:30},{term:"user",tf:23},{term:"app",tf:19},{term:"openid",tf:17},{term:"protect",tf:17},{term:"need",tf:16},{term:"via",tf:16},{term:"inform",tf:15},{term:"connect",tf:14},{term:"logout",tf:14},{term:"page",tf:14},{term:"call",tf:10},{term:"exampl",tf:10},{term:"us",tf:9},{term:"configur",tf:9},{term:"token",tf:9},{term:"handler",tf:9},{term:"access",tf:8},{term:"web",tf:8},{term:"show",tf:8},{term:"endpoint",tf:8},{term:"provid",tf:7},{term:"form",tf:7},{term:"current",tf:7},{term:"integr",tf:7}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"TL;DR:")),Object(o.a)("p",null,"In this blog post you\u2019ll learn:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"How to im\xadple\xadment Sin\xadgle Sign-\u200bon with OpenID Con\xadnect"),Object(o.a)("li",{parentName:"ul"},"How to use Key\xadcloak\u2019s OpenID Dis\xadcov\xadery to infer OpenID provider con\xadfig\xadu\xadra\xadtion"),Object(o.a)("li",{parentName:"ul"},"How to ob\xadtain user in\xadfor\xadma\xadtion"),Object(o.a)("li",{parentName:"ul"},"How to check for au\xadtho\xadriza\xadtion"),Object(o.a)("li",{parentName:"ul"},"How to call a Bearer pro\xadtected ser\xadvice with an Ac\xadcess Token"),Object(o.a)("li",{parentName:"ul"},"How to im\xadple\xadment a form based lo\xadgout")),Object(o.a)("h2",{id:"hello-blog"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#hello-blog"})),"Hello Blog"),Object(o.a)("p",null,"This is my first post in the Vert.x Blog and I must admit that up until now I have never used Vert.x in a real project.\n\u201cWhy are you here?\u201d, you might ask\u2026 Well I cur\xadrently have two main hob\xadbies, learn\xading new things and se\xadcur\xading apps with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.keycloak.org/"}),"Key\xadcloak"),".\nSo a few days ago, I stum\xadbled upon the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.youtube.com/watch?v=LsaXy7SRXMY&list=PLkeCJDaCC2ZsnySdg04Aq9D9FpAZY6K5D"}),"In\xadtro\xadduc\xadtion to Vert.x video se\xadries on youtube")," by ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://twitter.com/infosec812"}),"Deven Phillips")," and I was im\xadme\xaddi\xadately hooked. Vert.x was a new thing for me, so the next log\xadi\xadcal step was to fig\xadure out how to se\xadcure a Vert.x app with Key\xadcloak."),Object(o.a)("p",null,"For this ex\xadam\xadple I build a small web app with Vert.x that shows how to im\xadple\xadment Sin\xadgle Sign-\u200bon (SSO) with Key\xadcloak\nand OpenID Con\xadnect, ob\xadtain in\xadfor\xadma\xadtion about the cur\xadrent user, check for roles, call bearer pro\xadtected ser\xadvices and prop\xaderly han\xaddling lo\xadgout."),Object(o.a)("h2",{id:"keycloak"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#keycloak"})),"Keycloak"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.keycloak.org/"}),"Key\xadcloak")," is a Open Source Iden\xadtity and Ac\xadcess Man\xadage\xadment so\xadlu\xadtion which pro\xadvides sup\xadport for OpenID Con\xadnect\nbased Singe-\u200bSign on, among many other things. I briefly looked for ways to se\xadcur\xading a Vert.x app with Key\xadcloak\nand quickly found an ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/vertx-3-and-keycloak-tutorial/"}),"older Vert.x Key\xadcloak in\xadte\xadgra\xadtion ex\xadam\xadple")," in this very blog.\nWhilst this is a good start for be\xadgin\xadners, the ex\xadam\xadple con\xadtains a few is\xadsues, e.g.:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"It uses hard\xadcoded OpenID provider con\xadfig\xadu\xadra\xadtion"),Object(o.a)("li",{parentName:"ul"},"Fea\xadtures a very sim\xadplis\xadtic in\xadte\xadgra\xadtion (for the sake of sim\xadplic\xadity)"),Object(o.a)("li",{parentName:"ul"},"No user in\xadfor\xadma\xadtion used"),Object(o.a)("li",{parentName:"ul"},"No lo\xadgout func\xadtion\xadal\xadity is shown")),Object(o.a)("p",null,"That some\xadhow nerd\xadsniped me a bit and so it came that, after a long day of con\xadsult\xading work, I sat down to cre\xadate an ex\xadam\xadple for a com\xadplete Key\xadcloak in\xadte\xadgra\xadtion based on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-auth-oauth2/java/"}),"Vert.x OpenID Con\xadnect / OAuth2 Sup\xadport"),"."),Object(o.a)("p",null,"So let\u2019s get started!"),Object(o.a)("h3",{id:"keycloak-setup"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#keycloak-setup"})),"Keycloak Setup"),Object(o.a)("p",null,"To se\xadcure a Vert.x app with Key\xadcloak we of course need a Key\xadcloak in\xadstance. Al\xadthough ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.keycloak.org/docs/latest/getting_started/"}),"Key\xadcloak has a great get\xadting started guide")," I wanted to make it a bit eas\xadier to put every\xadthing to\xadgether, there\xadfore I pre\xadpared a local Key\xadcloak docker con\xadtainer ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/thomasdarimont/vertx-playground/tree/master/keycloak-vertx#start-keycloak-with-the-vertx-realm"}),"as de\xadscribed here")," that you can start eas\xadily, which comes with all the re\xadquired con\xadfig\xadu\xadra\xadtion in place."),Object(o.a)("p",null,"The pre\xadcon\xadfig\xadured Key\xadcloak realm named ",Object(o.a)("inlineCode",{parentName:"p"},"vertx")," con\xadtains a ",Object(o.a)("inlineCode",{parentName:"p"},"demo-client")," for our Vert.x web app and a set\nof users for test\xading."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-haml"}),"docker run \\\n  -",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"it \\\n"),"  -",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"-name vertx-keycloak \\\n"),"  -",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"-rm \\\n"),"  -",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"e KEYCLOAK_USER=admin \\\n"),"  -",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"e KEYCLOAK_PASSWORD=admin \\\n"),"  -",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"e KEYCLOAK_IMPORT=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-regexp"}),"/tmp/vertx"),"-realm.json \\\n"),"  -",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"v $PWD/vertx-realm.",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-symbol"}),"json:"),"/tmp/vertx-realm.json \\\n"),"  -",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"ruby"}),"p ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-number"}),"8080"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-symbol"}),":"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-number"}),"8080")," \\\n"),"  quay.io/keycloak/keycloak:9.0.0\n")),Object(o.a)("h2",{id:"vertx-web-app"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-web-app"})),"Vert.x Web App"),Object(o.a)("p",null,"The sim\xadple web app con\xadsists of a sin\xadgle ",Object(o.a)("inlineCode",{parentName:"p"},"Verticle"),", runs on ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8090")," and pro\xadvides a few routes with pro\xadtected re\xadsources. ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/thomasdarimont/vertx-playground/blob/master/keycloak-vertx/src/main/java/demo/MainVerticle.java"}),"You can find the com\xadplete ex\xadam\xadple here"),"."),Object(o.a)("p",null,"The web app con\xadtains the fol\xadlow\xading routes with han\xaddlers:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"/")," - The un\xadpro\xadtected index page"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"/protected")," - The pro\xadtected page, which shows a greet\xading mes\xadsage, users need to login to ac\xadcess pages be\xadneath this path."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"/protected/user")," - The pro\xadtected user page, which shows some in\xadfor\xadma\xadtion about the user."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"/protected/admin")," - The pro\xadtected admin page, which shows some in\xadfor\xadma\xadtion about the admin, only users with role ",Object(o.a)("inlineCode",{parentName:"li"},"admin")," can ac\xadcess this page."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"/protected/userinfo")," - The pro\xadtected user\xadinfo page, ob\xadtains user in\xadfor\xadma\xadtion from the bearer token pro\xadtected user\xadinfo end\xadpoint in Key\xadcloak."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"/logout")," - The pro\xadtected lo\xadgout re\xadsource, which trig\xadgers the user lo\xadgout.")),Object(o.a)("h3",{id:"running-the-app"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#running-the-app"})),"Running the app"),Object(o.a)("p",null,"To run the app, we need to build our app via:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-ada"}),"cd keycloak-vertx\nmvn clean ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-title"})))),Object(o.a)("p",null,"This cre\xadates a runnable jar, which we can run via:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-mipsasm"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"java "),"-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"jar "),"target",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"/*.jar\n"))),Object(o.a)("p",null,"Note, that you need to start Key\xadcloak, since our app will try to fetch con\xadfig\xadu\xadra\xadtion from Key\xadcloak."),Object(o.a)("p",null,"If the ap\xadpli\xadca\xadtion is run\xadning, just browse to: ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8090/"),"."),Object(o.a)("p",null,"An ex\xadam\xadple in\xadter\xadac\xadtion with the app can be seen in the fol\xadlow\xading gif:\n","![Vert.x Keycloak Integration Demo]","({{ site_url }}as\xadsets/blog/vertx-\u200bkeycloak-integration/2020-03-07-\u200bvertx-keycloak-integration.gif)"),Object(o.a)("h3",{id:"router-sessionstore-and-csrf-protection"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#router-sessionstore-and-csrf-protection"})),"Router, SessionStore and CSRF Protection"),Object(o.a)("p",null,"We start the con\xadfig\xadu\xadra\xadtion of our web app by cre\xadat\xading a ",Object(o.a)("inlineCode",{parentName:"p"},"Router")," where we can add cus\xadtom han\xaddler func\xadtions for our routes.\nTo prop\xaderly han\xaddle the au\xadthen\xadti\xadca\xadtion state we need to cre\xadate a ",Object(o.a)("inlineCode",{parentName:"p"},"SessionStore")," and at\xadtach it to the ",Object(o.a)("inlineCode",{parentName:"p"},"Router"),".\nThe ",Object(o.a)("inlineCode",{parentName:"p"},"SessionStore")," is used by our OAuth2/OpenID Con\xadnect in\xadfra\xadstruc\xadture to as\xadso\xadciate au\xadthen\xadti\xadca\xadtion in\xadfor\xadma\xadtion with a ses\xadsion.\nBy the way, the ",Object(o.a)("inlineCode",{parentName:"p"},"SessionStore")," can also be clus\xadtered if you need to dis\xadtrib\xadute the server-\u200bside state."),Object(o.a)("p",null,"Note that if you want to keep your server state\xadless but still want to sup\xadport clus\xadter\xading,\nthen you could pro\xadvide your own im\xadple\xadmen\xadta\xadtion of a ",Object(o.a)("inlineCode",{parentName:"p"},"SessionStore")," which stores the ses\xadsion in\xadfor\xadma\xadtion\nas an en\xadcrypted cookie on the Client."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Router router = Router.router(vertx);\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Store session information on the server side"),"\nSessionStore sessionStore = LocalSessionStore.create(vertx);\nSessionHandler sessionHandler = SessionHandler.create(sessionStore);\nrouter.route().handler(sessionHandler);\n")),Object(o.a)("p",null,"In order to pro\xadtected against CSRF at\xadtacks it is good prac\xadtice to pro\xadtect HTML forms with a CSRF token.\nWe need this for our lo\xadgout form that we\u2019ll see later."),Object(o.a)("p",null,"To do this we con\xadfig\xadure a ",Object(o.a)("inlineCode",{parentName:"p"},"CSRFHandler")," and add it to our ",Object(o.a)("inlineCode",{parentName:"p"},"Router"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// CSRF handler setup required for logout form"),"\nString csrfSecret = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"zwiebelfische"'),";\nCSRFHandler csrfHandler = CSRFHandler.create(csrfSecret);\nrouter.route().handler(ctx -> {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Ensures that the csrf token request parameter is available for the CsrfHandler"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// after the logout form was submitted."),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// See "Handling HTML forms" https://vertx.io/docs/vertx-core/java/#_handling_requests'),"\n            ctx.request().setExpectMultipart(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\n            ctx.request().endHandler(v -> csrfHandler.handle(ctx));\n        }\n);\n")),Object(o.a)("h3",{id:"keycloak-setup-via-openid-connect-discovery"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#keycloak-setup-via-openid-connect-discovery"})),"Keycloak Setup via OpenID Connect Discovery"),Object(o.a)("p",null,"Our app is reg\xadis\xadtered as a con\xadfi\xadden\xadtial OpenID Con\xadnect client with Au\xadtho\xadriza\xadtion Code Flow in Key\xadcloak,\nthus we need to con\xadfig\xadure ",Object(o.a)("inlineCode",{parentName:"p"},"client_id")," and ",Object(o.a)("inlineCode",{parentName:"p"},"client_secret"),". Con\xadfi\xadden\xadtial clients are typ\xadi\xadcally used\nfor server-\u200bside web ap\xadpli\xadca\xadtions, where one can se\xadcurely store the ",Object(o.a)("inlineCode",{parentName:"p"},"client_secret"),". You can find out more\nabout",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.keycloak.org/docs/latest/server_admin/index.html#_access-type"}),"The dif\xadfer\xadent Client Ac\xadcess Types")," in the Key\xadcloak doc\xadu\xadmen\xadta\xadtion."),Object(o.a)("p",null,"Since we don\u2019t want to con\xadfig\xadure things like OAuth2 / OpenID Con\xadnect End\xadpoints our\xadselves, we use Key\xadcloak\u2019s OpenID Con\xadnect dis\xadcov\xadery end\xadpoint to infer the nec\xades\xadsary Oauth2 / OpenID Con\xadnect end\xadpoint URLs."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"String hostname = System.getProperty(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.host"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," port = Integer.getInteger(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8090"),");\nString baseUrl = String.format(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://%s:%d"'),", hostname, port);\nString oauthCallbackPath = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/callback"'),";\n\nOAuth2ClientOptions clientOptions = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," OAuth2ClientOptions()\n    .setFlow(OAuth2FlowType.AUTH_CODE)\n    .setSite(System.getProperty(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"oauth2.issuer"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://localhost:8080/auth/realms/vertx"'),"))\n    .setClientID(System.getProperty(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"oauth2.client_id"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"demo-client"'),"))\n    .setClientSecret(System.getProperty(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"oauth2.client_secret"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"1f88bd14-7e7f-45e7-be27-d680da6e48d8"'),"));\n\nKeycloakAuth.discover(vertx, clientOptions, asyncResult -> {\n\n    OAuth2Auth oauth2Auth = asyncResult.result();\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (oauth2Auth == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"throw")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RuntimeException(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Could not configure Keycloak integration via OpenID Connect Discovery Endpoint. Is Keycloak running?"'),");\n    }\n\n    AuthHandler oauth2 = OAuth2AuthHandler.create(oauth2Auth, baseUrl + oauthCallbackPath)\n        .setupCallback(router.get(oauthCallbackPath))\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Additional scopes: openid for OpenID Connect"),"\n        .addAuthority(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"openid"'),");\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// session handler needs access to the authenticated user, otherwise we get an infinite redirect loop"),"\n    sessionHandler.setAuthProvider(oauth2Auth);\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// protect resources beneath /protected/* with oauth2 handler"),"\n    router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected/*"'),").handler(oauth2);\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// configure route handlers"),"\n    configureRoutes(router, webClient, oauth2Auth);\n});\n\ngetVertx().createHttpServer().requestHandler(router).listen(port);\n")),Object(o.a)("h3",{id:"route-handlers"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#route-handlers"})),"Route handlers"),Object(o.a)("p",null,"We con\xadfig\xadure our route han\xaddlers via ",Object(o.a)("inlineCode",{parentName:"p"},"configureRoutes"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"configureRoutes"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Router router, WebClient webClient, OAuth2Auth oauth2Auth)")," "),"{\n\n    router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleIndex);\n\n    router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleGreet);\n    router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected/user"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleUserPage);\n    router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected/admin"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleAdminPage);\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// extract discovered userinfo endpoint url"),"\n    String userInfoUrl =  ((OAuth2AuthProviderImpl)oauth2Auth).getConfig().getUserInfoPath();\n    router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/protected/userinfo"'),").handler(createUserInfoHandler(webClient, userInfoUrl));\n\n    router.post(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/logout"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),"::handleLogout);\n}\n")),Object(o.a)("p",null,"The index han\xaddler ex\xadposes an un\xadpro\xadtected re\xadsource:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleIndex"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    respondWithOk(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Welcome to Vert.x Keycloak Example</h1><br><a href=\\"/protected\\">Protected</a>"'),");\n}\n")),Object(o.a)("h3",{id:"extract-user-information-from-the-openid-connect-id-token"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#extract-user-information-from-the-openid-connect-id-token"})),"Extract User Information from the OpenID Connect ID Token"),Object(o.a)("p",null,"Our app ex\xadposes a sim\xadple greet\xading page which shows some in\xadfor\xadma\xadtion about the user and pro\xadvides links to other pages."),Object(o.a)("p",null,"The user greet\xading han\xaddler is pro\xadtected by the Key\xadcloak OAuth2 / OpenID Con\xadnect in\xadte\xadgra\xadtion. To show in\xadfor\xadma\xadtion about\nthe cur\xadrent user, we first need to call the ",Object(o.a)("inlineCode",{parentName:"p"},"ctx.user()")," method to get an user ob\xadject we can work with.\nTo ac\xadcess the OAuth2 token in\xadfor\xadma\xadtion, we need to cast it to ",Object(o.a)("inlineCode",{parentName:"p"},"OAuth2TokenImpl"),"."),Object(o.a)("p",null,"We can ex\xadtract the user in\xadfor\xadma\xadtion like the user\xadname from the ",Object(o.a)("inlineCode",{parentName:"p"},"IDToken")," ex\xadposed by the user ob\xadject via ",Object(o.a)("inlineCode",{parentName:"p"},'user.idToken().getString("preferred_username")'),".\nNote, there are many more claims like (name, email, give\xadnanme, fam\xadi\xadly\xadname etc.) avail\xadable. The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://openid.net/specs/openid-connect-core-1_0.html#Claims"}),"OpenID Con\xadnect Core Spec\xadi\xadfi\xadca\xadtion")," con\xadtains a list of avail\xadable claims."),Object(o.a)("p",null,"We also gen\xader\xadate a list with links to the other pages which are sup\xadported:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleGreet"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    OAuth2TokenImpl oAuth2Token = (OAuth2TokenImpl) ctx.user();\n\n    String username = oAuth2Token.idToken().getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"preferred_username"'),");\n\n    String greeting = String.format(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Hi %s @%s</h1><ul>"')," +\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<li><a href=\\"/protected/user\\">User Area</a></li>"')," +\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<li><a href=\\"/protected/admin\\">Admin Area</a></li>"')," +\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<li><a href=\\"/protected/userinfo\\">User Info (Remote Call)</a></li>"')," +\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"</ul>"'),", username, Instant.now());\n\n    String logoutForm = createLogoutForm(ctx);\n\n    respondWithOk(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", greeting + logoutForm);\n}\n")),Object(o.a)("p",null,"The user page han\xaddler shows in\xadfor\xadma\xadtion about the cur\xadrent user:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleUserPage"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    OAuth2TokenImpl user = (OAuth2TokenImpl) ctx.user();\n\n    String username = user.idToken().getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"preferred_username"'),");\n    String displayName = oAuth2Token.idToken().getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),");\n\n    String content = String.format(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>User Page: %s (%s) @%s</h1><a href=\\"/protected\\">Protected Area</a>"'),",\n                                   username, displayName, Instant.now());\n    respondWithOk(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", content);\n}\n")),Object(o.a)("h3",{id:"authorization-checking-for-required-roles"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#authorization-checking-for-required-roles"})),"Authorization: Checking for Required Roles"),Object(o.a)("p",null,"Our app ex\xadposes a sim\xadple admin page which shows some in\xadfor\xadma\xadtion for ad\xadmins, which should only be vis\xadi\xadble for ad\xadmins. Thus we re\xadquire that users must have the ",Object(o.a)("inlineCode",{parentName:"p"},"admin")," realm role in Key\xadcloak to be able to ac\xadcess the admin page."),Object(o.a)("p",null,"This is done via a call to ",Object(o.a)("inlineCode",{parentName:"p"},'user.isAuthorized("realm:admin", cb)'),". The han\xaddler func\xadtion ",Object(o.a)("inlineCode",{parentName:"p"},"cb")," ex\xadposes\nthe re\xadsult of the au\xadtho\xadriza\xadtion check via the ",Object(o.a)("inlineCode",{parentName:"p"},"AsyncResult<Boolean> res"),". If the cur\xadrent user has the\n",Object(o.a)("inlineCode",{parentName:"p"},"admin")," role then the re\xadsult is ",Object(o.a)("inlineCode",{parentName:"p"},"true")," oth\xader\xadwise ",Object(o.a)("inlineCode",{parentName:"p"},"false"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleAdminPage"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    OAuth2TokenImpl user = (OAuth2TokenImpl) ctx.user();\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// check for realm-role "admin"'),"\n    user.isAuthorized(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"realm:admin"'),", res -> {\n\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!res.succeeded() || !res.result()) {\n            respondWith(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"403"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Forbidden</h1>"'),");\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n        }\n\n        String username = user.idToken().getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"preferred_username"'),");\n\n        String content = String.format(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Admin Page: %s @%s</h1><a href=\\"/protected\\">Protected Area</a>"'),",\n                                        username, Instant.now());\n        respondWithOk(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", content);\n    });\n}\n")),Object(o.a)("h4",{id:"call-services-protected-with-bearer-token"},Object(o.a)("a",Object(n.a)({parentName:"h4"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#call-services-protected-with-bearer-token"})),"Call Services protected with Bearer Token"),Object(o.a)("p",null,"Often we need to call other ser\xadvices from our web app that are pro\xadtected via Bearer Au\xadthen\xadti\xadca\xadtion. This means\nthat we need a valid ",Object(o.a)("inlineCode",{parentName:"p"},"access token")," to ac\xadcess a re\xadsource pro\xadvided on an\xadother server."),Object(o.a)("p",null,"To demon\xadstrate this we use Key\xadcloak\u2019s ",Object(o.a)("inlineCode",{parentName:"p"},"/userinfo")," end\xadpoint as a straw man to demon\xadstrate back\xadend calls with a bearer token."),Object(o.a)("p",null,"We can ob\xadtain the cur\xadrent valid ",Object(o.a)("inlineCode",{parentName:"p"},"access token")," via ",Object(o.a)("inlineCode",{parentName:"p"},"user.opaqueAccessToken()"),".\nSince we use a ",Object(o.a)("inlineCode",{parentName:"p"},"WebClient")," to call the pro\xadtected end\xadpoint, we need to pass the ",Object(o.a)("inlineCode",{parentName:"p"},"access token"),"\nvia the ",Object(o.a)("inlineCode",{parentName:"p"},"Authorization")," header by call\xading ",Object(o.a)("inlineCode",{parentName:"p"},"bearerTokenAuthentication(user.opaqueAccessToken())"),"\nin the cur\xadrent ",Object(o.a)("inlineCode",{parentName:"p"},"HttpRequest")," ob\xadject:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Handler<RoutingContext> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"createUserInfoHandler"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(WebClient webClient, String userInfoUrl)")," "),"{\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," (RoutingContext ctx) -> {\n\n        OAuth2TokenImpl user = (OAuth2TokenImpl) ctx.user();\n\n        URI userInfoEndpointUri = URI.create(userInfoUrl);\n        webClient\n            .get(userInfoEndpointUri.getPort(), userInfoEndpointUri.getHost(), userInfoEndpointUri.getPath())\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// use the access token for calls to other services protected via JWT Bearer authentication"),"\n            .bearerTokenAuthentication(user.opaqueAccessToken())\n            .as(BodyCodec.jsonObject())\n            .send(ar -> {\n\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!ar.succeeded()) {\n                    respondWith(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"500"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"{}"'),");\n                    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n                }\n\n                JsonObject body = ar.result().body();\n                respondWithOk(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),", body.encode());\n            });\n    };\n}\n")),Object(o.a)("h3",{id:"handle-logout"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#handle-logout"})),"Handle logout"),Object(o.a)("p",null,"Now that we got a work\xading SSO login with au\xadtho\xadriza\xadtion, it would be great if we would allow users to lo\xadgout again.\nTo do this we can lever\xadage the built-\u200bin OpenID Con\xadnect lo\xadgout func\xadtion\xadal\xadity which can be called via ",Object(o.a)("inlineCode",{parentName:"p"},"oAuth2Token.logout(cb)"),"."),Object(o.a)("p",null,"The han\xaddler func\xadtion ",Object(o.a)("inlineCode",{parentName:"p"},"cb")," ex\xadposes the re\xadsult of the lo\xadgout ac\xadtion via the ",Object(o.a)("inlineCode",{parentName:"p"},"AsyncResult<Void> res"),".\nIf the lo\xadgout was suc\xadcess\xadfull we destory our ses\xadsion via ",Object(o.a)("inlineCode",{parentName:"p"},"ctx.session().destroy()")," and redi\xadrect the user to the index page."),Object(o.a)("p",null,"The lo\xadgout form is gen\xader\xadated via the ",Object(o.a)("inlineCode",{parentName:"p"},"createLogoutForm")," method."),Object(o.a)("p",null,"As men\xadtioned ear\xadlier, we need to pro\xadtect our lo\xadgout form with a CSRF token to pre\xadvent ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://owasp.org/www-community/attacks/csrf"}),"CSRF at\xadtacks"),"."),Object(o.a)("p",null,"Note: If we had end\xadpoints that would ac\xadcept data sent to the server, then we\u2019d need to guard those end\xadpoints with an CSRF token as well."),Object(o.a)("p",null,"We need to ob\xadtain the gen\xader\xadated ",Object(o.a)("inlineCode",{parentName:"p"},"CSRFToken")," and ren\xadder it into a hid\xadden form input field that\u2019s trans\xadfered via HTTP POST when the lo\xadgout form is sub\xadmit\xadted:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"handleLogout"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    OAuth2TokenImpl oAuth2Token = (OAuth2TokenImpl) ctx.user();\n    oAuth2Token.logout(res -> {\n\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!res.succeeded()) {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// the user might not have been logged out, to know why:"),"\n            respondWith(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"500"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),", String.format(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Logout failed %s</h1>"'),", res.cause()));\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n        }\n\n        ctx.session().destroy();\n        ctx.response().putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"location"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/?logout=true"'),").setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"302"),").end();\n    });\n}\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," String ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"createLogoutForm"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n\n    String csrfToken = ctx.get(CSRFHandler.DEFAULT_HEADER_NAME);\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<form action=\\"/logout\\" method=\\"post\\">"'),"\n            + String.format(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<input type=\\"hidden\\" name=\\"%s\\" value=\\"%s\\">"'),", CSRFHandler.DEFAULT_HEADER_NAME, csrfToken)\n            + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<button>Logout</button></form>"'),";\n}\n")),Object(o.a)("p",null,"Some ad\xaddi\xadtional plumb\xading:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"respondWithOk"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx, String contentType, String content)")," "),"{\n    respondWith(ctx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),", contentType, content);\n}\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"respondWith"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx, ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," statusCode, String contentType, String content)")," "),"{\n    ctx.request().response() ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//"),"\n            .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", contentType) ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//"),"\n            .setStatusCode(statusCode)\n            .end(content);\n}\n")),Object(o.a)("h2",{id:"more-examples"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#more-examples"})),"More examples"),Object(o.a)("p",null,"This con\xadcludes the Key\xadcloak in\xadte\xadgra\xadtion ex\xadam\xadple."),Object(o.a)("p",null,"Check out the com\xadplete ex\xadam\xadple in ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/thomasdarimont/vertx-playground/tree/master/keycloak-vertx"}),"keycloak-\u200bvertx Ex\xadam\xadples Repo"),"."),Object(o.a)("p",null,"Thank you for your time, stay tuned for more up\xaddates! If you want to learn more about Key\xadcloak, feel free to reach out to me. You can find me via ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://twitter.com/thomasdarimont"}),"thomas\xadda\xadri\xadmont on twit\xadter"),"."),Object(o.a)("p",null,"Happy Hack\xading!"))}m.isMDXComponent=!0},Hx7l:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3 and Azure cloud platform tutorial",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"Vert.x 3.2.1 applications can quickly be deployed on Microsoft Azure. Deployment is independent of your build so it is all about configuration."}),i=[{term:"deploi",tf:3},{term:"azur",tf:3},{term:"app",tf:3},{term:"quickli",tf:2},{term:"network",tf:2},{term:"virtual",tf:2},{term:"discoveri",tf:2},{term:"creat",tf:2},{term:"screencast",tf:2},{term:"follow",tf:2},{term:"applic",tf:1},{term:"microsoft",tf:1},{term:"deploy",tf:1},{term:"independ",tf:1},{term:"build",tf:1},{term:"configur",tf:1},{term:"design",tf:1},{term:"not",tf:1},{term:"support",tf:1},{term:"level",tf:1},{term:"howev",tf:1},{term:"machin",tf:1},{term:"defin",tf:1},{term:"group",tf:1},{term:"default",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Vert.x 3.2.1 ap\xadpli\xadca\xadtions can quickly be de\xadployed on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://portal.azure.com/"}),"Mi\xadcrosoft Azure"),". De\xadploy\xadment is in\xadde\xadpen\xaddent of your build so it is all about con\xadfig\xadu\xadra\xadtion."),Object(o.a)("h2",{id:"about-azure"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#about-azure"})),"About Azure"),Object(o.a)("p",null,"Azure by de\xadsign does not sup\xadport ",Object(o.a)("inlineCode",{parentName:"p"},"multicast")," on the net\xadwork vir\xadtu\xadal\xadiza\xadtion level, how\xadever all vir\xadtual ma\xadchines de\xadfined\non the same group are de\xadployed on the same net\xadwork (by de\xadfault), so ",Object(o.a)("inlineCode",{parentName:"p"},"TCP-IP")," dis\xadcov\xadery can be en\xadabled and quickly setup\nto form a clus\xadter."),Object(o.a)("p",null,"This how you would de\xadploy your app:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"cre\xadate a ",Object(o.a)("inlineCode",{parentName:"li"},"fat-jar")," with your app"),Object(o.a)("li",{parentName:"ol"},"cre\xadate a ",Object(o.a)("inlineCode",{parentName:"li"},"cluster.xml")," with tcp-\u200bip dis\xadcov\xadery"),Object(o.a)("li",{parentName:"ol"},"run your app with: ",Object(o.a)("inlineCode",{parentName:"li"},"cp folder_of_your_cluster_xml_file -cluster -cluster-host VM_PRIVATE_IP"))),Object(o.a)("h2",{id:"screencast"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#screencast"})),"Screencast"),Object(o.a)("p",null,"The fol\xadlow\xading screen\xadcast "),Object(o.a)("div",{className:"youtube-embed"},Object(o.a)("iframe",{src:"https://www.youtube.com/embed/nGQs_swWwAM",frameBorder:"0",allowFullScreen:!0})),Object(o.a)("p",null,"Don\u2019t for\xadget to fol\xadlow our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA"}),"youtube chan\xadnel"),"!"))}m.isMDXComponent=!0},KJRa:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x ES6 back to the future",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"On October 21th, 2015 we all rejoiced with the return from the past of Marty McFly with his flying car and so on, however in the Vert.x world we were quite sad about our rather old JavaScript support."}),i=[{term:"us",tf:9},{term:"file",tf:5},{term:"transpil",tf:4},{term:"howev",tf:3},{term:"world",tf:3},{term:"support",tf:3},{term:"someth",tf:3},{term:"futur",tf:3},{term:"let",tf:3},{term:"start",tf:3},{term:"hello",tf:3},{term:"es6",tf:3},{term:"code",tf:3},{term:"main",tf:3},{term:"compil",tf:3},{term:"npm",tf:3},{term:"quit",tf:2},{term:"javascript",tf:2},{term:"es5",tf:2},{term:"not",tf:2},{term:"run",tf:2},{term:"back",tf:2},{term:"ll",tf:2},{term:"write",tf:2},{term:"just",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"On ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://backtothefuture.wikia.com/wiki/2015"}),"Oc\xadto\xadber 21th, 2015")," we all re\xadjoiced with the re\xadturn from the past of\nMarty McFly with his fly\xading car and so on, how\xadever in the Vert.x world we were quite sad that the JavaScript sup\xadport we\nhave was still using a tech\xadnol\xadogy re\xadleased in ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/ECMAScript#Versions"}),"De\xadcem\xadber 2009"),". The\nsup\xadport for ES5 is not some\xadthing that we Vert.x team con\xadtrols but some\xadthing that is in\xadher\xadited from run\xadning on top of\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://openjdk.java.net/projects/nashorn/"}),"Nashorn"),"."),Object(o.a)("p",null,"With all these nos\xadtal\xadgic thoughts on my mind I\u2019ve de\xadcided to bring us back to the fu\xadture and by fu\xadture I mean, let\u2019s\nstart using a mod\xadern JavaScript, or more cor\xadrectly, let\u2019s start using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://es6-features.org/"}),"EC\xadMAScript 6"),"."),Object(o.a)("p",null,"It turned out to be quite sim\xadple to achieve this so I\u2019ll pick the hello world ex\xadam\xadple and write it in ES6 just to show\nhow you can port your code to ES6 and still use the cur\xadrent Vert.x APIs. Note that Vert.x in\xadter\xadnals still are ES5 and\nhave not been touched or mod\xadi\xadfied to sup\xadport any of ES6 fea\xadtures."),Object(o.a)("h2",{id:"main"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#main"})),"main"),Object(o.a)("p",null,"Tra\xaddi\xadtion\xadally your ",Object(o.a)("inlineCode",{parentName:"p"},"main.js")," file would re\xadside in the root of your mod\xadule (this is where ",Object(o.a)("inlineCode",{parentName:"p"},"NPM")," will look for it by\nde\xadfault); how\xadever as we are going to tran\xadspile to ",Object(o.a)("inlineCode",{parentName:"p"},"ES5")," you\u2019ll want to put your index file in ",Object(o.a)("inlineCode",{parentName:"p"},"/src/main.js"),"."),Object(o.a)("p",null,"How\xadever, be\xadcause we are tran\xadspiling to ",Object(o.a)("inlineCode",{parentName:"p"},"ES5"),", your ",Object(o.a)("inlineCode",{parentName:"p"},"package.json"),"\u2019s main block should point to the tran\xadspiled ",Object(o.a)("inlineCode",{parentName:"p"},"index.js"),"\nfile in the ",Object(o.a)("inlineCode",{parentName:"p"},"/lib")," di\xadrec\xadtory."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-es6"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"version"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0.0.1"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"private"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),",\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"main"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"lib/main.js"'),",\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"scripts"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"build"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"rm -Rf lib && ./node_modules/.bin/babel --out-dir lib src"'),",\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"start"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"./node_modules/.bin/vertx run lib/main.js"'),"\n  },\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"dependencies"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"vertx3-full"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"3.1.0"'),",\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"babel-cli"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"6.2.0"'),",\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"babel-preset-es2015"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"6.1.18"'),"\n  }\n}\n")),Object(o.a)("p",null,"As you can see, the main idea is to in\xadvoke the tran\xadspiler (Babel) when we are build\xading our project, and run it using the\ngen\xader\xadated files. This is slightly equiv\xada\xadlent to a com\xadpi\xadla\xadtion process you would have using com\xadpiled lan\xadguage."),Object(o.a)("h2",{id:"npmignore"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#npmignore"})),".npmignore"),Object(o.a)("p",null,"If you\u2019re plan\xadning to de\xadploy your pack\xadage to npm ei\xadther local or pri\xadvate you should be aware that npm will ex\xadclude\nany\xadthing listed on your ",Object(o.a)("inlineCode",{parentName:"p"},".gitignore")," since we should ig\xadnore the gen\xader\xadated code from git it need to in\xadform npm to ig\xadnore\nthat rule and keep the ",Object(o.a)("inlineCode",{parentName:"p"},"lib")," di\xadrec\xadtory. The ",Object(o.a)("inlineCode",{parentName:"p"},".gitignore")," should be some\xadthing like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),"/lib\n/node_modules\n")),Object(o.a)("p",null,"And the ",Object(o.a)("inlineCode",{parentName:"p"},".npmignore"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),"/.gitignore\n")),Object(o.a)("h2",{id:"hello-fat-arrows-and-let-keywords"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#hello-fat-arrows-and-let-keywords"})),"Hello fat arrows and let keywords"),Object(o.a)("p",null,"So all the heavy work has been done, in order to cre\xadate our hello world we just need to code some ",Object(o.a)("inlineCode",{parentName:"p"},"ES6")," in our\n",Object(o.a)("inlineCode",{parentName:"p"},"src/main.js")," file:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," Router = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"require"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-web-js/router"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," server = vertx.createHttpServer();\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," router = Router.router(vertx);\n\nrouter.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"ctx"),") =>")," {\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"let")," response = ctx.response();\n    response.putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/plain"'),");\n\n    response.end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello ES6 World!"'),");\n});\n\nserver.requestHandler(router.accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(o.a)("p",null,"As you can see we\u2019re using fat ar\xadrows in\xadstead of writ\xading a func\xadtion clo\xadsure and scoped vari\xadables using ",Object(o.a)("inlineCode",{parentName:"p"},"let")," key\xadword. If\nyou now com\xadpile your project:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-dockerfile"}),"npm ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"run"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," build"),"\n")),Object(o.a)("p",null,"And then start it:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-coffeescript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"npm")," start\n")),Object(o.a)("p",null,"You have your first back to the fu\xadture ",Object(o.a)("inlineCode",{parentName:"p"},"ES6")," ver\xadti\xadcle!"))}m.isMDXComponent=!0},KM6s:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return i})),t.d(a,"__tfidf__terms",(function(){return p})),t.d(a,"default",(function(){return j}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("a1bP"),i=(r.a.createElement,{title:"Contract Driven REST Services with Vert.x3",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"We see a new trend in development where we are shifting from developing applications to APIs. More and more we see services being offered as REST APIs that we are allowed to consume."}),p=[{term:"api",tf:21},{term:"test",tf:18},{term:"document",tf:16},{term:"code",tf:11},{term:"raml",tf:10},{term:"us",tf:9},{term:"contract",tf:9},{term:"implement",tf:8},{term:"develop",tf:7},{term:"rest",tf:7},{term:"not",tf:7},{term:"tool",tf:7},{term:"need",tf:7},{term:"applic",tf:6},{term:"just",tf:6},{term:"start",tf:6},{term:"howev",tf:6},{term:"simpl",tf:5},{term:"will",tf:5},{term:"ll",tf:5},{term:"web",tf:4},{term:"let",tf:4},{term:"client",tf:4},{term:"step",tf:4},{term:"load",tf:4}],m={meta:i,__tfidf__terms:p};function j(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},m,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We see a new trend in de\xadvel\xadop\xadment where we are shift\xading from de\xadvel\xadop\xading ap\xadpli\xadca\xadtions to de\xadvelop APIs. More and more we see ser\xadvices being of\xadfered as REST APIs that we are al\xadlowed to con\xadsume and we al\xadready see this trend from the big names in the in\xaddus\xadtry, e.g.: ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://developers.facebook.com/"}),"Face\xadbook"),", ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.mediawiki.org/wiki/API:Main_page"}),"Wikipedia"),", ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://developer.amazon.com/public/apis"}),"Ama\xadzon"),", ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://dev.twitter.com/overview/documentation"}),"Twit\xadter"),", ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://developers.google.com/apis-explorer/#p/"}),"Google")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.reddit.com/dev/api"}),"Red\xaddit")," they all offer APIs."),Object(o.a)("p",null,"Of course mak\xading an REST API using Vert.x is quite sim\xadple, just use ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/#web"}),"Vert.x Web")," and you can start writ\xading your API in sec\xadonds, how\xadever an API with\xadout doc\xadu\xadmen\xadta\xadtion is not an API since no de\xadvel\xadoper will know how to use it. How\xadever this is one of the most sen\xadsi\xadtive is\xadsues to tackle in soft\xadware de\xadvel\xadop\xadment, no\xadbody likes to write doc\xadu\xadmen\xadta\xadtion. How\xadever, in the REST age where REST-\u200bbased web-\u200bservices are ubiq\xadui\xadtous, doc\xadu\xadmen\xadta\xadtion for pub\xadlic web-\u200bservices is a ne\xadces\xadsity. There are a lot of tools out there, two of the most pop\xadu\xadlar are with\xadout a doubt:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://swagger.io"}),"Swag\xadger")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://raml.org"}),"RAML"))),Object(o.a)("p",null,"Both frame\xadworks have a large ecosys\xadtem of tools and tool\xading around but they tackle the doc\xadu\xadmen\xadta\xadtion from two dif\xadfer\xadent per\xadspec\xadtives. While Swag\xadger is purely a doc\xadu\xadmen\xadta\xadtion tool it tack\xadles the prob\xadlem from bot\xadtom up and RAML does doc\xadu\xadment top down. They both rely on a doc\xadu\xadment (",Object(o.a)("inlineCode",{parentName:"p"},"JSON")," for Swag\xadger, ",Object(o.a)("inlineCode",{parentName:"p"},"YAML")," for RAML)."),Object(o.a)("p",null,"I\u2019ll now go over build\xading a sim\xadple Hello World API, doc\xadu\xadment it and test it. For this ex\xadam\xadple I\u2019ll choose RAML since it feels more nat\xadural to the way we code with Vert.x Web."),Object(o.a)("h2",{id:"define-the-hello-world-api"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#define-the-hello-world-api"})),"Define the Hello World API"),Object(o.a)("p",null,"We need a con\xadtract and as with any other de\xadvel\xadop\xadment we need some spec\xadi\xadfi\xadca\xadtion, You can learn about RAML in its ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://raml.org"}),"web\xadsite")," and quickly see how easy it is to get started. So we start with the fol\xadlow\xading spec\xadi\xadfi\xadca\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-yaml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"#%RAML 0.8"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"title:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"Hello")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"world")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"REST")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"API"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"baseUri:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"http://localhost:8080/"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"version:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"v1"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"/hello:"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"get:"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"200:"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"body:"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"application/json:"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'|\n              { "$schema": "http://json-schema.org/schema",\n                "type": "object",\n                "description": "Hello World Greeting",\n                "properties": {\n                  "greeting":  { "type": "string" }\n                },\n                "required": [ "greeting" ]\n              }\n'))),Object(o.a)("p",null,"So if you didn\u2019t un\xadder\xadstood why I named RAML as a top down doc\xadu\xadmen\xadta\xadtion tool, I think it be\xadcomes clear now. So there are some basic de\xadf\xadi\xadn\xadi\xadtion on the top of the file like, ",Object(o.a)("inlineCode",{parentName:"p"},"title"),", ",Object(o.a)("inlineCode",{parentName:"p"},"baseUri")," and ",Object(o.a)("inlineCode",{parentName:"p"},"version")," which should be self ex\xadplana\xadtory."),Object(o.a)("p",null,"And then we start with the API doc\xadu\xadmen\xadta\xadtion, so we spec\xadify that at the ",Object(o.a)("inlineCode",{parentName:"p"},"URL")," ",Object(o.a)("inlineCode",{parentName:"p"},"/hello")," using the HTTP verb ",Object(o.a)("inlineCode",{parentName:"p"},"GET")," you are ex\xadpected to get a re\xadsponse with sta\xadtus code ",Object(o.a)("inlineCode",{parentName:"p"},"200")," and the body of the re\xadsponse should have con\xadtent type ",Object(o.a)("inlineCode",{parentName:"p"},"application/json"),". This is a very min\xadi\xadmal doc\xadu\xadment, one could go over and spec\xadify the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://json-schema.org/"}),Object(o.a)("inlineCode",{parentName:"a"},"json schema"))," for the re\xadsponse, input val\xadues, etc\u2026, how\xadever lets just keep it sim\xadple for this ex\xadam\xadple."),Object(o.a)(l.a,{info:!0,mdxType:"Alert"},Object(o.a)("p",null,"If you do not like to write yaml in your ed\xadi\xadtor you can al\xadways use the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://raml.org/projects.html"}),"API De\xadsigner")," which gives you in\xadstant feed\xadback on your API doc\xadu\xadment and pro\xadvides a test\xading plat\xadform.")),Object(o.a)("h2",{id:"implement-the-api"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implement-the-api"})),"Implement the API"),Object(o.a)("p",null,"So you got your con\xadtract, time to im\xadple\xadment it, this is a very sim\xadple API so I\u2019ll jump to the code im\xadme\xaddi\xadately:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"App")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    Router router = Router.router(vertx);\n\n    router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/hello"'),").handler(rc -> {\n      rc.response()\n          .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")\n          .end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"greeting"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello World!"'),").encode());\n    });\n\n    vertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n  }\n}\n")),Object(o.a)("p",null,"As you can see the code re\xadsem\xadbles the con\xadtract doc\xadu\xadment, when there is a ",Object(o.a)("inlineCode",{parentName:"p"},"GET")," re\xadquest to ",Object(o.a)("inlineCode",{parentName:"p"},"/hello")," we send to the client a empty ",Object(o.a)("inlineCode",{parentName:"p"},"JSON")," doc\xadu\xadment ",Object(o.a)("inlineCode",{parentName:"p"},"{}"),"."),Object(o.a)("h2",{id:"are-we-done"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#are-we-done"})),"Are we done?"),Object(o.a)("p",null,"The an\xadswer is ",Object(o.a)("strong",{parentName:"p"},"NO!!!")," how can we be sure that our im\xadple\xadmen\xadta\xadtion does com\xadply to the con\xadtract? We need to test. As I wrote be\xadfore there is no spe\xadcific sup\xadport for Vert.x from RAML or other tools how\xadever in this case it is not a prob\xadlem we can still test our code with\xadout hav\xading the need to im\xadple\xadment a test frame\xadwork from the ground up."),Object(o.a)("h2",{id:"testing-our-contract"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#testing-our-contract"})),"Testing our contract"),Object(o.a)("p",null,"The ini\xadtial step is to setup a test, this should be triv\xadial we are using Java (al\xadthough we could test any of Vert.x\nsup\xadported lan\xadguages using the same tech\xadnique). We cre\xadate a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://junit.org/"}),"JUnit")," unit test."),Object(o.a)(l.a,{info:!0,mdxType:"Alert"},Object(o.a)("p",null,"For this ex\xadam\xadple, I will be using JUnit in\xadstead of Vert.x Test mostly to let you know that Vert.x isn\u2019t an opin\xadion\xadated frame\xadwork, so you are free to choose the tool that best fits you.")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"APITest")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@BeforeClass"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"bootApp"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    Runner.run(App.class);\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"testHelloEndpoint"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n  }\n}\n")),Object(o.a)("p",null,"So at this mo\xadment you have a sim\xadple test, I\u2019ll share the code of the run\xadner class (ba\xadsi\xadcally it just in\xadstan\xadti\xadates a\n",Object(o.a)("inlineCode",{parentName:"p"},"Vertx")," in\xadstance and load the ",Object(o.a)("inlineCode",{parentName:"p"},"verticle")," we just im\xadple\xadmented above) and has a empty test ",Object(o.a)("inlineCode",{parentName:"p"},"testHelloEndpoint"),"."),Object(o.a)("h3",{id:"load-the-api-definition-into-the-test"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#load-the-api-definition-into-the-test"})),"Load the API definition into the test"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"APITest")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," RamlDefinition api = RamlLoaders.fromClasspath()\n        .load(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/hello.raml"'),")\n        .assumingBaseUri(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://localhost:8080/"'),");\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," CheckingWebTarget checking;\n\n  ...\n}\n")),Object(o.a)("p",null,"So the first step is to load the ",Object(o.a)("inlineCode",{parentName:"p"},"API")," de\xadf\xadi\xadn\xadi\xadtion into our test and have a ref\xader\xadence to a ",Object(o.a)("inlineCode",{parentName:"p"},"CheckingWebTarget")," ob\xadject. The check\xading ob\xadject is where you can per\xadform as\xadser\xadtions, but to do this we need some client make REST calls in order to test."),Object(o.a)("h3",{id:"create-a-rest-client"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#create-a-rest-client"})),"Create a REST client"),Object(o.a)("p",null,"There are many op\xadtions for this, you could use ",Object(o.a)("inlineCode",{parentName:"p"},"JAX-RS"),", ",Object(o.a)("inlineCode",{parentName:"p"},"RestAssured"),", ",Object(o.a)("inlineCode",{parentName:"p"},"RestEasy"),", etc\u2026 so I\u2019ll pick ",Object(o.a)("inlineCode",{parentName:"p"},"RestEasy")," for now:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"APITest")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," RamlDefinition api = RamlLoaders.fromClasspath()\n      .load(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/hello.raml"'),")\n      .assumingBaseUri(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://localhost:8080/"'),");\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ResteasyClient client = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ResteasyClientBuilder().build();\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," CheckingWebTarget checking;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@BeforeClass"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"bootApp"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    Runner.run(App.class);\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Before"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"createTarget"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    checking = api.createWebTarget(client.target(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://localhost:8080"'),"));\n  }\n\n  ...\n}\n")),Object(o.a)("h3",{id:"implement-the-test"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implement-the-test"})),"Implement the test"),Object(o.a)("p",null,"All of the boil\xader\xadplate code is in place and if you look at the pre\xadvi\xadous sec\xadtion you will see that it wasn\u2019t that bad, just a few lines and you loaded the RAML con\xadtract, cre\xadated a REST client and started up your ap\xadpli\xadca\xadtion and all this under ~10 lines of code."),Object(o.a)("p",null,"So lets fin\xadish and im\xadple\xadment the ver\xadi\xadfi\xadca\xadtion of the con\xadtract:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"APITest")," "),"{\n  ...\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"testHelloEndpoint"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    checking.path(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/hello"'),").request().get();\n    Assert.assertThat(checking.getLastReport(), RamlMatchers.hasNoViolations());\n  }\n}\n")),Object(o.a)("p",null,"Once you run your tests, you will see:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-css"}),"13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.200")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"o"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".a"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".h"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".i"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".conn"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".DefaultClientConnection")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Sending")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"request"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"GET")," /",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"hello")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"HTTP"),"/1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".1"),"\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.201")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  >> "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"GET")," /",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"hello")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"HTTP"),"/1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".1"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.202")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  >> "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Accept-Encoding"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"gzip"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"deflate"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.202")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  >> "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Host"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"localhost"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":8080"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.202")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  >> "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Connection"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Keep-Alive"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.202")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  >> "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.202")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".headers")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," >> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"GET")," /",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"hello")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"HTTP"),"/1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".1"),"\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.202")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".headers")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," >> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Accept-Encoding"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"gzip"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"deflate"),"\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.203")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".headers")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," >> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Host"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"localhost"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":8080"),"\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.203")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".headers")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," >> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Connection"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Keep-Alive"),"\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.412")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  << "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"HTTP"),"/1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".1")," 200 ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"OK"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.413")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  << "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"content-type"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"application"),"/",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"json"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.413")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  << "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Content-Length"),": 2",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.413")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  << "',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\r]"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[\\n]"),'"\n13',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.414")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"o"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".a"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".h"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".i"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".conn"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".DefaultClientConnection")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Receiving")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"response"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"HTTP"),"/1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".1")," 200 ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"OK"),"\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.414")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".headers")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," << ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"HTTP"),"/1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".1")," 200 ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"OK"),"\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.415")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".headers")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," << ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"content-type"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"application"),"/",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"json"),"\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.415")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".headers")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-")," << ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Content-Length"),": 2\n13",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":09"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-pseudo"}),":28.429")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-attr"}),"[main]")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"DEBUG")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"org"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".apache"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".http"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".wire")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"-"),'  << "{}"\n',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Tests")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"run"),": 1, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Failures"),": 0, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Errors"),": 0, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Skipped"),": 0, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Time")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"elapsed"),": 1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-class"}),".076")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"sec"),"\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Results")," :\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Tests")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"run"),": 1, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Failures"),": 0, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Errors"),": 0, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-selector-tag"}),"Skipped"),": 0\n")),Object(o.a)("p",null,"And we are done, we now have a API that fol\xadlow the con\xadtract, you can now keep de\xadvel\xadop\xading your API and im\xadple\xadmen\xadta\xadtion and have a test dri\xadven ap\xadproach to be sure that the con\xadtract is not bro\xadken."),Object(o.a)("h2",{id:"next-steps"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#next-steps"})),"Next steps"),Object(o.a)("p",null,"Until now you have learn how to in\xadte\xadgrate RAML into Vert.x and CI, how\xadever the users of your API will not be able to know much about the API yet since its doc\xadu\xadmen\xadta\xadtion is not pub\xadlicly avail\xadable. So lets pub\xadlish on\xadline the doc\xadu\xadmen\xadta\xadtion of your API, of course if your API is pri\xadvate you do not need to fol\xadlow these steps."),Object(o.a)("p",null,"In order to do this all we need it to in\xadclude in our ap\xadpli\xadca\xadtion the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/mulesoft/api-console"}),"RAML con\xadsole"),", the fastest way to do this is just down\xadload a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/mulesoft/api-console/releases"}),"re\xadlease")," to ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/resouces/webroot")," and in the orig\xadi\xadnal ap\xadpli\xadca\xadtion Vert.x Router we add a Sta\xadtic Con\xadtent Han\xaddler to serve the con\xadsole files. Your ap\xadpli\xadca\xadtion source code should look like this:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"App")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    Router router = Router.router(vertx);\n\n    router.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/hello"'),").handler(rc -> {\n      rc.response()\n          .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")\n          .end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"greeting"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello World!"'),").encode());\n    });\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// optionally enable the web console so users can play with your API"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// online from their web browsers"),"\n    router.route().handler(StaticHandler.create());\n\n    vertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n  }\n}\n")),Object(o.a)("p",null,"Once you start you ap\xadpli\xadca\xadtion open a browser point\xading at the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://localhost:8080?raml=/api/hello.raml"}),"con\xadsole"),". Once you do that you should be pre\xadsented with some\xadthing sim\xadi\xadlar to this:"),Object(o.a)("img",{src:t("OfB8"),alt:"apiconsole"}),Object(o.a)("h2",{id:"article-source-code"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#article-source-code"})),"Article source code"),Object(o.a)("p",null,"You can get the full source code for this ar\xadti\xadcle ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pmlopes/vert-x3-experiments/tree/experiments/raml"}),"here"),"."))}j.isMDXComponent=!0},KqH9:function(e,a){e.exports="/_next/static/images/screencast-e26cc8039f9486097b215b8b69845ef5.gif"},LFoy:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Time scheduling with Chime",category:"guides",authors:[{name:"Lisi",github_id:"LisiLisenok"}],summary:"Eclipse Vert.x executes periodic and delayed actions with periodic and one-shot timers. Chime is a time scheduler verticle that works on the Vert.x event bus."}),i=[{term:"timer",tf:55},{term:"schedul",tf:34},{term:"time",tf:24},{term:"chime",tf:19},{term:"name",tf:18},{term:"event",tf:15},{term:"address",tf:13},{term:"fire",tf:12},{term:"creat",tf:12},{term:"messag",tf:10},{term:"ceylon",tf:10},{term:"given",tf:9},{term:"request",tf:8},{term:"verticl",tf:7},{term:"bu",tf:7},{term:"provid",tf:7},{term:"send",tf:7},{term:"json",tf:7},{term:"date",tf:6},{term:"avail",tf:6},{term:"start",tf:6},{term:"info",tf:6},{term:"featur",tf:5},{term:"rather",tf:5},{term:"repeat",tf:5}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Eclipse Vert.x ex\xade\xadcutes pe\xadri\xadodic and de\xadlayed ac\xadtions with\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-core/java/#_executing_periodic_and_delayed_actions"}),"pe\xadri\xadodic and one-\u200bshot timers"),".\nThis is the base for time sched\xadul\xading and reach fea\xadture ex\xadten\xadsion must be rather in\xadter\xadest\xading.\nBe no\xadti\xadfied at cer\xadtain date / time, take into ac\xadcount hol\xadi\xaddays,\nre\xadpeat no\xadti\xadfi\xadca\xadtions until a given date, apply time zone,\ntake into ac\xadcount day\xadlight sav\xading time etc.\nThere are a lot of use\xadful fea\xadtures time sched\xaduler may in\xadtro\xadduce to the Vert.x stack.  "),Object(o.a)("h2",{id:"chime"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#chime"})),"Chime"),Object(o.a)("p",null," ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/LisiLisenok/Chime"}),"Chime")," is time sched\xaduler ver\xadti\xadcle which works on ",Object(o.a)("em",{parentName:"p"},"Vert.x")," event bus and pro\xadvides:  "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"sched\xadul\xading with ",Object(o.a)("em",{parentName:"li"},"cron-\u200bstyle"),", ",Object(o.a)("em",{parentName:"li"},"in\xadter\xadval")," or ",Object(o.a)("em",{parentName:"li"},"union")," timers:"),Object(o.a)("li",{parentName:"ul"},"at a cer\xadtain time of day (to the sec\xadond);  "),Object(o.a)("li",{parentName:"ul"},"on cer\xadtain days of the week, month or year;  "),Object(o.a)("li",{parentName:"ul"},"with a given time in\xadter\xadval;  "),Object(o.a)("li",{parentName:"ul"},"with nearly any com\xadbi\xadna\xadtion of all of above;  "),Object(o.a)("li",{parentName:"ul"},"re\xadpeat\xading a given num\xadber of times;  "),Object(o.a)("li",{parentName:"ul"},"re\xadpeat\xading until a given time / date;  "),Object(o.a)("li",{parentName:"ul"},"re\xadpeat\xading in\xadfi\xadnitely  "),Object(o.a)("li",{parentName:"ul"},"prox\xady\xading event bus with con\xadven\xadtional in\xadter\xadfaces  "),Object(o.a)("li",{parentName:"ul"},"ap\xadply\xading time zones avail\xadable on ",Object(o.a)("em",{parentName:"li"},"JVM")," with day\xadlight sav\xading time taken into ac\xadcount  "),Object(o.a)("li",{parentName:"ul"},"flex\xadi\xadble timers man\xadage\xadment sys\xadtem:  "),Object(o.a)("li",{parentName:"ul"},"group\xading timers;  "),Object(o.a)("li",{parentName:"ul"},"defin\xading a timer start or end times  "),Object(o.a)("li",{parentName:"ul"},"paus\xading / re\xadsum\xading;  "),Object(o.a)("li",{parentName:"ul"},"fire count\xading;  "),Object(o.a)("li",{parentName:"ul"},"lis\xadten\xading and send\xading mes\xadsages via event bus with ",Object(o.a)("em",{parentName:"li"},"JSON"),";  "),Object(o.a)("li",{parentName:"ul"},Object(o.a)("em",{parentName:"li"},"pub\xadlish\xading")," or ",Object(o.a)("em",{parentName:"li"},"send\xading")," timer fire event to the ad\xaddress of your choice.  ")),Object(o.a)("p",null,"[INFO ",Object(o.a)("em",{parentName:"p"},"Chime")," is writ\xadten in ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://ceylon-lang.org"}),"Cey\xadlon")," and is avail\xadable at\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://herd.ceylon-lang.org/modules/herd.schedule.chime"}),"Cey\xadlon Herd"),".]  "),Object(o.a)("h2",{id:"running"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#running"})),"Running"),Object(o.a)("h3",{id:"ceylon-users"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#ceylon-users"})),"Ceylon users"),Object(o.a)("p",null,"De\xadploy ",Object(o.a)("em",{parentName:"p"},"Chime")," using ",Object(o.a)("inlineCode",{parentName:"p"},"Verticle.deployVerticle")," method."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-Ceylon"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ceylon.core {vertx}\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," herd.schedule.chime {Chime}\nChime().deploy(vertx.vertx());\n")),Object(o.a)("p",null,"Or with ",Object(o.a)("inlineCode",{parentName:"p"},'vertx.deployVerticle(\\"ceylon:herd.schedule.chime/0.2.1\\");'),"\nbut en\xadsure that Cey\xadlon ver\xadti\xadcle fac\xadtory is avail\xadable at class path.   "),Object(o.a)("h3",{id:"java-users"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#java-users"})),"Java users"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"En\xadsure that Cey\xadlon ver\xadti\xadcle fac\xadtory is avail\xadable at class path.  "),Object(o.a)("li",{parentName:"ol"},"Put Cey\xadlon ver\xadsions to con\xadsis\xadtency. For in\xadstance, Vert.x 3.4.1 de\xadpends on Cey\xadlon 1.3.0\nwhile Chime 0.2.1 de\xadpends on Cey\xadlon 1.3.2. "),Object(o.a)("li",{parentName:"ol"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-core/java/#_deploying_verticles_programmatically"}),"De\xadploy ver\xadti\xadcle"),", like:  ")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-Java"}),"vertx.deployVerticle(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"ceylon:herd.schedule.chime/0.2.1"'),")\n")),Object(o.a)("p",null,"[INFO ex\xadam\xadple with Maven is avail\xadable at ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/LisiLisenok/ChimeJavaExample"}),"Github"),".]  "),Object(o.a)("h2",{id:"schedulers"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#schedulers"})),"Schedulers"),Object(o.a)("p",null,"Well, ",Object(o.a)("em",{parentName:"p"},"Chime")," ver\xadti\xadcle is de\xadployed. Let\u2019s see its struc\xadture.",Object(o.a)("br",{parentName:"p"}),"\n","In order to pro\xadvide flex\xadi\xadble and broad ways to man\xadage tim\xading two level ar\xadchi\xadtec\xadture is adopted.\nIt con\xadsists of sched\xadulers and timers. Timer is a unit which fires at a given time.\nWhile sched\xaduler is a set or group of timers and pro\xadvides fol\xadlow\xading:    "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"cre\xadat\xading and delet\xading timers;  "),Object(o.a)("li",{parentName:"ul"},"paus\xading / re\xadsum\xading all timers work\xading within the sched\xaduler;  "),Object(o.a)("li",{parentName:"ul"},"info on the run\xadning timers;  "),Object(o.a)("li",{parentName:"ul"},"de\xadfault time zone;  "),Object(o.a)("li",{parentName:"ul"},"lis\xadten\xading event bus at the given sched\xaduler ad\xaddress for the re\xadquests to.  ")),Object(o.a)("p",null,"Any timer op\xader\xadates within some sched\xaduler. And one or sev\xaderal sched\xadulers have to be cre\xadated be\xadfore start\xading sched\xadul\xading.",Object(o.a)("br",{parentName:"p"}),"\n","When ",Object(o.a)("em",{parentName:"p"},"Chime")," ver\xadti\xadcle is de\xadployed it starts lis\xadten event bus at ",Object(o.a)("strong",{parentName:"p"},"chime")," ad\xaddress (can be con\xadfig\xadured).\nIn order to cre\xadate sched\xaduler send to this ad\xaddress a JSON mes\xadsage.  "),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"operation"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"create"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scheduler name"'),"\n}\n")),Object(o.a)("p",null,"Once sched\xaduler is cre\xadated it starts lis\xadten event bus at ",Object(o.a)("strong",{parentName:"p"},"sched\xaduler name")," ad\xaddress.\nSend\xading mes\xadsages to ",Object(o.a)("strong",{parentName:"p"},"chime")," ad\xaddress or to ",Object(o.a)("strong",{parentName:"p"},"sched\xaduler name")," ad\xaddress are rather equiv\xada\xadlent,\nex\xadcept\xading that chime ad\xaddress pro\xadvides ser\xadvices for every sched\xaduler, while sched\xaduler ad\xaddress\npro\xadvides ser\xadvices for this par\xadtic\xadu\xadlar sched\xaduler only.",Object(o.a)("br",{parentName:"p"}),"\n","The re\xadquest sent to the ",Object(o.a)("em",{parentName:"p"},"Chime")," has to con\xadtain ",Object(o.a)("strong",{parentName:"p"},"op\xader\xada\xadtion")," and ",Object(o.a)("strong",{parentName:"p"},"name")," keys.\nName key pro\xadvides sched\xaduler or timer name. While op\xader\xada\xadtion key shows an ac\xadtion ",Object(o.a)("em",{parentName:"p"},"Chime")," has to per\xadform.\nThere are only four pos\xadsi\xadble op\xader\xada\xadtions:  "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"cre\xadate - cre\xadate new sched\xaduler or timer;  "),Object(o.a)("li",{parentName:"ul"},"delete - delete sched\xaduler or timer;  "),Object(o.a)("li",{parentName:"ul"},"info - re\xadquest info on ",Object(o.a)("em",{parentName:"li"},"Chime")," or on a par\xadtic\xadu\xadlar sched\xaduler or timer;  "),Object(o.a)("li",{parentName:"ul"},"state - set or get sched\xaduler or timer state (run\xadning, paused or com\xadpleted).  ")),Object(o.a)("h2",{id:"timers"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#timers"})),"Timers"),Object(o.a)("p",null,"Now we have sched\xaduler cre\xadated and timers can be run within. There are two ways to ac\xadcess a given timer:  "),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"Send\xading mes\xadsage to ",Object(o.a)("strong",{parentName:"li"},"chime")," ad\xaddress with \u2018name\u2019 field set to ",Object(o.a)("strong",{parentName:"li"},"sched\xaduler name:timer name"),".  "),Object(o.a)("li",{parentName:"ol"},"Send\xading mes\xadsage to ",Object(o.a)("strong",{parentName:"li"},"sched\xaduler name")," ad\xaddress with \u2018name\u2019 field set to ei\xadther ",Object(o.a)("strong",{parentName:"li"},"timer name")," or ",Object(o.a)("strong",{parentName:"li"},"sched\xaduler name:timer name"),".  ")),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://modules.ceylon-lang.org/repo/1/herd/schedule/chime/0.2.1/module-doc/api/index.html#timer-request"}),"Timer re\xadquest")," is rather com\xadpli\xadcated and con\xadtains a lot of de\xadtails. In this blog post only basic fea\xadtures are con\xadsid\xadered:  "),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"operation"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"create"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scheduler name:timer name"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"description"'),": {}\n};\n")),Object(o.a)("p",null,"This is rather sim\xadi\xadlar to re\xadquest sent to cre\xadate a sched\xaduler.\nThe dif\xadfer\xadence is only ",Object(o.a)("strong",{parentName:"p"},"de\xadscrip\xadtion")," field is added.\nThis de\xadscrip\xadtion is an JSON ob\xadject which iden\xadti\xadfies par\xadtic\xadu\xadlar timer type and its de\xadtails.",Object(o.a)("br",{parentName:"p"}),"\n","The other fields not shown here are op\xadtional and in\xadcludes:  "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"ini\xadtial timer state (paused or run\xadning);  "),Object(o.a)("li",{parentName:"ul"},"start or end date-\u200btime;  "),Object(o.a)("li",{parentName:"ul"},"num\xadber of re\xadpeat\xading times;  "),Object(o.a)("li",{parentName:"ul"},"is timer mes\xadsage to be pub\xadlished or sent;  "),Object(o.a)("li",{parentName:"ul"},"timer fire mes\xadsage and de\xadliv\xadery op\xadtions;  "),Object(o.a)("li",{parentName:"ul"},"time zone.  ")),Object(o.a)("h2",{id:"timer-descriptions"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#timer-descriptions"})),"Timer descriptions"),Object(o.a)("p",null,"Cur\xadrently, three types of timers are sup\xadported:  "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"In\xadter\xadval timer")," which fires after each given time pe\xadriod (min\xadi\xadmum 1 sec\xadond):  ")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"interval"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"delay"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"timer delay in seconds, Integer"'),"\n};\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"Cron style timer")," which is de\xadfined with cron-\u200bstyle:  ")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"cron"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"seconds"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"seconds in cron style, String"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"minutes"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"minutes in cron style, String"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"hours"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hours in cron style, String"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"days of month"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"days of month in cron style, String"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"months"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"months in cron style, String"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"days of week"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"days of week in cron style, String, optional"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"years"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"years in cron style, String, optional"'),"  \n};\n")),Object(o.a)("p",null,"Cron timer is rather pow\xader\xadful and flex\xadi\xadble. In\xadves\xadti\xadgate ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://modules.ceylon-lang.org/repo/1/herd/schedule/chime/0.2.1/module-doc/api/index.html#cron-expression"}),"spec\xadi\xadfi\xadca\xadtion")," for the com\xadplete list of fea\xadtures.  "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"Union timer")," which com\xadbines a num\xadber of timers into a one:  ")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"union"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"timers"'),": [",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"list of the timer descriptions"'),"]  \n};\n")),Object(o.a)("p",null,"Union timer may be use\xadful to fire at a list of spe\xadcific dates / times."),Object(o.a)("h2",{id:"timer-events"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#timer-events"})),"Timer events"),Object(o.a)("p",null,"Once timer is started it sends or pub\xadlishes mes\xadsages to ",Object(o.a)("strong",{parentName:"p"},"sched\xaduler name:timer name")," ad\xaddress in JSON for\xadmat.\nTwo types of events are sent:  "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"fire event which oc\xadcurs when time reaches next timer value:  ")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scheduler name:timer name, String"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"event"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"fire"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"count"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"total number of fire times, Integer"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"time"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"ISO formated time / date, String"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"seconds"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"number of seconds since last minute, Integer"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"minutes"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"number of minutes since last hour, Integer"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"hours"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hour of day, Integer"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"day of month"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"day of month, Integer"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"month"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"month, Integer"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"year"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"year, Integer"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"time zone"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"time zone the timer works in, String"'),"\n};\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"com\xadplete event which oc\xadcurs when timer is ex\xadhausted by some cri\xadte\xadria given at timer cre\xadate re\xadquest:  ")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scheduler name:timer name, String"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"event"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"complete"'),",  \n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"count"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"total number of fire times, Integer"'),"  \n};\n")),Object(o.a)("p",null,"Ba\xadsi\xadcally, now we know every\xadthing to be happy with ",Object(o.a)("em",{parentName:"p"},"Chime"),": sched\xadulers and re\xadquests to them, timers and timer events.\nWill see some ex\xadam\xadples in the next sec\xadtion.  "),Object(o.a)("h2",{id:"examples"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#examples"})),"Examples"),Object(o.a)("h3",{id:"ceylon-example"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#ceylon-example"})),"Ceylon example"),Object(o.a)("p",null,"Let\u2019s con\xadsider a timer which has to fire every month at 16-30 last Sun\xadday.  "),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-Ceylon"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// listen the timer events"),"\neventBus.consumer (\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my scheduler:my timer"'),",\n  (Throwable|Message<JsonObject?> msg) {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"is")," Message<JsonObject?> msg) { print(msg.body()); }\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," { print(msg); }  \n  }\n);\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// create scheduler and timer"),"\neventBus.send<JsonObject> (\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"chime"'),",\n  JsonObject {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"operation"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"create"'),",\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my scheduler:my timer"'),",\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"')," -> JsonObject {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"type"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"cron"'),",\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"seconds"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0"'),",\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"minutes"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"30"'),",\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hours"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"16"'),",\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"days of month"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"*"'),",\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"months"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"*"'),",\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"days of week"')," -> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SundayL"'),"\n    }\n  }\n);\n\n")),Object(o.a)("p",null,"[INFO \u2019*\u2019 means any, \u2018Sun\xaddayL\u2019 means last Sun\xadday.]","  "),Object(o.a)("p",null,"[NOTE If \u2018cre\xadate\u2019 re\xadquest is sent to Chime ad\xaddress with name set to \u2018sched\xaduler name:timer name\u2019 and cor\xadre\xadspond\xading sched\xaduler hasn\u2019t been cre\xadated be\xadfore then Chime cre\xadates both new sched\xaduler and new timer.]","  "),Object(o.a)("h3",{id:"java-example"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#java-example"})),"Java example"),Object(o.a)("p",null,"Let\u2019s con\xadsider a timer which has to fire every Mon\xadday at 8-30 and every Fri\xadday at 17-30.  "),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-Java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// listen the timer events"),"\nMessageConsumer<JsonObject> consumer = eventBus.consumer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my scheduler:my timer"'),");\nconsumer.handler (\n  message -> {\n    System.out.println(message.body());\n    }\n);\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// description of timers"),"\nJsonObject mondayTimer = (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()).put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"cron"'),")\n  .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"seconds"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0"'),").put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"minutes"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"30"'),").put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hours"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"8"'),")\n  .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"days of month"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"*"'),").put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"months"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"*"'),")\n  .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"days of week"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Monday"'),");\nJsonObject fridayTimer = (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()).put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"cron"'),")\n  .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"seconds"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0"'),").put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"minutes"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"30"'),").put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hours"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"17"'),")\n  .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"days of month"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"*"'),").put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"months"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"*"'),")\n  .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"days of week"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Friday"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// union timer - combines mondayTimer and fridayTimer"),"\nJsonArray combination = (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonArray()).add(mondayTimer)\n  .add(fridayTimer);\nJsonObject timer = (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()).put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"union"'),")\n  .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"timers"'),", combination);\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// create scheduler and timer"),"\neventBus.send (\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"chime"'),",\n  (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()).put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"operation"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"create"'),")\n    .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my scheduler:my timer"'),")\n    .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),", timer)\n);\n")),Object(o.a)("p",null,"[IM\xadPOR\xadTANT En\xadsure that Cey\xadlon ver\xadti\xadcle fac\xadtory with right ver\xadsion is avail\xadable at class path.]","  "),Object(o.a)("h2",{id:"at-the-end"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#at-the-end"})),"At the end"),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"herd.schedule.chime")," mod\xadule pro\xadvides some fea\xadtures not men\xadtioned here:  "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"con\xadve\xadnient builders use\xadful to fill in JSON de\xadscrip\xadtion of var\xadi\xadous timers;  "),Object(o.a)("li",{parentName:"ul"},"prox\xady\xading event bus with con\xadven\xadtional in\xadter\xadfaces;  "),Object(o.a)("li",{parentName:"ul"},"read\xading JSON timer event into an ob\xadject;  "),Object(o.a)("li",{parentName:"ul"},"at\xadtach\xading JSON mes\xadsage to the timer fire event;  "),Object(o.a)("li",{parentName:"ul"},"man\xadag\xading time zones.  ")),Object(o.a)("p",null,"There are also some ideas for the fu\xadture:  "),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"cus\xadtom or user-\u200bdefined timers;  "),Object(o.a)("li",{parentName:"ul"},"lim\xadit\xading the timer fire time / date with cal\xaden\xaddar;  "),Object(o.a)("li",{parentName:"ul"},"ex\xadtract\xading timer fire mes\xadsage from ex\xadter\xadnal source.  ")),Object(o.a)("p",null,"This is very quick in\xadtro\xadduc\xadtion to the ",Object(o.a)("em",{parentName:"p"},"Chime")," and if you are in\xadter\xadested in you may read\nmore in ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://modules.ceylon-lang.org/repo/1/herd/schedule/chime/0.2.1/module-doc/api/index.html"}),"Chime doc\xadu\xadmen\xadta\xadtion")," or even ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/LisiLisenok/Chime"}),"con\xadtribute")," to.  "),Object(o.a)("p",null,"Thank\u2019s for the read\xading and enjoy with cod\xading!"))}m.isMDXComponent=!0},NH4K:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Preview of a guide for Java developers",category:"news",authors:[{name:"Julien Ponge",github_id:"jponge"}],summary:"We are introducing the book \u201cA gentle guide to asynchronous programming with Eclipse Vert.x for enterprise application developers\u201d."}),i=[{term:"applic",tf:8},{term:"web",tf:8},{term:"guid",tf:6},{term:"program",tf:6},{term:"develop",tf:5},{term:"asynchron",tf:5},{term:"http",tf:5},{term:"render",tf:4},{term:"page",tf:4},{term:"us",tf:4},{term:"will",tf:3},{term:"side",tf:3},{term:"code",tf:3},{term:"integr",tf:3},{term:"expos",tf:3},{term:"feedback",tf:3},{term:"github",tf:3},{term:"last",tf:2},{term:"commun",tf:2},{term:"face",tf:2},{term:"on",tf:2},{term:"need",tf:2},{term:"aim",tf:2},{term:"part",tf:2},{term:"share",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"I could not at\xadtend the last Eclipse Vert.x com\xadmu\xadnity face-\u200bto-face meet\xading last fall, but one item that was dis\xadcussed is the need for guides aimed at cer\xadtain types of de\xadvel\xadop\xaders.\nOne of my mis\xadsions as part of join\xading the team was to work on this and I\u2019m very happy to share it with you today!"),Object(o.a)("h2",{id:"a-gentle-guide-to-asynchronous-programming-with-eclipse-vertx-for-enterprise-application-developers"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#a-gentle-guide-to-asynchronous-programming-with-eclipse-vertx-for-enterprise-application-developers"})),"A gentle guide to asynchronous programming with Eclipse Vert.x for enterprise application developers"),Object(o.a)("p",null,"The guide is called ",Object(o.a)("strong",{parentName:"p"},"\u201cA gen\xadtle guide to asyn\xadchro\xadnous pro\xadgram\xadming with Eclipse Vert.x for en\xadter\xadprise ap\xadpli\xadca\xadtion de\xadvel\xadop\xaders\u201d")," and it is an in\xadtro\xadduc\xadtion to asyn\xadchro\xadnous pro\xadgram\xadming with Vert.x, pri\xadmar\xadily aimed at de\xadvel\xadop\xaders fa\xadmil\xadiar with main\xadstream non-\u200basynchronous web de\xadvel\xadop\xadment frame\xadworks and li\xadbraries (e.g., Java EE, Spring)."),Object(o.a)("p",null,"Quot\xading the in\xadtro\xadduc\xadtion:"),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"We will start from a wiki web ap\xadpli\xadca\xadtion backed by a re\xadla\xadtional data\xadbase and server-\u200bside ren\xadder\xading of pages; then we will evolve the ap\xadpli\xadca\xadtion through sev\xaderal steps until it be\xadcomes a mod\xadern single-\u200bpage ap\xadpli\xadca\xadtion with \u201creal-\u200btime\u201d web fea\xadtures. Along the way you will learn to:")),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"De\xadsign a web ap\xadpli\xadca\xadtion with server-\u200bside ren\xadder\xading of pages through tem\xadplates, and using a re\xadla\xadtional data\xadbase for per\xadsist\xading data.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Cleanly iso\xadlate each tech\xadni\xadcal com\xadpo\xadnent as a reusable event pro\xadcess\xading unit called a ver\xadti\xadcle.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Ex\xadtract Vert.x ser\xadvices for fa\xadcil\xadi\xadtat\xading the de\xadsign of ver\xadti\xadcles that com\xadmu\xadni\xadcate with each other seam\xadlessly both within the same JVM process or among dis\xadtrib\xaduted nodes in a clus\xadter.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Test\xading code with asyn\xadchro\xadnous op\xader\xada\xadtions.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"In\xadte\xadgrat\xading with third-\u200bparty ser\xadvices ex\xadpos\xading a HTTP/JSON web API.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Ex\xadpos\xading a HTTP/JSON web API.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Se\xadcur\xading and con\xadtrol\xadling ac\xadcess using HTTPS, user au\xadthen\xadti\xadca\xadtion for web browser ses\xadsions and JWT to\xadkens for third-\u200bparty client ap\xadpli\xadca\xadtions.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Refac\xadtor\xading some code to use re\xadac\xadtive pro\xadgram\xadming with the pop\xadu\xadlar Rx\xadJava li\xadbrary and its Vert.x in\xadte\xadgra\xadtion.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Client-\u200bside pro\xadgram\xadming of a single-\u200bpage ap\xadpli\xadca\xadtion with An\xadgu\xadlarJS.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Real-\u200btime web pro\xadgram\xadming using the uni\xadfied Vert.x event bus in\xadte\xadgra\xadtion over SockJS."))),Object(o.a)("p",null,"The guide takes a grad\xadual ap\xadproach by start\xading with a \u201cquick and dirty\u201d so\xadlu\xadtion, then refac\xadtor\xading it prop\xaderly, ex\xadpos\xading the core Vert.x con\xadcepts, adding fea\xadtures, and mov\xading from call\xadbacks to Rx\xadJava."),Object(o.a)("h2",{id:"we-need-your-feedback"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#we-need-your-feedback"})),"We need your feedback!"),Object(o.a)("p",null,"The code is avail\xadable at ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-guide-for-java-devs"}),"https://github.com/vert-\u200bx3/vertx-\u200bguide-for-java-devs"),".\nYou can re\xadport feed\xadback as Github is\xadsues to that repos\xadi\xadtory and even offer pull-\u200brequests."),Object(o.a)("p",null,"You can check it out from GitHub (the Asci\xadiDoc is being ren\xaddered fine from the repos\xadi\xadtory in\xadter\xadface) or you can check out pre-\u200brendered HTML and PDF ver\xadsions that I am tem\xadporar\xadily shar\xading and keep\xading up-\u200bto-date from my Drop\xadbox: ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.dropbox.com/sh/ni9znfkzlkl3q12/AABn-OCi1CZfgbTzOU0jYQpJa?dl=0"}),"https://www.drop\xadbox.com/sh/ni9zn\xadfk\xadzlkl3q12/AABn-\u200bOCi1CZfg\xadbT\xadzOU0jYQpJa?dl=0")),Object(o.a)("p",null,"Many thanks to Thomas Segis\xadmont and Julien Viet who con\xadtributed some parts, and also to the peo\xadple who re\xadviewed it pri\xadvately."),Object(o.a)("p",null,"As usual, we wel\xadcome your feed\xadback!"))}m.isMDXComponent=!0},NHiH:function(e,a,t){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var a=0,t=new Array(e.length);a<e.length;a++)t[a]=e[a];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.r(a),t.d(a,"__N_SSG",(function(){return U}));var s=t("q1tI"),c=t.n(s),r=t("UMc4"),o=t("YFqc"),l=t.n(o),i=(t("ZKd4"),c.a.createElement),p=function(e){var a=e.categories;return i("div",{className:"blog-navbar"},i("h2",null,"Blog"),i("ul",null,i("li",null,i(l.a,{href:"/blog/[[...slug]]",as:"/blog/"},i("a",null,"All posts"))),a.map((function(e){return i("li",{key:e},i(l.a,{href:"/blog/[[...slug]]",as:"/blog/category/".concat(e,"/")},i("a",null,e)))}))))},m=(t("yodW"),c.a.createElement),j=function(e){return m(r.a,e,m("div",{className:"blog"},m(p,{categories:e.categories}),e.children))},b=t("wx14"),h=(t("S8sm"),c.a.createElement),d=function(e){return h(r.a,Object(b.a)({hashSmoothScroll:!0},e),h("div",{className:"blog-post"},h(p,{categories:e.categories}),e.children))},O=c.a.createElement,u=function(e){var a=e.date,t=new Intl.DateTimeFormat("en",{year:"numeric",month:"long",day:"numeric"}).formatToParts(new Date(a)),n=t.find((function(e){return"day"===e.type})).value+" "+t.find((function(e){return"month"===e.type})).value+" "+t.find((function(e){return"year"===e.type})).value;return O(c.a.Fragment,null,n)},N=t("ACoj"),g=(t("beur"),c.a.createElement),f=function(e){var a=e.post,n=t("uYRw")("./".concat(a.filename)),s=n.meta.authors.map((function(e){return g("li",{key:e.github_id},g("img",{src:"https://github.com/".concat(e.github_id,".png?size=50")}),g("a",{href:"https://github.com/".concat(e.github_id),target:"_blank",rel:"noopener noreferrer"},e.name))}));return g("div",{className:"blog-entry"},g("div",{className:"blog-entry-meta"},g("span",{className:"blog-entry-date"},g(u,{date:a.date})),g(l.a,{href:"/blog/[[...slug]]",as:"/blog/category/".concat(n.meta.category,"/")},g("a",{className:"blog-entry-category"},n.meta.category))),g("h3",null,g(l.a,{href:"/blog/[[...slug]]",as:"/blog/".concat(a.slug,"/")},g("a",null,n.meta.title))),g("span",{className:"blog-entry-authors"},g("ul",null,s)),g("p",{className:"blog-entry-summary"},n.meta.summary||"*** PLEASE SPECIFY A MEANINGFUL SUMMARY ***"),g(N.a,{href:"/blog/[[...slug]]",as:"/blog/".concat(a.slug,"/")}))},w=t("TSYQ"),y=t.n(w),v=(t("4Nad"),c.a.createElement);function x(e,a){var t="/blog/";return void 0!==a&&(t+="category/".concat(a,"/")),1===e?t:"".concat(t,"page/").concat(e,"/")}var k=function(e){var a=e.currentPage,t=void 0===a?1:a,n=e.numPages,s=void 0===n?1:n,r=e.category;if(s<=1)return v(c.a.Fragment,null);var o=function(e,a){var t=e-2,n=e+3;t<0&&(t=0,n=5),n>a&&(n=a,t=Math.max(0,a-5));for(var s=[],c=t;c<n;++c)s.push(c+1);return s[0]>2&&s.unshift({text:"\u2026",id:"left-hellip"}),s[s.length-1]<a-1&&s.push({text:"\u2026",id:"right-hellip"}),1!==s[0]&&s.unshift(1),s[s.length-1]!==a&&s.push(a),s}(t,s);return o=o.map((function(e){var a=e===t,n=e.id||e,s=e.text||e;return Number.isInteger(s)?v("div",{className:y()("pagination-page",{active:a}),key:n},v(l.a,{href:"/blog/[[...slug]]",as:x(e,r)},v("a",null,s))):v("div",{className:"pagination-page disabled",key:n},s)})),t>1?o.unshift(v("div",{className:"pagination-page",key:"prev-page"},v(l.a,{href:"/blog/[[...slug]]",as:x(t-1,r)},v("a",null,"\xab")))):o.unshift(v("div",{className:"pagination-page disabled",key:"prev-page"},"\xab")),t<s?o.push(v("div",{className:"pagination-page",key:"next-page"},v(l.a,{href:"/blog/[[...slug]]",as:x(t+1,r)},v("a",null,"\xbb")))):o.push(v("div",{className:"pagination-page disabled",key:"next-page"},"\xbb")),v("div",{className:"pagination"},o)},C=t("Suba").keys().map((function(e){var a=e.match(/.\/([0-9]+-[0-9]+-[0-9]+)-(.*)\.mdx/);if(a[2].indexOf(".")>=0)throw"Invalid blog post filename: ".concat(e,". Dots '.' are not allowed.");var n=e.substring(2),s=t("uYRw")("./".concat(n));return{filename:n,date:a[1],slug:a[2],meta:s.meta,tfIdfTerms:s.__tfidf__terms}}));C.sort((function(e,a){return new Date(a.date)-new Date(e.date)}));var T=C,S=t("6acW"),I=t.n(S),A=t("17x9"),_=t.n(A);function V(){return(V=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function E(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var R=Object(s.forwardRef)((function(e,a){var t=e.color,n=void 0===t?"currentColor":t,s=e.size,r=void 0===s?24:s,o=E(e,["color","size"]);return c.a.createElement("svg",V({ref:a,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},o),c.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),c.a.createElement("polyline",{points:"12 6 12 12 16 14"}))}));R.propTypes={color:_.a.string,size:_.a.oneOfType([_.a.string,_.a.number])},R.displayName="Clock";var q=R,M=t("+Vjl");function P(){return(P=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var L=Object(s.forwardRef)((function(e,a){var t=e.color,n=void 0===t?"currentColor":t,s=e.size,r=void 0===s?24:s,o=e.title,l=void 0===o?"LinkedIn":o,i=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,["color","size","title"]);return c.a.createElement("svg",P({xmlns:"http://www.w3.org/2000/svg",width:r,height:r,fill:n,viewBox:"0 0 24 24",ref:a},i),c.a.createElement("title",null,l),c.a.createElement("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"}))}));L.propTypes={color:_.a.string,size:_.a.oneOfType([_.a.string,_.a.number]),title:_.a.string};var H=L;function D(){return(D=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var F=Object(s.forwardRef)((function(e,a){var t=e.color,n=void 0===t?"currentColor":t,s=e.size,r=void 0===s?24:s,o=e.title,l=void 0===o?"Facebook":o,i=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,["color","size","title"]);return c.a.createElement("svg",D({xmlns:"http://www.w3.org/2000/svg",width:r,height:r,fill:n,viewBox:"0 0 24 24",ref:a},i),c.a.createElement("title",null,l),c.a.createElement("path",{d:"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"}))}));F.propTypes={color:_.a.string,size:_.a.oneOfType([_.a.string,_.a.number]),title:_.a.string};var W=F,J=c.a.createElement;function B(e,a){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,a){if(!e)return;if("string"===typeof e)return G(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return G(e,a)}(e))||a&&e&&"number"===typeof e.length){t&&(e=t);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,r=!0,o=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return r=e.done,e},e:function(e){o=!0,c=e},f:function(){try{r||null==t.return||t.return()}finally{if(o)throw c}}}}function G(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=new Array(a);t<a;t++)n[t]=e[t];return n}var z=function(){var e,a=new Set,t=B(T);try{for(t.s();!(e=t.n()).done;){var s=e.value;void 0!==s.meta.category&&a.add(s.meta.category)}}catch(c){t.e(c)}finally{t.f()}return n(a)}(),U=!0;a.default=function(e){var a=e.filename,n=e.date,s=e.slug,r=e.readingTime,o=e.relatedPosts,i=e.category,p=e.page,m=void 0===p?1:p;if(void 0===a){var b=T;void 0!==i&&(b=b.filter((function(e){return e.meta.category===i})));var h=Math.ceil(b.length/6),O=(b=b.slice(6*(m-1),6*m)).map((function(e){return J(f,{key:e.slug,post:e})})),N="Blog";return void 0!==i&&(N="".concat(I()(i)," | ").concat(N)),m>1&&(N="Page ".concat(m," | ").concat(N)),J(j,{meta:{title:N},categories:z},J("div",{className:"blog-entries"},O),J(k,{currentPage:m,numPages:h,category:i}))}var g,w,y=t("uYRw")("./".concat(a)),v=y.default,x=T.findIndex((function(e){return e.slug===s}));x>0&&(g=T[x-1]),x<T.length-1&&(w=T[x+1]);var C="".concat("https://vertx-web-site.github.io","/blog/").concat(s);return J(d,{meta:{title:"".concat(y.meta.title," | Blog")},categories:z},J("div",{className:"blog-post-main"},J("div",{className:"blog-post-content"},J("h1",null,y.meta.title),J(v,null)),J("div",{className:"blog-post-sidebar"},y.meta.authors.map((function(e){return J("div",{className:"blog-post-author",key:e.github_id},J("img",{className:"blog-post-author-avatar",src:"https://github.com/".concat(e.github_id,".png?size=160")}),J("div",{className:"blog-post-author-name"},1===y.meta.authors.length&&"by ",J("a",{href:"https://github.com/".concat(e.github_id),target:"_blank",rel:"noopener noreferrer"},e.name)))})),J("div",{className:"blog-post-sidebar-date"},"Posted on ",J(u,{date:n})),"in ",J(l.a,{href:"/blog/[[...slug]]",as:"/blog/category/".concat(y.meta.category,"/")},J("a",{className:"blog-post-sidebar-category"},y.meta.category)),J("div",{className:"blog-post-sidebar-reading-time"},J(q,{className:"feather"})," ",r.text),J("div",{className:"blog-post-sidebar-share-icons"},J("a",{href:"https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(y.meta.title),"&url=").concat(encodeURIComponent(C),"&via=vertx_project"),target:"_blank",rel:"noopener noreferrer"},J(M.a,null)),J("a",{href:"https://www.linkedin.com/sharing/share-offsite/?url=".concat(encodeURIComponent(C)),target:"_blank",rel:"noopener noreferrer"},J(H,null)),J("a",{href:"https://www.facebook.com/sharer.php?u=".concat(encodeURIComponent(C)),target:"_blank",rel:"noopener noreferrer"},J(W,null))))),J("div",{className:"blog-post-next-prev"},J("div",{className:"blog-post-next-prev-entry"},g&&J(c.a.Fragment,null,J("h5",null,"Next post"),J(f,{post:g}))),J("div",{className:"blog-post-next-prev-entry"},w&&J(c.a.Fragment,null,J("h5",null,"Previous post"),J(f,{post:w})))),J("div",{className:"blog-post-related"},J("h5",null,"Related posts"),J("div",{className:"blog-post-related-posts"},o.map((function(e){return J(f,{key:e,post:T[e]})})))))}},NL1R:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x for Scala next steps",category:"guides",authors:[{name:"Jochen Mader",github_id:"codepitbull"}],summary:"This blog post gives an overview of the current plans for the vertx-lang-scala module, in particular with respect to the upcoming Vert.x 4."}),i=[{term:"scala",tf:25},{term:"support",tf:11},{term:"new",tf:11},{term:"will",tf:11},{term:"method",tf:11},{term:"13",tf:9},{term:"class",tf:9},{term:"approach",tf:8},{term:"version",tf:7},{term:"idea",tf:6},{term:"wrap",tf:6},{term:"base",tf:5},{term:"promis",tf:5},{term:"api",tf:5},{term:"us",tf:5},{term:"java",tf:5},{term:"valu",tf:4},{term:"receiv",tf:4},{term:"lang",tf:4},{term:"look",tf:4},{term:"current",tf:4},{term:"creat",tf:4},{term:"collect",tf:4},{term:"time",tf:4},{term:"futur",tf:4}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"TL;DR:")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"No Scala 2.13 in Eclipse Vert.x 3.x due to in\xadcreased sup\xadport bur\xadden"),Object(o.a)("li",{parentName:"ul"},"New value classes based ap\xadproach for Vert.x 4")),Object(o.a)("h2",{id:"retrospective"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#retrospective"})),"Retrospective"),Object(o.a)("p",null,"It\u2019s been more than two years since the in\xadcep\xadtion of ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-lang-scala")," to the Vert.x ecosys\xadtem. And al\xadmost as long since I wrote my first ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/scala-is-here/"}),"blog post")," about it."),Object(o.a)("p",null,"A lot has hap\xadpened since March 2017:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"vertx-lang-scala")," kept up with new ver\xadsions of Scala"),Object(o.a)("li",{parentName:"ul"},"all Vert.x-\u200bmodules are sup\xadported (35 so far)"),Object(o.a)("li",{parentName:"ul"},"a Giter8 based ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-scala.g8"}),"tem\xadplate")," was added for eas\xadily boot\xadstrap\xadping a Vert.x-\u200bScala-project"),Object(o.a)("li",{parentName:"ul"},"Bugs were squashed")),Object(o.a)("p",null,"And most re\xadcently we re\xadceived a great con\xadtri\xadbu\xadtion by ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/NikolajLeischner"}),"Niko\xadlaj Leis\xadchner")," who was kind enough to port the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/TechEmpower/FrameworkBenchmarks/tree/master/frameworks/Scala/vertx-web-scala"}),"techempow\xadered")," bench\xadmark to vert-\u200blang-scala. Which will be part of the next steps."),Object(o.a)("p",null,"The num\xadbers pro\xadduced by this bench\xadmark were very promis\xading and and ad\xaddi\xadtional mo\xadti\xadva\xadtion to move to the next phase of Scala sup\xadport for Vert.x."),Object(o.a)("h2",{id:"old-idea"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#old-idea"})),"Old idea"),Object(o.a)("p",null,"Be\xadfore get\xadting to the new ideas I want to take a look at the \u201cold\u201d one."),Object(o.a)("p",null,"The cur\xadrent ver\xadsion of vert-\u200blang-scala is based around the idea of wrap\xadping the Vert.x-API with a ded\xadi\xadcated Scala-\u200blayer. That layer is cre\xadated using a Freemarker-\u200bbased code gen\xader\xada\xadtor. I took this idea from the first try by Tim Fox for build\xading that sup\xadport."),Object(o.a)("p",null,"Wrap\xadping the ex\xadist\xading Java-\u200bAPI was rather painful but gave me great flex\xadi\xadbil\xadity to cre\xadate an id\xadiomatic Scala-\u200bAPI."),Object(o.a)("p",null,"But an ap\xadproach like that comes with a price:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"There are a lot of in\xadter\xadme\xaddi\xadate ob\xadjects being cre\xadated."),Object(o.a)("li",{parentName:"ul"},"Many un\xadnec\xadces\xadsary con\xadver\xadsions be\xadtween Java/Scala types")),Object(o.a)("p",null,"Both in\xadcreased mem\xadory con\xadsump\xadtion and garbage col\xadlec\xadtion ac\xadtiv\xadity quite a bit and has been bug\xadging me from the be\xadgin\xadning."),Object(o.a)("h2",{id:"new-idea"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#new-idea"})),"New idea"),Object(o.a)("p",null,"With Vert.x 4 ap\xadproach\xading I was fi\xadnally able to in\xadvest time into the re\xadwork I had wanted to do for quite a while."),Object(o.a)("p",null,"The core idea is to re\xadplace the cur\xadrent wrap\xadping based ap\xadproach with some\xadthing more light\xadweight but na\xadtive to the Scala-\u200bworld."),Object(o.a)("p",null,"And that\u2019s where ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://docs.scala-lang.org/overviews/core/value-classes.html"}),"value classes")," come in."),Object(o.a)("p",null,"Value classes allow the ex\xadten\xadsion of ex\xadist\xading classes with ad\xaddi\xadtional meth\xadods. They make it easy to con\xadtrol ",Object(o.a)("strong",{parentName:"p"},"when")," meth\xadods be\xadcome vis\xadi\xadble and do that with a min\xadi\xadmum of over\xadhead. To be pre\xadcise: A wrap\xadping class is nor\xadmally ever only in\xadstan\xadti\xadated ",Object(o.a)("strong",{parentName:"p"},"once"),"."),Object(o.a)("p",null,"A good ex\xadam\xadple is the ad\xaddi\xadtion of meth\xadods for wrap\xadping the Vert.x ap\xadproach of Promises with Scala-\u200bFutures. Each method re\xadturn\xading a Vert.x-\u200bPromise needs to re\xadceive an al\xadter\xadna\xadtive ver\xadsion which re\xadturns a Scala-\u200bFuture."),Object(o.a)("p",null,"In Vert.x 3 I achieved that by adding meth\xadods to the wrap\xadper and giv\xading them a dis\xadtinct name. A method called ",Object(o.a)("strong",{parentName:"p"},"lis\xadten")," re\xadturn\xading a Promise would re\xadceive a com\xadpan\xadion called ",Object(o.a)("strong",{parentName:"p"},"lis\xadten\xadFu\xadture")," in the Scala layer."),Object(o.a)("p",null,"Let\u2019s look at how this looks in the new ap\xadproach:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-scala"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," io.vertx.scala\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"object")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"core")),"{\n   ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"implicit")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"HttpServerScala"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"val asJava: io.vertx.core.http.",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-type"}),"HttpServer")),") ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AnyVal")," "),"{\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"def")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"listenFuture")),"(port: java.lang.",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Integer"),"): scala.concurrent.",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Future"),"[io.vertx.core.http.",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"HttpServer"),"] = {..}\n      ..\n}\n")),Object(o.a)("p",null,"The code above does the fol\xadlow\xading things:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"It cre\xadates a pack\xadage ob\xadject for ",Object(o.a)("strong",{parentName:"li"},"io.vertx.scala.core")),Object(o.a)("li",{parentName:"ul"},"it adds an im\xadplict class ",Object(o.a)("strong",{parentName:"li"},"HttpServer\xadScala")," to wrpa ",Object(o.a)("strong",{parentName:"li"},"HttpServer")),Object(o.a)("li",{parentName:"ul"},"it adds a ",Object(o.a)("strong",{parentName:"li"},"lis\xadten\xadFu\xadture")," method")),Object(o.a)("p",null,"Using this method in code looks like this:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-scala"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," io.vertx.scala.demo\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.lang.scala.",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"VertxExecutionContext"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.scala.core._\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," scala.util.{",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Failure"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Success"),"}\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"object")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Main")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"def")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"main")),"(args: ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Array"),"[",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"String"),"]): ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Unit")," = {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"val")," vertx = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Vertx"),".vertx()\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"implicit")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"val")," ec = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"VertxExecutionContext"),"(vertx.getOrCreateContext())\n    vertx\n      .createHttpServer()\n      .requestHandler(r => {\n        r.response().end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"bye"'),")\n      })\n      .listenFuture(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"6667"),")\n      .onComplete {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"case")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Success"),"(_) => println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Started"'),")\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"case")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-type"}),"Failure"),"(exception) => println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Failure"'),")\n      }\n  }\n}\n")),Object(o.a)("p",null,"Im\xadport\xading the pack\xadage ob\xadject using ",Object(o.a)("strong",{parentName:"p"},"im\xadport io.vertx.scala.core._")," brings the ex\xadten\xadsion method into scope and makes them avail\xadable on all in\xadstances of ",Object(o.a)("strong",{parentName:"p"},"HttpServer"),". In the ex\xadam\xadple above ",Object(o.a)("strong",{parentName:"p"},"cre\xadate\xadHttpServer()")," re\xadturn such an in\xadstance and we can now use the id\xadiomatic Scala way of han\xaddling a Fu\xadture."),Object(o.a)("h3",{id:"even-more"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#even-more"})),"Even more"),Object(o.a)("p",null,"Ex\xadtend\xading classes with Future-\u200bmethods is only one of the new things to come. On top of that the sup\xadport for DataOb\xadjects will be con\xadsid\xader\xadably im\xadproved, both through ex\xadtend\xading them and by pro\xadvid\xading type aliases."),Object(o.a)("p",null,"I also switched from doing all con\xadver\xadsions for col\xadlec\xadtions au\xadto\xadmat\xadi\xadcally to hand\xading the con\xadtrol back to the user. Some\xadthing which gets even more im\xadpor\xadtant for Scala 2.13 and the new col\xadlec\xadtion API."),Object(o.a)("h3",{id:"the-downside"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#the-downside"})),"The downside"),Object(o.a)("p",null,"The clear down\xadside of this ap\xadproach is that the Java-\u200bmethods will stay vis\xadi\xadble since the java-\u200bclasses won\u2019t be wrapped but ex\xadtended. This might lead to some con\xadfu\xadsion but I am pretty sure the ben\xade\xadfits out\xadweight this down\xadside."),Object(o.a)("p",null,"The big\xadger change will be the re\xadmoval of au\xadto\xadmatic von\xadver\xadsion be\xadtween Scala types (Long/Int/String and  Col\xadlec\xadtions) and their Java coun\xadter\xadparts. I spent con\xadsid\xader\xadable time try\xading to tune that part in the cur\xadrent ver\xadsion bbut al\xadways ended up hit\xadting some edge\xadcase. For now I\u2019ve de\xadcided to have the user pick the right time to con\xadvert."),Object(o.a)("p",null,"I might still add this fea\xadture in a later ver\xadsion if user feed\xadback points into that di\xadrec\xadtion."),Object(o.a)("h2",{id:"when-will-i-get-it"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#when-will-i-get-it"})),"When will I get it?"),Object(o.a)("p",null,"First for the good news: There is al\xadready a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-lang-scala/tree/4.0"}),"branch")," with a full im\xadple\xadmen\xadta\xadtion."),Object(o.a)("p",null,"The bad news: It will break until Vert.x 4.0 is fi\xadnally re\xadleased."),Object(o.a)("p",null,"Vert.x 4 is in ac\xadtive de\xadvel\xadop\xadment with most APIs al\xadready fi\xadnal\xadized but break\xading changes still hap\xadpen. So use at your own risk!"),Object(o.a)("h2",{id:"what-about-scala-213"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#what-about-scala-213"})),"What about Scala 2.13?"),Object(o.a)("p",null,"Scala 2.13 has been re\xadleased re\xadcently which prompted ques\xadtions from the com\xadmu\xadnity about when it will be sup\xadported by Vert.x."),Object(o.a)("p",null,"I haven\u2019t done a good job pro\xadvid\xading the re\xadsults of our in\xadter\xadnal dis\xadcus\xadsions on that topic to the com\xadmu\xadnity. So here we go:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Vert.x 3 will stay on 2.12 for the fol\xadlow\xading rea\xadsons:",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"Both are still ac\xadtively sup\xadported"),Object(o.a)("li",{parentName:"ul"},"Scala ecosys\xadtems takes some time to do the switch to 2.13"),Object(o.a)("li",{parentName:"ul"},"We sim\xadply don\u2019t have the ca\xadpac\xadity to sup\xadport both ver\xadsions ",Object(o.a)("strong",{parentName:"li"},"AND")," the up\xadcom\xading new ver\xadsion"))),Object(o.a)("li",{parentName:"ul"},"Vert.x 4 will re\xadceive 2.13 sup\xadport",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"Scala ecosys\xadtem will have moved closer to 2.13 adop\xadtion when Vert.x 4 comes out")))),Object(o.a)("h2",{id:"for-the-adventure-seaker"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#for-the-adventure-seaker"})),"For the adventure seaker"),Object(o.a)("p",null,"I ac\xadtu\xadally did a port of vertx-\u200blang-scala 3.8 to Scala 2.13 and you can grab the work in this ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-lang-scala/tree/3.8_2.13"}),"branch"),"."),Object(o.a)("p",null,"Don\u2019t ex\xadpect ",Object(o.a)("strong",{parentName:"p"},"ANY")," sup\xadport for this branch. This was only an ex\xadper\xadi\xadment to see how much I had to change for ini\xadtial 2.13 sup\xadport."),Object(o.a)("h2",{id:"summary"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#summary"})),"Summary"),Object(o.a)("p",null,"Vert.x 4 will be an evo\xadlu\xadtion\xadary step for vertx-\u200blang-scala. Value classes promise to re\xadduce both com\xadplex\xadity and al\xadlo\xadca\xadtion rate, two things which have been bug\xadging me quite a bit with the cur\xadrent ap\xadproach."),Object(o.a)("p",null,"I am eager to hear from you all what you think about this new di\xadrec\xadtion."))}m.isMDXComponent=!0},NuQH:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x based Framework URL Shortener Backend",category:"guides",authors:[{name:"Lazar Buli\u0107",github_id:"pendula95"}],summary:"We combine Vert.x with the serverless framework to write a microservice that runs on AWS Lambda."}),i=[{term:"lambda",tf:13},{term:"aw",tf:10},{term:"verticl",tf:10},{term:"url",tf:10},{term:"will",tf:9},{term:"servic",tf:8},{term:"serverless",tf:8},{term:"creat",tf:8},{term:"class",tf:8},{term:"deploi",tf:7},{term:"request",tf:7},{term:"line",tf:7},{term:"method",tf:7},{term:"code",tf:6},{term:"handler",tf:6},{term:"need",tf:6},{term:"event",tf:5},{term:"framework",tf:5},{term:"pass",tf:5},{term:"instanc",tf:5},{term:"consum",tf:5},{term:"jdbc",tf:5},{term:"api",tf:5},{term:"id",tf:5},{term:"long",tf:5}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Re\xadcently, I stum\xadbled upon ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/"}),Object(o.a)("strong",{parentName:"a"},"Vertx")),". ",Object(o.a)("strong",{parentName:"p"},"Event-\u200bdriven, asyn\xadchro\xadnized, light\xadweight, re\xadac\xadtive, highly per\xadfor\xadmant, poly\xadglot")," ap\xadpli\xadca\xadtion frame\xadwork. Ideal for writ\xading ",Object(o.a)("strong",{parentName:"p"},"micro-\u200bservices"),". I played around with it for a while and re\xadally en\xadjoyed the con\xadcept of ",Object(o.a)("strong",{parentName:"p"},"server\xadless")," ap\xadpli\xadca\xadtions."),Object(o.a)("p",null,"I de\xadvel\xadoped a few apps and cases and started to won\xadder how to run and de\xadploy them so that I get a 100% re\xadli\xadable ser\xadvice. I sud\xaddenly re\xadmem\xadbered the tech sem\xadi\xadnar that I at\xadtended re\xadcently, specif\xadi\xadcally ses\xadsion about server\xadless apps with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://aws.amazon.com/"}),Object(o.a)("strong",{parentName:"a"},"AWS"))," (Ama\xadzon Web Ser\xadvices) ",Object(o.a)("strong",{parentName:"p"},"Lambda"),". Lambda is a server\xadless com\xadpute ser\xadvice that runs your code in re\xadsponse to events and au\xadto\xadmat\xadi\xadcally man\xadages the un\xadder\xadly\xading com\xadpute re\xadsources for you. Fairly sim\xadi\xadlar con\xadcepts ",Object(o.a)("strong",{parentName:"p"},"Vertx")," and ",Object(o.a)("strong",{parentName:"p"},"AWS Lambda"),", so maybe they com\xadple\xadment each other? As it turns out they do, ",Object(o.a)("strong",{parentName:"p"},"Vertx")," can get most of your ",Object(o.a)("strong",{parentName:"p"},"Lamb\xaddas"),"\u2026"),Object(o.a)("p",null,"Using the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://serverless.com/"}),Object(o.a)("strong",{parentName:"a"},"Server\xadless Frame\xadwork"))," to cre\xadate, man\xadage and de\xadploy your new ",Object(o.a)("strong",{parentName:"p"},"Lamb\xaddas")," I was able to get this ",Object(o.a)("strong",{parentName:"p"},"micro-\u200bservice")," up and run\xadning in no time."),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Enough with the talk, lets see the im\xadple\xadmen\xadta\xadtion.")),Object(o.a)("h2",{id:"code"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#code"})),"Code"),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Han\xaddler Class, entry point of AWS Re\xadquest.")),Object(o.a)("p",null,"The first issue that I had was the ",Object(o.a)("strong",{parentName:"p"},"sync")," Event Han\xaddler that is pro\xadvided by AWS. So I had to by pass it with Fu\xadture. In the Han\xaddler class I first ini\xadti\xadate Vertx in\xadstance in a sta\xadtic block and de\xadploy few Ver\xadti\xadcles that will do the work. This class only re\xadceives the event, ex\xadtracts needed data from the re\xadquest and passes the data to Vertx Event\xadBus. After the Con\xadsumers han\xaddle the re\xadquest, Han\xaddler class will gen\xader\xadate a proper re\xadsponse and fin\xadish the AWS re\xadquest."),Object(o.a)("script",{src:"https://gist.github.com/pendula95/583eb45bd0a7990136fba029bdcd555b.js"}),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Line 4-18:")," This is where Vertx in\xadstance is cre\xadated, Ver\xadti\xadcles are de\xadployed and ",Object(o.a)("strong",{parentName:"p"},"Async JDBC")," client is cre\xadated. I fig\xadured out that it is bet\xadter to cre\xadated JDBC client here as in some cases I was time\xadout when that logic was in the Ver\xadti\xadcle start method."),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Line 27-36:")," These are helper lines, pars\xading and for\xadmat\xadting the data so I can pass it to the Ver\xadti\xadcles."),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Line 38-45:")," I have de\xadcided to map the con\xadsumers to the ad\xaddress that is made of re\xadquest method and url path, ex\xadam\xadple POST/api. This means each API re\xadquest is mapped to its own con\xadsumer in Ver\xadti\xadcle class."),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Line 47-77:")," This is noth\xading but a block of code that han\xaddles the re\xadsponse that was passed from Ver\xadti\xadcles to the Fu\xadture and gen\xader\xadates the final re\xadsponse that will be re\xadturn to API Gate\xadway."),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"UrlSer\xadvice, Vertx Ver\xadti\xadcle.")),Object(o.a)("p",null,"Ver\xadti\xadcle class is pretty for\xadward. Con\xadsumers that will process the mes\xadsage, meth\xadods for work\xading with JDBC and helper meth\xadods for hash\xading/de\xadhash\xading id. The logic be\xadhind url short\xaden\xading is fairly sim\xadple here. Each long url is stored in data\xadbase with a unique id and few ad\xaddi\xadtional columns. Row id is hashed and re\xadturned as short url. When re\xadtriev\xading long url hash is de\xadcoded to row id and long url is re\xadtrieved. Later user is redi\xadrected to long url. With this im\xadple\xadmen\xadta\xadtion, on 6 char short url (char\xadac\xadters after the do\xadmain) you get 62^6 com\xadbi\xadna\xadtions which is 56 800 235 584 rows for stor\xading your urls. TinyURL is cur\xadrently at 6 long char urls (char\xadac\xadters after do\xadmain). You can of course im\xadple\xadment meth\xadods for reusing and re\xadcy\xadcling ids."),Object(o.a)("script",{src:"https://gist.github.com/pendula95/aeb4479162e6e33504add2af9fa68bc5.js"}),Object(o.a)("p",null,"As said, this is all fairly straight for\xadward, if you are al\xadready fa\xadmil\xadiar with ",Object(o.a)("strong",{parentName:"p"},"Vertx"),". If you are think\xading why have I re\xadpeated the code for es\xadtab\xadlish a ",Object(o.a)("strong",{parentName:"p"},"JDBC")," con\xadnec\xadtion, here is the ex\xadpla\xadna\xadtion ",Object(o.a)("em",{parentName:"p"},"(line: 10-16)"),". I was get\xadting Time\xadouts when cre\xadat\xading JDBC con\xadnec\xadtion in Ver\xadti\xadcles. To avoid this I also added this code to my Han\xaddler class. This way con\xadnec\xadtion is cre\xadated there and be\xadcause of the ",Object(o.a)("strong",{parentName:"p"},"Vertx")," im\xadple\xadmen\xadta\xadtion any later at\xadtempt to cre\xadate it again will re\xadsult in just get\xadting the in\xadstances from the first in\xadvo\xadca\xadtion. This es\xadcaped the need to pass the in\xadstances di\xadrectly from the Han\xaddler class when cre\xadat\xading Ver\xadti\xadcle in\xadstances."),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"Server\xadless con\xadfig\xadu\xadra\xadtion.")),Object(o.a)("p",null,"Lastly I would like to share the server\xadless.yml, con\xadfir\xadma\xadtion file that al\xadlows seam\xadlessly de\xadploy and man\xadage\xadment of AWS Lambda. With just a few com\xadmands and lines of con\xadfig\xadu\xadra\xadtion you are able to con\xadfig\xadure all nec\xades\xadsary steps for de\xadploy\xading your AWS Lambda. Frame\xadwork takes care of mak\xading con\xadfig\xadu\xadra\xadtion of Api-\u200bGateway and other AWS has\xadsle that would oth\xader\xadwise needed to be done by hand. In this case Lambda is in\xadvoked by HTTP events."),Object(o.a)("script",{src:"https://gist.github.com/pendula95/33adc47265072ed930c7df98c9ace7be.js"}),Object(o.a)("h2",{id:"performance-and-tests"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#performance-and-tests"})),"Performance and Tests"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Vertx")," async ca\xadpa\xadbil\xadi\xadties eased the stress and mem\xadory needs of tra\xaddi\xadtional ",Object(o.a)("strong",{parentName:"p"},"AWS Lamb\xaddas")," with sync meth\xadods. After per\xadform\xading load tests Lamb\xaddas that were writ\xadten using Vertx frame\xadwork pre\xadformed ",Object(o.a)("strong",{parentName:"p"},"10% faster and con\xadsumed 40% less mem\xadory"),". As I have read some\xadwhere in Vertx doc\xadu\xadmen\xadta\xadtion, Sync meth\xadods will def\xadi\xadnitely fin\xadish the first re\xadquest faster but in total Async will be faster in the end. This sav\xadings in mem\xadory and time will def\xadi\xadnitely re\xadduce the cost of run\xadning your Lamb\xaddas and the lit\xadtle over\xadhead with ad\xaddi\xadtional code is for sure worth it."),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"To fol\xadlow the pace of de\xadmand\xading needs for fast and re\xadsilient ser\xadvices we need to move from tra\xaddi\xadtional Mono\xadliths. Em\xadbrac\xading the ",Object(o.a)("strong",{parentName:"p"},"micro ser\xadvice")," ar\xadchi\xadtec\xadture alone will not cut it, not any\xadmore. With the rise and rapid ad\xadvance\xadment of ",Object(o.a)("strong",{parentName:"p"},"Cloud")," so\xadlu\xadtions it has never been so easy to make a truly ",Object(o.a)("strong",{parentName:"p"},"Server\xadless")," sys\xadtems build upon net\xadwork of ",Object(o.a)("strong",{parentName:"p"},"micro ser\xadvices"),".\nAs you have seen ",Object(o.a)("strong",{parentName:"p"},"Vertx")," with its async API makes the full ad\xadvan\xadtage of ",Object(o.a)("strong",{parentName:"p"},"AWS Lamb\xaddas"),", em\xadbrac\xading them while also im\xadprov\xading the per\xadfor\xadmance and low\xader\xading the costs. With the help from ",Object(o.a)("strong",{parentName:"p"},"Server\xadless Frame\xadwork")," writ\xading, de\xadploy\xading and man\xadag\xading your ",Object(o.a)("strong",{parentName:"p"},"Lamb\xaddas")," has never been so easy."),Object(o.a)("p",null,"If you are in\xadter\xadested in the whole project, you can find it on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pendula95/vertx-aws-url-shortener-service/tree/master"}),Object(o.a)("strong",{parentName:"a"},"GitHub")),"."),Object(o.a)("p",null,"[INFO Info | this is a re-\u200bpublication of the fol\xadlow\xading ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://lazarbulic.com/blog/2017/11/10/aws-lambda-vertx-framework-url-shortener-backend/"}),"blog post"),"]"))}m.isMDXComponent=!0},OfB8:function(e,a){e.exports="/_next/static/images/raml-console-eff5887ef1e653846846a2e85c1df9ad.png"},OrTX:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 4 milestone 2 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"The new milestone release of Vert.x 4 includes progress on futurisation, tracing, and many other improvements."}),i=[{term:"client",tf:9},{term:"mileston",tf:5},{term:"releas",tf:5},{term:"trace",tf:5},{term:"applic",tf:5},{term:"featur",tf:3},{term:"provid",tf:3},{term:"distribut",tf:3},{term:"develop",tf:3},{term:"asynchron",tf:3},{term:"redi",tf:3},{term:"amqp",tf:3},{term:"not",tf:3},{term:"flow",tf:3},{term:"request",tf:3},{term:"http",tf:3},{term:"chang",tf:3},{term:"replac",tf:3},{term:"second",tf:2},{term:"seri",tf:2},{term:"aim",tf:2},{term:"futuris",tf:2},{term:"callback",tf:2},{term:"model",tf:2},{term:"first",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce the sec\xadond 4.0 mile\xadstone re\xadlease of Eclipse Vert.x ."),Object(o.a)("p",null,"Vert.x 4 is the evo\xadlu\xadtion of the Vert.x 3.x se\xadries that will bring key fea\xadtures to Vert.x."),Object(o.a)("p",null,"This re\xadlease aims to pro\xadvide a re\xadli\xadable dis\xadtri\xadb\xadu\xadtion of the cur\xadrent de\xadvel\xadop\xadment of Vert.x 4 for peo\xadple who\nwant to try it and pro\xadvide feed\xadback."),Object(o.a)("h2",{id:"futurisation"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#futurisation"})),"Futurisation"),Object(o.a)("p",null,"Vert.x 4 ex\xadtends the 3.x call\xadback asyn\xadchro\xadnous model to a fu\xadture/call\xadback hy\xadbrid model."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"NetClient")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Since 3.0"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host, Handler<AsyncResult<NetSocket>> handler)")),";\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// New in 4.0"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Future<NetSocket> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host)")),";\n}\n")),Object(o.a)("p",null,"The first mile\xadstone, only cov\xadered ",Object(o.a)("em",{parentName:"p"},"Vert.x Core"),", this sec\xadond mile\xadstone has made sig\xadnif\xadi\xadcant progress with the fu\xadtur\xadi\xadsa\xadtion\nof the fol\xadlow\xading stack mod\xadules:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"vertx-\u200bauth"),Object(o.a)("li",{parentName:"ul"},"vertx-\u200bweb"),Object(o.a)("li",{parentName:"ul"},"vertx-\u200bmqtt"),Object(o.a)("li",{parentName:"ul"},"vertx-\u200bcassandra-client"),Object(o.a)("li",{parentName:"ul"},"vertx-\u200bredis-client"),Object(o.a)("li",{parentName:"ul"},"vertx-\u200bkakfa-client"),Object(o.a)("li",{parentName:"ul"},"vertx-\u200bamqp-client")),Object(o.a)("h2",{id:"tracing"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#tracing"})),"Tracing"),Object(o.a)("p",null,"In\xadstru\xadment\xading asyn\xadchro\xadnous ap\xadpli\xadca\xadtion for dis\xadtrib\xaduted trac\xading is quite chal\xadleng\xading be\xadcause most trac\xading li\xadbraries\nrely on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://fr.wikipedia.org/wiki/Thread_Local_Storage"}),"thread local stor\xadage"),". While it works rea\xadsonnably well\nin a block\xading ap\xadpli\xadca\xadtion, this does not work for an asyn\xadchro\xadnous ap\xadpli\xadca\xadtion."),Object(o.a)("p",null,"This sup\xadposes that the ap\xadpli\xadca\xadtion con\xadtrol flow mat\xadters (i.e threads) al\xadthough what re\xadally mat\xadters is the ap\xadpli\xadca\xadtion\nre\xadquest flow (e.g the in\xadcom\xading HTTP re\xadquest)."),Object(o.a)("p",null,"We im\xadproved Vert.x 4 to reify the re\xadquest flow, mak\xading it pos\xadsi\xadble to in\xadte\xadgrate pop\xadu\xadlar trac\xading tools such as ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://zipkin.io"}),"Zip\xadkin"),"\nor ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://opentracing.io"}),"Open\xadtrac\xading"),". Vert.x per\xadfor\xadmance is leg\xadendary and we made sure that this does not have\nany over\xadhead out of the box (dis\xadabled)."),Object(o.a)("p",null,"We pro\xadvide sup\xadport for these two pop\xadu\xadlar li\xadbraries under the ",Object(o.a)("em",{parentName:"p"},"Vert.x Trac\xading")," um\xadbrella."),Object(o.a)("h2",{id:"other-changes"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#other-changes"})),"Other changes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Groovy has been sim\xadpli\xadfied in Vert.x 4 to re\xadmove code gen\xader\xada\xadtion that was not re\xadally needed in prac\xadtice"),Object(o.a)("li",{parentName:"ul"},"The orig\xadi\xadnal Redis client dep\xadre\xadcated in 3.7 has been re\xadmoved re\xadplaced by the new Redis client"),Object(o.a)("li",{parentName:"ul"},"The fol\xadlow\xading com\xadpo\xadnents have reached their end of life and have been pruned",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"MySQL / Post\xadgreSQL async client re\xadplaced by the Vert.x SQL Client (since 3.8)"),Object(o.a)("li",{parentName:"ul"},"AMQP bridge re\xadplaced by the Vert.x AMQP Client (since 3.7)")))),Object(o.a)("h2",{id:"ramping-up-to-vertx-4"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#ramping-up-to-vertx-4"})),"Ramping up to Vert.x 4"),Object(o.a)("p",null,"In\xadstead of de\xadvel\xadop\xading all new fea\xadtures ex\xadclu\xadsively in Vert.x 4, we in\xadtro\xadduce some of these fea\xadtures in the 3.x branch\nso the com\xadmu\xadnity can ben\xade\xadfit from them. The Vert.x 4 de\xadvel\xadop\xadment focus on more fun\xadda\xadmen\xadtal changes that can\xadnot be done\nin the 3.x se\xadries."),Object(o.a)("img",{src:"{{ site_url }}assets/blog/vertx-4-milestone2-release/vertx-4-timeline.png",alt:"Screenshot",class:"img-responsive"}),Object(o.a)("p",null,"This is the first mile\xadstone of Vert.x 4, we aim to re\xadlease Vert.x 4 by the end of this year and you can of course\nex\xadpect more mile\xadstones to out\xadline the progress of the ef\xadfort."),Object(o.a)("h2",{id:"finally"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finally"})),"Finally"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes"),"\ncan be found on the wiki."),Object(o.a)("p",null,"For this re\xadlease there are no Docker im\xadages.,"),Object(o.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://search.maven.org/search?q=g:io.vertx%20AND%20v:4.0.0-milestone2"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://repo1.maven.org/maven2/io/vertx/vertx-stack-manager/4.0.0-milestone2/"}),"Maven Cen\xadtral"),"."),Object(o.a)("p",null,"You can boot\xadstrap a Vert.x 4.0.0-\u200bmilestone2 project using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(o.a)("p",null,"The doc\xadu\xadmen\xadta\xadtion has been de\xadployed on this pre\xadview web-\u200bsite ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx-ci.github.io/vertx-4-preview/docs/"}),"https://vertx-\u200bci.github.io/vertx-\u200b4-\u200bpreview/docs/")),Object(o.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},Pc3Q:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x RabbitMQ client gets a new consumer API!",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"In this blog post, we present the new consumer API of the RabbitMQ client that will be released with Eclipse Vert.x 3.6.0."}),i=[{term:"api",tf:11},{term:"queue",tf:10},{term:"messag",tf:9},{term:"new",tf:7},{term:"consum",tf:7},{term:"call",tf:4},{term:"rabbitmq",tf:3},{term:"will",tf:3},{term:"limit",tf:3},{term:"provid",tf:3},{term:"type",tf:3},{term:"method",tf:3},{term:"stream",tf:3},{term:"client",tf:2},{term:"go",tf:2},{term:"us",tf:2},{term:"let",tf:2},{term:"event",tf:2},{term:"control",tf:2},{term:"simpli",tf:2},{term:"handler",tf:2},{term:"idiomat",tf:2},{term:"arriv",tf:2},{term:"allow",tf:2},{term:"intern",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"In Eclipse Vert.x 3.6.0, the Rab\xadbitMQ client will get a new con\xadsumer API. In this post we are going to show\nthe im\xadprove\xadments since the pre\xadvi\xadous API and how easy it is to use now."),Object(o.a)("p",null,"Be\xadfore dig\xadging into the new API let\u2019s find out what were the lim\xadi\xadta\xadtions of the ac\xadtual one:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"The API uses the event bus in such lim\xadit\xading the con\xadtrol of the con\xadsumer over the Rab\xadbitMQ queue."),Object(o.a)("li",{parentName:"ol"},"The mes\xadsage API is based on ",Object(o.a)("inlineCode",{parentName:"li"},"JsonObject")," which does not pro\xadvide a typed API")),Object(o.a)("h2",{id:"the-new-api-at-a-glance"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#the-new-api-at-a-glance"})),"The new API at a glance"),Object(o.a)("p",null,"Here is how sim\xadple queue con\xadsump\xadtion looks like with the new API:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"RabbitMQClient client = RabbitMQClient.create(vertx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RabbitMQOptions());\n\nclient.basicConsumer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my.queue"'),", res -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (res.succeeded()) {\n    System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"RabbitMQ consumer created !"'),");\n    RabbitMQConsumer mqConsumer = res.result();\n    mqConsumer.handler((RabbitMQMessage message) -> {\n        System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Got message: "')," + message.body().toString());\n    });\n  } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Oups something went wrong"),"\n    res.cause().printStackTrace();\n  }\n});\n")),Object(o.a)("p",null,"Now to cre\xadate a queue you sim\xadply call the ",Object(o.a)("inlineCode",{parentName:"p"},"basicConsumer")," method and you ob\xadtain asyn\xadchro\xadnously\na ",Object(o.a)("inlineCode",{parentName:"p"},"RabbitMQConsumer"),"."),Object(o.a)("p",null,"Then you need to pro\xadvide a han\xaddler called for each mes\xadsage con\xadsumed via ",Object(o.a)("em",{parentName:"p"},"Rab\xadbit\xadMQ\xadCon\xadsumer#han\xaddler")," which\nis the id\xadiomatic way to con\xadsumer stream in Vert.x"),Object(o.a)("p",null,"You may also note that when we a mes\xadsage ar\xadrives, it has the type of ",Object(o.a)("inlineCode",{parentName:"p"},"RabbitMQMessage"),", this is a typed\nmes\xadsage rep\xadre\xadsen\xadta\xadtion."),Object(o.a)("p",null,"Since ",Object(o.a)("inlineCode",{parentName:"p"},"RabbitMQConsumer")," is a stream, you also al\xadlowed to ",Object(o.a)("inlineCode",{parentName:"p"},"pause")," and ",Object(o.a)("inlineCode",{parentName:"p"},"resume")," the stream, sub\xadscribe to the\nend event, get no\xadti\xadfied when an ex\xadcep\xadtion oc\xadcurs."),Object(o.a)("p",null,"In ad\xaddi\xadtion, you can can\xadcel the sub\xadscrip\xadtion by call\xading ",Object(o.a)("inlineCode",{parentName:"p"},"RabbitMQConsumer#cancel")," method."),Object(o.a)("h2",{id:"backpressure"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#backpressure"})),"Backpressure"),Object(o.a)("p",null,"Some\xadtimes you can have more in\xadcom\xading mes\xadsages than you can han\xaddle."),Object(o.a)("p",null,"The new con\xadsumer API al\xadlows you to con\xadtrol this and lets you store ar\xadrived mes\xadsages in the in\xadter\xadnal queue\nbe\xadfore they are de\xadliv\xadered to the ap\xadpli\xadca\xadtion. In\xaddeed, you can con\xadfig\xadure the queue size."),Object(o.a)("p",null,"Here is how you can limit the in\xadter\xadnal queue size:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Limit to max 300 messages"),"\nQueueOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," QueueOptions()\n  .setMaxInternalQueueSize(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"300"),");\n\nRabbitMQClient client = RabbitMQClient.create(vertx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," RabbitMQOptions());\n\nclient.basicConsumer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my.queue"'),", options, res -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (res.succeeded()) {\n    System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"RabbitMQ consumer created !"'),");\n    RabbitMQConsumer mqConsumer = res.result();\n    mqConsumer.handler((RabbitMQMessage message) -> {\n      System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Got message: "')," + message.body().toString());\n    });\n  } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    res.cause().printStackTrace();\n  }\n});\n")),Object(o.a)("p",null,"When the in\xadten\xadral queue queue ca\xadpac\xadity is ex\xadceeded, the new mes\xadsage will be sim\xadply dropped."),Object(o.a)("p",null,"An al\xadter\xadna\xadtive op\xadtion is to drop the old\xadest mes\xadsage in the queue."),Object(o.a)("p",null,"In order to achieve this, you should spec\xadify the be\xadhav\xadior by call\xading ",Object(o.a)("inlineCode",{parentName:"p"},"QueueOptions#setKeepMostRecent")," method."),Object(o.a)("h2",{id:"finally"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finally"})),"Finally"),Object(o.a)("p",null,"The new Vert.x Rab\xadbitMQ client con\xadsumer API is way more id\xadiomatic and mod\xadern way to con\xadsume mes\xadsages from a queue."),Object(o.a)("p",null,"This API is going to pro\xadvided in the 3.6.0 re\xadlease, while the old will be dep\xadre\xadcated."),Object(o.a)("p",null,"I hope you en\xadjoyed read\xading this ar\xadti\xadcle. See you soon on our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"Git\xadter chan\xadnel"),"!"))}m.isMDXComponent=!0},QYtG:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/[[...slug]]",function(){return t("NHiH")}])},Suba:function(e,a,t){var n={"./2015-06-30-vert-x-2-1-6-released.mdx":"h9Ra","./2015-07-01-vert-x3-web-easy-as-pi.mdx":"9LB0","./2015-07-02-vert-x-3-init-d-script.mdx":"j61u","./2015-07-03-vert-x3-and-postgresql-json-type.mdx":"/V1q","./2015-07-06-checklist-for-migrating-from-vert-x-2-1-x-to-vert-x-3-part-one.mdx":"mBXf","./2015-07-13-vert-x3-says-hello-to-npm-users.mdx":"kFeL","./2015-07-14-my-first-vert-x-3-application.mdx":"cmAP","./2015-07-20-vert-x-application-configuration.mdx":"gcZK","./2015-07-27-some-rest-with-vert-x.mdx":"Dc8p","./2015-08-03-unit-and-integration-tests.mdx":"cLI+","./2015-08-31-vert-x3-real-time-web-apps.mdx":"dAKA","./2015-09-14-writing-secure-vert-x-web-apps.mdx":"5B1d","./2015-09-17-contract-driven-rest-services-with-vert-x3.mdx":"KM6s","./2015-10-08-vert-x-3-1-0-is-released.mdx":"EomW","./2015-10-19-using-the-asynchronous-sql-client.mdx":"zDbz","./2015-11-25-vert-x-es6-back-to-the-future.mdx":"KJRa","./2015-11-30-combine-vert-x-and-mongo-to-build-a-giant.mdx":"Z82Q","./2015-12-15-vert-x-3-2-0-is-released.mdx":"nY3K","./2015-12-20-automatic-redeployment-in-eclipse-ide.mdx":"a69w","./2016-01-03-ecmascript-6-7-on-the-jvm-with-typescript-and-vert-x.mdx":"VCtW","./2016-01-15-real-time-bidding-with-websockets-and-vert-x.mdx":"+g7z","./2016-01-18-using-hamcrest-matchers-with-vert-x-unit.mdx":"rXrF","./2016-01-25-intro-to-vert-x-shell.mdx":"8HTu","./2016-02-05-vert-x-3-2-1-is-released.mdx":"TiEF","./2016-03-17-vertx-3-and-azure-cloud-platform-tutorial.mdx":"Hx7l","./2016-03-30-vertx-3-and-keycloak-tutorial.mdx":"lihu","./2016-06-24-vert-x-3-3-0-is-released.mdx":"swLC","./2016-07-12-vert-x-3-3-2-is-released.mdx":"2Ici","./2016-08-26-vert-x-fall-conferences.mdx":"34c/","./2016-09-01-vert-x-blueprint-tutorials.mdx":"kixY","./2016-09-08-centralized-logging-for-vert-x-applications-using-the-elk-stack.mdx":"oY/r","./2016-09-12-vert-x-3-3-3-is-released.mdx":"9Sms","./2017-04-14-dynamic-routing-in-serverless-microservice-with-vert-x-event-bus.mdx":"kxuk","./2017-04-26-building-a-real-time-web-app-with-angular-ngrx-and-vert-x.mdx":"00pu","./2017-05-09-time-scheduling-with-chime.mdx":"LFoy","./2017-05-22-presentation-of-the-vert-x-swagger-project.mdx":"oTZn","./2017-06-09-preview-of-a-guide-for-java-developers.mdx":"NH4K","./2017-07-04-openapi-fka-swagger-3-support-in-eclipse-vert-x-now-in-test-stage.mdx":"xhNl","./2017-08-21-introducing-vert-x-mqtt-client.mdx":"hE7a","./2017-09-28-an-eclipse-vert-x-gradle-plugin.mdx":"GoqC","./2017-11-14-eclipse-vert-x-meets-graphql.mdx":"mT7v","./2017-12-20-tcp-client-using-eclipse-vert-x-kotlin-and-gradle-build.mdx":"+dJJ","./2017-12-21-eclipse-vert-x-based-framework-url-shortener-backend.mdx":"NuQH","./2018-03-13-google-summer-of-code-2018.mdx":"/93W","./2018-04-09-eclipse-vert-x-metrics-now-with-micrometer-io.mdx":"pJo+","./2018-04-13-new-community-channels.mdx":"zj+8","./2018-04-23-eclipse-vert-x-rabbitmq-client-gets-a-new-consumer-api.mdx":"Pc3Q","./2018-06-04-eclipse-vert-x-goes-native.mdx":"WjdI","./2018-07-02-simplified-database-transaction-management-with-the-vert-x-rxjava-api.mdx":"wjlg","./2018-08-20-the-rss-reader-tutorial.mdx":"BuQJ","./2018-09-05-the-rss-reader-tutorial-step-2.mdx":"GOOg","./2018-12-06-the-rss-reader-tutorial-step-3.mdx":"lWra","./2018-12-10-http-response-validation-with-the-vert-x-web-client.mdx":"eHGC","./2018-12-13-vertx-web-api-service.mdx":"ZJXT","./2019-07-26-eclipse-vert-x-4-milestone-1-released.mdx":"i72n","./2019-08-23-eclipse-vert-x-3-8-1.mdx":"dRkU","./2019-08-26-eclipse-vert-x-4-milestone-2-released.mdx":"OrTX","./2019-08-30-eclipse-vert-x-for-scala-next-steps.mdx":"NL1R","./2019-09-19-eclipse-vert-x-4-milestone-3-released.mdx":"hkBy","./2019-10-07-eclipse-vert-x-3-8-2.mdx":"/pBu","./2019-10-18-eclipse-vert-x-3-8-3.mdx":"lybm","./2019-10-22-send-web-requests-and-assert-results-with-vertx-junit5-web-client.mdx":"4PoU","./2019-11-28-eclipse-vert-x-3-8-4.mdx":"AiqT","./2019-12-13-eclipse-vert-x-4-milestone-4-released.mdx":"4Sve","./2020-01-24-eclipse-vert-x-3-8-5.mdx":"xDq6","./2020-03-16-easy-sso-for-vert-x-with-keycloak.mdx":"HAnQ","./2020-04-02-eclipse-vert-x-3-9-0-released.mdx":"4nW3","./2020-05-22-eclipse-vert-x-3-9-1-released.mdx":"+/MD"};function s(e){var a=c(e);return t(a)}function c(e){if(!t.o(n,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=c,e.exports=s,s.id="Suba"},TiEF:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3.2.1 is released !",category:"releases",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"We are pleased to announce the release of Vert.x 3.2.1!"}),i=[{term:"http",tf:5},{term:"releas",tf:4},{term:"com",tf:4},{term:"wiki",tf:4},{term:"improv",tf:3},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"support",tf:2},{term:"note",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"distribut",tf:2},{term:"2016",tf:1},{term:"pleas",tf:1},{term:"announc",tf:1},{term:"contain",tf:1},{term:"bug",tf:1},{term:"fix",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We are pleased to an\xadnounce the re\xadlease of Vert.x 3.2.1!"),Object(o.a)("p",null,"The re\xadlease con\xadtains many bug fixes and a ton of small im\xadprove\xadments, such as fu\xadture com\xadpo\xadsi\xadtion, im\xadproved Cey\xadlon sup\xadport, Stomp vir\xadtual host sup\xadport, per\xadfor\xadmance im\xadprove\xadments\u2026 Full re\xadlease notes can be found here:"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.2.1---Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.2.1-\u200b\u2014Release-Notes")),Object(o.a)("p",null,"Break\xading changes are here:"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.2.1---Breaking-Changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.2.1-\u200b\u2014Breaking-Changes")),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Dock\xaders im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),"\nThe vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan"),"."),Object(o.a)("p",null,"Many thanks to all the com\xadmit\xadters and com\xadmu\xadnity whose con\xadtri\xadbu\xadtions made this pos\xadsi\xadble."),Object(o.a)("p",null,"Next stop is Vert.x 3.3.0 which we hope to have out in May 2016."),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.2.1%22"}),"Maven Cen\xadtral"),"\nand you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.2.1/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"Happy cod\xading !"))}m.isMDXComponent=!0},UMc4:function(e,a,t){"use strict";var n=t("q1tI"),s=t.n(n),c=t("TSYQ"),r=t.n(c),o=t("nOHt"),l=t.n(o),i=t("4hdO"),p=t("anbt"),m=t("Cgje"),j=t("naWs"),b=(t("05nU"),s.a.createElement);function h(e,a){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,a){if(!e)return;if("string"===typeof e)return d(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return d(e,a)}(e))||a&&e&&"number"===typeof e.length){t&&(e=t);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,r=!0,o=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return r=e.done,e},e:function(e){o=!0,c=e},f:function(){try{r||null==t.return||t.return()}finally{if(o)throw c}}}}function d(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=new Array(a);t<a;t++)n[t]=e[t];return n}a.a=function(e){var a=e.meta,t=void 0===a?{}:a,s=e.narrow,c=e.hashSmoothScroll,o=void 0!==c&&c,d=e.children,O=Object(n.useContext)(p.a.State),u=Object(n.useRef)(),N=Object(n.useCallback)((function(e,a){var t=e.substring(e.indexOf("#")+1),n=document.getElementById(t);if(n){var s=n.offsetTop-O.height;Object(i.a)(s,a?200:500)}}),[O.height]),g=Object(n.useCallback)((function(e){N(e.newURL)}),[N]),f=Object(n.useCallback)((function(e){var a,t=h(e.current.querySelectorAll("a[href^='#']"));try{var n=function(){var e=a.value;e.onclick=function(a){a.preventDefault();var t=window.location.href;t.substring(t.indexOf("#"))!==e.getAttribute("href")?l.a.push(window.location.pathname+e.getAttribute("href")):N(t)}};for(t.s();!(a=t.n()).done;)n()}catch(s){t.e(s)}finally{t.f()}}),[N]);return Object(n.useEffect)((function(){return o&&(l.a.events.on("hashChangeStart",N),window.addEventListener("hashchange",g),f(u),N(window.location.href,!0)),function(){o&&(window.removeEventListener("hashchange",g),l.a.events.off("hashChangeStart",N))}}),[g,N,f,o]),b("main",{className:"page"},b(m.a,{title:t.title}),b("div",{className:"page-content"},b("div",{className:r()("container",{"container-narrow":s}),ref:u},d)),b(j.a,null))}},Uhhe:function(e,a){e.exports="/_next/static/images/elk-overview-d637f3455278492bcb6820de578d066b.svg"},VCtW:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return m})),t.d(a,"__tfidf__terms",(function(){return j})),t.d(a,"default",(function(){return h}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("280p"),i=t("YFqc"),p=t.n(i),m=(r.a.createElement,{title:"ECMAScript 6/7 on the JVM with TypeScript and Vert.x",category:"guides",authors:[{name:"Michel Kr\xe4mer",github_id:"michel-kraemer"}],summary:"I figured it would be a good idea to give you a couple of examples how teaming\n  Vert.x and TypeScript helps you use ECMAScript 6 and 7 features on the JVM today."}),j=[{term:"typescript",tf:22},{term:"us",tf:15},{term:"es6",tf:12},{term:"ecmascript",tf:11},{term:"lang",tf:9},{term:"featur",tf:8},{term:"type",tf:7},{term:"support",tf:5},{term:"javascript",tf:5},{term:"compil",tf:5},{term:"verticl",tf:5},{term:"follow",tf:4},{term:"exampl",tf:4},{term:"es7",tf:4},{term:"new",tf:4},{term:"will",tf:4},{term:"paramet",tf:4},{term:"applic",tf:4},{term:"good",tf:3},{term:"jvm",tf:3},{term:"librari",tf:3},{term:"part",tf:3},{term:"execut",tf:3},{term:"definit",tf:3},{term:"api",tf:3}],b={meta:m,__tfidf__terms:j};function h(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},b,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Fol\xadlow\xading the lat\xadest re\xadleases of ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io"}),"Vert.x 3.2")," and\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/michel-kraemer/vertx-lang-typescript"}),"vertx-\u200blang-typescript 1.1.0"),"\nI fig\xadured it would be a good idea to give you a cou\xadple of ex\xadam\xadples how team\xading\nVert.x and Type\xadScript helps you use EC\xadMAScript 6 and 7 fea\xadtures on the JVM today."),Object(o.a)("p",null,"The vertx-\u200blang-typescript li\xadbrary adds ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://www.typescriptlang.org/"}),"Type\xadScript")," sup\xadport to Vert.x 3.\nType\xadScript is a typed su\xadper\xadset of JavaScript that com\xadpiles to plain JavaScript. It sup\xadports the\nEC\xadMAScript 6 (EC\xadMAScript 2015, ES6) stan\xaddard and also a few parts of EC\xadMAScript 7 (ES7) al\xadready."),Object(o.a)("p",null,"The li\xadbrary au\xadto\xadmat\xadi\xadcally com\xadpiles Vert.x ver\xadti\xadcles writ\xadten in\nType\xadScript to JavaScript and ex\xade\xadcutes them on the JVM. vertx-\u200blang-typescript also pro\xadvides\ntype de\xadf\xadi\xadn\xadi\xadtions for the Vert.x JavaScript API. Use them in your favourite\nType\xadScript ed\xadi\xadtor/IDE to get auto-\u200bcompletion, API doc\xadu\xadmen\xadta\xadtion and mean\xading\xadful error\nmes\xadsages. See the fol\xadlow\xading screen\xadcast:"),Object(o.a)("img",{src:"https://raw.githubusercontent.com/michel-kraemer/vertx-lang-typescript/aaa67228c998bf9dc64b5f45fb407ef56169efec/screencast.gif"}),Object(o.a)("h2",{id:"ecmascript-67-and-vertx"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#ecmascript-67-and-vertx"})),"ECMAScript 6/7 and Vert.x"),Object(o.a)("p",null,"Below you find an ex\xadam\xadple ver\xadti\xadcle writ\xadten in Type\xadScript. Well, I left all\nthe TypeScript-\u200bspecific parts out. In fact the ver\xadti\xadcle is valid EC\xadMAScript 6\n(ex\xadcept for the last snip\xadpet ","[9]"," which is EC\xadMAScript 7)."),Object(o.a)("p",null,"First, fol\xadlow the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/michel-kraemer/vertx-lang-typescript/blob/master/README.md"}),"vertx-\u200blang-typescript README"),"\nto in\xadstall the li\xadbrary and to en\xadable Type\xadScript in Vert.x. Then ex\xadtract the\ntype de\xadf\xadi\xadn\xadi\xadtions (",Object(o.a)("inlineCode",{parentName:"p"},"vertx-lang-typescript-1.1.0-typings.zip"),") into a new di\xadrec\xadtory.\nCre\xadate a new file named ",Object(o.a)("inlineCode",{parentName:"p"},"es7verticle.ts")," in this di\xadrec\xadtory and copy the code\nbelow into it. Fi\xadnally, open your com\xadmand prompt and ex\xade\xadcute"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"vertx run es7verticle.ts\n")),Object(o.a)("p",null,"This will run a small HTTP server that lis\xadtens to re\xadquests on port 8080. If you\nopen your browser and go to http://lo\xadcal\xadhost:8080 you will see the fol\xadlow\xading:"),Object(o.a)("img",{src:t("qUP3"),alt:"Output of the verticle written in TypeScript"}),Object(o.a)("p",null,"So far so good. Now let\u2019s have a look at the code. I num\xadbered the in\xaddi\xadvid\xadual\nEC\xadMAScript fea\xadtures used. Here\u2019s a com\xadplete list:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"Use an ",Object(o.a)("em",{parentName:"li"},"arrow func\xadtion")," to cre\xadate a re\xadquest han\xaddler (ES6)"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Block-\u200bscoped vari\xadables")," do not pol\xadlute your global name\xadspace (ES6)"),Object(o.a)("li",{parentName:"ol"},"Spec\xadify a ",Object(o.a)("em",{parentName:"li"},"de\xadfault value")," for a func\xadtion pa\xadra\xadme\xadter (ES6)"),Object(o.a)("li",{parentName:"ol"},"Use ",Object(o.a)("em",{parentName:"li"},"rest pa\xadra\xadme\xadters")," to col\xadlect mul\xadti\xadple pa\xadra\xadme\xadters in an array (ES6)"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"Spread")," the con\xadtents of an array to func\xadtion pa\xadra\xadme\xadters (ES6)"),Object(o.a)("li",{parentName:"ol"},"It\xader\xadate over array con\xadtents using the ",Object(o.a)("em",{parentName:"li"},"for\u2026of loop")," (ES6)"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("em",{parentName:"li"},"tem\xadplate strings")," en\xadable ",Object(o.a)("em",{parentName:"li"},"string in\xadter\xadpo\xadla\xadtion")," and ",Object(o.a)("em",{parentName:"li"},"multi-\u200bline strings")," (ES6)"),Object(o.a)("li",{parentName:"ol"},"Use ",Object(o.a)("em",{parentName:"li"},"classes")," and ",Object(o.a)("em",{parentName:"li"},"in\xadher\xadi\xadtance")," (ES6)"),Object(o.a)("li",{parentName:"ol"},"Use the new ",Object(o.a)("em",{parentName:"li"},"ex\xadpo\xadnen\xadti\xada\xadtion op\xader\xada\xadtor")," as a short\xadcut for ",Object(o.a)("inlineCode",{parentName:"li"},"Math.pow()")," (ES7)")),Object(o.a)(l.a,{url:"https://gist.github.com/michel-kraemer/892866038dabcb8376e6",mdxType:"Gist"}),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"The ex\xadam\xadple demon\xadstrates very well how you can use EC\xadMAScript 6 (and parts of\n7) on the JVM today. In fact, there are a lot more\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://es6-features.org/"}),"cool ES6 fea\xadtures")," not in\xadcluded in the ex\xadam\xadple such\nas con\xadstants (",Object(o.a)("inlineCode",{parentName:"p"},"const"),"), the prop\xaderty short\xadhand or method prop\xader\xadties."),Object(o.a)("p",null,"Type\xadScript is so much more than just ES6. It ac\xadtu\xadally has a\nvery good sta\xadtic type sys\xadtem that al\xadlows you to make compile-\u200btime type checks.\nThis is makes it much eas\xadier to write large Vert.x ap\xadpli\xadca\xadtions with many\nver\xadti\xadcles. Per\xadson\xadally I re\xadally like the sup\xadport that I get from my IDE when\npro\xadgram\xadming Type\xadScript. Since vertx-\u200blang-typescript comes with type de\xadf\xadi\xadn\xadi\xadtions\nfor the Vert.x JavaScript API I get auto-\u200bcompletion and ac\xadcess to the doc\xadu\xadmen\xadta\xadtion\nright in the ed\xadi\xadtor. I mostly use ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://www.sublimetext.com/"}),"Sub\xadlime")," by the\nway, but I have tested it suc\xadcess\xadfully with\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://code.visualstudio.com/"}),"Vi\xadsual Stu\xaddio Code"),", ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://www.eclipse.org/"}),"Eclipse"),"\nand ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://atom.io/"}),"Atom"),"."),Object(o.a)("p",null,"Un\xadfor\xadtu\xadnately, the only ES7 fea\xadture that you can use at the mo\xadment with\nvertx-\u200blang-typescript is the ",Object(o.a)("em",{parentName:"p"},"ex\xadpo\xadnen\xadti\xada\xadtion op\xader\xada\xadtor"),". Type\xadScript 1.7 also\nsup\xadports ",Object(o.a)("em",{parentName:"p"},"dec\xado\xadra\xadtors")," but this fea\xadture is dis\xadabled at the mo\xadment in\nvertx-\u200blang-typescript be\xadcause it is ex\xadper\xadi\xadmen\xadtal and sub\xadject to change. I\u2019ll\nkeep you up to date when new fea\xadtures are in\xadtro\xadduced."),Object(o.a)("h2",{id:"alternatives"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#alternatives"})),"Alternatives"),Object(o.a)("p",null,"We\u2019ve re\xadcently ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/vert-x-es6-back-to-the-future/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"pub\xadlished a post")),"\non how to use EC\xadMAScript 6 with Vert.x here on this blog. We used ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://babeljs.io/"}),"Babel"),", a\ncom\xadpiler that trans\xadlates ES6 to ES5."),Object(o.a)("p",null,"Al\xadthough this ap\xadproach works well it is a bit harder to set up and use than the\none pre\xadsented here. First, you need to wrap your Vert.x ap\xadpli\xadca\xadtion in a NPM pack\xadage.\nSec\xadond, in order to run your ap\xadpli\xadca\xadtion, you need to ex\xade\xadcute two com\xadmands.\nYou have to com\xadpile it with ",Object(o.a)("inlineCode",{parentName:"p"},"npm run build")," and then then call ",Object(o.a)("inlineCode",{parentName:"p"},"npm start"),".\nWith vertx-\u200blang-typescript you only need one com\xadmand. vertx-\u200blang-typescript\nalso al\xadlows you to embed the Type\xadScript ver\xadti\xadcle in a larger Vert.x ap\xadpli\xadca\xadtion\nand also mix mul\xadti\xadple lan\xadguages in one project. This is not pos\xadsi\xadble if you wrap\nevery\xadthing in a NPM pack\xadage."),Object(o.a)("p",null,"Fi\xadnally, the ap\xadproach based on Babel only sup\xadports EC\xadMAScript 6 (2015), al\xadthough\nmore fea\xadtures from ES7 will surely be in\xadtro\xadduced in Babel in the fu\xadture.\nType\xadScript on the other hand gives you much more fea\xadtures such as sta\xadtic\ntyp\xading that you will cer\xadtainly find use\xadful for any larger project."))}h.isMDXComponent=!0},WjdI:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x goes Native",category:"guides",authors:[{name:"Johannes Sch\xfcth",github_id:"jotschi"}],summary:"This blog post introduces native image generation of Vert.x applications with GraalVM. Generated executables can be run without a JVM."}),i=[{term:"nativ",tf:10},{term:"graalvm",tf:9},{term:"gener",tf:7},{term:"need",tf:7},{term:"substrat",tf:7},{term:"vm",tf:7},{term:"imag",tf:6},{term:"applic",tf:6},{term:"support",tf:6},{term:"netti",tf:6},{term:"us",tf:5},{term:"execut",tf:5},{term:"run",tf:5},{term:"will",tf:5},{term:"class",tf:5},{term:"no",tf:4},{term:"memori",tf:4},{term:"mb",tf:4},{term:"within",tf:4},{term:"patch",tf:4},{term:"ssl",tf:4},{term:"jvm",tf:3},{term:"requir",tf:3},{term:"contain",tf:3},{term:"build",tf:3}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"I this blog post, I would like to give you a pre\xadview on na\xadtive image gen\xader\xada\xadtion of Vert.x ap\xadpli\xadca\xadtions using GraalVM."),Object(o.a)("p",null,"With ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.graalvm.org/"}),"GraalVM")," it is pos\xadsi\xadble to gen\xader\xadate na\xadtive ex\xade\xadcuta\xadbles.\nThese ex\xade\xadcuta\xadbles can be di\xadrectly run with\xadout the need of an in\xadstalled JVM."),Object(o.a)("h2",{id:"benefits"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#benefits"})),"Benefits"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"The start up time is way faster. It is no longer re\xadquired to wait for the start up of the JVM. The ap\xadpli\xadca\xadtion is usu\xadally up and run\xadning in a mat\xadter of mil\xadlisec\xadonds.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"Re\xadduced mem\xadory foot\xadprint. I mea\xadsured 40 MB mem\xadory usage (RSS) for the Vert.x Web ap\xadpli\xadca\xadtion which I\u2019m going to show\xadcase.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"Smaller Con\xadtain\xaders. No JVM means no over\xadhead. All the needed parts are al\xadready con\xadtained within the ex\xade\xadcutable. This can be very ben\xade\xadfi\xadcial when build\xading de\xadploy\xadable con\xadtainer im\xadages."))),Object(o.a)("h2",{id:"demo-project"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#demo-project"})),"Demo Project"),Object(o.a)("p",null,"For the demo ap\xadpli\xadca\xadtion I choose a very basic hello world ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web/java/"}),"Vert.x Web")," server."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," de.jotschi.examples;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," java.io.File;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.Vertx;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.logging.Logger;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.logging.LoggerFactory;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.logging.SLF4JLogDelegateFactory;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.web.Router;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Runner")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"main"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String[] args)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Use logback for logging"),"\n    File logbackFile = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," File(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"config"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"logback.xml"'),");\n    System.setProperty(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"logback.configurationFile"'),', logbackFile.getAbsolutePath());\n    System.setProperty(LoggerFactory.LOGGER_DELEGATE_FACTORY_CLASS_NAME, SLF4JLogDelegateFactory.class.getName());\n    Logger log = LoggerFactory.getLogger(Runner.class);\n\n    // Setup the http server\n    log.info("Starting server ',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"for"),": http://localhost:",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),"/hello",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'");\n    Vertx vertx = Vertx.vertx();\n    Router router = Router.router(vertx);\n\n    router.route("'),"/hello",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'").handler(rc -> {\n      log.info("'),"Got hello request",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'");\n      rc.response().end("'),"World",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'");\n    });\n\n    vertx.createHttpServer()\n      .requestHandler(router::accept)\n      .listen(8080);\n\n  }\n\n}\n'))),Object(o.a)("h2",{id:"graalvm"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#graalvm"})),"GraalVM"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.graalvm.org/"}),"GraalVM"),"runs a sta\xadtic analy\xadsis on the gen\xader\xadated ap\xadpli\xadca\xadtion in order to find the reach\xadable code.\nThis process which is run within the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/oracle/graal/tree/master/substratevm"}),"Sub\xadstrate VM")," will lead to the gen\xader\xada\xadtion of the na\xadtive image."),Object(o.a)("h3",{id:"limitations"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#limitations"})),"Limitations"),Object(o.a)("p",null,"Due to the na\xadture of the sta\xadtic analy\xadsis Sub\xadstrate VM also has some ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/oracle/graal/blob/master/substratevm/LIMITATIONS.md"}),"lim\xadi\xadta\xadtions"),"."),Object(o.a)("p",null,"Dy\xadnamic class load\xading and un\xadload\xading for ex\xadam\xadple is not sup\xadported be\xadcause this would in essence alter the avail\xadable code dur\xading run\xadtime. "),Object(o.a)("p",null,"Re\xadflec\xadtion is only par\xadtially sup\xadported and re\xadquires some man\xadual steps which we will cover later on."),Object(o.a)("h3",{id:"patches--workarounds"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#patches--workarounds"})),"Patches / Workarounds"),Object(o.a)("p",null,"[NOTE Work in progress | Next we need to apply some patches / workarounds. Keep in mind that na\xadtive image gen\xader\xada\xadtion is a fairly new topic and the these workarounds will hope\xadfully no longer be re\xadquired once the Sub\xadstrate VM and Netty have bet\xadter sup\xadport for each other.]"),Object(o.a)("p",null,"I did not man\xadage to get na\xadtive epoll, kqueue and SSL in\xadte\xadgra\xadtion to work with na\xadtive im\xadages.\nThese parts are heav\xadily op\xadti\xadmized within Netty and use JNI to di\xadrectly ac\xadcess the OS fea\xadtures.\nSub\xadstrate VM sup\xadports JNI and could in the\xadory in\xadte\xadgrate these na\xadtive li\xadbraries. "),Object(o.a)("p",null,"I cre\xadated a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graalvm-native-image-test/tree/netty-native-epoll"}),"re\xadpro\xadducer"),"\nand an ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/oracle/graal/issues/442"}),"issue")," so hope\xadfully these prob\xadlems can be ad\xaddressed soon."),Object(o.a)("h3",{id:"vertx-transport"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-transport"})),"Vert.x Transport"),Object(o.a)("p",null,"First I needed to patch the ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.core.net.impl.transport.Transport")," class in order to pre\xadvent the load\xading of EPoll and KQueue na\xadtive sup\xadport. Oth\xader\xadwise Sub\xadstrate VM will try to load these classes and fail."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Transport")," "),"{\n\u2026\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"/**\n   * The native transport, it may be {",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-doctag"}),"@code")," null} or failed.\n   */"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," Transport ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"nativeTransport"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Patched: I remove the native transport discovery. "),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// The imports would be picked up by substrate "),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// and cause further issues. "),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),";\n  }\n\u2026\n}\n")),Object(o.a)("h3",{id:"netty-ssl"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#netty-ssl"})),"Netty SSL"),Object(o.a)("p",null,"Na\xadtive SSL sup\xadport is an\xadother prob\xadlem\xadatic area. I cre\xadated a patched dummy ",Object(o.a)("inlineCode",{parentName:"p"},"io.netty.handler.ssl.ReferenceCountedOpenSslEngine")," class in order to pre\xadvent Sub\xadstrate VM from dig\xadging deeper into the SSL code of Netty."),Object(o.a)("p",null,"Next we need to set up the re\xadflec\xadtion con\xadfig\xadu\xadra\xadtion within ",Object(o.a)("inlineCode",{parentName:"p"},"reflectconfigs/netty.json"),"."),Object(o.a)("p",null,"Netty uses re\xadflec\xadtion to in\xadstan\xadti\xadate the socket chan\xadnels. This is done in the Re\xadflec\xadtiveChan\xadnelFac\xadtory. We need to tell Sub\xadstrate VM how classes of type NioServer\xadSock\xadetChan\xadnel  and NioSock\xadetChan\xadnel can be in\xadstan\xadti\xadated. "),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"[\n  {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"io.netty.channel.socket.nio.NioSocketChannel"'),",\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"methods"')," : [\n      { ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<init>"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"parameterTypes"')," : [] }\n    ]\n  },\n  {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"io.netty.channel.socket.nio.NioServerSocketChannel"'),",\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"methods"')," : [\n      { ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<init>"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"parameterTypes"')," : [] }\n    ]\n  }\n]\n")),Object(o.a)("p",null,"If you want to learn more about the state of Netty and GraalVM I can rec\xadom\xadmend this ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://medium.com/graalvm/instant-netty-startup-using-graalvm-native-image-generation-ed6f14ff7692"}),"GraalVM Blog\xadpost")," by Co\xaddrut Stancu."),Object(o.a)("h2",{id:"building"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#building"})),"Building"),Object(o.a)("p",null,"Fi\xadnally we can build our maven project to gen\xader\xadate a shaded jar."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean package\n")),Object(o.a)("p",null,"Next we need the GraalVM pack\xadage. You can down\xadload it from the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.graalvm.org/"}),"GraalVM web\xadsite"),"."),Object(o.a)("p",null,"We use the shaded jar as the input source for the ",Object(o.a)("inlineCode",{parentName:"p"},"native-image")," com\xadmand which will gen\xader\xadate the ex\xade\xadcutable."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-variable"}),"$GRAALVMDIR"),"/bin/native-image \\\n --verbose \\\n --no-server \\\n -Dio.netty.noUnsafe=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"  \\\n -H:ReflectionConfigurationFiles=./reflectconfigs/netty.json \\\n -H:+ReportUnsupportedElementsAtRuntime \\\n -Dfile.encoding=UTF-8 \\\n -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar\n")),Object(o.a)("h2",{id:"result"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#result"})),"Result"),Object(o.a)("p",null,"Fi\xadnally we end up with an 27 MB ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-graalvm-native-image-test-0.0.1-SNAPSHOT")," ex\xade\xadcutable which we can run."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"$ ldd vertx-graalvm-native-image-test-0.0.1-SNAPSHOT \n  linux-vdso.so.1 (0x00007ffc65be8000)\n  libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f8e892f0000)\n  libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f8e890d3000)\n  libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007f8e88eb9000)\n  librt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007f8e88cb1000)\n  libcrypt.so.1 => /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007f8e88a79000)\n  libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f8e886da000)\n  /lib64/ld-linux-x86-64.so.2 (0x00007f8e8afb7000)\n")),Object(o.a)("h3",{id:"memory"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#memory"})),"Memory"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"/usr/bin/time -f ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"\\nmaxRSS\\t%MkB"')," java -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar \n/usr/bin/time -f ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"\\nmaxRSS\\t%MkB"')," ./vertx-graalvm-native-image-test-0.0.1-SNAPSHOT \n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Na\xadtive Image: 40 MB"),Object(o.a)("li",{parentName:"ul"},"Java 10: 125 MB")),Object(o.a)("p",null,"The full project can be found on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graalvm-native-image-test"}),"GitHub"),"."),Object(o.a)("p",null,"If you want to read more on the topic I can also rec\xadom\xadmend ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://sites.google.com/a/athaydes.com/renato-athaydes/posts/a7mbnative-imagejavaappthatrunsin30msandusesonly4mbofram"}),"this ar\xadti\xadcle")," by Re\xadnato Athay\xaddes in which he demon\xadstrates how to cre\xadate a very small light weight low mem\xadory ap\xadpli\xadca\xadtion using GraalVM."),Object(o.a)("p",null,"Thanks for read\xading. If you have any fur\xadther ques\xadtions or feed\xadback don\u2019t hes\xadi\xadtate to send me a tweet to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://twitter.com/Jotschi/"}),"@Jotschi"),"."))}m.isMDXComponent=!0},Yekb:function(e,a){e.exports="/_next/static/images/bidding_in_application-2d6ab16e2136916c844b9425fa93407c.png"},YnlU:function(e,a){e.exports="/_next/static/images/post-3-My_Whisky_Collection-fbcc708f4e08b9560db543f8020d3574.png"},Z82Q:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return m})),t.d(a,"__tfidf__terms",(function(){return j})),t.d(a,"default",(function(){return h}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("a1bP"),i=t("YFqc"),p=t.n(i),m=(r.a.createElement,{title:"Combine vert.x and mongo to build a giant",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"This blog post is part of the introduction to Vert.x series. We are now going to replace this JDBC client by the vertx-mongo-client, and thus connect to a Mongo database."}),j=[{term:"us",tf:27},{term:"mongo",tf:26},{term:"document",tf:21},{term:"client",tf:14},{term:"post",tf:13},{term:"applic",tf:12},{term:"test",tf:12},{term:"configur",tf:12},{term:"databas",tf:11},{term:"need",tf:11},{term:"jdbc",tf:10},{term:"code",tf:10},{term:"updat",tf:10},{term:"start",tf:9},{term:"file",tf:9},{term:"server",tf:8},{term:"time",tf:7},{term:"let",tf:7},{term:"queri",tf:7},{term:"select",tf:7},{term:"data",tf:6},{term:"verticl",tf:6},{term:"json",tf:6},{term:"object",tf:6},{term:"go",tf:5}],b={meta:m,__tfidf__terms:j};function h(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},b,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"This blog post is part of the ",Object(o.a)("em",{parentName:"p"},"in\xadtro\xadduc\xadtion to vert.x")," se\xadries. Last time, we have seen how we can use the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-jdbc-client")," to con\xadnect to a data\xadbase using a JDBC dri\xadver. In this post, we are going to re\xadplace this JDBC client by the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-mongo-client"),", and thus con\xadnect to a Mongo data\xadbase."),Object(o.a)("p",null,"You don\u2019t un\xadder\xadstand the title, check the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.mongodb.org"}),"mon\xadgoDB")," web\xadsite."),Object(o.a)("p",null,"But be\xadfore going fur\xadther, let\u2019s recap."),Object(o.a)("h2",{id:"previously-in--introduction-to-vertx"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#previously-in--introduction-to-vertx"})),"Previously in  \u2018introduction to vert.x\u2019"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/my-first-vert-x-3-application/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"first post"))," has de\xadscribed how to build a vert.x ap\xadpli\xadca\xadtion with Maven and ex\xade\xadcute unit tests."),Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/vert-x-application-configuration/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"sec\xadond post"))," has de\xadscribed how this ap\xadpli\xadca\xadtion can be\xadcome con\xadfig\xadurable."),Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/some-rest-with-vert-x/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"third post"))," has in\xadtro\xadduced ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-web/java/"}),"vertx-\u200bweb"),", and a small col\xadlec\xadtion man\xadage\xadment ap\xadpli\xadca\xadtion has been de\xadvel\xadoped. This ap\xadpli\xadca\xadtion of\xadfers a REST API used by a HTML/JavaScript fron\xadtend."),Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/unit-and-integration-tests/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"fourth post"))," has pre\xadsented how you can run in\xadte\xadgra\xadtion tests to en\xadsure the be\xadhav\xadior of your ap\xadpli\xadca\xadtion."),Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/using-the-asynchronous-sql-client/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"last post"))," has pre\xadsented how you can in\xadter\xadact with a JDBC data\xadbase using the vertx-\u200bjdbc-client.")),Object(o.a)("p",null,"This post shows an\xadother client that lets you use Mon\xadgoDB in a vert.x ap\xadpli\xadca\xadtion. This client pro\xadvides an vert.x API to ac\xadcess asyn\xadchro\xadnously to the Mongo data\xadbase. We won\u2019t com\xadpare whether or not JDBC is su\xadpe\xadrior to Mongo, they have both pros and cons, and you should use the one that meet your re\xadquire\xadments. Vert.x lets you choose, that\u2019s the point."),Object(o.a)("p",null,"The vertx-\u200bmongo-client doc\xadu\xadmen\xadta\xadtion is avail\xadable ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-mongo-client/java/"}),"here"),"."),Object(o.a)("p",null,"The code de\xadvel\xadoped in this blog post is avail\xadable in the branch ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-6"}),"post-6"),". Our start\xading point is the code from the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-5"}),"post-5 branch"),"."),Object(o.a)("h2",{id:"asynchronous-data-access"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#asynchronous-data-access"})),"Asynchronous data access"),Object(o.a)("p",null,"One of the vert.x char\xadac\xadter\xadis\xadtics is being asyn\xadchro\xadnous. With an asyn\xadchro\xadnous API, you don\u2019t wait for a re\xadsult, but you are no\xadti\xadfied when this re\xadsult is ready. Thanks to vert.x, this no\xadti\xadfi\xadca\xadtion hap\xadpens in the same thread (un\xadder\xadstand event loop) as the ini\xadtial re\xadquest:"),Object(o.a)("img",{src:t("4CLo"),alt:"Asynchronous data access"}),Object(o.a)("p",null,"Your code (on the left) is going to in\xadvoke the mongo client and pass a call\xadback that will be in\xadvoked when the re\xadsult is avail\xadable. The in\xadvo\xadca\xadtion to the mongo client is non block\xading and re\xadturns im\xadme\xaddi\xadately. The client is deal\xading with the mongo data\xadbase and when the re\xadsult has been com\xadputed / re\xadtrieved, it in\xadvokes the call\xadback in the same event loop as the re\xadquest."),Object(o.a)("p",null,"This model is par\xadtic\xadu\xadlarly pow\xader\xadful as it avoids the syn\xadchro\xadniza\xadtion pit\xadfalls. In\xaddeed, your code is only called by a sin\xadgle thread, no need to syn\xadchro\xadnize any\xadthing."),Object(o.a)("h2",{id:"as-with-every-maven-project"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#as-with-every-maven-project"})),"As with every Maven project\u2026"),Object(o.a)("p",null,"\u2026 we need to up\xaddate the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file first."),Object(o.a)("p",null,"In the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file, re\xadplace the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-jdbc-client")," by the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-mongo-client"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-mongo-client",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.1.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"Un\xadlike JDBC where we were in\xadstan\xadti\xadat\xading a data\xadbase on the fly, here we need to ex\xadplic\xaditly starts a Mon\xadgoDB server. In order to launch a Mongo server in our test, we are going to add an\xadother de\xadpen\xaddency:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"de.flapdoodle.embed",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"de.flapdoodle.embed.mongo",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.50.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"This de\xadpen\xaddency will be used in our unit tests, as it lets us start a mongo server pro\xadgram\xadmat\xadi\xadcally. For our in\xadte\xadgra\xadtion tests, we are going to use a Maven plug\xadin start\xading and stop\xadping the mongo server be\xadfore and after our in\xadte\xadgra\xadtion tests. Add this plug\xadin to the ",Object(o.a)("inlineCode",{parentName:"p"},"<plugins/>")," sec\xadtion of your ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"com.github.joelittlejohn.embedmongo",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"embedmongo-maven-plugin",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"0.2.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"start",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"start",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"port"),">"),"37017",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"port"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"stop",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"stop",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n")),Object(o.a)("p",null,"No\xadtice the port we use here (37017), we will use this port later."),Object(o.a)("h2",{id:"enough-xml-for-today"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#enough-xml-for-today"})),"Enough XML for today"),Object(o.a)("p",null,"Now that we have up\xaddated our ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file, it\u2019s time to change our ver\xadti\xadcle. The first thing to do is to re\xadplace the jdbc client by the mongo client:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"mongo = MongoClient.createShared(vertx, config());\n")),Object(o.a)("p",null,"This client is con\xadfig\xadured with the con\xadfig\xadu\xadra\xadtion given to the ver\xadti\xadcle (more on this below)."),Object(o.a)("p",null,"Once done, we need to change how we start the ap\xadpli\xadca\xadtion. With the mongo client, no need to ac\xadquire a con\xadnec\xadtion, it han\xaddles this in\xadter\xadnally. So our startup se\xadquence is a bit more sim\xadple:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"createSomeData(\n    (nothing) -> startWebApp(\n        (http) -> completeStartup(http, fut)\n    ), fut);\n")),Object(o.a)("p",null,"As in the pre\xadvi\xadous post, we need to in\xadsert some pre\xadde\xadfined data if the data\xadbase is empty:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"createSomeData"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Handler<AsyncResult<Void>> next, Future<Void> fut)")," "),"{\n  Whisky bowmore = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Bowmore 15 Years Laimrig"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Islay"'),");\n  Whisky talisker = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Talisker 57\xb0 North"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Island"'),");\n  System.out.println(bowmore.toJson());\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Do we have data in the collection ?"),"\n  mongo.count(COLLECTION, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject(), count -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (count.succeeded()) {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (count.result() == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),") {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// no whiskies, insert data"),"\n        mongo.insert(COLLECTION, bowmore.toJson(), ar -> {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.failed()) {\n            fut.fail(ar.cause());\n          } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            mongo.insert(COLLECTION, talisker.toJson(), ar2 -> {\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar2.failed()) {\n                fut.failed();\n              } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n                next.handle(Future.<Void>succeededFuture());\n              }\n            });\n          }\n        });\n      } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n        next.handle(Future.<Void>succeededFuture());\n      }\n    } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// report the error"),"\n      fut.fail(count.cause());\n    }\n  });\n}\n")),Object(o.a)("p",null,"To de\xadtect whether or not the data\xadbase al\xadready con\xadtains some data, we re\xadtrieve the num\xadber of ",Object(o.a)("em",{parentName:"p"},"doc\xadu\xadments")," from the ",Object(o.a)("inlineCode",{parentName:"p"},"whiskies")," col\xadlec\xadtion. This is done with : ",Object(o.a)("inlineCode",{parentName:"p"},"mongo.count(COLLECTION, new JsonObject(), count -> {})"),". The sec\xadond pa\xadra\xadme\xadter is the query. In our case, we want to count all doc\xadu\xadments. This is done using ",Object(o.a)("inlineCode",{parentName:"p"},"new JsonObject()")," that would cre\xadate a query ac\xadcept\xading all doc\xadu\xadments from the col\xadlec\xadtion (it\u2019s equiv\xada\xadlent to a ",Object(o.a)("inlineCode",{parentName:"p"},"SELECT * FROM ..."),")."),Object(o.a)("p",null,"Also no\xadtice the ",Object(o.a)("inlineCode",{parentName:"p"},"insert")," calls. Doc\xadu\xadments are passed as JSON ob\xadject, so to in\xadsert an ob\xadject, just se\xadri\xadal\xadize it to JSON and use ",Object(o.a)("inlineCode",{parentName:"p"},"mongo.insert(COLLECTION, json, completion handler)"),"."),Object(o.a)("h2",{id:"mongo-ize-the-rest-handlers"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#mongo-ize-the-rest-handlers"})),"Mongo-ize the REST handlers"),Object(o.a)("p",null,"Now that the ap\xadpli\xadca\xadtion boot se\xadquence has been mi\xadgrated to mongo, it\u2019s time to up\xaddate the code han\xaddling the REST re\xadquests."),Object(o.a)("p",null,"Let\u2019s start by the ",Object(o.a)("inlineCode",{parentName:"p"},"getAll")," method that re\xadturns all stored prod\xaducts. To im\xadple\xadment this, we use the ",Object(o.a)("inlineCode",{parentName:"p"},"find")," method. As we saw for the ",Object(o.a)("inlineCode",{parentName:"p"},"count")," method, we pass an empty json ob\xadject to de\xadscribe a query ac\xadcept\xading all doc\xadu\xadments:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getAll"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext routingContext)")," "),"{\n  mongo.find(COLLECTION, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject(), results -> {\n    List<JsonObject> objects = results.result();\n    List<Whisky> whiskies = objects.stream().map(Whisky::",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new"),").collect(Collectors.toList());\n    routingContext.response()\n        .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json; charset=utf-8"'),")\n        .end(Json.encodePrettily(whiskies));\n  });\n}\n")),Object(o.a)("p",null,"The query re\xadsults are passed as a list of JSON ob\xadjects. From this list we can cre\xadate our prod\xaduct in\xadstances, and fill the HTTP re\xadsponse with this set."),Object(o.a)("p",null,"To delete a spe\xadcific doc\xadu\xadment we need to se\xadlect the doc\xadu\xadment using its ",Object(o.a)("inlineCode",{parentName:"p"},"id"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"deleteOne"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext routingContext)")," "),"{\n  String id = routingContext.request().getParam(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"id"'),");\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (id == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n    routingContext.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"400"),").end();\n  } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    mongo.removeOne(COLLECTION, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"_id"'),", id),\n        ar -> routingContext.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"204"),").end());\n  }\n}\n")),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},'new JsonObject().put("_id", id)')," de\xadscribes a query se\xadlect\xading a sin\xadgle doc\xadu\xadment (se\xadlected by its unique ",Object(o.a)("inlineCode",{parentName:"p"},"id"),", so it\u2019s the equiv\xada\xadlent to ",Object(o.a)("inlineCode",{parentName:"p"},"SELECT * WHERE id=..."),"). No\xadtice the ",Object(o.a)("inlineCode",{parentName:"p"},"_id")," which is a mongo trick to se\xadlect a doc\xadu\xadment by id."),Object(o.a)("p",null,"Up\xaddat\xading a doc\xadu\xadment is a less triv\xadial:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"updateOne"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext routingContext)")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," String id = routingContext.request().getParam(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"id"'),");\n  JsonObject json = routingContext.getBodyAsJson();\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (id == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null")," || json == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n    routingContext.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"400"),").end();\n  } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    mongo.update(COLLECTION,\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"_id"'),", id), ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Select a unique document"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// The update syntax: {$set, the json object containing the fields to update}"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()\n            .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"$set"'),", json),\n        v -> {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (v.failed()) {\n            routingContext.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"404"),").end();\n          } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            routingContext.response()\n                .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json; charset=utf-8"'),")\n                .end(Json.encodePrettily(\n                  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(id, json.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),"),\n                    json.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"origin"'),"))));\n          }\n        });\n  }\n}\n")),Object(o.a)("p",null,"As we can see, the ",Object(o.a)("inlineCode",{parentName:"p"},"update")," method takes two JSON ob\xadjects as pa\xadra\xadme\xadter:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"The first one de\xadnotes the query (here we se\xadlect a sin\xadgle doc\xadu\xadment using its id)."),Object(o.a)("li",{parentName:"ol"},"The sec\xadond ob\xadject ex\xadpresses the change to apply to the se\xadlected doc\xadu\xadment. It uses a mongo syn\xadtax. In our case, we up\xaddate the doc\xadu\xadment using the ",Object(o.a)("inlineCode",{parentName:"li"},"$set")," op\xader\xada\xadtor.")),Object(o.a)(l.a,{info:!0,mdxType:"Alert"},Object(o.a)("p",null,"In this code we up\xaddate the doc\xadu\xadment and re\xadplace only a set of fields. You can also re\xadplace the whole doc\xadu\xadment using ",Object(o.a)("inlineCode",{parentName:"p"},"mongo.replace(...)"),".")),Object(o.a)("p",null,"I def\xadi\xadnitely rec\xadom\xadmend to have a look to the Mon\xadgoDB doc\xadu\xadmen\xadta\xadtion, es\xadpe\xadcially:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://docs.mongodb.org/manual/tutorial/query-documents/",title:"MongoDB Query Documentation"}),"Query syn\xadtax doc\xadu\xadmen\xadta\xadtion")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://docs.mongodb.org/manual/tutorial/modify-documents/",title:"MongoDB Update Documentation"}),"Up\xaddate syn\xadtax doc\xadu\xadmen\xadta\xadtion"))),Object(o.a)("h2",{id:"time-for-configuration"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#time-for-configuration"})),"Time for configuration"),Object(o.a)("p",null,"Well, the code is mi\xadgrated, but we still need to up\xaddate the con\xadfig\xadu\xadra\xadtion. With JDBC we passed the JDBC url and the dri\xadver class in the con\xadfig\xadu\xadra\xadtion. With mongo, we need to con\xadfig\xadure the ",Object(o.a)("inlineCode",{parentName:"p"},"connection_string")," - the ",Object(o.a)("inlineCode",{parentName:"p"},"mongo://")," url on which the ap\xadpli\xadca\xadtion is con\xadnected, and ",Object(o.a)("inlineCode",{parentName:"p"},"db_name")," - a name for the data source."),Object(o.a)("p",null,"Let\u2019s start by the unit test. Edit the ",Object(o.a)("inlineCode",{parentName:"p"},"MyFirstVerticleTest")," file and add the fol\xadlow\xading code:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," MongodProcess MONGO;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," MONGO_PORT = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"12345"),";\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@BeforeClass"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"initialize"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"throws")," IOException "),"{\n  MongodStarter starter = MongodStarter.getDefaultInstance();\n  IMongodConfig mongodConfig = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MongodConfigBuilder()\n      .version(Version.Main.PRODUCTION)\n      .net(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Net(MONGO_PORT, Network.localhostIsIPv6()))\n      .build();\n  MongodExecutable mongodExecutable =\n      starter.prepare(mongodConfig);\n  MONGO = mongodExecutable.start();\n}\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@AfterClass"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"shutdown"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{  MONGO.stop(); }\n")),Object(o.a)("p",null,"Be\xadfore our tests, we start (pro\xadgram\xadmat\xadi\xadcally) a mongo data\xadbase on the port 12345. When all our tests have been ex\xade\xadcuted, we shut\xaddown the data\xadbase."),Object(o.a)("p",null,"So now that the mongo server is man\xadaged, we need to to give the right con\xadfig\xadu\xadra\xadtion to our ver\xadti\xadcle. Up\xaddate the ",Object(o.a)("inlineCode",{parentName:"p"},"DeploymentOption")," in\xadstance with:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"DeploymentOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," DeploymentOptions()\n    .setConfig(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()\n        .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", port)\n        .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"db_name"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"whiskies-test"'),")\n        .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"connection_string"'),",\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"mongodb://localhost:"')," + MONGO_PORT)\n);\n")),Object(o.a)("p",null,"That\u2019s all for the unit tests."),Object(o.a)("p",null,"For the integration-\u200btest, we are using an ex\xadter\xadnal\xadized json file. Edit the ",Object(o.a)("inlineCode",{parentName:"p"},"src/test/resources/my-it-config.json")," with the fol\xadlow\xading con\xadtent:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"http.port"'),": ${http.port},\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"db_name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"whiskies-it"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"connection_string"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"mongodb://localhost:37017"'),"\n}\n")),Object(o.a)("p",null,"No\xadtice the port we are using for the mongo server. This port was con\xadfig\xadured in the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file."),Object(o.a)("p",null,"Last but not least, we still have a con\xadfig\xadu\xadra\xadtion file to edit: the con\xadfig\xadu\xadra\xadtion you use to launch the ap\xadpli\xadca\xadtion in ",Object(o.a)("inlineCode",{parentName:"p"},"production"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"http.port"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8082"),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"db_name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"whiskies"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"connection_string"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"mongodb://localhost:27017"'),"\n}\n")),Object(o.a)("p",null,"Here you would need to edit the ",Object(o.a)("inlineCode",{parentName:"p"},"localhost:27017")," with the right url for your mongo server."),Object(o.a)(l.a,{info:!0,title:"Some changes in the integration tests",mdxType:"Alert"},Object(o.a)("p",null,"Be\xadcause mongo doc\xadu\xadment id are String and not in\xadte\xadger, we have to slightly change doc\xadu\xadment se\xadlec\xadtion in the in\xadte\xadgra\xadtion test.")),Object(o.a)("h2",{id:"time-for-a-run"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#time-for-a-run"})),"Time for a run"),Object(o.a)("p",null,"It\u2019s time to pack\xadage and run the ap\xadpli\xadca\xadtion and check that every\xadthing works as ex\xadpected. Let\u2019s pack\xadage the ap\xadpli\xadca\xadtion using:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),"mvn clean verify\n")),Object(o.a)("p",null,"And then to launch it, start your mongo server and launch:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),"java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar \\\n  -conf src/main/conf/my-application-conf.json\n")),Object(o.a)("p",null,"If you are, like me, using docker / docker-\u200bmachine for al\xadmost every\xadthing, edit the con\xadfig\xadu\xadra\xadtion file to refer to the right host (lo\xadcal\xadhost for docker, the docker-\u200bmachine ip if you use docker-\u200bmachine) and then launch:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"docker run -d -p 27017:27017 mongo\njava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar \\\n  -conf src/main/conf/my-application-conf.json\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"# or"),"\njava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar \\\n  -conf src/main/conf/my-application-conf-docker-machine.json\n")),Object(o.a)("img",{src:t("hiWL"),alt:"The application live and running"}),Object(o.a)("h2",{id:"thats-all-folks"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#thats-all-folks"})),"That\u2019s all folks!"),Object(o.a)("p",null,"We are reach\xading the end of this post. We saw how you can use the vert-\u200bmongo-client to ac\xadcess asyn\xadchro\xadnously data stored in\xadside a mongo data\xadbase as well as in\xadsert\xading/up\xaddat\xading this data. Now you have the choice be\xadtween JDBC or Mongo. In ad\xaddi\xadtion, vert.x pro\xadvides a client for Redis."),Object(o.a)("p",null,"Next time, we will see how the ver\xadti\xadcle class can be split in two ver\xadti\xadcles in order to bet\xadter or\xadga\xadnize your code. The in\xadter\xadac\xadtion be\xadtween the two ver\xadti\xadcles will uses ",Object(o.a)("em",{parentName:"p"},"ser\xadvices"),"."),Object(o.a)("p",null,"Stay tuned & Happy cod\xading!"))}h.isMDXComponent=!0},ZJXT:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x Web API Service Introduction",category:"guides",authors:[{name:"Francesco Guardiani",github_id:"slinkydeveloper"}],summary:"This blog post teaches you how to use the new module vertx-web-api-service to combine the Web Router and the OpenAPI Router Factory with service proxies."}),i=[{term:"servic",tf:29},{term:"oper",tf:14},{term:"router",tf:10},{term:"handler",tf:10},{term:"web",tf:8},{term:"event",tf:8},{term:"bu",tf:8},{term:"gener",tf:7},{term:"paramet",tf:7},{term:"api",tf:6},{term:"interfac",tf:6},{term:"exampl",tf:6},{term:"request",tf:5},{term:"us",tf:5},{term:"will",tf:5},{term:"annot",tf:5},{term:"new",tf:4},{term:"factori",tf:4},{term:"let",tf:4},{term:"need",tf:4},{term:"implement",tf:4},{term:"mount",tf:4},{term:"method",tf:4},{term:"call",tf:3},{term:"openapi",tf:3}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Vert.x 3.6 in\xadtro\xadduces a new mod\xadule called ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-web-api-service"),". With the new Web API Ser\xadvices you can eas\xadily com\xadbine the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web/java/"}),"Vert.x Web Router")," and the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web-api-contract/java/"}),"Vert.x Ope\xadnAPI Router Fac\xadtory")," fea\xadtures with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-service-proxy/java/"}),"Vert.x Ser\xadvices on Event Bus"),"."),Object(o.a)("h2",{id:"small-recap-on-openapi-and-vertx-web-api-contract"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#small-recap-on-openapi-and-vertx-web-api-contract"})),"Small recap on OpenAPI and Vert.x Web API Contract"),Object(o.a)("p",null,"Let\u2019s start from this Ope\xadnAPI de\xadf\xadi\xadn\xadi\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-yaml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"openapi:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"3.0"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),".0"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"paths:"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"/api/transactions:"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"get:"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"operationId:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"getTransactionsList"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"description:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"Get")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"list")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"filtered")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"by")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"sender"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"x-vertx-event-bus:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions_manager.myapp"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"parameters:"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"name:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"from"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"in:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"query"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"description:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"Matches")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"exactly")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"the")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"email")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"from"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"style:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"form"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"explode:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"type:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"array"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"items:"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"type:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"string"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"post:"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"operationId:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"addTransaction"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"x-vertx-event-bus:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions_manager.myapp"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"requestBody:"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"required:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"content:"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"application/json:"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"$ref:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"#/components/schemas/Transaction"'),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"/api/transactions/{transactionId}:"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"parameters:"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"name:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactionId"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"in:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"path"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"required:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"type:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"string"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"put:"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"operationId:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"updateTransaction"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"x-vertx-event-bus:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions_manager.myapp"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"requestBody:"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"required:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"content:"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"application/json:"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schema:"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"$ref:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"#/components/schemas/Transaction"'),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"delete:"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"operationId:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"removeTransaction"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"x-vertx-event-bus:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"transactions_manager.myapp"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"responses:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"components:"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"schemas:"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"Transaction:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"Error:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"..."),"\n")),Object(o.a)("p",null,"We de\xadfined ",Object(o.a)("inlineCode",{parentName:"p"},"getTransactionsList"),", ",Object(o.a)("inlineCode",{parentName:"p"},"addTransaction"),", ",Object(o.a)("inlineCode",{parentName:"p"},"updateTransaction")," and ",Object(o.a)("inlineCode",{parentName:"p"},"removeTransaction")," op\xader\xada\xadtions. Now with ",Object(o.a)("inlineCode",{parentName:"p"},"OpenAPI3RouterFactory")," we cre\xadate a ",Object(o.a)("inlineCode",{parentName:"p"},"Router")," that ac\xadcepts this var\xadi\xadous op\xader\xada\xadtion re\xadquests:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"OpenAPI3RouterFactory.create(vertx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"src/main/resources/petstore.yaml"'),", ar -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.succeeded()) {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Spec loaded with success"),"\n    OpenAPI3RouterFactory routerFactory = ar.result();\n    routerFactory.addHandlerByOperationId(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"getTransactionsList"'),", routingContext -> {\n      RequestParameters params = routingContext.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"parsedParameters"'),");\n      RequestParameter from = params.queryParameter(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"from"'),");\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// getTransactionsList business logic"),"\n    });\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// add handlers for addTransaction, updateTransaction and removeTransaction"),"\n    Router router = routerFactory.getRouter();\n  } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Something went wrong during router factory initialization"),"\n    Throwable exception = ar.cause();\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Log exception, fail verticle deployment ... etc"),"\n  }\n});\n")),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"OpenAPI3RouterFactory")," pro\xadvides an easy way to cre\xadate a spec\xadi\xadfi\xadca\xadtion com\xadpli\xadant ",Object(o.a)("inlineCode",{parentName:"p"},"Router"),", but it doesn\u2019t pro\xadvide a mech\xada\xadnism to de\xadcou\xadple the busi\xadness logic from your op\xader\xada\xadtion han\xaddlers."),Object(o.a)("p",null,"In a typ\xadi\xadcal Vert.x ap\xadpli\xadca\xadtion, when you re\xadceive a re\xadquest to your router, you would for\xadward it to an event bus end\xadpoint that per\xadforms some ac\xadtions and sends the re\xadsult back to the op\xader\xada\xadtion han\xaddler."),Object(o.a)("p",null,"Vert.x Web API Ser\xadvice sim\xadpli\xadfies that in\xadte\xadgra\xadtion be\xadtween ",Object(o.a)("inlineCode",{parentName:"p"},"RouterFactory")," and ",Object(o.a)("inlineCode",{parentName:"p"},"EventBus")," with a new code gen\xader\xada\xadtor. The final re\xadsult is a ",Object(o.a)("em",{parentName:"p"},"loose cou\xadpling")," be\xadtween the Web Router logic and your busi\xadness logic."),Object(o.a)("h2",{id:"lets-get-started-with-vertx-web-api-services"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#lets-get-started-with-vertx-web-api-services"})),"Let\u2019s get started with Vert.x Web Api Services!"),Object(o.a)("p",null,"To use ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-web-api-service")," you need to add a cou\xadple of de\xadpen\xadden\xadcies to your project. In a Maven POM file that would be:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-codegen",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.6.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"classifier"),">"),"processor",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"classifier"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-web-api-service",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.6.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"We will pro\xadceed in this order:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"Model the ser\xadvice in\xadter\xadface"),Object(o.a)("li",{parentName:"ol"},"Rewrite it to work with Web Api Ser\xadvices"),Object(o.a)("li",{parentName:"ol"},"Im\xadple\xadment the ser\xadvice"),Object(o.a)("li",{parentName:"ol"},"Mount the ser\xadvice on the event bus"),Object(o.a)("li",{parentName:"ol"},"Use the router fac\xadtory to build a router with han\xaddlers that con\xadnects to our event bus ser\xadvices")),Object(o.a)("h2",{id:"model-your-service"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#model-your-service"})),"Model your service"),Object(o.a)("p",null,"Let\u2019s say that we want to model a ser\xadvice that man\xadages all op\xader\xada\xadtions re\xadgard\xading CRUD trans\xadac\xadtions. An ex\xadam\xadple in\xadter\xadface for this asyn\xadchro\xadnous ser\xadvice could be:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerService")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getTransactionsList"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(List<String> from, Handler<AsyncResult<List<Transaction>>> resultHandler)")),";\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"addTransaction"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Transaction transaction, Handler<AsyncResult<Transaction>> resultHandler)")),";\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"updateTransaction"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String transactionId, Transaction transaction, Handler<AsyncResult<Transaction>> resultHandler)")),";\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"removeTransaction"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String transactionId, Handler<AsyncResult<Integer>> resultHandler)")),";\n}\n")),Object(o.a)("p",null,"For each op\xader\xada\xadtion, we have some pa\xadra\xadme\xadters, de\xadpend\xading on the op\xader\xada\xadtion, and a call\xadback (",Object(o.a)("inlineCode",{parentName:"p"},"resultHandler"),") that should be called when the op\xader\xada\xadtion suc\xadceeds or fails."),Object(o.a)("p",null,"With ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-service-proxy/java/"}),"Vert.x Ser\xadvice Proxy"),", you can de\xadfine an event bus ser\xadvice with a Java in\xadter\xadface sim\xadi\xadlar to the one we just saw and then an\xadno\xadtate it with ",Object(o.a)("inlineCode",{parentName:"p"},"@ProxyGen"),". This an\xadno\xadta\xadtion will gen\xader\xadate a ",Object(o.a)("em",{parentName:"p"},"ser\xadvice han\xaddler")," for the de\xadfined ser\xadvice that can be plugged to the event bus with ",Object(o.a)("inlineCode",{parentName:"p"},"ServiceBinder"),". ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-web-api-service")," works in a very sim\xadi\xadlar way: you need to an\xadno\xadtate the Java in\xadter\xadface with ",Object(o.a)("inlineCode",{parentName:"p"},"@WebApiServiceGen")," and it will gen\xader\xadate the ser\xadvice han\xaddler for the event bus."),Object(o.a)("p",null,"Let\u2019s rewrite the ",Object(o.a)("inlineCode",{parentName:"p"},"TransactionsManagerService")," to work with Web API Ser\xadvice:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.web.api.*;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.web.api.generator.WebApiServiceGen;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@WebApiServiceGen"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerService")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getTransactionsList"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(List<String> from, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),";\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"addTransaction"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Transaction body, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),";\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"updateTransaction"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String transactionId, Transaction body, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),";\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"removeTransaction"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String transactionId, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),";\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Factory method to instantiate the implementation"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," TransactionsManagerService ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"create"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Vertx vertx)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," TransactionsManagerServiceImpl(vertx);\n  }\n}\n\n")),Object(o.a)("p",null,"First of all, look at the an\xadno\xadta\xadtion ",Object(o.a)("inlineCode",{parentName:"p"},"@WebApiServiceGen"),". This an\xadno\xadta\xadtion will trig\xadger the code gen\xader\xada\xadtor that gen\xader\xadates the event bus han\xaddler for this ser\xadvice. Each method has the same two last pa\xadra\xadme\xadters:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"OperationRequest context"),": this data ob\xadject con\xadtains the head\xaders and the pa\xadra\xadme\xadters of the HTTP re\xadquest"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"Handler<AsyncResult<OperationResponse>> resultHandler"),": this call\xadback ac\xadcepts an ",Object(o.a)("inlineCode",{parentName:"li"},"OperationResponse")," data ob\xadject that will en\xadcap\xadsu\xadlate the body of the re\xadsult, the sta\xadtus code, the sta\xadtus mes\xadsage and the head\xaders")),Object(o.a)("p",null,"The gen\xader\xadated han\xaddler re\xadceives only the ",Object(o.a)("inlineCode",{parentName:"p"},"OperationRequest")," data ob\xadject and ex\xadtracts from it all op\xader\xada\xadtion pa\xadra\xadme\xadters. For ex\xadam\xadple, when the router re\xadceives a re\xadquest at ",Object(o.a)("inlineCode",{parentName:"p"},"getTransactionsList"),", it sends to ",Object(o.a)("inlineCode",{parentName:"p"},"TransactionsManagerService")," the ",Object(o.a)("inlineCode",{parentName:"p"},"OperationRequest")," con\xadtain\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"RequestParameters")," map. From this map, the ser\xadvice gen\xader\xadated han\xaddler ex\xadtracts the ",Object(o.a)("inlineCode",{parentName:"p"},"from")," pa\xadra\xadme\xadter. "),Object(o.a)("p",null,"There\xadfore ",Object(o.a)("strong",{parentName:"p"},"op\xader\xada\xadtion pa\xadra\xadme\xadters names should match method pa\xadra\xadme\xadter names"),"."),Object(o.a)("p",null,"When you want to ex\xadtract the body you must use ",Object(o.a)("inlineCode",{parentName:"p"},"body")," key\xadword. For more de\xadtails, please refer to the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-web-api-service/java/"}),"doc\xadu\xadmen\xadta\xadtion"),"."),Object(o.a)("h2",{id:"implement-the-service"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implement-the-service"})),"Implement the service"),Object(o.a)("p",null,"Now that you have your in\xadter\xadface, you can im\xadple\xadment the ser\xadvice:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerServiceImpl")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"implements")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerService")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," Vertx vertx;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"TransactionsManagerServiceImpl"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Vertx vertx)")," "),"{  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".vertx = vertx;  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getTransactionsList"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(List<String> from, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)")),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Write your business logic here"),"\n    resultHandler.handle(Future.succeededFuture(OperationResult.completedWithJson(resultJson)));\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Implement other operations"),"\n\n}\n")),Object(o.a)("p",null,"Check the ",Object(o.a)("inlineCode",{parentName:"p"},"OperationResult")," doc\xadu\xadmen\xadta\xadtion to look at var\xadi\xadous handy meth\xadods to cre\xadate a com\xadplete re\xadsponse."),Object(o.a)("h2",{id:"mount-the-service"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#mount-the-service"})),"Mount the Service"),Object(o.a)("p",null,"Now that you have your ser\xadvice in\xadter\xadface and im\xadple\xadmen\xadta\xadtion, you can mount your ser\xadvice with ",Object(o.a)("inlineCode",{parentName:"p"},"ServiceBinder"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"ServiceBinder serviceBinder = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ServiceBinder(vertx);\n\nTransactionsManagerService transactionsManagerService = TransactionsManagerService.create(vertx);\nregisteredConsumers.add(\n  serviceBinder\n    .setAddress(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"transactions_manager.myapp"'),")\n    .register(TransactionsManagerService.class, transactionsManagerService)\n);\n")),Object(o.a)("h2",{id:"and-the-router-factory"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#and-the-router-factory"})),"And the Router Factory?"),Object(o.a)("p",null,"The ser\xadvice is up and run\xadning, but we need to con\xadnect it to the ",Object(o.a)("inlineCode",{parentName:"p"},"Router")," built by ",Object(o.a)("inlineCode",{parentName:"p"},"OpenAPI3RouterFactory"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"OpenAPI3RouterFactory.create(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".vertx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my_spec.yaml"'),", openAPI3RouterFactoryAsyncResult -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (openAPI3RouterFactoryAsyncResult.succeeded()) {\n    OpenAPI3RouterFactory routerFactory = openAPI3RouterFactoryAsyncResult.result();\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Mount services on event bus based on extensions"),"\n    routerFactory.mountServicesFromExtensions(); ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// <- Pure magic happens!"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Generate the router"),"\n    Router router = routerFactory.getRouter();\n    server = vertx.createHttpServer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," HttpServerOptions().setPort(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),"));\n    server.requestHandler(router).listen();\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Initialization completed"),"\n  } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Something went wrong during router factory initialization"),"\n  }\n});\n")),Object(o.a)("p",null,"In our spec ex\xadam\xadple we added an ex\xadten\xadsion ",Object(o.a)("inlineCode",{parentName:"p"},"x-vertx-event-bus")," to each op\xader\xada\xadtion that spec\xadi\xadfies the ad\xaddress of the ser\xadvice. Using this ex\xadten\xadsion, you only need to call ",Object(o.a)("inlineCode",{parentName:"p"},"OpenAPI3RouterFactory.mountServicesFromExtensions()")," to trig\xadger a scan of all op\xader\xada\xadtions and mount all found ser\xadvice ad\xaddresses. For each op\xader\xada\xadtion that con\xadtains ",Object(o.a)("inlineCode",{parentName:"p"},"x-vertx-event-bus"),", the Router Fac\xadtory in\xadstan\xadti\xadates an han\xaddler that routes the in\xadcom\xading re\xadquests to the ad\xaddress you spec\xadi\xadfied."),Object(o.a)("p",null,"This is one of the meth\xadods you can use to match ser\xadvices with router op\xader\xada\xadtion han\xaddlers. Check the doc\xadu\xadmen\xadta\xadtion for all de\xadtails."),Object(o.a)("h2",{id:"more-examples"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#more-examples"})),"More examples"),Object(o.a)("p",null,"Check out the com\xadplete ex\xadam\xadple in ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/tree/master/web-api-service-example"}),"vertx-\u200bexamples repo"),"."),Object(o.a)("p",null,"Thanks you for your time, stay tuned for more up\xaddates! And please pro\xadvide feed\xadback about this new pack\xadage!"))}m.isMDXComponent=!0},a1bP:function(e,a,t){"use strict";var n=t("q1tI"),s=t.n(n),c=t("TSYQ"),r=t.n(c),o=(t("l3qQ"),s.a.createElement);a.a=function(e){var a=e.children,t=e.error,n=e.warning,s=e.info,c=e.title;return o("div",{className:r()("alert",{error:t,warning:n,info:s})},c&&o("div",{className:"alert-title"},c),a)}},a69w:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Automatic redeployment in Eclipse IDE",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"Vert.x 3.1 has (re-)introduced the redeploy feature. This blog post explains how to use this feature in the Eclipse IDE. However, you can easily adapt the content to your IDE."}),i=[{term:"applic",tf:13},{term:"redeploi",tf:10},{term:"class",tf:8},{term:"configur",tf:8},{term:"chang",tf:6},{term:"featur",tf:5},{term:"file",tf:5},{term:"us",tf:4},{term:"launch",tf:4},{term:"id",tf:3},{term:"not",tf:3},{term:"build",tf:3},{term:"tool",tf:3},{term:"process",tf:3},{term:"listen",tf:3},{term:"stop",tf:3},{term:"restart",tf:3},{term:"set",tf:3},{term:"let",tf:3},{term:"explain",tf:2},{term:"howev",tf:2},{term:"integr",tf:2},{term:"plug",tf:2},{term:"actual",tf:2},{term:"mode",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Vert.x 3.1 has (re-)in\xadtro\xadduced the ",Object(o.a)("em",{parentName:"p"},"re\xadde\xadploy")," fea\xadture. This blog post ex\xadplains how to use this fea\xadture in the Eclipse IDE. How\xadever, you can eas\xadily adapt the con\xadtent to your IDE."),Object(o.a)("h2",{id:"how-does-redeploy-work"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#how-does-redeploy-work"})),"How does redeploy work"),Object(o.a)("p",null,"How is im\xadple\xadmented the ",Object(o.a)("inlineCode",{parentName:"p"},"redeploy")," is not as you may ex\xadpect. First, the re\xadde\xadploy does not rely on a build tool, but is in\xadte\xadgrated in vert.x. How\xadever you can plug your build tools with the re\xadde\xadploy fea\xadture. This fea\xadture is of\xadfered by the ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.core.Launcher")," class. The re\xadde\xadploy\xadment process is ac\xadtu\xadally very sim\xadple:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"the ap\xadpli\xadca\xadtion is launched in ",Object(o.a)("em",{parentName:"li"},"re\xadde\xadploy mode"),"."),Object(o.a)("li",{parentName:"ol"},"it lis\xadtens for file changes"),Object(o.a)("li",{parentName:"ol"},"when a ",Object(o.a)("em",{parentName:"li"},"match\xading")," file is changed, it stops the ap\xadpli\xadca\xadtion"),Object(o.a)("li",{parentName:"ol"},"it ex\xade\xadcutes the ",Object(o.a)("inlineCode",{parentName:"li"},"on-redeploy")," ac\xadtions if any"),Object(o.a)("li",{parentName:"ol"},"it restarts the ap\xadpli\xadca\xadtion"),Object(o.a)("li",{parentName:"ol"},"back to (2)")),Object(o.a)("p",null,"Ini\xadtially the ap\xadpli\xadca\xadtion is launched in ",Object(o.a)("em",{parentName:"p"},"re\xadde\xadploy mode"),". The ap\xadpli\xadca\xadtion is ac\xadtu\xadally launched in back\xadground, in a sep\xada\xadrated process. Vert.x lis\xadtens for file changes. You give it a set of (Ant-\u200bstyle) pat\xadterns and every time a match\xading file changes, Vert.x stops the whole ap\xadpli\xadca\xadtion and restarts it. Op\xadtion\xadally you can con\xadfig\xadure a ",Object(o.a)("inlineCode",{parentName:"p"},"on-redeploy")," ac\xadtion to plug in your build tools."),Object(o.a)("p",null,"To in\xadte\xadgrate this process in Eclipse (or in your IDE), you just need to con\xadfig\xadure the set of lis\xadtened files, and let the ",Object(o.a)("inlineCode",{parentName:"p"},"Launcher")," class starts and stops your ap\xadpli\xadca\xadtion."),Object(o.a)("h2",{id:"redeploy-in-eclipse"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#redeploy-in-eclipse"})),"Redeploy in Eclipse"),Object(o.a)("p",null,"The fol\xadlow\xading screen\xadcast ex\xadplains how you con\xadfig\xadure a vert.x ap\xadpli\xadca\xadtion to be run in Eclipse and how to con\xadfig\xadure the re\xadde\xadploy:"),Object(o.a)("div",{className:"youtube-embed"},Object(o.a)("iframe",{src:"https://www.youtube.com/embed/iyZwAzEVX-o",frameBorder:"0",allowFullScreen:!0})),Object(o.a)("p",null,"To sum\xadma\xadrize the last con\xadfig\xadu\xadra\xadtion:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"it\u2019s a Java ap\xadpli\xadca\xadtion con\xadfig\xadu\xadra\xadtion"),Object(o.a)("li",{parentName:"ul"},"it uses ",Object(o.a)("inlineCode",{parentName:"li"},"io.vertx.core.Launcher")," as main class"),Object(o.a)("li",{parentName:"ul"},"In the ",Object(o.a)("em",{parentName:"li"},"Pro\xadgram ar\xadgu\xadments")," (",Object(o.a)("em",{parentName:"li"},"Ar\xadgu\xadments")," tab), write: ",Object(o.a)("inlineCode",{parentName:"li"},'run org.acme.verticle.MyMainVerticle --redeploy="src/**/*.java" --launcher-class=io.vertx.core.Launcher'))),Object(o.a)("h2",{id:"redeploy-with-your-own-main-class"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#redeploy-with-your-own-main-class"})),"Redeploy with your own Main class"),Object(o.a)("p",null,"Let\u2019s now imag\xadine that you have your own ",Object(o.a)("inlineCode",{parentName:"p"},"Main")," class, start\xading your ap\xadpli\xadca\xadtion. For in\xadstance, it can be some\xadthing like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," org.acme.vertx;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.Vertx;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"Main")," "),"{\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"main"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String[] args)")," "),"{\n        Vertx vertx = Vertx.vertx();\n        vertx.deployVerticle(MyMainVerticle.class.getName());\n    }\n\n}\n")),Object(o.a)("p",null,"The re\xadde\xadploy fea\xadture from vert.x lets you use your own ",Object(o.a)("inlineCode",{parentName:"p"},"Main")," class:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"Cre\xadate an\xadother ",Object(o.a)("inlineCode",{parentName:"li"},"Run")," con\xadfig\xadu\xadra\xadtion"),Object(o.a)("li",{parentName:"ol"},"Set the ",Object(o.a)("inlineCode",{parentName:"li"},"Main-Class")," to ",Object(o.a)("inlineCode",{parentName:"li"},"io.vertx.core.Launcher")," (yes, the one from vert.x not yours)"),Object(o.a)("li",{parentName:"ol"},"In the ap\xadpli\xadca\xadtion pa\xadra\xadme\xadter add: ",Object(o.a)("inlineCode",{parentName:"li"},'run --redeploy="src/**/*.java" --launcher-class=org.acme.vertx.Main'))),Object(o.a)("p",null,"With this con\xadfig\xadu\xadra\xadtion, the ap\xadpli\xadca\xadtion is launched in back\xadground using your own ",Object(o.a)("inlineCode",{parentName:"p"},"Main")," class, and will restart the ap\xadpli\xadca\xadtion every time you change your source code (you can even change the source code of your ",Object(o.a)("inlineCode",{parentName:"p"},"Main")," class)."))}m.isMDXComponent=!0},bahg:function(e,a){e.exports=function(e){return e.split("")}},"cLI+":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return m})),t.d(a,"__tfidf__terms",(function(){return j})),t.d(a,"default",(function(){return h}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("a1bP"),i=t("YFqc"),p=t.n(i),m=(r.a.createElement,{title:"Unit and Integration Tests",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"Let\u2019s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn\u2019t test the API."}),j=[{term:"test",tf:66},{term:"applic",tf:31},{term:"integr",tf:25},{term:"us",tf:23},{term:"let",tf:17},{term:"post",tf:17},{term:"need",tf:17},{term:"configur",tf:16},{term:"unit",tf:15},{term:"port",tf:14},{term:"start",tf:14},{term:"implement",tf:13},{term:"execut",tf:12},{term:"add",tf:12},{term:"window",tf:12},{term:"file",tf:12},{term:"not",tf:11},{term:"step",tf:11},{term:"rest",tf:10},{term:"check",tf:10},{term:"first",tf:8},{term:"code",tf:8},{term:"creat",tf:8},{term:"right",tf:8},{term:"onc",tf:8}],b={meta:m,__tfidf__terms:j};function h(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},b,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Let\u2019s re\xadfresh our mind about what we de\xadvel\xadoped so far in the ",Object(o.a)("em",{parentName:"p"},"in\xadtro\xadduc\xadtion to vert.x")," se\xadries. In ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/my-first-vert-x-3-application/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"the first post")),", we de\xadvel\xadoped a very sim\xadple Vert.x 3 ap\xadpli\xadca\xadtion, and saw how this ap\xadpli\xadca\xadtion can be tested, pack\xadaged and ex\xade\xadcuted. In ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/vert-x-application-configuration/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"the sec\xadond post")),", we saw how this ap\xadpli\xadca\xadtion be\xadcame con\xadfig\xadurable and how we can use a ran\xaddom port in test, and use an\xadother con\xadfig\xadurable port in pro\xadduc\xadtion. Fi\xadnally, the ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/some-rest-with-vert-x/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"pre\xadvi\xadous post"))," has shown how to use vertx-\u200bweb and how to im\xadple\xadment a small REST API. How\xadever, we for\xadgot an im\xadpor\xadtant task. We didn\u2019t test the API. In this post we will in\xadcrease the con\xadfi\xaddence we have on this ap\xadpli\xadca\xadtion by im\xadple\xadment\xading unit and in\xadte\xadgra\xadtion tests."),Object(o.a)("p",null,"The code of this post is avail\xadable in the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-4"}),"post-4 branch")," of the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app"}),"project"),". The start\xading post, how\xadever is the code avail\xadable in the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-3"}),"post-3 branch"),"."),Object(o.a)("h2",{id:"tests-tests-tests"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#tests-tests-tests"})),"Tests, Tests, Tests\u2026"),Object(o.a)("p",null,"This post is mainly about tests. We dis\xadtin\xadguish two types of tests: unit tests and in\xadte\xadgra\xadtion tests. Both are equally im\xadpor\xadtant, but have dif\xadfer\xadent focus. Unit tests en\xadsure that one ",Object(o.a)("em",{parentName:"p"},"com\xadpo\xadnent")," of your ap\xadpli\xadca\xadtion, gen\xader\xadally a class in the Java world, be\xadhaves as ex\xadpected. The ap\xadpli\xadca\xadtion is not tested as a whole, but pieces by pieces. In\xadte\xadgra\xadtion tests are more ",Object(o.a)("em",{parentName:"p"},"black box")," in the sense that the ap\xadpli\xadca\xadtion is started and tested gen\xader\xadally ex\xadter\xadnally."),Object(o.a)("p",null,"In this post we are going to start with some more unit tests as a warm up ses\xadsion and then focus on in\xadte\xadgra\xadtion tests. If you al\xadready im\xadple\xadmented in\xadte\xadgra\xadtion tests, you may be a bit scared, and it makes sense. But don\u2019t worry, with Vert.x there are no hid\xadden sur\xadprises."),Object(o.a)("h2",{id:"warmup-some-more-unit-tests"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#warmup-some-more-unit-tests"})),"Warmup: Some more unit tests"),Object(o.a)("p",null,"Let\u2019s start slowly. Re\xadmem\xadber in the first post we have im\xadple\xadmented a unit test with ",Object(o.a)(p.a,{href:"/docs/[[...slug]]",as:"/docs/vertx-unit/java/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"vertx-\u200bunit")),". The test we did is dead sim\xadple:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"we started the ap\xadpli\xadca\xadtion be\xadfore the test"),Object(o.a)("li",{parentName:"ol"},"we checks that it replies \u201cHello\u201d")),Object(o.a)("p",null,"Just to re\xadfresh your mind, let\u2019s have a look at the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/blob/post-4/src/test/java/io/vertx/blog/first/MyFirstVerticleTest.java"}),"code")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Before"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"setUp"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"throws")," IOException "),"{\n  vertx = Vertx.vertx();\n  ServerSocket socket = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ServerSocket(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),");\n  port = socket.getLocalPort();\n  socket.close();\n  DeploymentOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," DeploymentOptions()\n      .setConfig(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", port)\n      );\n  vertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());\n}\n")),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"setUp")," method is in\xadvoked be\xadfore each test (as in\xadstructed by the ",Object(o.a)("inlineCode",{parentName:"p"},"@Before")," an\xadno\xadta\xadtion). It, first, cre\xadates a new in\xadstance of Vert.x. Then, it gets a free port and then de\xadploys our ver\xadti\xadcle with the right con\xadfig\xadu\xadra\xadtion. Thanks to the ",Object(o.a)("inlineCode",{parentName:"p"},"context.asyncAssertSuccess()")," it waits until the suc\xadcess\xadful de\xadploy\xadment of the ver\xadti\xadcle."),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"tearDown")," is straight\xadfor\xadward and just closes the Vert.x in\xadstance. It au\xadto\xadmat\xadi\xadcally un-\u200bdeploys the ver\xadti\xadcles:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@After"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"tearDown"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n  vertx.close(context.asyncAssertSuccess());\n}\n")),Object(o.a)("p",null,"Fi\xadnally, our sin\xadgle test is:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"testMyApplication"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," Async async = context.async();\n  vertx.createHttpClient().getNow(port, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),", response -> {\n    response.handler(body -> {\n      context.assertTrue(body.toString().contains(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello"'),"));\n      async.complete();\n    });\n  });\n }\n")),Object(o.a)("p",null,"It is only check\xading that the ap\xadpli\xadca\xadtion replies \u201cHello\u201d when we emit a HTTP re\xadquest on ",Object(o.a)("inlineCode",{parentName:"p"},"/"),"."),Object(o.a)("p",null,"Let\u2019s now try to im\xadple\xadment some unit tests checkin that our web ap\xadpli\xadca\xadtion and the REST API be\xadhave as ex\xadpected. Let\u2019s start by check\xading that the ",Object(o.a)("inlineCode",{parentName:"p"},"index.html")," page is cor\xadrectly served. This test is very sim\xadi\xadlar to the pre\xadvi\xadous one:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"checkThatTheIndexPageIsServed"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n  Async async = context.async();\n  vertx.createHttpClient().getNow(port, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/assets/index.html"'),", response -> {\n    context.assertEquals(response.statusCode(), ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),");\n    context.assertEquals(response.headers().get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),"), ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/html"'),");\n    response.bodyHandler(body -> {\n      context.assertTrue(body.toString().contains(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<title>My Whisky Collection</title>"'),"));\n      async.complete();\n    });\n  });\n}\n")),Object(o.a)("p",null,"We re\xadtrieve the ",Object(o.a)("inlineCode",{parentName:"p"},"index.html")," page and check:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"it\u2019s there (sta\xadtus code 200)"),Object(o.a)("li",{parentName:"ol"},"it\u2019s a HTML page (con\xadtent type set to \u201ctext/html\u201d)"),Object(o.a)("li",{parentName:"ol"},"it has the right title (\u201cMy Whisky Col\xadlec\xadtion\u201d)")),Object(o.a)(l.a,{info:!0,mdxType:"Alert"},Object(o.a)("p",null,"As you can see, we can test the sta\xadtus code and the head\xaders di\xadrectly on the HTTP re\xadsponse, but en\xadsure that the body is right, we need to re\xadtrieve it. This is done with a body han\xaddler that re\xadceives the com\xadplete body as pa\xadra\xadme\xadter. Once the last check is made, we re\xadlease the ",Object(o.a)("inlineCode",{parentName:"p"},"async")," by call\xading ",Object(o.a)("inlineCode",{parentName:"p"},"complete"),".")),Object(o.a)("p",null,"Ok, great, but this ac\xadtu\xadally does not test our REST API. Let\u2019s en\xadsure that we can add a bot\xadtle to the col\xadlec\xadtion. Un\xadlike the pre\xadvi\xadous tests, this one is using ",Object(o.a)("inlineCode",{parentName:"p"},"post")," to ",Object(o.a)("em",{parentName:"p"},"post")," data to the server:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"checkThatWeCanAdd"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n  Async async = context.async();\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," String json = Json.encodePrettily(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Jameson"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Ireland"'),"));\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," String length = Integer.toString(json.length());\n  vertx.createHttpClient().post(port, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies"'),")\n      .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")\n      .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-length"'),", length)\n      .handler(response -> {\n        context.assertEquals(response.statusCode(), ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"201"),");\n        context.assertTrue(response.headers().get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),").contains(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),"));\n        response.bodyHandler(body -> {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final"),' Whisky whisky = Json.decodeValue(body.toString(), Whisky.class);\n          context.assertEquals(whisky.getName(), "Jameson");\n          context.assertEquals(whisky.getOrigin(), "Ireland");\n          context.assertNotNull(whisky.getId());\n          async.complete();\n        });\n      })\n      .write(json)\n      .end();\n}\n')),Object(o.a)("p",null,"First we cre\xadate the con\xadtent we want to add. The server con\xadsumes JSON data, so we need a JSON string. You can ei\xadther write your JSON doc\xadu\xadment man\xadu\xadally, or use the Vert.x method (",Object(o.a)("inlineCode",{parentName:"p"},"Json.encodePrettily"),") as done here. Once we have the con\xadtent, we cre\xadate a ",Object(o.a)("inlineCode",{parentName:"p"},"post")," re\xadquest. We need to con\xadfig\xadure some head\xaders to be cor\xadrectly read by the server. First, we say that we are send\xading JSON data and we also set the con\xadtent length. We also at\xadtach a re\xadsponse han\xaddler very close to the checks made in the pre\xadvi\xadous test. No\xadtice that we can re\xadbuild our ob\xadject from the JSON doc\xadu\xadment send by the server using the ",Object(o.a)("inlineCode",{parentName:"p"},"JSON.decodeValue")," method. It\u2019s very con\xadve\xadnient as it avoids lots of boil\xader\xadplate code.  At this point the re\xadquest is not emit\xadted, we need to write the data and call the ",Object(o.a)("inlineCode",{parentName:"p"},"end()")," method. This is made using ",Object(o.a)("inlineCode",{parentName:"p"},".write(json).end();"),"."),Object(o.a)("p",null,"The order of the meth\xadods is im\xadpor\xadtant. You can\xadnot ",Object(o.a)("em",{parentName:"p"},"write")," data if you don\u2019t have a re\xadsponse han\xaddler con\xadfig\xadured. Fi\xadnally don\u2019t for\xadget to call ",Object(o.a)("inlineCode",{parentName:"p"},"end"),"."),Object(o.a)("p",null,"So, let\u2019s try this. You can run the test using:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"test"),"\n")),Object(o.a)("p",null,"We could con\xadtinue writ\xading more unit test like that, but it could be\xadcome quite com\xadplex. Let\u2019s see how we could con\xadtinue our tests using in\xadte\xadgra\xadtion tests."),Object(o.a)("h2",{id:"it-hurts"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#it-hurts"})),"IT hurts"),Object(o.a)("p",null,"Well, I think we need to make that clear, in\xadte\xadgra\xadtion test\xading hurts. If you have ex\xadpe\xadri\xadence in this area, can you re\xadmem\xadber how long did it take to setup every\xadthing cor\xadrectly? I get new white hairs by just think\xading about it. Why are in\xadte\xadgra\xadtion tests more com\xadpli\xadcated? It\u2019s ba\xadsi\xadcally be\xadcause of the setup:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"We must start the ap\xadpli\xadca\xadtion in a ",Object(o.a)("em",{parentName:"li"},"close to pro\xadduc\xadtion")," way"),Object(o.a)("li",{parentName:"ol"},"We must then run the tests (and con\xadfig\xadure them to hit the right ap\xadpli\xadca\xadtion in\xadstance)"),Object(o.a)("li",{parentName:"ol"},"We must stop the ap\xadpli\xadca\xadtion")),Object(o.a)("p",null,"That does not sound un\xadcon\xadquer\xadable like that, but if you need Linux, MacOS X and Win\xaddows sup\xadport, it quickly get messy. There are plenty of great frame\xadworks eas\xading this such as ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://arquillian.org"}),"Ar\xadquil\xadlian"),", but let\u2019s do it with\xadout any frame\xadwork to un\xadder\xadstand how it works."),Object(o.a)("h2",{id:"we-need-a-battle-plan"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#we-need-a-battle-plan"})),"We need a battle plan"),Object(o.a)("p",null,"Be\xadfore rush\xading into the com\xadplex con\xadfig\xadu\xadra\xadtion, let\u2019s think a minute about the tasks:"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Step 1 - Re\xadserve a free port"),"\nWe need to get a free port on which the ap\xadpli\xadca\xadtion can ",Object(o.a)("em",{parentName:"p"},"lis\xadten"),", and we need to in\xadject this port in our in\xadte\xadgra\xadtion tests."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Step 2 - Gen\xader\xadate the ap\xadpli\xadca\xadtion con\xadfig\xadu\xadra\xadtion"),"\nOnce we have the free port, we need to write a JSON file con\xadfig\xadur\xading the ap\xadpli\xadca\xadtion HTTP Port to this port."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Step 3 - Start the ap\xadpli\xadca\xadtion"),"\nSounds easy right? Well it\u2019s not that sim\xadple as we need to launch our ap\xadpli\xadca\xadtion in a back\xadground process."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Step 4 - Ex\xade\xadcute the in\xadte\xadgra\xadtion tests"),"\nFi\xadnally, the cen\xadtral part, run the tests. But be\xadfore that we should im\xadple\xadment some in\xadte\xadgra\xadtion tests. Let\u2019s come to that later."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Step 5 - Stop the ap\xadpli\xadca\xadtion"),"\nOnce the tests have been ex\xade\xadcuted, re\xadgard\xadless if there are fail\xadures or er\xadrors in the tests, we need to stop the ap\xadpli\xadca\xadtion."),Object(o.a)("p",null,"There are mul\xadti\xadple way to im\xadple\xadment this plan. We are going to use a ",Object(o.a)("em",{parentName:"p"},"generic")," way. It\u2019s not nec\xades\xadsar\xadily the bet\xadter, but can be ap\xadplied al\xadmost every\xadwhere. The ap\xadproach is tight to Apache Maven. If you want to pro\xadpose an al\xadter\xadna\xadtive using Gra\xaddle or a dif\xadfer\xadent tool, I will be happy to add your way to the post."),Object(o.a)("h2",{id:"implement-the-plan"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implement-the-plan"})),"Implement the plan"),Object(o.a)("p",null,"As said above, this sec\xadtion is Maven-\u200bcentric, and most of the code goes in the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/blob/post-4/pom.xml"}),"pom.xml")," file. If you never used the dif\xadfer\xadent Maven life\xadcy\xadcle phases, I rec\xadom\xadmend you to look at the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html"}),"in\xadtro\xadduc\xadtion to the Maven life\xadcy\xadcle"),"."),Object(o.a)("p",null,"We need to add and con\xadfig\xadure a cou\xadple of plu\xadg\xadins. Open the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file and in the ",Object(o.a)("inlineCode",{parentName:"p"},"<plugins>")," sec\xadtion add:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"org.codehaus.mojo",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"build-helper-maven-plugin",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.9.1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"reserve-network-port",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"reserve-network-port",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"process-sources",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"portNames"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"portName"),">"),"http.port",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"portName"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"portNames"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n")),Object(o.a)("p",null,"We use the ",Object(o.a)("inlineCode",{parentName:"p"},"build-helper-maven-plugin")," (a plug\xadin to know if you are often using Maven) to pick up a free port. Once found, the plug\xadin as\xadsigns the ",Object(o.a)("inlineCode",{parentName:"p"},"http.port")," vari\xadable to the picked port. We ex\xade\xadcute this plug\xadin early in the build (dur\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"process-sources")," phase), so we can use the ",Object(o.a)("inlineCode",{parentName:"p"},"http.port")," vari\xadable in the other plug\xadin. This was for the first step."),Object(o.a)("p",null,"Two ac\xadtions are re\xadquired for the sec\xadond step. First, in the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file, just below the ",Object(o.a)("inlineCode",{parentName:"p"},"<build>")," open\xading tag, add:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"testResources"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"testResource"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"directory"),">"),"src/test/resources",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"directory"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"filtering"),">"),"true",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"filtering"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"testResource"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"testResources"),">"),"\n")),Object(o.a)("p",null,"This in\xadstructs Maven to ",Object(o.a)("em",{parentName:"p"},"fil\xadter")," re\xadsources from the ",Object(o.a)("inlineCode",{parentName:"p"},"src/test/resources")," di\xadrec\xadtory. ",Object(o.a)("em",{parentName:"p"},"Fil\xadter")," means re\xadplac\xading place\xadhold\xaders by ac\xadtual val\xadues. That\u2019s ex\xadactly what we need as we now have the ",Object(o.a)("inlineCode",{parentName:"p"},"http.port")," vari\xadable. So cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"src/test/resources/my-it-config.json")," file with the fol\xadlow\xading con\xadtent:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),": ${http.port}\n}\n")),Object(o.a)("p",null,"This con\xadfig\xadu\xadra\xadtion file is sim\xadi\xadlar to the one we did in pre\xadvi\xadous posts. The only dif\xadfer\xadence is the ",Object(o.a)("inlineCode",{parentName:"p"},"${http.port}")," which is the (de\xadfault) Maven syn\xadtax for fil\xadter\xading. So, when Maven is going to process or file it will re\xadplace ",Object(o.a)("inlineCode",{parentName:"p"},"${http.port}")," by the se\xadlected port. That\u2019s all for the sec\xadond step."),Object(o.a)("p",null,"The step 3 and 5 are a bit more tricky. We should start and stop the ap\xadpli\xadca\xadtion. We are going to use the ",Object(o.a)("inlineCode",{parentName:"p"},"maven-antrun-plugin")," to achieve this. In the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file, below the ",Object(o.a)("inlineCode",{parentName:"p"},"build-helper-maven-plugin"),", add:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"\x3c!-- We use the maven-antrun-plugin to start the application before the integration tests\nand stop them afterward --\x3e"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"maven-antrun-plugin",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.8",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"start-vertx-app",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"pre-integration-test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"run",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"target"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"\x3c!--\n          Launch the application as in 'production' using the fatjar.\n          We pass the generated configuration, configuring the http port to the picked one\n          --\x3e"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"exec")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"executable"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"${java.home}/bin/java"'),"\n                ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"dir"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"${project.build.directory}"'),"\n                ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"spawn"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"true"'),">"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"-jar"'),"/>"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"${project.artifactId}-${project.version}-fat.jar"'),"/>"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"-conf"'),"/>"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"${project.build.directory}/test-classes/my-it-config.json"'),"/>"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"exec"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"target"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"stop-vertx-app",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"post-integration-test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"run",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"\x3c!--\n          Kill the started process.\n          Finding the right process is a bit tricky. Windows command in in the windows profile (below)\n          --\x3e"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"target"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"exec")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"executable"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"bash"'),"\n                ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"dir"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"${project.build.directory}"'),"\n                ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"spawn"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"false"'),">"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"-c"'),"/>"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),"\"ps ax | grep -Ei '[\\-]DtestPort=${http.port}\\s+\\-jar\\s+${project.artifactId}' | awk 'NR==1{print $1}' | xargs kill -SIGTERM\""),"/>"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"exec"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"target"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n")),Object(o.a)("p",null,"That\u2019s a huge piece of XML, isn\u2019t it ? We con\xadfig\xadure two ex\xade\xadcu\xadtions of the plug\xadin. The first one, hap\xadpen\xading in the ",Object(o.a)("inlineCode",{parentName:"p"},"pre-integration-test")," phase, ex\xade\xadcutes a set of bash com\xadmand to start the ap\xadpli\xadca\xadtion. It ba\xadsi\xadcally ex\xade\xadcutes:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"java -jar my-first-app-1.0-SNAPSHOT-fat.jar -conf .../my-it-config.json\n")),Object(o.a)(l.a,{info:!0,title:"Is the fatjar created?",mdxType:"Alert"},Object(o.a)("p",null,"The fat jar em\xadbed\xadding our ap\xadpli\xadca\xadtion is cre\xadated in the ",Object(o.a)("inlineCode",{parentName:"p"},"package")," phase, pre\xadced\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"pre-integration-test"),", so yes, the fat jar is cre\xadated.")),Object(o.a)("p",null,"As men\xadtioned above, we launch the ap\xadpli\xadca\xadtion as we would in a pro\xadduc\xadtion en\xadvi\xadron\xadment."),Object(o.a)("p",null,"Once, the in\xadte\xadgra\xadtion tests are ex\xade\xadcuted (step 4 we didn\u2019t look at it yet), we need to stop the ap\xadpli\xadca\xadtion (so in the the ",Object(o.a)("inlineCode",{parentName:"p"},"post-integration-test")," phase).  To close the ap\xadpli\xadca\xadtion, we are going to in\xadvoke some shell magic com\xadmand to find our process in with the ",Object(o.a)("inlineCode",{parentName:"p"},"ps")," com\xadmand and send the ",Object(o.a)("inlineCode",{parentName:"p"},"SIGTERM")," sig\xadnal. It is equiv\xada\xadlent to:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"ps\n.... -> find your process id\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"kill")," your_process_id -SIGTERM\n")),Object(o.a)(l.a,{info:!0,title:"And Windows?",mdxType:"Alert"},Object(o.a)("p",null,"I men\xadtioned it above, we want Win\xaddows to be sup\xadported and these com\xadmands are not going to work on Win\xaddows. Don\u2019t worry, Win\xaddows con\xadfig\xadu\xadra\xadtion is below \u2026")),Object(o.a)("p",null,"We should now do the fourth step we (silently) skipped. To ex\xade\xadcute our in\xadte\xadgra\xadtion tests, we use the ",Object(o.a)("inlineCode",{parentName:"p"},"maven-failsafe-plugin"),". Add the fol\xadlow\xading plug\xadin con\xadfig\xadu\xadra\xadtion to your ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"org.apache.maven.plugins",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"maven-failsafe-plugin",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"2.18.1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"integration-test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"verify",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"systemProperties"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"http.port"),">"),"${http.port}",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"http.port"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"systemProperties"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n")),Object(o.a)("p",null,"As you can see, we pass the ",Object(o.a)("inlineCode",{parentName:"p"},"http.port")," prop\xaderty as a sys\xadtem vari\xadable, so our tests are able to con\xadnect on the right port."),Object(o.a)("p",null,"That\u2019s all! Wow\u2026 Let\u2019s try this (for win\xaddows users, you will need to be pa\xadtient or to jump to the last sec\xadtion)."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean verify\n")),Object(o.a)("p",null,"We should not use ",Object(o.a)("inlineCode",{parentName:"p"},"mvn integration-test")," be\xadcause the ap\xadpli\xadca\xadtion would still be run\xadning. The ",Object(o.a)("inlineCode",{parentName:"p"},"verify")," phase is after the ",Object(o.a)("inlineCode",{parentName:"p"},"post-integration-test")," phase and will analyse the integration-\u200btests re\xadsults. Build fail\xadures be\xadcause of in\xadte\xadgra\xadtion tests failed as\xadser\xadtions are re\xadported in this phase."),Object(o.a)("h2",{id:"hey-we-dont-have-integration-tests-"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#hey-we-dont-have-integration-tests-"})),"Hey, we don\u2019t have integration tests !"),Object(o.a)("p",null,"And that\u2019s right, we set up every\xadthing, but we don\u2019t have a sin\xadgle in\xadte\xadgra\xadtion test. To ease the im\xadple\xadmen\xadta\xadtion, let\u2019s use two li\xadbraries: ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://joel-costigliola.github.io/assertj/"}),"As\xadsertJ")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/jayway/rest-assured"}),"Rest-\u200bAssured"),"."),Object(o.a)("p",null,"As\xadsertJ pro\xadposes a set of as\xadser\xadtions that you can chain and use flu\xadently. Rest As\xadsured is a frame\xadwork to test REST API."),Object(o.a)("p",null,"In the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file, add the two fol\xadlow\xading de\xadpen\xadden\xadcies just be\xadfore ",Object(o.a)("inlineCode",{parentName:"p"},"</dependencies>"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"com.jayway.restassured",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"rest-assured",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"2.4.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"org.assertj",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"assertj-core",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"2.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"Then, cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"src/test/java/io/vertx/blog/first/MyRestIT.java")," file. Un\xadlike unit test, in\xadte\xadgra\xadtion test ends with ",Object(o.a)("inlineCode",{parentName:"p"},"IT"),". It\u2019s a con\xadven\xadtion from the Fail\xadsafe plug\xadin to dis\xadtin\xadguish unit (start\xading or end\xading with ",Object(o.a)("em",{parentName:"p"},"Test"),") from in\xadte\xadgra\xadtion tests (start\xading or end\xading with ",Object(o.a)("em",{parentName:"p"},"IT"),"). In the cre\xadated file add:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," io.vertx.blog.first;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," com.jayway.restassured.RestAssured;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," org.junit.AfterClass;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," org.junit.BeforeClass;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"MyRestIT")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@BeforeClass"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"configureRestAssured"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    RestAssured.baseURI = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http://localhost"'),";\n    RestAssured.port = Integer.getInteger(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@AfterClass"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"unconfigureRestAssured"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    RestAssured.reset();\n  }\n}\n")),Object(o.a)("p",null,"The meth\xadods an\xadno\xadtated with ",Object(o.a)("inlineCode",{parentName:"p"},"@BeforeClass")," and ",Object(o.a)("inlineCode",{parentName:"p"},"@AfterClass")," are in\xadvoked once be\xadfore / after all tests of the class. Here, we just re\xadtrieve the http port (passed as a sys\xadtem prop\xaderty) and we con\xadfig\xadure REST As\xadsured."),Object(o.a)(l.a,{info:!0,title:"Am I ready to serve?",mdxType:"Alert"},Object(o.a)("p",null,"You may need to wait in the ",Object(o.a)("inlineCode",{parentName:"p"},"configureRestAssured")," method that the HTTP server has been started. We rec\xadom\xadmend the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/jayway/awaitility"}),"await\xadil\xadity")," test frame\xadwork to check that the re\xadquest can be served. It would fail the test if the server does not start.")),Object(o.a)("p",null,"It\u2019s now time to im\xadple\xadment a real test. Let\u2019s check we can re\xadtrieve an in\xaddi\xadvid\xadual prod\xaduct:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"checkThatWeCanRetrieveIndividualProduct"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Get the list of bottles, ensure it's a success and extract the first id."),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," id = get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies"'),").then()\n      .assertThat()\n      .statusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),")\n      .extract()\n      .jsonPath().getInt(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"find { it.name=='Bowmore 15 Years Laimrig' }.id\""),");\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Now get the individual resource and check the content"),"\n  get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies/"')," + id).then()\n      .assertThat()\n      .statusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),")\n      .body(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),", equalTo(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Bowmore 15 Years Laimrig"'),"))\n      .body(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"origin"'),", equalTo(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Islay"'),"))\n      .body(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"id"'),", equalTo(id));\n}\n")),Object(o.a)("p",null,"Here you can ap\xadpre\xadci\xadate the power and ex\xadpres\xadsive\xadness of Rest As\xadsured. We re\xadtrieve the list of prod\xaduct, en\xadsure the re\xadsponse is cor\xadrect, and ex\xadtract the ",Object(o.a)("em",{parentName:"p"},"id")," of a spe\xadcific bot\xadtle using a JSON (Groovy) Path ex\xadpres\xadsion."),Object(o.a)("p",null,"Then, we try to re\xadtrieve the meta\xaddata of this in\xaddi\xadvid\xadual prod\xaduct, and check the re\xadsult."),Object(o.a)("p",null,"Let\u2019s now im\xadple\xadment a more so\xadphis\xadti\xadcated sce\xadnario. Let\u2019s add and delete a prod\xaduct:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"checkWeCanAddAndDeleteAProduct"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Create a new bottle and retrieve the result (as a Whisky instance)."),"\n  Whisky whisky = given()\n      .body(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"{\\"name\\":\\"Jameson\\", \\"origin\\":\\"Ireland\\"}"'),").request().post(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies"'),').thenReturn().as(Whisky.class);\n  assertThat(whisky.getName()).isEqualToIgnoringCase("Jameson");\n  assertThat(whisky.getOrigin()).isEqualToIgnoringCase("Ireland");\n  assertThat(whisky.getId()).isNotZero();\n  // Check that it has created an individual resource, and check the content.\n  get("/api/whiskies/" + whisky.getId()).then()\n      .assertThat()\n      .statusCode(',Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),")\n      .body(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),", equalTo(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Jameson"'),"))\n      .body(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"origin"'),", equalTo(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Ireland"'),"))\n      .body(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"id"'),", equalTo(whisky.getId()));\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Delete the bottle"),"\n  delete(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies/"')," + whisky.getId()).then().assertThat().statusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"204"),");\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Check that the resource is not available anymore"),"\n  get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/api/whiskies/"')," + whisky.getId()).then()\n      .assertThat()\n      .statusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"404"),");\n}\n")),Object(o.a)("p",null,"So, now we have in\xadte\xadgra\xadtion tests let\u2019s try:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean verify\n")),Object(o.a)("p",null,"Sim\xadple no? Well, sim\xadple once the setup is done right\u2026 You can con\xadtinue im\xadple\xadment\xading other in\xadte\xadgra\xadtion tests to be sure that every\xadthing be\xadhave as you ex\xadpect."),Object(o.a)("h2",{id:"dear-windows-users"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#dear-windows-users"})),"Dear Windows users\u2026"),Object(o.a)("p",null,"This sec\xadtion is the bonus part for Win\xaddows user, or peo\xadple want\xading to run their in\xadte\xadgra\xadtion tests on Win\xaddows ma\xadchine too. The com\xadmand we ex\xade\xadcute to stop the ap\xadpli\xadca\xadtion is not going to work on Win\xaddows. Luck\xadily, it\u2019s pos\xadsi\xadble to ex\xadtend the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," with a pro\xadfile ex\xade\xadcuted on Win\xaddows."),Object(o.a)("p",null,"In your ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml"),", just after ",Object(o.a)("inlineCode",{parentName:"p"},"</build>"),", add:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"profiles"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"\x3c!-- A profile for windows as the stop command is different --\x3e"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"profile"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"windows",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"activation"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"os"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"family"),">"),"windows",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"family"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"os"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"activation"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"build"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugins"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"maven-antrun-plugin",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.8",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"stop-vertx-app",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"id"),">"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"post-integration-test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"run",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"target"),">"),"\n                  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"exec")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"executable"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"wmic"'),"\n                      ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"dir"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"${project.build.directory}"'),"\n                      ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"spawn"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"false"'),">"),"\n                    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"process"'),"/>"),"\n                    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"where"'),"/>"),"\n                    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),"\"CommandLine like '%${project.artifactId}%' and not name='wmic.exe'\""),"/>"),"\n                    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"arg")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"value"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"delete"'),"/>"),"\n                  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"exec"),">"),"\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"target"),">"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugins"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"build"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"profile"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"profiles"),">"),"\n")),Object(o.a)("p",null,"This pro\xadfile re\xadplaces the ac\xadtions de\xadscribed above to stop the ap\xadpli\xadca\xadtion with a ver\xadsion work\xading on win\xaddows. The pro\xadfile is au\xadto\xadmat\xadi\xadcally en\xadabled on Win\xaddows. As on oth\xaders op\xader\xadat\xading sys\xadtems, ex\xade\xadcute with:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean verify\n")),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"Wow, what a trip ! We are done\u2026 In this post we have seen how we can gain con\xadfi\xaddence in Vert.x ap\xadpli\xadca\xadtions by im\xadple\xadment\xading both unit and in\xadte\xadgra\xadtion tests. Unit tests, thanks to vert.x unit, are able to check the asyn\xadchro\xadnous as\xadpect of Vert.x ap\xadpli\xadca\xadtion, but could be com\xadplex for large sce\xadnar\xadios. Thanks to Rest As\xadsured and As\xadsertJ, in\xadte\xadgra\xadtion tests are dead sim\xadple to write\u2026 but the setup is not straight\xadfor\xadward. This post have shown how it can be con\xadfig\xadured eas\xadily. Ob\xadvi\xadously, you could also use As\xadsertJ and Rest As\xadsured in your unit tests."),Object(o.a)("p",null,"In the ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/using-the-asynchronous-sql-client/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"next post")),", we re\xadplace the ",Object(o.a)("em",{parentName:"p"},"in mem\xadory")," back\xadend with a data\xadbase, and use asyn\xadchro\xadnous in\xadte\xadgra\xadtion with this data\xadbase."),Object(o.a)("p",null,"Stay Tuned & Happy Cod\xading !"))}h.isMDXComponent=!0},cmAP:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"My first Vert.x 3 Application",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"Let's say, you heard someone saying that Vert.x is awesome. Ok great, but you may want to try it by yourself. Well, the next natural question is \u201cwhere do I start ?\u201d"}),i=[{term:"applic",tf:25},{term:"test",tf:23},{term:"us",tf:19},{term:"let",tf:17},{term:"method",tf:17},{term:"creat",tf:15},{term:"verticl",tf:11},{term:"start",tf:9},{term:"file",tf:9},{term:"post",tf:7},{term:"packag",tf:7},{term:"jar",tf:7},{term:"code",tf:6},{term:"complet",tf:6},{term:"asynchron",tf:6},{term:"request",tf:6},{term:"mai",tf:5},{term:"maven",tf:5},{term:"just",tf:5},{term:"follow",tf:5},{term:"class",tf:5},{term:"call",tf:5},{term:"deploi",tf:5},{term:"receiv",tf:5},{term:"lambda",tf:5}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Let\u2019s say, you heard some\xadone say\xading that Vert.x is ",Object(o.a)("em",{parentName:"p"},"awe\xadsome"),". Ok great, but you may want to try it by your\xadself. Well, the next nat\xadural ques\xadtion is \u201cwhere do I start?\u201d. This post is a good start\xading point. It shows how is built a very sim\xadple vert.x ap\xadpli\xadca\xadtion (noth\xading fancy), how it is tested and how it is pack\xadaged and ex\xade\xadcuted. So, every\xadthing you need to know be\xadfore build\xading your own ground\xadbreak\xading ap\xadpli\xadca\xadtion."),Object(o.a)("p",null,"The code de\xadvel\xadoped in this post is avail\xadable on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app"}),"github"),". This post is part of the ",Object(o.a)("em",{parentName:"p"},"In\xadtro\xadduc\xadtion to Vert.x se\xadries"),". The code of this post in in the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-1"}),"post-1 branch"),"."),Object(o.a)("h2",{id:"lets-start"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#lets-start"})),"Let\u2019s start!"),Object(o.a)("p",null,"First, let\u2019s cre\xadate a project. In this post, we use Apache Maven, but you can use Gra\xaddle or the build process tool you pre\xadfer. You could use the Maven jar ar\xadche\xadtype to cre\xadate the struc\xadture, but ba\xadsi\xadcally, you just need a di\xadrec\xadtory with:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"a ",Object(o.a)("inlineCode",{parentName:"li"},"src/main/java")," di\xadrec\xadtory"),Object(o.a)("li",{parentName:"ol"},"a ",Object(o.a)("inlineCode",{parentName:"li"},"src/test/java")," di\xadrec\xadtory"),Object(o.a)("li",{parentName:"ol"},"a ",Object(o.a)("inlineCode",{parentName:"li"},"pom.xml")," file")),Object(o.a)("p",null,"So, you would get some\xadthing like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),".\n\u251c\u2500\u2500 pom.xml\n\u251c\u2500\u2500 src\n\u2502\xa0\xa0 \u251c\u2500\u2500 main\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 java\n\u2502\xa0\xa0 \u2514\u2500\u2500 test\n\u2502\xa0\xa0     \u2514\u2500\u2500 java\n")),Object(o.a)("p",null,"Let\u2019s cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file with the fol\xadlow\xading con\xadtent:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"project")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"xmlns"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"http://maven.apache.org/POM/4.0.0"'),"\n         ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"xmlns:xsi"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"http://www.w3.org/2001/XMLSchema-instance"'),"\n         ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"xsi:schemaLocation"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"http://maven.apache.org/POM/4.0.0\n                      http://maven.apache.org/xsd/maven-4.0.0.xsd"'),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"modelVersion"),">"),"4.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"modelVersion"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx.blog",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"my-first-app",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.0-SNAPSHOT",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependencies"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-core",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependencies"),">"),"\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"build"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugins"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"maven-compiler-plugin",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.3",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"source"),">"),"1.8",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"source"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"target"),">"),"1.8",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"target"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugins"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"build"),">"),"\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"project"),">"),"\n")),Object(o.a)("p",null,"This ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file is pretty straight\xadfor\xadward:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"it de\xadclares a de\xadpen\xaddency on ",Object(o.a)("inlineCode",{parentName:"li"},"vertx-core")),Object(o.a)("li",{parentName:"ul"},"it con\xadfig\xadures the ",Object(o.a)("em",{parentName:"li"},"maven-\u200bcompiler-plugin")," to use Java 8.")),Object(o.a)("p",null,"This sec\xadond point is im\xadpor\xadtant, Vert.x ap\xadpli\xadca\xadtions re\xadquire Java 8."),Object(o.a)("h2",{id:"lets-code"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#lets-code"})),"Let\u2019s code!"),Object(o.a)("p",null,"Ok, now we have made the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file. Let\u2019s do some real cod\xading\u2026 Cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/java/io/vertx/blog/first/MyFirstVerticle.java")," file with the fol\xadlow\xading con\xadtent:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," io.vertx.blog.first;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.AbstractVerticle;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.Future;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"MyFirstVerticle")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Future<Void> fut)")," "),"{\n    vertx\n        .createHttpServer()\n        .requestHandler(r -> {\n          r.response().end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Hello from my first "')," +\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Vert.x 3 application</h1>"'),");\n        })\n        .listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", result -> {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (result.succeeded()) {\n            fut.complete();\n          } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            fut.fail(result.cause());\n          }\n        });\n  }\n}\n")),Object(o.a)("p",null,"This is ac\xadtu\xadally our not fancy ap\xadpli\xadca\xadtion. The class ex\xadtends ",Object(o.a)("inlineCode",{parentName:"p"},"AbstractVerticle"),". In the Vert.x world, a ",Object(o.a)("em",{parentName:"p"},"ver\xadti\xadcle")," is a com\xadpo\xadnent. By ex\xadtend\xading ",Object(o.a)("inlineCode",{parentName:"p"},"AbstractVerticle"),", our class gets ac\xadcess to the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx")," field."),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method is called when the ver\xadti\xadcle is de\xadployed. We could also im\xadple\xadment a ",Object(o.a)("inlineCode",{parentName:"p"},"stop")," method, but in this case Vert.x takes care of the garbage for us. The ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method re\xadceives a ",Object(o.a)("inlineCode",{parentName:"p"},"Future")," ob\xadject that will let us in\xadform Vert.x when our start se\xadquence is com\xadpleted or re\xadport an error. One of the par\xadtic\xadu\xadlar\xadity of Vert.x is its asyn\xadchro\xadnous / non-\u200bblocking as\xadpect. When our ver\xadti\xadcle is going to be de\xadployed it won\u2019t wait until the start method has been com\xadpleted. So, the ",Object(o.a)("inlineCode",{parentName:"p"},"Future")," pa\xadra\xadme\xadter is im\xadpor\xadtant to no\xadtify of the com\xadple\xadtion."),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method cre\xadates a HTTP server and at\xadtaches a re\xadquest han\xaddler to it. The re\xadquest han\xaddler is a lambda, passed in the ",Object(o.a)("inlineCode",{parentName:"p"},"requestHandler")," method, called every time the server re\xadceives a re\xadquest. Here, we just reply ",Object(o.a)("inlineCode",{parentName:"p"},"Hello ...")," (noth\xading fancy I told you). Fi\xadnally, the server is bound to the 8080 port. As this may fails (be\xadcause the port may al\xadready be used), we pass an\xadother lambda ex\xadpres\xadsion check\xading whether or not the con\xadnec\xadtion has suc\xadceeded. As men\xadtioned above it calls ei\xadther ",Object(o.a)("inlineCode",{parentName:"p"},"fut.complete")," in case of suc\xadcess or ",Object(o.a)("inlineCode",{parentName:"p"},"fut.fail")," to re\xadport an error."),Object(o.a)("p",null,"Let\u2019s try to com\xadpile the ap\xadpli\xadca\xadtion using:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean compile\n")),Object(o.a)("p",null,"For\xadtu\xadnately, it should suc\xadceed."),Object(o.a)("p",null,"That\u2019s all for the ap\xadpli\xadca\xadtion."),Object(o.a)("h2",{id:"lets-test"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#lets-test"})),"Let\u2019s test"),Object(o.a)("p",null,"Well, that\u2019s good to have de\xadvel\xadoped an ap\xadpli\xadca\xadtion, but we can never be too care\xadful, so let\u2019s test it. The test uses JUnit and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-unit/java/"}),"vertx-\u200bunit")," - a frame\xadwork de\xadliv\xadered with vert.x to make the test\xading of vert.x ap\xadpli\xadca\xadtion more nat\xadural."),Object(o.a)("p",null,"Open the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file to add the two fol\xadlow\xading de\xadpen\xadden\xadcies:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"junit",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"junit",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"4.12",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-unit",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"Now cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"src/test/java/io/vertx/blog/first/MyFirstVerticleTest.java")," with the fol\xadlow\xading con\xadtent:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"package")," io.vertx.blog.first;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.Vertx;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.unit.Async;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.unit.TestContext;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.ext.unit.junit.VertxUnitRunner;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," org.junit.After;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," org.junit.Before;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," org.junit.Test;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," org.junit.runner.RunWith;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@RunWith(VertxUnitRunner.class)"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"MyFirstVerticleTest")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," Vertx vertx;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Before"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"setUp"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n    vertx = Vertx.vertx();\n    vertx.deployVerticle(MyFirstVerticle.class.getName(),\n        context.asyncAssertSuccess());\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@After"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"tearDown"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n    vertx.close(context.asyncAssertSuccess());\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"testMyApplication"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," Async async = context.async();\n\n    vertx.createHttpClient().getNow(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),",\n     response -> {\n      response.handler(body -> {\n        context.assertTrue(body.toString().contains(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello"'),"));\n        async.complete();\n      });\n    });\n  }\n}\n")),Object(o.a)("p",null,"This is a JUnit test for our ver\xadti\xadcle. The test uses vertx-\u200bunit, so we use a cus\xadtom run\xadner. vert.x-\u200bunit makes easy to test asyn\xadchro\xadnous in\xadter\xadac\xadtions, which are the basis of vert.x ap\xadpli\xadca\xadtions."),Object(o.a)("p",null,"In the ",Object(o.a)("inlineCode",{parentName:"p"},"setUp")," method, we cre\xadates an in\xadstance of ",Object(o.a)("inlineCode",{parentName:"p"},"Vertx")," and de\xadploy our ver\xadti\xadcle. You may have no\xadticed that un\xadlike the tra\xaddi\xadtional JUnit ",Object(o.a)("inlineCode",{parentName:"p"},"@Before")," method, it re\xadceives a ",Object(o.a)("inlineCode",{parentName:"p"},"TestContext"),". This ob\xadject lets us con\xadtrol the asyn\xadchro\xadnous as\xadpect of our test. For in\xadstance, when we de\xadploy our ver\xadti\xadcle, it starts asyn\xadchro\xadnously, as most Vert.x in\xadter\xadac\xadtions. We can\xadnot check any\xadthing until it gets started cor\xadrectly. So, as sec\xadond ar\xadgu\xadment of the ",Object(o.a)("inlineCode",{parentName:"p"},"deployVerticle")," method, we pass a re\xadsult han\xaddler: ",Object(o.a)("inlineCode",{parentName:"p"},"context.asyncAssertSuccess()"),". It fails the test if the ver\xadti\xadcle does not start cor\xadrectly. In ad\xaddi\xadtion it waits until the ver\xadti\xadcle has com\xadpleted its start se\xadquence. Re\xadmem\xadber, in our ver\xadti\xadcle, we call ",Object(o.a)("inlineCode",{parentName:"p"},"fut.complete()"),". So it waits until this method is called, and in the case of a fail\xadures, fails the test."),Object(o.a)("p",null,"Well, the ",Object(o.a)("inlineCode",{parentName:"p"},"tearDown")," method is straight\xadfor\xadward, and just ter\xadmi\xadnates the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx")," in\xadstance we cre\xadated."),Object(o.a)("p",null,"Let\u2019s now have a look to the test of our ap\xadpli\xadca\xadtion: the ",Object(o.a)("inlineCode",{parentName:"p"},"testMyApplication")," method. The test emits a re\xadquest to our ap\xadpli\xadca\xadtion and checks the re\xadsult.  Emit\xadting the re\xadquest and re\xadceiv\xading the re\xadsponse is asyn\xadchro\xadnous. So we need a way to con\xadtrol this. As the ",Object(o.a)("inlineCode",{parentName:"p"},"setUp")," and ",Object(o.a)("inlineCode",{parentName:"p"},"tearDown")," meth\xadods, the test method re\xadceives a ",Object(o.a)("inlineCode",{parentName:"p"},"TestContext"),". From this ob\xadject we cre\xadates an ",Object(o.a)("em",{parentName:"p"},"async han\xaddle")," (",Object(o.a)("inlineCode",{parentName:"p"},"async"),") that lets us no\xadtify the test frame\xadwork when the test has com\xadpleted (using ",Object(o.a)("inlineCode",{parentName:"p"},"async.complete()"),")."),Object(o.a)("p",null,"So, once the ",Object(o.a)("em",{parentName:"p"},"async han\xaddle")," is cre\xadated, we cre\xadate a HTTP client and emits a HTTP re\xadquest han\xaddled by our ap\xadpli\xadca\xadtion with the ",Object(o.a)("inlineCode",{parentName:"p"},"getNow()")," method (",Object(o.a)("inlineCode",{parentName:"p"},"getNow")," is just a short\xadcut for ",Object(o.a)("inlineCode",{parentName:"p"},"get(...).end()"),"). The re\xadsponse is han\xaddled by a lambda. In this lambda we re\xadtrieves the re\xadsponse body by pass\xading an\xadother lambda to the ",Object(o.a)("inlineCode",{parentName:"p"},"handler")," method. The ",Object(o.a)("inlineCode",{parentName:"p"},"body")," ar\xadgu\xadment is the re\xadsponse body (as a ",Object(o.a)("inlineCode",{parentName:"p"},"buffer")," ob\xadject). We check that the body con\xadtains the ",Object(o.a)("inlineCode",{parentName:"p"},'"Hello"')," String and de\xadclare the test com\xadplete."),Object(o.a)("p",null,"Let\u2019s take a minute to men\xadtion the ",Object(o.a)("em",{parentName:"p"},"as\xadser\xadtions"),". Un\xadlike in tra\xaddi\xadtional JUnit tests, it uses ",Object(o.a)("inlineCode",{parentName:"p"},"context.assert..."),". In\xaddeed, if the as\xadser\xadtion fails, it will in\xadter\xadrupt the test im\xadme\xaddi\xadately. So it\u2019s pretty im\xadpor\xadtant to al\xadways uses these as\xadser\xadtion meth\xadods be\xadcause of the asyn\xadchro\xadnous as\xadpect of the Vert.x ap\xadpli\xadca\xadtion and so tests."),Object(o.a)("p",null,"Our test can be run from an IDE, or using Maven:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"test"),"\n")),Object(o.a)("h2",{id:"packaging"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#packaging"})),"Packaging"),Object(o.a)("p",null,"So, let\u2019s sum up. We have an ap\xadpli\xadca\xadtion and a test. Well, let\u2019s now pack\xadage the ap\xadpli\xadca\xadtion. In this post we pack\xadage the ap\xadpli\xadca\xadtion in a ",Object(o.a)("em",{parentName:"p"},"fat jar"),". A ",Object(o.a)("em",{parentName:"p"},"fat jar")," is a stand\xadalone ex\xade\xadcutable Jar file con\xadtain\xading all the de\xadpen\xadden\xadcies re\xadquired to run the ap\xadpli\xadca\xadtion. This is a very con\xadve\xadnient way to pack\xadage Vert.x ap\xadpli\xadca\xadtions as it\u2019s only one file. It also make them easy to ex\xade\xadcute."),Object(o.a)("p",null,"To cre\xadate a ",Object(o.a)("em",{parentName:"p"},"fat jar"),", edit the ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file and add the fol\xadlow\xading code just be\xadfore ",Object(o.a)("inlineCode",{parentName:"p"},"</plugins>"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"org.apache.maven.plugins",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"maven-shade-plugin",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"2.3",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"package",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"phase"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"shade",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goal"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"goals"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"transformers"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"transformer"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"implementation"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"'),">"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"manifestEntries"),">"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Main-Class"),">"),"io.vertx.core.Starter",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Main-Class"),">"),"\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Main-Verticle"),">"),"io.vertx.blog.first.MyFirstVerticle",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Main-Verticle"),">"),"\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"manifestEntries"),">"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"transformer"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"transformers"),">"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactSet"),"/>"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"outputFile"),">"),"${project.build.directory}/${project.artifactId}-${project.version}-fat.jar",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"outputFile"),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"configuration"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"execution"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"executions"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"plugin"),">"),"\n")),Object(o.a)("p",null,"It uses the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://maven.apache.org/plugins/maven-shade-plugin/"}),"maven-\u200bshade-plugin")," to cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"fat jar"),". In the ",Object(o.a)("inlineCode",{parentName:"p"},"manifestEntries")," it in\xaddi\xadcates the name of our ver\xadti\xadcle. You may won\xadder from where comes the ",Object(o.a)("inlineCode",{parentName:"p"},"Starter")," class. It\u2019s ac\xadtu\xadally a class from vert.x, that is going to cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx")," in\xadstance and de\xadploy our ver\xadti\xadcle."),Object(o.a)("p",null,"So, with this plug\xadin con\xadfig\xadured, let\u2019s launch:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean package\n")),Object(o.a)("p",null,"This is going to cre\xadate ",Object(o.a)("inlineCode",{parentName:"p"},"target/my-first-app-1.0-SNAPSHOT-fat.jar")," em\xadbed\xadding our ap\xadpli\xadca\xadtion along with all the de\xadpen\xadden\xadcies (in\xadclud\xading vert.x it\xadself)."),Object(o.a)("h2",{id:"executing-our-application"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#executing-our-application"})),"Executing our application"),Object(o.a)("p",null,"Well, it\u2019s nice to have a ",Object(o.a)("em",{parentName:"p"},"fat jar"),", but we want to see our ap\xadpli\xadca\xadtion run\xadning! As said above, thanks to the ",Object(o.a)("em",{parentName:"p"},"fat jar")," pack\xadag\xading, run\xadning Vert.x ap\xadpli\xadca\xadtion is easy as:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar\n")),Object(o.a)("p",null,"Then, open a browser to http://lo\xadcal\xadhost:8080."),Object(o.a)("p",null,"To stop the ap\xadpli\xadca\xadtion, hit ",Object(o.a)("inlineCode",{parentName:"p"},"CTRL+C"),"."),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"This Vert.x 3 crash class has pre\xadsented how you can de\xadvelop a sim\xadple ap\xadpli\xadca\xadtion using Vert.x 3, how to test it, pack\xadage it and run it. So, you now know every\xadthing you need to build amaz\xading sys\xadtem on top of Vert.x 3. Next time we will see how to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"/blog/vert-x-application-configuration/"}),"con\xadfig\xadure our ap\xadpli\xadca\xadtion"),"."),Object(o.a)("p",null,"Happy cod\xading ","&"," Stay tuned !"))}m.isMDXComponent=!0},dAKA:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return p})),t.d(a,"__tfidf__terms",(function(){return m})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("YFqc"),i=t.n(l),p=(r.a.createElement,{title:"Vert.x 3 real time web apps",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"One of the interesting features of Vert.x is the SockJS event bus bridge. It allows external applications to communicate with Vert.x event bus using Websockets."}),m=[{term:"applic",tf:15},{term:"will",tf:14},{term:"not",tf:10},{term:"us",tf:9},{term:"draw",tf:8},{term:"event",tf:7},{term:"on",tf:6},{term:"bu",tf:6},{term:"listen",tf:6},{term:"client",tf:5},{term:"address",tf:5},{term:"start",tf:5},{term:"file",tf:5},{term:"add",tf:5},{term:"code",tf:5},{term:"bridg",tf:4},{term:"allow",tf:4},{term:"time",tf:4},{term:"server",tf:4},{term:"post",tf:4},{term:"user",tf:4},{term:"run",tf:4},{term:"main",tf:4},{term:"window",tf:4},{term:"extern",tf:3}],j={meta:p,__tfidf__terms:m};function b(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},j,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"One of the in\xadter\xadest\xading fea\xadtures of Vert.x is the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sockjs.org"}),"SockJS")," event bus bridge. This piece of soft\xadware\nal\xadlows ex\xadter\xadnal ap\xadpli\xadca\xadtions to com\xadmu\xadni\xadcate with Vert.x event bus using Web\xadsock\xadets and if your browser does not\nsup\xadport it then it grace\xadfully de\xadgrades to pool\xading AJAX calls."),Object(o.a)("p",null,"Web\xadSock\xadets bring a new level of in\xadter\xadac\xadtion to the web, they re\xadally bring real time to web ap\xadpli\xadca\xadtions due to the\nfact that its com\xadmu\xadni\xadca\xadtion model is bi-\u200bdirectional in con\xadtrast to the tra\xaddi\xadtional HTTP model where a client can\nini\xadti\xadate a data re\xadquest to a server but not the other way around."),Object(o.a)("p",null,"In this small post I will demon\xadstrate how you can cre\xadate a sim\xadple col\xadlab\xado\xadra\xadtive draw\xading app. The idea is sim\xadple, all\nusers that open the app will be be pre\xadsented with a empty can\xadvas and what they draw or is drawn on other can\xadvas is\nshared in real time on their screen."),Object(o.a)("p",null,"For the sake of sim\xadplic\xadity and mak\xading this post light there is no se\xadcu\xadrity in\xadvolved so, every\xadone is free to lis\xadten to\nwhat is being drawn, how\xadever the ex\xadter\xadnal ap\xadpli\xadca\xadtion has lim\xadited read write ac\xadcess to a sin\xadgle ad\xaddress on Vert.x\nevent bus, en\xadsur\xading that other ser\xadvices run\xadning on the clus\xadter will not be ex\xadposed."),Object(o.a)("p",null,"This is what you should ex\xadpect to see:"),Object(o.a)("img",{src:t("KqH9"),alt:"Screencast"}),Object(o.a)("h2",{id:"bootstrap-a-project"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#bootstrap-a-project"})),"Bootstrap a project"),Object(o.a)("p",null,"If you fol\xadlowed the pre\xadvi\xadous ",Object(o.a)(i.a,{href:"/blog/[[...slug]]",as:"/blog/my-first-vert-x-3-application/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"se\xadries"))," on Vert.x de\xadvel\xadop\xadment, you saw\nthat Java and Maven were the main topic, since Vert.x is poly\xadglot I will focus on JavaScript and\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.npmjs.com/"}),"NPM")," as my pro\xadgram\xadming lan\xadguage and pack\xadage man\xadage\xadment tool."),Object(o.a)("p",null,"With NPM start by cre\xadat\xading a ",Object(o.a)("inlineCode",{parentName:"p"},"package.json"),", in order to do this we should run:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"npm init\n")),Object(o.a)("p",null,"This will present a se\xadlec\xadtion of ques\xadtions and in the end you should have a basic ",Object(o.a)("inlineCode",{parentName:"p"},"package.json")," file. This\ncon\xadfig\xadu\xadra\xadtion is very basic so you need to add a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.npmjs.com/package/vertx3-full"}),"de\xadpen\xaddency")," to Vert.x so\nyou can run the ap\xadpli\xadca\xadtion. You can add it to the ",Object(o.a)("inlineCode",{parentName:"p"},"dependencies")," prop\xaderty and it should look more or less like this:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"draw"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"private"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"dependencies"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx3-full"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"3.0.0-1"'),"\n  },\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scripts"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"start"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx run server.js"'),"\n  },\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"version"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"1.0.0"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"main"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"server.js"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"devDependencies"'),": {},\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"author"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'""'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"license"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"ISC"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"A Real Time Drawing App"'),"\n}\n")),Object(o.a)("p",null,"If you do not know why there is the de\xadpen\xaddency on ",Object(o.a)("inlineCode",{parentName:"p"},"vertx3-full")," or why the added ",Object(o.a)("inlineCode",{parentName:"p"},"scripts")," prop\xaderty please check the ",Object(o.a)(i.a,{href:"/blog/[[...slug]]",as:"/blog/vert-x3-says-hello-to-npm-users/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"older"))," blog post about it."),Object(o.a)("h2",{id:"project-structure"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#project-structure"})),"Project Structure"),Object(o.a)("p",null,"This post has no pref\xader\xadence over project struc\xadture, so if you do not agree with the struc\xadture used here feel free to\nuse what you feel best. For this ex\xadam\xadple I will keep it to:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-text"}),"\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 server.js\n\u2514\u2500\u2500 webroot\n  \u251c\u2500\u2500 assets\n  \u2502\xa0\xa0 \u2514\u2500\u2500 js\n  \u2502\xa0\xa0   \u251c\u2500\u2500 script.js\n  \u2502\xa0\xa0   \u2514\u2500\u2500 vertxbus.js\n  \u2514\u2500\u2500 index.html\n\n3 directories, 5 files\n")),Object(o.a)("p",null,"As you can imag\xadine ",Object(o.a)("inlineCode",{parentName:"p"},"server.js")," will be our Vert.x ap\xadpli\xadca\xadtion and every\xadthing under ",Object(o.a)("inlineCode",{parentName:"p"},"webroot")," will be the client\nap\xadpli\xadca\xadtion."),Object(o.a)("p",null,"The client ap\xadpli\xadca\xadtion is not re\xadally Vert.x spe\xadcific and could in the\xadory be used by any other frame\xadwork so I will go\nlightly over its code."),Object(o.a)("h3",{id:"client-application"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#client-application"})),"Client Application"),Object(o.a)("p",null,"Our ap\xadpli\xadca\xadtion main entry point is as one can ex\xadpect ",Object(o.a)("inlineCode",{parentName:"p"},"index.html"),". In the index file de\xadfine the fol\xadlow\xading HTML:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-html"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"<!DOCTYPE ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-meta-keyword"}),"html"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"html"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"head"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"meta")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"charset"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"utf-8"'),"/>"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"title"),">"),"Real time drawing App",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"title"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'\x3c!--[if lt IE 9]>\n  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"><\/script>\n  <![endif]--\x3e'),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"head"),">"),"\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"body"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"canvas")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"id"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"paper"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"width"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"1900"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"height"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"1000"'),">"),"\n  Your browser needs to support canvas for this to work!\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"canvas"),">"),"\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"\x3c!-- JavaScript includes. --\x3e"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"script")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"src"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"http://code.jquery.com/jquery-1.8.0.min.js"'),">"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"script"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"script")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"src"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"//cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js"'),">"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"script"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"script")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"src"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),"'assets/js/vertxbus.js'"),">"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"script"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"script")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"src"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"assets/js/script.js"'),">"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"script"),">"),"\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"body"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"html"),">"),"\n")),Object(o.a)("p",null,"As I pre\xadvi\xadously wrote, the idea is to keep it as sim\xadple as pos\xadsi\xadble so it is all about hav\xading a can\xadvas el\xade\xadment and a\nap\xadpli\xadca\xadtion main script ",Object(o.a)("inlineCode",{parentName:"p"},"script.js"),". All the rest are files served by CDNs that pro\xadvide com\xadmon web ap\xadpli\xadca\xadtion\nli\xadbraries such as ",Object(o.a)("inlineCode",{parentName:"p"},"jQuery"),", ",Object(o.a)("inlineCode",{parentName:"p"},"HTML5")," shim for older browsers, ",Object(o.a)("inlineCode",{parentName:"p"},"SockJS")," client and ",Object(o.a)("inlineCode",{parentName:"p"},"vertxbus")," bridge."),Object(o.a)("p",null,"The main code is on ",Object(o.a)("inlineCode",{parentName:"p"},"script.js")," file:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"$(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// This demo depends on the canvas element"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'getContext'")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"in")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"document"),".createElement(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'canvas'"),"))) {\n    alert(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'Sorry, it looks like your browser does not support canvas!'"),");\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),";\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," doc = $(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"document"),"),\n    canvas = $(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'#paper'"),"),\n    ctx = canvas[",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"].getContext(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'2d'"),");\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Generate an unique ID"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," id = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"Math"),".round($.now() * ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"Math"),".random());\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// A flag for drawing activity"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," drawing = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),";\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," clients = {};\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// create a event bus bridge to the server that served this file"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," eb = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," vertx.EventBus(\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"window"),".location.protocol + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'//'")," + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"window"),".location.hostname + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"':'")," + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"window"),".location.port + ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'/eventbus'"),");\n\n  eb.onopen = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// listen to draw events"),"\n    eb.registerHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'draw'"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"data"),") "),"{\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Is the user drawing?"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (data.drawing && clients[data.id]) {\n\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Draw a line on the canvas. clients[data.id] holds"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// the previous position of this user's mouse pointer"),"\n\n        drawLine(clients[data.id].x, clients[data.id].y, data.x, data.y);\n      }\n\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Saving the current client state"),"\n      clients[data.id] = data;\n      clients[data.id].updated = $.now();\n    });\n  };\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," prev = {};\n\n  canvas.on(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'mousedown'"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"e"),") "),"{\n    e.preventDefault();\n    drawing = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),";\n    prev.x = e.pageX;\n    prev.y = e.pageY;\n  });\n\n  doc.bind(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'mouseup mouseleave'"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n    drawing = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),";\n  });\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," lastEmit = $.now();\n\n  doc.on(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'mousemove'"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"e"),") "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," ($.now() - lastEmit > ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"30"),") {\n      eb.publish(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'draw'"),", {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'x'"),": e.pageX,\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'y'"),": e.pageY,\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'drawing'"),": drawing,\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'id'"),": id\n      });\n      lastEmit = $.now();\n    }\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Draw a line for the current user's movement, as it is"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// not received in the eventbus"),"\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (drawing) {\n\n      drawLine(prev.x, prev.y, e.pageX, e.pageY);\n\n      prev.x = e.pageX;\n      prev.y = e.pageY;\n    }\n  });\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Remove inactive clients after 10 seconds of inactivity"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"setInterval"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"})),") "),"{\n\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"for")," (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," ident ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"in")," clients) {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (clients.hasOwnProperty(ident)) {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," ($.now() - clients[ident].updated > ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"10000"),") {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Last update was more than 10 seconds ago."),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// This user has probably closed the page"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"delete")," clients[ident];\n        }\n      }\n    }\n\n  }, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"10000"),");\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"drawLine"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"fromx, fromy, tox, toy"),") "),"{\n    ctx.moveTo(fromx, fromy);\n    ctx.lineTo(tox, toy);\n    ctx.stroke();\n  }\n\n});\n")),Object(o.a)("p",null,"The most im\xadpor\xadtant part in this code is all the code re\xadlated to ",Object(o.a)("inlineCode",{parentName:"p"},"eb"),". The vari\xadable ",Object(o.a)("inlineCode",{parentName:"p"},"eb")," is our bridge to the event\nbus, Start by cre\xadat\xading a bridge using the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.EventBus")," ob\xadject and de\xadfine where to con\xadnect, using the de\xadtails\nof the cur\xadrent win\xaddow lo\xadca\xadtion."),Object(o.a)("p",null,"Then add a ",Object(o.a)("inlineCode",{parentName:"p"},"onopen")," lis\xadtener that will sub\xadscribe to the ad\xaddress ",Object(o.a)("inlineCode",{parentName:"p"},"draw")," on the event bus so it can lis\xadten to all\nmes\xadsages re\xadgard\xading draw\xading and per\xadform the draw\xading ac\xadtions. Since lis\xadten\xading is not enough I also add a mouse lis\xadtener\nto the doc\xadu\xadment so when it moves it pub\xadlishes events to the ",Object(o.a)("inlineCode",{parentName:"p"},"draw")," ad\xaddress."),Object(o.a)("p",null,"Note that I am using ",Object(o.a)("inlineCode",{parentName:"p"},"publish")," and not ",Object(o.a)("inlineCode",{parentName:"p"},"send"),", the rea\xadson should be ob\xadvi\xadous, I want every\xadone to know this users mouse\nmove\xadments, I am not in\xadter\xadested on send\xading the events to just a sin\xadgle user. You can see now that if you want to have\na draw\xading app in a one on one user basis then in\xadstead of ",Object(o.a)("inlineCode",{parentName:"p"},"publish()")," you should use ",Object(o.a)("inlineCode",{parentName:"p"},"send()"),"."),Object(o.a)("h3",{id:"server-application"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#server-application"})),"Server Application"),Object(o.a)("p",null,"The server code is quite straight for\xadward, all you need is:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," Router = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"require"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-web-js/router"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," SockJSHandler = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"require"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-web-js/sock_js_handler"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," StaticHandler = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"require"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-web-js/static_handler"'),");\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," router = Router.router(vertx);\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Allow outbound traffic to the draw address"),"\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," options = {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"outboundPermitteds"')," : [{",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"address"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"draw"'),"}],\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"inboundPermitteds"')," :  [{",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"address"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"draw"'),"}]\n};\n\nrouter.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/eventbus/*"'),").handler(SockJSHandler.create(vertx).bridge(options).handle);\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Serve the static resources"),"\nrouter.route().handler(StaticHandler.create().handle);\n\nvertx.createHttpServer().requestHandler(router.accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(o.a)("p",null,"We start with the usual im\xadports, we im\xadport a ref\xader\xadence to the ",Object(o.a)("inlineCode",{parentName:"p"},"Router")," ob\xadject and a cou\xadple of helper han\xaddlers\n",Object(o.a)("inlineCode",{parentName:"p"},"SockJSHandler")," and ",Object(o.a)("inlineCode",{parentName:"p"},"StaticHandler"),". As their names should tell you one han\xaddler will be re\xadspon\xadsi\xadble to han\xaddle all\n",Object(o.a)("inlineCode",{parentName:"p"},"SockJS")," data and the other all HTTP file serv\xading re\xadquests."),Object(o.a)("p",null,"We then add then to a router and start a HTTP server that will han\xaddle all in\xadcom\xading re\xadquest using the han\xaddler ac\xadcept\nfunc\xadtion. Fi\xadnally we lis\xadten on port ",Object(o.a)("inlineCode",{parentName:"p"},"8080")," and we are ready."),Object(o.a)("p",null,"Note that there is a op\xadtions ob\xadject where a cou\xadple of prop\xader\xadties are de\xadfined ",Object(o.a)("inlineCode",{parentName:"p"},"outbound/inbound")," per\xadmit\xadted ad\xaddresses.\nWith\xadout this con\xadfig\xadu\xadra\xadtion the ex\xadter\xadnal ap\xadpli\xadca\xadtion will not be al\xadlowed to con\xadnect to the vert.x bus, in fact the\nde\xadfault con\xadfig\xadu\xadra\xadtion of the Sock\xadJSHan\xaddler is deny all. So you must spec\xadify ex\xadplic\xaditly which ad\xaddress are al\xadlowed to\nre\xadceive mes\xadsages from ",Object(o.a)("inlineCode",{parentName:"p"},"SockJS")," and which ones are al\xadlowed to send/pub\xadlish to ",Object(o.a)("inlineCode",{parentName:"p"},"SockJS"),"."),Object(o.a)("p",null,"Now you can start your ap\xadpli\xadca\xadtion, don\u2019t for\xadget to in\xadstall the de\xadpen\xadden\xadcies for the first time:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"npm install\n")),Object(o.a)("p",null,"And then run the ap\xadpli\xadca\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"npm start\n")),Object(o.a)("p",null,"If you now open 2 browser win\xaddows you will be able to draw nice pic\xadtures and see the draw\xading show\xading in \u201creal time\u201d\non the other win\xaddow, if you then draw on the sec\xadond you should get the mir\xadror ef\xadfect on the first win\xaddow."),Object(o.a)("p",null,"Have fun!"))}b.isMDXComponent=!0},dRkU:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 3.8.1",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This new version is a bug fix release that addresses issues reported in Eclipse Vert.x 3.8.1. We also updated Netty to version 4.1.39.Final to fix some CVEs."}),i=[{term:"http",tf:7},{term:"releas",tf:5},{term:"cve",tf:5},{term:"2019",tf:4},{term:"flood",tf:4},{term:"com",tf:4},{term:"wiki",tf:4},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"fix",tf:2},{term:"report",tf:2},{term:"deprec",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"note",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We have just re\xadleased Vert.x 3.8.1, a bug fix re\xadlease of Vert.x 3.8.x."),Object(o.a)("p",null,"This ver\xadsion up\xaddates to Netty 4.1.39.Final fix\xading the fol\xadlow\xading HTTP/2 re\xadlated CVEs:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"CVE-2019-9512: Ping Flood"),Object(o.a)("li",{parentName:"ul"},"CVE-2019-9514: Reset Flood"),Object(o.a)("li",{parentName:"ul"},"CVE-2019-9515: Set\xadtings Flood"),Object(o.a)("li",{parentName:"ul"},"CVE-2019-9518: Empty DATA frame flood\xading")),Object(o.a)("p",null,"Since the re\xadlease of Vert.x 3.8.0, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"Vert.x 3.8.1 dep\xadre\xadca\xadtions and break\xading changes")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.1-Deprecations-and-breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.1-\u200bDeprecations-and-breaking-changes")))),Object(o.a)("p",null,"Vert.x 3.8.1 re\xadlease notes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.1-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.1-\u200bRelease-Notes"))),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.1%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.1/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.1 project using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},eHGC:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"HTTP response validation with the Vert.x Web Client",category:"guides",authors:[{name:"Thomas Segismont",github_id:"tsegismont"}],summary:"Learn how to use response predicates from the Vert.x Web module to validate HTTP responses and to automatically generate error messages."}),i=[{term:"respons",tf:16},{term:"predic",tf:10},{term:"error",tf:7},{term:"web",tf:4},{term:"not",tf:4},{term:"us",tf:4},{term:"statu",tf:4},{term:"code",tf:4},{term:"bodi",tf:4},{term:"convert",tf:4},{term:"content",tf:3},{term:"type",tf:3},{term:"check",tf:3},{term:"receiv",tf:3},{term:"gener",tf:3},{term:"except",tf:3},{term:"default",tf:2},{term:"client",tf:2},{term:"request",tf:2},{term:"wrong",tf:2},{term:"failur",tf:2},{term:"perform",tf:2},{term:"come",tf:2},{term:"full",tf:2},{term:"json",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"By de\xadfault, a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"/docs/vertx-web-client/java/"}),"Vert.x Web Client")," re\xadquest ends with an error only if some\xadthing wrong hap\xadpens at the net\xadwork level.\nIn other words, a ",Object(o.a)("inlineCode",{parentName:"p"},"404 Not Found")," re\xadsponse, or a re\xadsponse with the wrong con\xadtent type, are ",Object(o.a)("strong",{parentName:"p"},"not")," con\xadsid\xadered as fail\xadures."),Object(o.a)("p",null,"Hence, you would usu\xadally per\xadform san\xadity checks man\xadu\xadally after the re\xadsponse is re\xadceived:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-clojure"}),"client\n  .get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  .send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ar")," -> {\n    if (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ar.succeeded"),"()) {\n      HttpResponse<Buffer> response = ar.result()",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n      if (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"response.statusCode"),"() == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200")," && response.getHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),").equals(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")) {\n        // Decode the body as a json object\n        JsonObject body = response.bodyAsJsonObject()",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n      } else {\n        System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Something went wrong "')," + response.statusCode())",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n      }\n    } else {\n      System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Something went wrong "')," + ar.cause().getMessage())",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n    }\n  })",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n")),Object(o.a)("p",null,"Start\xading with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"/blog/eclipse-vert-x-3-6-0-released/"}),"Vert.x 3.6"),", you can can trade flex\xadi\xadbil\xadity for clar\xadity and con\xadcise\xadness using ",Object(o.a)("em",{parentName:"p"},"re\xadsponse pred\xadi\xadcates"),"."),Object(o.a)("h2",{id:"response-predicates"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#response-predicates"})),"Response predicates"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"/docs/apidocs/io/vertx/ext/web/client/predicate/ResponsePredicate.html"}),"Re\xadsponse pred\xadi\xadcates")," can fail a re\xadquest when the re\xadsponse does not match cri\xadte\xadrion."),Object(o.a)("p",null,"The Web Client mod\xadule comes with a set of ready-\u200bto-use pred\xadi\xadcates:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-clojure"}),"client\n  .get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  .expect(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ResponsePredicate.SC_SUCCESS"),")\n  .expect(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ResponsePredicate.JSON"),")\n  .send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ar")," -> {\n    if (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ar.succeeded"),"()) {\n      HttpResponse<Buffer> response = ar.result()",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n      // Safely decode the body as a json object\n      JsonObject body = response.bodyAsJsonObject()",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n    } else {\n      System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Something went wrong "')," + ar.cause().getMessage())",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n    }\n  })",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n\n")),Object(o.a)("p",null,"The web is full of HTTP/JSON end\xadpoints, so there is no doubt the ",Object(o.a)("inlineCode",{parentName:"p"},"ResponsePredicate.SC_SUCCESS")," and ",Object(o.a)("inlineCode",{parentName:"p"},"ResponsePredicate.JSON")," can be handy."),Object(o.a)("p",null,"Nev\xader\xadthe\xadless, you might also need to check that the sta\xadtus code is whithin a spe\xadcific range:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-scheme"}),"client\n  .get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"8080"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  .expect(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ResponsePredicate.status"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"200"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"202"),"))\n  .send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ar")," -> {\n    // ....\n  })",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n")),Object(o.a)("p",null,"Or that the con\xadtent is of a spe\xadcific type: "),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-clojure"}),"client\n  .get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  .expect(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ResponsePredicate.contentType"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"some/content-type"'),"))\n  .send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ar")," -> {\n    // ....\n  })",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n")),Object(o.a)("p",null,"Please refer to the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"/docs/apidocs/io/vertx/ext/web/client/predicate/ResponsePredicate.html"}),Object(o.a)("inlineCode",{parentName:"a"},"ResponsePredicate")," doc\xadu\xadmen\xadta\xadtion")," for a full list of pre\xadde\xadfined pred\xadi\xadcates."),Object(o.a)("h3",{id:"custom-predicates"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#custom-predicates"})),"Custom predicates"),Object(o.a)("p",null,"Even\xadtu\xadally, pred\xadi\xadcates were not de\xadsigned for sta\xadtus code and con\xadtent type check\xading only, so feel free to cre\xadate your own val\xadi\xadda\xadtion code:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-clojure"}),"// Check CORS header allowing to do POST\nFunction<HttpResponse<Void>, ResponsePredicateResult> methodsPredicate = resp -> {\n  String methods = resp.getHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Access-Control-Allow-Methods"'),")",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n  if (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"methods")," != null) {\n    if (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"methods.contains"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"POST"'),")) {\n      return ResponsePredicateResult.success()",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n    }\n  }\n  return ResponsePredicateResult.failure(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Does not work"'),")",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n}",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n\n// Send pre-flight CORS request\nclient\n  .request(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"HttpMethod.OPTIONS"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"myserver.mycompany.com"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/some-uri"'),")\n  .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Origin"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Server-b.com"'),")\n  .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Access-Control-Request-Method"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"POST"'),")\n  .expect(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"methodsPredicate"),")\n  .send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ar")," -> {\n    if (",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ar.succeeded"),"()) {\n      // Process the POST request now\n    } else {\n      System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Something went wrong "')," + ar.cause().getMessage())",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n    }\n  })",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n")),Object(o.a)("p",null,"Note that re\xadsponse pred\xadi\xadcates are eval\xadu\xadated ",Object(o.a)("em",{parentName:"p"},"be\xadfore")," the re\xadsponse body is re\xadceived.\nThere\xadfore ",Object(o.a)("strong",{parentName:"p"},"you can\u2019t in\xadspect the re\xadsponse body")," in a pred\xadi\xadcate test func\xadtion, only sta\xadtus code, sta\xadtus mes\xadsage and re\xadsponse head\xaders."),Object(o.a)("h2",{id:"dealing-with-failures"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#dealing-with-failures"})),"Dealing with failures"),Object(o.a)("p",null,"By de\xadfault, re\xadsponse pred\xadi\xadcates (in\xadclud\xading the pre\xadde\xadfined ones) use a generic error con\xadverter which dis\xadcards the re\xadsponse body and con\xadveys a sim\xadple mes\xadsage.\nYou can cus\xadtomize the ex\xadcep\xadtion class by chang\xading the error con\xadverter:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-clojure"}),"ResponsePredicate predicate = ResponsePredicate.create(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"ResponsePredicate.SC_SUCCESS"),", result -> {\n  return new MyCustomException(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"result.message"),"())",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n})",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n")),Object(o.a)("p",null,"Be\xadware that cre\xadat\xading ex\xadcep\xadtions in Java comes with the ",Object(o.a)("strong",{parentName:"p"},"per\xadfor\xadmance cost")," of cap\xadtur\xading the call stack.\nThe generic error con\xadverter gen\xader\xadates ex\xadcep\xadtions that do not cap\xadture it."),Object(o.a)("h3",{id:"reading-details-in-error-responses"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#reading-details-in-error-responses"})),"Reading details in error responses"),Object(o.a)("p",null,"Many web APIs pro\xadvide de\xadtails in error re\xadsponses.\nFor ex\xadam\xadple, the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://developer.marvel.com/docs"}),"Mar\xadvel API")," uses this JSON ob\xadject for\xadmat:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"code"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"InvalidCredentials"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"message"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"The passed API key is invalid."'),"\n}\n")),Object(o.a)("p",null,"To avoid los\xading this in\xadfor\xadma\xadtion, it is pos\xadsi\xadble to wait for the re\xadsponse body to be fully re\xadceived be\xadfore the error con\xadverter is called:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-reasonml"}),"ErrorConverter converter = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-module-access"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-module"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-identifier"}),"ErrorConverter"),".")),"create",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"FullBody(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"result")," -> {\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-operator"}),"/"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-operator"}),"/")," Invoked ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"after")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"the")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"response")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"body")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"is")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"fully")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"received"),"\n  HttpResponse<Buffer> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"response")," = ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"result"),".",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"response"),"()"),";\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (response.get",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"Header(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"content-type"'),")"),".equals(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")) {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Error body is JSON data"),"\n    JsonObject body = response.body",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"AsJsonObject()"),";\n    return ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"MyCustomException(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"body"),".",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"getString"),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"code"'),")"),", body.get",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"String(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"message"'),")"),");\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Fallback to defaut message"),"\n  return ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-constructor"}),"MyCustomException(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"result"),".",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"message"),"()"),");\n});\n\nResponsePredicate predicate = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-module-access"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-module"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-identifier"}),"ResponsePredicate"),".")),"create(ResponsePredicate.SC_SUCCESS, converter);\n")),Object(o.a)("p",null,"That\u2019s it! Feel free to com\xadment here or ask ques\xadtions on our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"/community"}),"com\xadmu\xadnity chan\xadnels"),"."))}m.isMDXComponent=!0},gQMU:function(e,a,t){var n=t("0ZTe")("toUpperCase");e.exports=n},gcZK:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return p})),t.d(a,"__tfidf__terms",(function(){return m})),t.d(a,"default",(function(){return b}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("YFqc"),i=t.n(l),p=(r.a.createElement,{title:"Vert.x Application Configuration",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"In our previous post, we developed a very simple Vert.x 3 application, and saw how this application can be tested, packaged and executed. That was nice, wasn\u2019t it?"}),m=[{term:"port",tf:19},{term:"applic",tf:18},{term:"configur",tf:16},{term:"us",tf:16},{term:"let",tf:9},{term:"8080",tf:6},{term:"test",tf:6},{term:"random",tf:6},{term:"post",tf:5},{term:"http",tf:5},{term:"code",tf:5},{term:"not",tf:5},{term:"develop",tf:4},{term:"simpl",tf:4},{term:"server",tf:4},{term:"verticl",tf:4},{term:"pick",tf:4},{term:"previou",tf:3},{term:"execut",tf:3},{term:"ok",tf:3},{term:"go",tf:3},{term:"extern",tf:3},{term:"just",tf:3},{term:"need",tf:3},{term:"work",tf:3}],j={meta:p,__tfidf__terms:m};function b(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},j,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"In ",Object(o.a)(i.a,{href:"/blog/[[...slug]]",as:"/blog/my-first-vert-x-3-application/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"our pre\xadvi\xadous post")),", we de\xadvel\xadoped a very sim\xadple Vert.x 3 ap\xadpli\xadca\xadtion, and saw how this ap\xadpli\xadca\xadtion can be tested, pack\xadaged and ex\xade\xadcuted. That was nice, wasn\u2019t it? Well, ok, that was only the be\xadgin\xadning. In this post, we are going to en\xadhance our ap\xadpli\xadca\xadtion to sup\xadport ",Object(o.a)("em",{parentName:"p"},"ex\xadter\xadnal")," con\xadfig\xadu\xadra\xadtion."),Object(o.a)("p",null,"So just to re\xadmind you, we have an ap\xadpli\xadca\xadtion start\xading a HTTP server on the port 8080 and re\xadply\xading a po\xadlite \u201cHello\u201d mes\xadsage to all HTTP re\xadquests. The pre\xadvi\xadous code is avail\xadable ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-1"}),"here"),". The code de\xadvel\xadoped in this post is in the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-2"}),"post-2 branch"),"."),Object(o.a)("h2",{id:"so-why-do-we-need-configuration"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#so-why-do-we-need-configuration"})),"So, why do we need configuration?"),Object(o.a)("p",null,"That\u2019s a good ques\xadtion. The ap\xadpli\xadca\xadtion works right now, but well, let\u2019s say you want to de\xadploy it on a ma\xadchine where the port 8080 is al\xadready taken. We would need to change the port in the ap\xadpli\xadca\xadtion code and in the test, just for this ma\xadchine. That would be sad. For\xadtu\xadnately, Vert.x ap\xadpli\xadca\xadtions are con\xadfig\xadurable."),Object(o.a)("p",null,"Vert.x con\xadfig\xadu\xadra\xadtions are using the JSON for\xadmat, so don\u2019t ex\xadpect any\xadthing com\xadpli\xadcated. They can be passed to ver\xadti\xadcle ei\xadther from the com\xadmand line, or using an API. Let\u2019s have a look."),Object(o.a)("h2",{id:"no-8080-anymore"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#no-8080-anymore"})),"No \u20188080\u2019 anymore"),Object(o.a)("p",null,"The first step is to mod\xadify the ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.blog.first.MyFirstVerticle")," class to not bind to the port 8080, but to read it from the con\xadfig\xadu\xadra\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Future<Void> fut)")," "),"{\n  vertx\n      .createHttpServer()\n      .requestHandler(r -> {\n        r.response().end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"<h1>Hello from my first "')," +\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Vert.x 3 application</h1>"'),");\n      })\n      .listen(\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Retrieve the port from the configuration,"),"\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// default to 8080."),"\n          config().getInteger(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),"),\n          result -> {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (result.succeeded()) {\n              fut.complete();\n            } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n              fut.fail(result.cause());\n            }\n          }\n      );\n}\n")),Object(o.a)("p",null,"So, the only dif\xadfer\xadence with the pre\xadvi\xadous ver\xadsion is ",Object(o.a)("inlineCode",{parentName:"p"},'config().getInteger("http.port", 8080)'),". Here, our code is now re\xadquest\xading the con\xadfig\xadu\xadra\xadtion and check whether the ",Object(o.a)("em",{parentName:"p"},"http.port")," prop\xaderty is set. If not, the port 8080 is used as fall-\u200bback. The re\xadtrieved con\xadfig\xadu\xadra\xadtion is a ",Object(o.a)("inlineCode",{parentName:"p"},"JsonObject"),"."),Object(o.a)("p",null,"As we are using the port 8080 by de\xadfault, you can still pack\xadage our ap\xadpli\xadca\xadtion and run it as be\xadfore:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean package\njava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar\n")),Object(o.a)("p",null,"Sim\xadple right ?"),Object(o.a)("h2",{id:"api-based-configuration---random-port-for-the-tests"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#api-based-configuration---random-port-for-the-tests"})),"API-based configuration - Random port for the tests"),Object(o.a)("p",null,"Now that the ap\xadpli\xadca\xadtion is con\xadfig\xadurable, let\u2019s try to pro\xadvide a con\xadfig\xadu\xadra\xadtion. In our test, we are going to con\xadfig\xadure our ap\xadpli\xadca\xadtion to use the port 8081. So, pre\xadvi\xadously we were de\xadploy\xading our ver\xadti\xadcle with:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"vertx.deployVerticle(MyFirstVerticle.class.getName(), context.asyncAssertSuccess());\n")),Object(o.a)("p",null,"Let\u2019s now pass some ",Object(o.a)("em",{parentName:"p"},"de\xadploy\xadment op\xadtions"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"port = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8081"),";\nDeploymentOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," DeploymentOptions()\n    .setConfig(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", port));\nvertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());\n")),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"DeploymentOptions")," ob\xadject lets us cus\xadtomize var\xadi\xadous pa\xadra\xadme\xadters. In par\xadtic\xadu\xadlar, it lets us in\xadject the ",Object(o.a)("inlineCode",{parentName:"p"},"JsonObject")," re\xadtrieved by the ver\xadti\xadcle when using the ",Object(o.a)("inlineCode",{parentName:"p"},"config()")," method."),Object(o.a)("p",null,"Ob\xadvi\xadously, the test con\xadnect\xading to the server needs to be slightly mod\xadi\xadfied to use the right port (",Object(o.a)("inlineCode",{parentName:"p"},"port")," is a field):"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"vertx.createHttpClient().getNow(port, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),", response -> {\n  response.handler(body -> {\n    context.assertTrue(body.toString().contains(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello"'),"));\n    async.complete();\n  });\n});\n")),Object(o.a)("p",null,"Ok, well, this does not re\xadally fix our issue. What hap\xadpens when the port 8081 is used too. Let\u2019s now pick a ran\xaddom port:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"ServerSocket socket = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ServerSocket(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),");\nport = socket.getLocalPort();\nsocket.close();\n\nDeploymentOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," DeploymentOptions()\n    .setConfig(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", port));\n\nvertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());\n")),Object(o.a)("p",null,"So, the idea is very sim\xadple. We open a ",Object(o.a)("em",{parentName:"p"},"server socket")," that would pick a ran\xaddom port (that\u2019s why we put 0 as pa\xadra\xadme\xadter). We re\xadtrieve the used port and close the socket. Be aware that this method is ",Object(o.a)("strong",{parentName:"p"},"not")," per\xadfect and may fail if the picked port be\xadcomes used be\xadtween the ",Object(o.a)("inlineCode",{parentName:"p"},"close")," method and the start of our HTTP server. How\xadever, it would work fine in the very high ma\xadjor\xadity of the case."),Object(o.a)("p",null,"With this in place, our test is now using a ran\xaddom port. Ex\xade\xadcute them with:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"test"),"\n")),Object(o.a)("h2",{id:"external-configuration---lets-run-on-another-port"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#external-configuration---lets-run-on-another-port"})),"External configuration - Let\u2019s run on another port"),Object(o.a)("p",null,"Ok, well ran\xaddom port is not what we want in ",Object(o.a)("em",{parentName:"p"},"pro\xadduc\xadtion"),". Could you imag\xadine the face of your pro\xadduc\xadtion team if you tell them that your ap\xadpli\xadca\xadtion is pick\xading a ran\xaddom port. It can ac\xadtu\xadally be funny, but we should never mess with the pro\xadduc\xadtion team."),Object(o.a)("p",null,"So for the ac\xadtual ex\xade\xadcu\xadtion of your ap\xadpli\xadca\xadtion, let\u2019s pass the con\xadfig\xadu\xadra\xadtion in an ex\xadter\xadnal file. The con\xadfig\xadu\xadra\xadtion is stored in a ",Object(o.a)("em",{parentName:"p"},"json")," file."),Object(o.a)("p",null,"Cre\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/conf/my-application-conf.json")," with the fol\xadlow\xading con\xadtent:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8082"),"\n}\n")),Object(o.a)("p",null,"And now, to use this con\xadfig\xadu\xadra\xadtion just launch your ap\xadpli\xadca\xadtion with:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar -conf src/main/conf/my-application-conf.json\n")),Object(o.a)("p",null,"Open a browser on http://lo\xadcal\xadhost:8082, here it is !"),Object(o.a)("p",null,"How does that work ? Re\xadmem\xadber, our ",Object(o.a)("em",{parentName:"p"},"fat jar")," is using the ",Object(o.a)("inlineCode",{parentName:"p"},"Starter")," class (pro\xadvided by Vert.x) to launch our ap\xadpli\xadca\xadtion. This class is read\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"-conf")," pa\xadra\xadme\xadter and cre\xadate the cor\xadre\xadspond\xading de\xadploy\xadment op\xadtions when de\xadploy\xading our ver\xadti\xadcle."),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"After hav\xading de\xadvel\xadoped your first Vert.x ap\xadpli\xadca\xadtion, we have seen how this ap\xadpli\xadca\xadtion is con\xadfig\xadurable, and this with\xadout adding any com\xadplex\xadity to our ap\xadpli\xadca\xadtion. ",Object(o.a)(i.a,{href:"/blog/[[...slug]]",as:"/blog/some-rest-with-vert-x/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"In the next post")),", we are going to see how we can use vertx-\u200bweb to de\xadvelop a small ap\xadpli\xadca\xadtion serv\xading sta\xadtic pages and a REST API. A bit more fancy, but still very sim\xadple."),Object(o.a)("p",null,"Happy Cod\xading and ","&"," Stay Tuned!"))}b.isMDXComponent=!0},ghJH:function(e,a){e.exports="/_next/static/images/kibana-dashboard-3c28c8dda8615298263ae606fcec7d70.png"},h9Ra:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 2.1.6 released !",category:"releases",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"The Vert.x team is pleased to announce the release of Vert.x 2.1.6"}),i=[{term:"fix",tf:6},{term:"bug",tf:4},{term:"releas",tf:3},{term:"state",tf:3},{term:"node",tf:3},{term:"pleas",tf:2},{term:"product",tf:2},{term:"upgrad",tf:2},{term:"connect",tf:2},{term:"hazelcast",tf:2},{term:"cluster",tf:2},{term:"event",tf:2},{term:"bu",tf:2},{term:"close",tf:2},{term:"deploi",tf:2},{term:"team",tf:1},{term:"announc",tf:1},{term:"mainten",tf:1},{term:"branch",tf:1},{term:"design",tf:1},{term:"user",tf:1},{term:"immedi",tf:1},{term:"latest",tf:1},{term:"version",tf:1},{term:"new",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"The Vert.x team is pleased to an\xadnounce the re\xadlease of Vert.x ",Object(o.a)("strong",{parentName:"p"},"2.1.6"),"."),Object(o.a)("p",null,"This is a main\xadte\xadnance re\xadlease on the 2.x branch that fixes a few bugs and is de\xadsigned for Vert.x 2 pro\xadduc\xadtion users who can\xadnot up\xadgrade to 3.0 im\xadme\xaddi\xadately."),Object(o.a)("p",null,"For the lat\xadest pro\xadduc\xadtion ver\xadsion for new projects please see ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io"}),"Vert.x 3.0"),"."),Object(o.a)("p",null,"Fixes in this re\xadlease in\xadclude:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("em",{parentName:"li"},"run\xadZip")," - fix bugs in un\xadpack\xading zips"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("em",{parentName:"li"},"Http\xadClient")," - make sure write\xadHead is set to true be\xadfore con\xadnect"),Object(o.a)("li",{parentName:"ul"},"Up\xadgrade to Hazel\xadcast 3.5 to fix bug in ",Object(o.a)("inlineCode",{parentName:"li"},"Multimap")," state."),Object(o.a)("li",{parentName:"ul"},"Workaround for Hazel\xadcast bug which could re\xadsult in in\xadcon\xadsis\xadtent clus\xadter state if mul\xadti\xadple nodes shut\xaddown con\xadcur\xadrently"),Object(o.a)("li",{parentName:"ul"},"Clus\xadter\xading fixes re\xadlated to clear\xading up state in case of event bus con\xadnec\xadtions clos\xading and on close of event bus."),Object(o.a)("li",{parentName:"ul"},"Fix mes\xadsage replies to nodes other than the node the SockJS bridge is de\xadployed on.")),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%222.1.6%22"}),"Maven Cen\xadtral"),", and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/2.1.6/view"}),"Bin\xadtray"),"."))}m.isMDXComponent=!0},hE7a:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Introducing Vert.x MQTT client",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"In this article, we will see how to set up the new Vert.x MQTT client. An example project is available on GitHub."}),i=[{term:"us",tf:4},{term:"gradl",tf:4},{term:"mqtt",tf:3},{term:"client",tf:3},{term:"maven",tf:3},{term:"applic",tf:3},{term:"broker",tf:3},{term:"subscrib",tf:3},{term:"connect",tf:3},{term:"will",tf:2},{term:"exampl",tf:2},{term:"depend",tf:2},{term:"project",tf:2},{term:"messag",tf:2},{term:"handler",tf:2},{term:"call",tf:2},{term:"topic",tf:2},{term:"method",tf:2},{term:"complet",tf:2},{term:"starter",tf:2},{term:"articl",tf:1},{term:"sett",tf:1},{term:"new",tf:1},{term:"actual",tf:1},{term:"real",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"In this ar\xadti\xadcle, we will see how to sett up the new Vert.x MQTT client. Ac\xadtu\xadally, I have a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Sammers21/vertx-mqtt-client-example"}),"real ex\xadam\xadple")," so you can try it quickly."),Object(o.a)("p",null,"If you are using Maven or Gra\xaddle, add the fol\xadlow\xading de\xadpen\xaddency to the de\xadpen\xadden\xadcies sec\xadtion of your project de\xadscrip\xadtor to ac\xadcess the Vert.x MQTT client:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Maven (in your pom.xml):")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-mqtt",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.5.0.Beta1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Gra\xaddle (in your build.gra\xaddle file):")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-groovy"}),"dependencies {\n  compile ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'io.vertx:vertx-mqtt:3.5.0.Beta1'"),"\n}\n")),Object(o.a)("p",null,"Now that you\u2019ve set up your project, you can cre\xadate a sim\xadple ap\xadpli\xadca\xadtion which will re\xadceive all mes\xadsages from all bro\xadker chan\xadnels:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.core.AbstractVerticle;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.mqtt.MqttClient;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," io.vertx.mqtt.MqttClientOptions;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," java.io.UnsupportedEncodingException;\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"MainVerticle")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n     MqttClientOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MqttClientOptions();\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// specify broker host"),"\n      options.setHost(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"iot.eclipse.org"'),");\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// specify max size of message in bytes"),"\n      options.setMaxMessageSize(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"100_000_000"),");\n\n    MqttClient client = MqttClient.create(vertx, options);\n\n    client.publishHandler(s -> {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"try")," {\n        String message = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," String(s.payload().getBytes(), ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"UTF-8"'),");\n        System.out.println(String.format(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Receive message with content: \\"%s\\" from topic \\"%s\\""'),", message, s.topicName()));\n      } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"catch")," (UnsupportedEncodingException e) {\n        e.printStackTrace();\n      }\n    });\n\n    client.connect(s -> {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// subscribe to all subtopics"),"\n      client.subscribe(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"#"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),");\n    });\n  }\n}\n")),Object(o.a)("p",null,"The ",Object(o.a)("strong",{parentName:"p"},"pub\xadlish\xadHan\xaddler")," is the han\xaddler called each time the bro\xadker, lo\xadcated at ",Object(o.a)("inlineCode",{parentName:"p"},"iot.eclipse.org:1883"),", sends a mes\xadsage to you, from the top\xadics you are sub\xadscrib\xading for."),Object(o.a)("p",null,"But only pro\xadvid\xading a han\xaddler is not enough, you should also con\xadnect to the bro\xadker and sub\xadscribe to some top\xadics. For this rea\xadson, you should use the ",Object(o.a)("strong",{parentName:"p"},"con\xadnect")," method and then call ",Object(o.a)("strong",{parentName:"p"},"sub\xadscribe")," when the con\xadnec\xadtion es\xadtab\xadlished. "),Object(o.a)("p",null,"To de\xadploy this ver\xadti\xadcle from an ap\xadpli\xadca\xadtion you should have in your ",Object(o.a)("strong",{parentName:"p"},"main")," method some\xadthing like that:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Vertx vertx = Vertx.vertx();\nvertx.deployVerticle(MainVerticle.class.getCanonicalName());\n")),Object(o.a)("p",null,"When you have com\xadpleted all steps cor\xadrectly the re\xadsult should look like that:"),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"http://i.imgur.com/b4yYQJE.gif",alt:null}))),Object(o.a)("p",null,"As the al\xadter\xadna\xadtive and rec\xadom\xadmended way to boot\xadstrap Vert.x ap\xadpli\xadca\xadtions you can use ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-maven-starter"}),"vertx-\u200bmaven-starter")," or ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-gradle-starter"}),"vertx-\u200bgradle-starter"),". For com\xadplet\xading this guide I have used the first one. The final source code avail\xadable ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Sammers21/vertx-mqtt-client-example"}),"here"),". If you would like to learn more about Vert.x MQTT client API then check out the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-mqtt-client/blob/initial-work/src/main/asciidoc/java/index.adoc"}),"full doc\xadu\xadmen\xadta\xadtion")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/tree/3.5.0.beta1/mqtt-examples"}),"more ex\xadam\xadples"),". "),Object(o.a)("p",null,"Thank you for read\xading!"),Object(o.a)("p",null,"Cheers!"))}m.isMDXComponent=!0},hiWL:function(e,a){e.exports="/_next/static/images/whisky-mongo-9e9d6faa219dbfd2651e64377c0cf3bf.png"},hkBy:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 4 milestone 3 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"The next milestone release of Vert.x 4 aims to provide a reliable distribution of the current development for people who want to try it and provide feedback."}),i=[{term:"json",tf:10},{term:"client",tf:9},{term:"object",tf:7},{term:"servic",tf:6},{term:"releas",tf:5},{term:"will",tf:5},{term:"data",tf:5},{term:"type",tf:5},{term:"respons",tf:5},{term:"us",tf:5},{term:"mileston",tf:4},{term:"provid",tf:4},{term:"proxi",tf:4},{term:"third",tf:3},{term:"featur",tf:3},{term:"develop",tf:3},{term:"map",tf:3},{term:"request",tf:3},{term:"gener",tf:3},{term:"code",tf:3},{term:"seri",tf:2},{term:"aim",tf:2},{term:"distribut",tf:2},{term:"current",tf:2},{term:"extend",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce the third 4.0 mile\xadstone re\xadlease of Eclipse Vert.x ."),Object(o.a)("p",null,"Vert.x 4 is the evo\xadlu\xadtion of the Vert.x 3.x se\xadries that will bring key fea\xadtures to Vert.x."),Object(o.a)("p",null,"This re\xadlease aims to pro\xadvide a re\xadli\xadable dis\xadtri\xadb\xadu\xadtion of the cur\xadrent de\xadvel\xadop\xadment of Vert.x 4 for peo\xadple who\nwant to try it and pro\xadvide feed\xadback."),Object(o.a)("h2",{id:"futurisation"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#futurisation"})),"Futurisation"),Object(o.a)("p",null,"Vert.x 4 ex\xadtends the 3.x call\xadback asyn\xadchro\xadnous model to a fu\xadture/call\xadback hy\xadbrid model."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"NetClient")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Since 3.0"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host, Handler<AsyncResult<NetSocket>> handler)")),";\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// New in 4.0"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Future<NetSocket> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host)")),";\n}\n")),Object(o.a)("p",null,"This third mile\xadstone makes progress and coverts the fol\xadlow\xading stack mod\xadules:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"vertx-\u200bservice-discovery"),Object(o.a)("li",{parentName:"ul"},"vertx-\u200bconfig"),Object(o.a)("li",{parentName:"ul"},"vertx-\u200bcircuit-breaker")),Object(o.a)("h2",{id:"data-object-mapping-for-service-proxies"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#data-object-mapping-for-service-proxies"})),"Data object mapping for service proxies"),Object(o.a)("p",null,"Vert.x 3 ser\xadvice prox\xadies is a light\xadweight layer on top of Vert.x Event-\u200bBus pro\xadvid\xading typed con\xadtracts."),Object(o.a)("p",null,"One can eas\xadily cre\xadate a ser\xadvice on top of the Event-\u200bBus."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@VertxGen"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"DateService")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// callback the handler with the current date"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"date"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Handler<AsyncResult<String>> handler)"),"\n}\n"))),Object(o.a)("p",null,"Ser\xadvice prox\xadies re\xadquest/re\xadsponse pay\xadload are of type JSON."),Object(o.a)("p",null,"Of course ser\xadvice prox\xadies allow to map beans to JSON using data ob\xadjects but this comes with two caveats"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"only JSON ob\xadject can be mapped"),Object(o.a)("li",{parentName:"ul"},"the data ob\xadject must be a ",Object(o.a)("inlineCode",{parentName:"li"},"@DataObject")," an\xadno\xadtated bean with a ",Object(o.a)("inlineCode",{parentName:"li"},"toJson()")," method and a JSON ob\xadject con\xadstruc\xadtor")),Object(o.a)("p",null,"In Vert.x 4 we ex\xadtend the data ob\xadject sup\xadport to any Java class and any JSON type, e.g in this ex\xadam\xadple"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@VertxGen"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"DateService")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// encode the date with iso date format"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Mapper")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," String ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"toJson"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(ZonedDateTime value)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ZonedDateTime.format(value);\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// decode the date with iso date format"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Mapper")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ZonedDateTime ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"fromJson"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(String value)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," ZonedDateTime.parse(value);\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// callback the handler with the current date"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"date"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Handler<AsyncResult<ZonedDateTime>> handler)"),"\n}\n"))),Object(o.a)("p",null,"The gen\xader\xadated code will then use these map\xadpers to en\xadcode and de\xadcode JSON val\xadues."),Object(o.a)("p",null,"For reusabil\xadity map\xadpers can also be ",Object(o.a)("inlineCode",{parentName:"p"},"java.util.function.Function")," in\xadstead, e.g"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Mapper")," Function<String, ZonedDateTime) fromJson = ZonedDateTime::parse;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Mapper")," Function<ZonedDateTime, String> toJson = ZonedDateTime::toString;\n")),Object(o.a)("h2",{id:"mongo-client-gridfs"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#mongo-client-gridfs"})),"Mongo client GridFS"),Object(o.a)("p",null,"The client can store and re\xadtrieve files and bi\xadnary data using Mon\xadgoDB GridFS."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Future<String> fut = gridFsClient.uploadFile(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"file.name"'),");\n\nfut.setHandler(res -> {\n   ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (res.succeeded()) {\n     String id = res.result();\n     ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"//The ID of the stored object in Grid FS"),"\n   } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n     res.cause().printStackTrace();\n   }\n });\n")),Object(o.a)("p",null,"The client can per\xadform the usual CRUD op\xader\xada\xadtions on files and also pro\xadvide bucket man\xadage\xadment."),Object(o.a)("h2",{id:"vertx-web-utilities"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-web-utilities"})),"Vert.x Web utilities"),Object(o.a)("p",null,"While the rout\xading con\xadtext will allow you to ac\xadcess the un\xadder\xadly\xading re\xadquest and re\xadsponse ob\xadjects, some\xadtimes it will be\nmore pro\xadduc\xadtive if a few short\xadcuts would be present to help with com\xadmon tasks. A few helpers are present in\nthe con\xadtext to fa\xadcil\xadi\xadtate with this task."),Object(o.a)("p",null,"Serve an \u201cat\xadtach\xadment\u201d, an at\xadtach\xadment is a re\xadsponse that will trig\xadger the browser to open the re\xadsponse on the OS ap\xadpli\xadca\xadtion\ncon\xadfig\xadured to han\xaddle a spe\xadcific mime type. Imag\xadine you\u2019re gen\xader\xadat\xading a PDF:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"routingContext\n  .attachment(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"weekly-report.pdf"'),")\n  .end(pdfBuffer);\n")),Object(o.a)("p",null,"Per\xadform a redi\xadrect to a dif\xadfer\xadent page or host. One ex\xadam\xadple is to redi\xadrect to an HTTPS vari\xadant of the ap\xadpli\xadca\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"routingContext.redirect(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"https://securesite.com/"'),");\n")),Object(o.a)("p",null,"Send a JSON re\xadsponse to the client:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// no need to specify the content type headers"),"\nrc.json(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject().put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hello"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vert.x"'),"));\n")),Object(o.a)("p",null,"Sim\xadple con\xadtent type check:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (routingContext.is(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json"'),")) {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// ..."),"\n}\n")),Object(o.a)("p",null,"Ver\xadify if a re\xadquest is \u201cfresh\u201d with re\xadspect to the cache head\xaders and the cur\xadrent val\xadues of last mod\xadi\xadfied/ etag:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (rc.isFresh()) {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// client cache value is fresh perhaps we"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// can stop and return 304?"),"\n}\n")),Object(o.a)("h2",{id:"other-changes"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#other-changes"})),"Other changes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Groovy has been sim\xadpli\xadfied in Vert.x 4 to re\xadmove code gen\xader\xada\xadtion that was not re\xadally needed in prac\xadtice"),Object(o.a)("li",{parentName:"ul"},"The orig\xadi\xadnal Redis client dep\xadre\xadcated in 3.7 has been re\xadmoved re\xadplaced by the new Redis client"),Object(o.a)("li",{parentName:"ul"},"JSON changes",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"Jack\xadson data\xadbind is now an op\xadtional Maven de\xadpen\xaddency which means that ap\xadpli\xadca\xadtions need to ex\xadplic\xaditly add this de\xadpen\xaddency to the class\xadpath"),Object(o.a)("li",{parentName:"ul"},"Spe\xadcific Jack\xadson util\xadity meth\xadods are moved to spe\xadcific Jack\xadson classes"),Object(o.a)("li",{parentName:"ul"},"Vert.x can use an al\xadter\xadna\xadtive im\xadple\xadmen\xadta\xadtion than Jack\xadson for JSON en\xadcod\xading and JSON de\xadcod\xading"))),Object(o.a)("li",{parentName:"ul"},"The fol\xadlow\xading com\xadpo\xadnents have reached their end of life and have been pruned",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"MySQL / Post\xadgreSQL async client re\xadplaced by the Vert.x SQL Client (since 3.8)"),Object(o.a)("li",{parentName:"ul"},"AMQP bridge re\xadplaced by the Vert.x AMQP Client (since 3.7)")))),Object(o.a)("h2",{id:"ramping-up-to-vertx-4"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#ramping-up-to-vertx-4"})),"Ramping up to Vert.x 4"),Object(o.a)("p",null,"In\xadstead of de\xadvel\xadop\xading all new fea\xadtures ex\xadclu\xadsively in Vert.x 4, we in\xadtro\xadduce some of these fea\xadtures in the 3.x branch\nso the com\xadmu\xadnity can ben\xade\xadfit from them. The Vert.x 4 de\xadvel\xadop\xadment focus on more fun\xadda\xadmen\xadtal changes that can\xadnot be done\nin the 3.x se\xadries."),Object(o.a)("img",{src:"{{ site_url }}assets/blog/vertx-4-milestone3-release/vertx-4-timeline.png",alt:"Screenshot",className:"img-responsive"}),Object(o.a)("p",null,"This is the third mile\xadstone of Vert.x 4, we aim to re\xadlease Vert.x 4 by the end of this year and you can of course\nex\xadpect more mile\xadstones to out\xadline the progress of the ef\xadfort."),Object(o.a)("h2",{id:"finally"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finally"})),"Finally"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes"),"\ncan be found on the wiki."),Object(o.a)("p",null,"For this re\xadlease there are no Docker im\xadages.,"),Object(o.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://search.maven.org/search?q=g:io.vertx%20AND%20v:4.0.0-milestone3"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://repo1.maven.org/maven2/io/vertx/vertx-stack-manager/4.0.0-milestone3/"}),"Maven Cen\xadtral"),"."),Object(o.a)("p",null,"You can boot\xadstrap a Vert.x 4.0.0-\u200bmilestone3 project using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(o.a)("p",null,"The doc\xadu\xadmen\xadta\xadtion has been de\xadployed on this pre\xadview web-\u200bsite ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx-ci.github.io/vertx-4-preview/docs/"}),"https://vertx-\u200bci.github.io/vertx-\u200b4-\u200bpreview/docs/")),Object(o.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},i72n:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 4 milestone 1 released!",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This is the first milestone of the upcoming Vert.x 4. It extends the 3.x callback asynchronous model to a future/callback hybrid model and introduces a Tracing API."}),i=[{term:"mileston",tf:5},{term:"releas",tf:5},{term:"trace",tf:5},{term:"applic",tf:5},{term:"client",tf:5},{term:"first",tf:3},{term:"will",tf:3},{term:"featur",tf:3},{term:"provid",tf:3},{term:"distribut",tf:3},{term:"develop",tf:3},{term:"asynchron",tf:3},{term:"model",tf:3},{term:"librari",tf:3},{term:"not",tf:3},{term:"flow",tf:3},{term:"request",tf:3},{term:"chang",tf:3},{term:"replac",tf:3},{term:"seri",tf:2},{term:"aim",tf:2},{term:"try",tf:2},{term:"core",tf:2},{term:"callback",tf:2},{term:"futur",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We are ex\xadtremely pleased to an\xadnounce the first 4.0 mile\xadstone re\xadlease of Eclipse Vert.x ."),Object(o.a)("p",null,"Vert.x 4 is the evo\xadlu\xadtion of the Vert.x 3.x se\xadries that will bring key fea\xadtures to Vert.x."),Object(o.a)("p",null,"This re\xadlease aims to pro\xadvide a re\xadli\xadable dis\xadtri\xadb\xadu\xadtion of the cur\xadrent de\xadvel\xadop\xadment of Vert.x 4 for peo\xadple that\nwant to try it and pro\xadvide feed\xadback."),Object(o.a)("h2",{id:"core-futurisation"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#core-futurisation"})),"Core futurisation"),Object(o.a)("p",null,"Vert.x 4 ex\xadtends the 3.x call\xadback asyn\xadchro\xadnous model to a fu\xadture/call\xadback hy\xadbrid model."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"interface")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"NetClient")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Since 3.0"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host, Handler<AsyncResult<NetSocket>> handler)")),";\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// New in 4.0"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),"Future<NetSocket> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"connect"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," port, String host)")),";\n}\n")),Object(o.a)("p",null,"In this first mile\xadstone, only the ",Object(o.a)("em",{parentName:"p"},"Vert.x Core")," li\xadbrary con\xadtains the hy\xadbrid model. More Vert.x com\xadpo\xadnents\nwill be fu\xadtur\xadized soon and you will be able to try them in the next mile\xadstones."),Object(o.a)("h2",{id:"tracing"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#tracing"})),"Tracing"),Object(o.a)("p",null,"In\xadstru\xadment\xading asyn\xadchro\xadnous ap\xadpli\xadca\xadtion for dis\xadtrib\xaduted trac\xading is quite chal\xadleng\xading be\xadcause most trac\xading li\xadbraries\nrely on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://fr.wikipedia.org/wiki/Thread_Local_Storage"}),"thread local stor\xadage"),". While it works rea\xadson\xadably well\nin a block\xading ap\xadpli\xadca\xadtion, this does not work for an asyn\xadchro\xadnous ap\xadpli\xadca\xadtion."),Object(o.a)("p",null,"This sup\xadposes that the ap\xadpli\xadca\xadtion con\xadtrol flow mat\xadters (i.e threads) al\xadthough what re\xadally mat\xadters is the ap\xadpli\xadca\xadtion\nre\xadquest flow (e.g the in\xadcom\xading HTTP re\xadquest)."),Object(o.a)("p",null,"We im\xadproved Vert.x 4 to reify the re\xadquest flow, mak\xading it pos\xadsi\xadble to in\xadte\xadgrate pop\xadu\xadlar trac\xading tools such as ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://zipkin.io"}),"Zip\xadkin"),"\nor ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://opentracing.io"}),"Open\xadtrac\xading"),". Vert.x per\xadfor\xadmance is leg\xadendary and we made sure that this does not have\nany over\xadhead out of the box (dis\xadabled)."),Object(o.a)("p",null,"We pro\xadvide sup\xadport for these two pop\xadu\xadlar li\xadbraries under the ",Object(o.a)("em",{parentName:"p"},"Vert.x Trac\xading")," um\xadbrella."),Object(o.a)("h2",{id:"other-changes"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#other-changes"})),"Other changes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Groovy has been sim\xadpli\xadfied in Vert.x 4 to re\xadmove code gen\xader\xada\xadtion that was not re\xadally needed in prac\xadtice"),Object(o.a)("li",{parentName:"ul"},"The orig\xadi\xadnal Redis client dep\xadre\xadcated in 3.7 has been re\xadmoved re\xadplaced by the new Redis client"),Object(o.a)("li",{parentName:"ul"},"The fol\xadlow\xading com\xadpo\xadnents have reached their end of life and have been pruned",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"MySQL / Post\xadgreSQL async client re\xadplaced by the Vert.x SQL Client (since 3.8)"),Object(o.a)("li",{parentName:"ul"},"AMQP bridge re\xadplaced by the Vert.x AMQP Client (since 3.7)")))),Object(o.a)("h2",{id:"ramping-up-to-vertx-4"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#ramping-up-to-vertx-4"})),"Ramping up to Vert.x 4"),Object(o.a)("p",null,"In\xadstead of de\xadvel\xadop\xading all new fea\xadtures ex\xadclu\xadsively in Vert.x 4, we in\xadtro\xadduce some of these fea\xadtures in the 3.x branch\nso the com\xadmu\xadnity can ben\xade\xadfit from them. The Vert.x 4 de\xadvel\xadop\xadment focus on more fun\xadda\xadmen\xadtal changes that can\xadnot be done\nin the 3.x se\xadries."),Object(o.a)("img",{src:"{{ site_url }}assets/blog/vertx-4-milestone1-release/vertx-4-timeline.png",alt:"Screenshot",class:"img-responsive"}),Object(o.a)("p",null,"This is the first mile\xadstone of Vert.x 4, we aim to re\xadlease Vert.x 4 by the end of this year and you can of course\nex\xadpect more mile\xadstones to out\xadline the progress of the ef\xadfort."),Object(o.a)("h2",{id:"finally"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#finally"})),"Finally"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/4.0.0-Deprecations-and-breaking-changes"}),"dep\xadre\xadca\xadtions and break\xading changes"),"\ncan be found on the wiki."),Object(o.a)("p",null,"For this re\xadlease there are no Docker im\xadages.,"),Object(o.a)("p",null,"The re\xadlease ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://search.maven.org/search?q=g:io.vertx%20AND%20v:4.0.0-milestone1"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://repo1.maven.org/maven2/io/vertx/vertx-stack-manager/4.0.0-milestone1/"}),"Maven Cen\xadtral"),"."),Object(o.a)("p",null,"Most im\xadpor\xadtantly the doc\xadu\xadmen\xadta\xadtion has been de\xadployed on this pre\xadview web-\u200bsite ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx-ci.github.io/vertx-4-preview/docs/"}),"https://vertx-\u200bci.github.io/vertx-\u200b4-\u200bpreview/docs/")),Object(o.a)("p",null,"That\u2019s it! Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},j61u:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return i})),t.d(a,"__tfidf__terms",(function(){return p})),t.d(a,"default",(function(){return j}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("280p"),i=(r.a.createElement,{title:"Vert.x 3 init.d Script",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"Let's say you have a Vert.x 3 application you want to install on a Linux server. But you want the old school way (I mean not the Docker way)."}),p=[{term:"script",tf:10},{term:"applic",tf:9},{term:"start",tf:8},{term:"us",tf:7},{term:"need",tf:4},{term:"stop",tf:4},{term:"set",tf:4},{term:"let",tf:3},{term:"not",tf:3},{term:"init",tf:3},{term:"command",tf:3},{term:"want",tf:2},{term:"propos",tf:2},{term:"restart",tf:2},{term:"hook",tf:2},{term:"boot",tf:2},{term:"shutdown",tf:2},{term:"sequenc",tf:2},{term:"system",tf:2},{term:"variabl",tf:2},{term:"file",tf:2},{term:"sai",tf:1},{term:"instal",tf:1},{term:"linux",tf:1},{term:"server",tf:1}],m={meta:i,__tfidf__terms:p};function j(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},m,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Let\u2019s say you have a Vert.x 3 ap\xadpli\xadca\xadtion you want to in\xadstall on a Linux server. But you want the ",Object(o.a)("em",{parentName:"p"},"old school")," way (I mean not the Docker way ","\u263a","). So, in other words, you need an ",Object(o.a)("em",{parentName:"p"},"init.d")," script. This post pro\xadposes an ",Object(o.a)("em",{parentName:"p"},"init.d")," script that you can use to start/stop/restart a Vert.x 3 ap\xadpli\xadca\xadtion."),Object(o.a)("h2",{id:"prerequisites"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#prerequisites"})),"Prerequisites"),Object(o.a)("p",null,"The pro\xadposed script as\xadsumes your ap\xadpli\xadca\xadtion is pack\xadaged as a ",Object(o.a)("em",{parentName:"p"},"fat jar"),". So, your ap\xadpli\xadca\xadtion is going to be launched using ",Object(o.a)("inlineCode",{parentName:"p"},"java -jar your-fat-jar ..."),"."),Object(o.a)("h2",{id:"the-script"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#the-script"})),"The script"),Object(o.a)("p",null,"The ",Object(o.a)("em",{parentName:"p"},"init.d")," scripts have to reply to a set of ",Object(o.a)("em",{parentName:"p"},"com\xadmands"),":"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"start")," : starts the ap\xadpli\xadca\xadtion (if not yet started)"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"stop")," : stops the ap\xadpli\xadca\xadtion (if started)"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"status")," : let you know if the ap\xadpli\xadca\xadtion is started or not"),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"restart")," : restart the ap\xadpli\xadca\xadtion")),Object(o.a)("p",null,"These ",Object(o.a)("em",{parentName:"p"},"com\xadmands")," are in\xadvoked using:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"service my-service-script start\nservice my-service-script stop\nservice my-service-script status\nservice my-service-script restart\n")),Object(o.a)("p",null,"In gen\xaderal, ser\xadvice scripts are hooked in the boot and shut\xaddown se\xadquences to start and stop au\xadto\xadmat\xadi\xadcally dur\xading the sys\xadtem starts and stops."),Object(o.a)("p",null,"So, enough talks, let\u2019s look at the script:"),Object(o.a)(l.a,{url:"https://gist.github.com/cescoffier/ccc8b391787e93f4e6e0",mdxType:"Gist"}),Object(o.a)("h2",{id:"using-the-script"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#using-the-script"})),"Using the script"),Object(o.a)("p",null,"First down\xadload the script from the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gist.githubusercontent.com/cescoffier/ccc8b391787e93f4e6e0/raw/my-vertx-application"}),"here"),"."),Object(o.a)("p",null,"You need to set a cou\xadple of vari\xadables lo\xadcated at the be\xadgin\xadning of the file:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-ini"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"# The directory in which your application is installed"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"APPLICATION_DIR"),"=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/opt/my-vertx-app"'),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"# The fat jar containing your application"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"APPLICATION_JAR"),"=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"maven-verticle-3.0.0-fat.jar"'),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"# The application argument such as -cluster -cluster-host ..."),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"APPLICATION_ARGS"),"=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'""'),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"# vert.x options and system properties (-Dfoo=bar)."),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"VERTX_OPTS"),"=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'""'),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"# The path to the Java command to use to launch the application (must be java 8+)"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"JAVA"),"=/opt/java/java/bin/java\n")),Object(o.a)("p",null,"The rest of the script can stay as it is, but feel free to adapt it to your needs. Once you have set these vari\xadables based on your en\xadvi\xadron\xadment, move the file to ",Object(o.a)("inlineCode",{parentName:"p"},"/etc/init.d")," and set it as ex\xade\xadcutable:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"sudo mv my-vertx-application /etc/init.d\nsudo chmod +x my-vertx-application\n")),Object(o.a)("p",null,"Then, you should be able to start your ap\xadpli\xadca\xadtion using:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"sudo service my-vertx-application start\n")),Object(o.a)("p",null,"De\xadpend\xading to your op\xader\xadat\xading sys\xadtem, adding the hooks to the boot and shut\xaddown se\xadquence dif\xadfers. For in\xadstance on Ubuntu you need to use the ",Object(o.a)("inlineCode",{parentName:"p"},"update-rc.d")," com\xadmand while on Cen\xadtOS ",Object(o.a)("inlineCode",{parentName:"p"},"chkconfig")," is used"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"That\u2019s all, enjoy !")))}j.isMDXComponent=!0},kFeL:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3 says \u201chello\u201d to NPM users",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"In programming literature it has become the standard to create a hello world program as the first example. In this article, I'll demonstrate how NPM users can quickly get started with Vert.x."}),i=[{term:"hello",tf:11},{term:"exampl",tf:8},{term:"world",tf:7},{term:"start",tf:7},{term:"us",tf:7},{term:"simpl",tf:6},{term:"will",tf:5},{term:"server",tf:5},{term:"not",tf:4},{term:"depend",tf:4},{term:"need",tf:4},{term:"web",tf:4},{term:"applic",tf:4},{term:"respond",tf:4},{term:"program",tf:3},{term:"note",tf:3},{term:"code",tf:3},{term:"test",tf:3},{term:"http",tf:3},{term:"messag",tf:3},{term:"tcp",tf:3},{term:"first",tf:2},{term:"differ",tf:2},{term:"done",tf:2},{term:"re",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"In pro\xadgram\xadming lit\xader\xada\xadture it has be\xadcome the stan\xaddard to cre\xadate a hello world pro\xadgram as the first ex\xadam\xadple. In this\nar\xadti\xadcle, I\u2019ll be demon\xadstrat\xading how ",Object(o.a)("inlineCode",{parentName:"p"},"NPM")," users can quickly get started with ",Object(o.a)("inlineCode",{parentName:"p"},"vert.x"),". You will see that it is not\nthat dif\xadfer\xadent and in fact it can be done using the tools you\u2019re used to. Note that al\xadthough we are using ",Object(o.a)("inlineCode",{parentName:"p"},"NPM")," we are\nnot re\xadly\xading on ",Object(o.a)("inlineCode",{parentName:"p"},"node.js"),", all ",Object(o.a)("inlineCode",{parentName:"p"},"javascript")," code runs on the ",Object(o.a)("inlineCode",{parentName:"p"},"JVM"),"."),Object(o.a)("h2",{id:"hello-world-examples"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#hello-world-examples"})),"Hello World Examples"),Object(o.a)("p",null,"Here are four sim\xadple hello world ex\xadam\xadples. The com\xadments in the code ex\xadplain how the code works and the text around it\nex\xadplain what it does and how to test it."),Object(o.a)("h2",{id:"hello-console"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#hello-console"})),"Hello Console"),Object(o.a)("p",null,"This ex\xadam\xadple is about as plain as it can get. It prints the words \u201d",Object(o.a)("inlineCode",{parentName:"p"},"Hello World"),"\u201d to the ter\xadmi\xadnal. If you\u2019re a\njavascript de\xadvel\xadoper you should be al\xadready used to ",Object(o.a)("inlineCode",{parentName:"p"},"npm")," and know that you al\xadways start a project with the file\n",Object(o.a)("inlineCode",{parentName:"p"},"package.json"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx3-hello-console"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"private"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"dependencies"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx3-min"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"3.0.0-1"'),"\n  },\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scripts"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"start"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"./node_modules/.bin/vertx run server.js"'),"\n  }\n}\n")),Object(o.a)("p",null,"Note that we have a de\xadpen\xaddency wich is ob\xadvi\xadous ",Object(o.a)("inlineCode",{parentName:"p"},"vert.x")," now note that there are 3 flavours of this de\xadpen\xaddency:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-min"}),"min")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-base"}),"base")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-full"}),"full"))),Object(o.a)("p",null,"Ac\xadcord\xading to your needs you can pick a dif\xadfer\xadent flavour, since for a sim\xadple hello world we only need the min\xadi\xadmal that\nis the one we add to the de\xadpen\xaddency prop\xaderty."),Object(o.a)("p",null,"Now we need to do a sim\xadple hello app, we will call this file \u201d",Object(o.a)("inlineCode",{parentName:"p"},"server.js"),"\u201c:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Call the console.log function."),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"console"),".log(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello World"'),");\n")),Object(o.a)("p",null,"You can run this by ex\xade\xadcut\xading:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"npm install\nnpm start\n")),Object(o.a)("p",null,"The first com\xadmand re\xadtrieve the vert.x stack while the sec\xadonds starts your pro\xadgram."),Object(o.a)("h2",{id:"hello-http"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#hello-http"})),"Hello HTTP"),Object(o.a)("p",null,"I\u2019d guess that while it\u2019s not the only use case for ",Object(o.a)("inlineCode",{parentName:"p"},"vert.x"),", most peo\xadple are using it as a web ap\xadpli\xadca\xadtion plat\xadform. So\nthe next ex\xadam\xadple will be a sim\xadple HTTP server that re\xadsponds to every re\xadquest with the plain text mes\xadsage \u201d",Object(o.a)("inlineCode",{parentName:"p"},"Hello World"),"\u201d\n",Object(o.a)("inlineCode",{parentName:"p"},"server.js"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"vertx.createHttpServer()\n  .requestHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"req"),") "),"{\n    req.response()\n      .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/plain"'),")\n      .end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello World!"'),");\n}).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(o.a)("p",null,"Now you can reuse the same ",Object(o.a)("inlineCode",{parentName:"p"},"package.json")," we\u2019ve just de\xadfined in the pre\xadvi\xadous sec\xadtion and start the server with\n",Object(o.a)("inlineCode",{parentName:"p"},"npm start"),". Once the server starts you can open a browser to ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8080")," and enjoy the mes\xadsage."),Object(o.a)("h2",{id:"hello-tcp"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#hello-tcp"})),"Hello TCP"),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"Vert.x")," also makes an ex\xadcel\xadlent TCP server, and here is an ex\xadam\xadple that re\xadsponds to all TCP con\xadnec\xadtions with the\nmes\xadsage \u201cHello World\u201d and then closes the con\xadnec\xadtion ",Object(o.a)("inlineCode",{parentName:"p"},"server.js"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," server = vertx.createNetServer();\nserver.connectHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"socket"),") "),"{\n  socket.write(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello World!\\n"'),");\n  socket.close();\n});\n\nserver.listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"7000"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),");\n")),Object(o.a)("p",null,"Again reuse the pre\xadvi\xadous ",Object(o.a)("inlineCode",{parentName:"p"},"package.json")," and test it by doing ",Object(o.a)("inlineCode",{parentName:"p"},"telnet localhost 7000"),"."),Object(o.a)("h2",{id:"hello-web"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#hello-web"})),"Hello Web"),Object(o.a)("p",null,"Often you won\u2019t be using ",Object(o.a)("inlineCode",{parentName:"p"},"vert.x")," built-\u200bin li\xadbraries be\xadcause they are de\xadsigned to be very low level. This makes ",Object(o.a)("inlineCode",{parentName:"p"},"vert.x"),"\nquick, nim\xadble, and easy to main\xadtain, but if you are plan\xadning to build a com\xadplex ap\xadpli\xadca\xadtion you want some pro\xadduc\xadtiv\xadity\nand rely on a sim\xadple web frame\xadwork. For this spe\xadcific case there is ",Object(o.a)("inlineCode",{parentName:"p"},"vert.x web"),",\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/#web"}),"a sim\xadple, yet pro\xadduc\xadtive frame\xadwork"),", to build fast web ap\xadpli\xadca\xadtion with rout\xading, tem\xadplate\nren\xadder\xading, lots of mid\xaddle\xadware etc\u2026usu\xadally not enough to get started on a real world ap\xadpli\xadca\xadtion. This ex\xadam\xadple shows an\nHTTP server that re\xadsponds with \u201cHello World\u201d to all re\xadquests to \u201d/\u201d and re\xadsponds with a 404 error to every\xadthing else\n",Object(o.a)("inlineCode",{parentName:"p"},"server.js"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," Router = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"require"),"(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx-web-js/router"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," server = vertx.createHttpServer();\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," router = Router.router(vertx);\n\nrouter.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"function")," (",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"ctx"),") "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// This handler will be called for "/" requests'),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"var")," response = ctx.response();\n  response.putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"text/plain"'),");\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Write to the response and end it"),"\n  response.end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello World!"'),");\n});\n\nserver.requestHandler(router.accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(o.a)("p",null,"In order to test this, you will need to in\xadstall the ",Object(o.a)("inlineCode",{parentName:"p"},"vertx3-full")," stack. There are two ways to do this. You can ei\xadther\nin\xadstall it glob\xadally ",Object(o.a)("inlineCode",{parentName:"p"},"npm install -g vertx3-full")," or add it as a de\xadpen\xaddency to our ",Object(o.a)("inlineCode",{parentName:"p"},"package.json")," as we have done be\xadfore,\nfor ex\xadam\xadple ",Object(o.a)("inlineCode",{parentName:"p"},"package.json"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-javascript"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx3-hello-web"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"private"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"dependencies"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"vertx3-full"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"3.0.0-1"'),"\n  },\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scripts"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"start"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"./node_modules/.bin/vertx run server.js"'),"\n  }\n}\n")),Object(o.a)("p",null,"That\u2019s it for now. Hope\xadfully this will help you get started work\xading with ",Object(o.a)("inlineCode",{parentName:"p"},"vert.x"),"!"))}m.isMDXComponent=!0},kixY:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x Blueprint Tutorials",category:"guides",authors:[{name:"Eric Zhao",github_id:"sczyh30"}],summary:"The Vert.x Blueprint project aims to provide guidelines to Vert.x users to implement various applications such as message-based applications and microservices."}),i=[{term:"blueprint",tf:20},{term:"develop",tf:14},{term:"microservic",tf:10},{term:"us",tf:10},{term:"kue",tf:9},{term:"version",tf:9},{term:"tutori",tf:8},{term:"applic",tf:7},{term:"todo",tf:6},{term:"backend",tf:6},{term:"english",tf:6},{term:"event",tf:6},{term:"implement",tf:5},{term:"messag",tf:5},{term:"shop",tf:5},{term:"servic",tf:5},{term:"base",tf:4},{term:"chines",tf:4},{term:"redi",tf:4},{term:"web",tf:4},{term:"api",tf:4},{term:"asynchron",tf:4},{term:"pattern",tf:4},{term:"bu",tf:4},{term:"project",tf:3}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"The Vert.x Blue\xadprint project aims to pro\xadvide guide\xadlines to Vert.x users to im\xadple\xadment var\xadi\xadous ap\xadpli\xadca\xadtions such as message-\u200bbased ap\xadpli\xadca\xadtions and mi\xadcroser\xadvices. This post in\xadtro\xadduces the con\xadtent of each blue\xadprints."),Object(o.a)("p",null,"This work has been done in the con\xadtext of a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://developers.google.com/open-source/gsoc/"}),"Google Sum\xadmer of Code project")," ."),Object(o.a)("h1",{id:"overview"},Object(o.a)("a",Object(n.a)({parentName:"h1"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#overview"})),"Overview"),Object(o.a)("p",null,"The blue\xadprint project con\xadtains three parts: ",Object(o.a)("strong",{parentName:"p"},"Todo Back\xadend"),", ",Object(o.a)("strong",{parentName:"p"},"Vert.x Kue")," and ",Object(o.a)("strong",{parentName:"p"},"On\xadline Shop\xadping Mi\xadcroser\xadvice"),". Both runnable code and very de\xadtailed doc\xadu\xadments and tu\xadto\xadri\xadals (both in Eng\xadlish and Chi\xadnese) are pro\xadvided."),Object(o.a)("h1",{id:"vertx-blueprint---todo-backend"},Object(o.a)("a",Object(n.a)({parentName:"h1"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-blueprint---todo-backend"})),"Vert.x Blueprint - Todo Backend"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Repos\xadi\xadtory"),": ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/sczyh30/vertx-blueprint-todo-backend"}),"sczyh30/vertx-\u200bblueprint-todo-backend"),"."),Object(o.a)("p",null,"This blue\xadprint is a todo-\u200bbackend im\xadple\xadmen\xadta\xadtion using Vert.x and var\xadi\xadous per\xadsis\xadtence (e.g. Redis or MySQL). It is in\xadtended to be an in\xadtro\xadduc\xadtion to basic Vert.x web REST\xadful ser\xadvice de\xadvel\xadop\xadment. From this blue\xadprint, de\xadvel\xadop\xaders  learn:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"What is Vert.x and its prin\xadci\xadples"),Object(o.a)("li",{parentName:"ul"},"What is and how to use ",Object(o.a)("inlineCode",{parentName:"li"},"Verticle")),Object(o.a)("li",{parentName:"ul"},"How to de\xadvelop a REST API using ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-web/java/"}),"Vert.x Web")),Object(o.a)("li",{parentName:"ul"},"How to make use of ",Object(o.a)("strong",{parentName:"li"},"asyn\xadchro\xadnous de\xadvel\xadop\xadment model")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"Future"),"-\u200bbased asyn\xadchro\xadnous pat\xadterns"),Object(o.a)("li",{parentName:"ul"},"How to use per\xadsis\xadtence such as ",Object(o.a)("em",{parentName:"li"},"Redis")," and ",Object(o.a)("em",{parentName:"li"},"MySQL")," with the help of Vert.x async data")),Object(o.a)("p",null,"The tu\xadto\xadri\xadals are:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-todo-backend/"}),"Vert.x Blue\xadprint - Todo Back\xadend (Eng\xadlish ver\xadsion)")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-todo-backend/cn/"}),"Vert.x Blue\xadprint - Todo Back\xadend (Chi\xadnese ver\xadsion)"))),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"https://raw.githubusercontent.com/sczyh30/vertx-blueprint-todo-backend/master/docs/img/vertx-todobackend-ui.png",alt:null}))),Object(o.a)("h1",{id:"vertx-blueprint---vertx-kue"},Object(o.a)("a",Object(n.a)({parentName:"h1"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-blueprint---vertx-kue"})),"Vert.x Blueprint - Vert.x Kue"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Repos\xadi\xadtory"),": ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/sczyh30/vertx-blueprint-job-queue"}),"sczyh30/vertx-\u200bblueprint-job-queue"),"."),Object(o.a)("p",null,"This blue\xadprint is a pri\xador\xadity job queue de\xadvel\xadoped with Vert.x and backed by Redis. It\u2019s a Vert.x im\xadple\xadmen\xadta\xadtion ver\xadsion of ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Automattic/kue"}),"Au\xadtomat\xadtic/kue")," that can be used in pro\xadduc\xadtion."),Object(o.a)("p",null,"The list of fea\xadtures pro\xadvided by Vert.x Kue is avail\xadable here: ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/sczyh30/vertx-blueprint-job-queue/blob/master/docs/en/vertx-kue-features-en.md"}),"Vert.x Kue Fea\xadtures"),"."),Object(o.a)("p",null,"This blue\xadprint is in\xadtended to be an in\xadtro\xadduc\xadtion to message-\u200bbased ap\xadpli\xadca\xadtion de\xadvel\xadop\xadment using Vert.x. From this blue\xadprint, de\xadvel\xadop\xaders learn:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"How to make use of ",Object(o.a)("strong",{parentName:"li"},"Vert.x Event Bus")," (dis\xadtrib\xaduted)"),Object(o.a)("li",{parentName:"ul"},"How to de\xadvelop mes\xadsage based ap\xadpli\xadca\xadtions with Vert.x"),Object(o.a)("li",{parentName:"ul"},"Event and mes\xadsage pat\xadterns with the event bus (Pub/sub, point to point)"),Object(o.a)("li",{parentName:"ul"},"How to de\xadsign clus\xadtered Vert.x ap\xadpli\xadca\xadtions"),Object(o.a)("li",{parentName:"ul"},"How to de\xadsign and im\xadple\xadment a job queue"),Object(o.a)("li",{parentName:"ul"},"How to use ",Object(o.a)("strong",{parentName:"li"},"Vert.x Ser\xadvice Proxy")),Object(o.a)("li",{parentName:"ul"},"More com\xadplex usage of ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-redis-client/java/"}),"Vert.x Redis"))),Object(o.a)("p",null,"The tu\xadto\xadr\xadial are:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Eng\xadlish ver\xadsion",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-job-queue/kue-core/index.html"}),"Vert.x Kue Core Tu\xadto\xadr\xadial - Eng\xadlish Ver\xadsion")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-job-queue/kue-http/index.html"}),"Vert.x Kue Web Tu\xadto\xadr\xadial - Eng\xadlish Ver\xadsion")))),Object(o.a)("li",{parentName:"ul"},"Chi\xadnese ver\xadsion",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-job-queue/cn/kue-core/index.html"}),"Vert.x \u84dd\u56fe - Vert.x Kue (Core\u90e8\u5206)")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-job-queue/cn/kue-http/index.html"}),"Vert.x \u84dd\u56fe - Vert.x Kue (Web\u90e8\u5206)"))))),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"https://raw.githubusercontent.com/sczyh30/vertx-blueprint-job-queue/master/docs/images/vertx_kue_ui_1.png",alt:null}))),Object(o.a)("h1",{id:"vertx-blueprint---online-shopping-microservice"},Object(o.a)("a",Object(n.a)({parentName:"h1"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-blueprint---online-shopping-microservice"})),"Vert.x Blueprint - Online Shopping Microservice"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Repos\xadi\xadtory"),": ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/sczyh30/vertx-blueprint-microservice"}),"sczyh30/vertx-\u200bblueprint-microservice"),"."),Object(o.a)("p",null,"This blue\xadprint is a micro-\u200bshop mi\xadcroser\xadvice ap\xadpli\xadca\xadtion de\xadvel\xadoped with Vert.x. It is in\xadtended to be an il\xadlus\xadtra\xadtion on how to de\xadvelop mi\xadcroser\xadvice ap\xadpli\xadca\xadtions using Vert.x. From this blue\xadprint, de\xadvel\xadop\xaders learn:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Mi\xadcroser\xadvice de\xadvel\xadop\xadment with Vert.x"),Object(o.a)("li",{parentName:"ul"},"Asyn\xadchro\xadnous de\xadvel\xadop\xadment model"),Object(o.a)("li",{parentName:"ul"},"Re\xadac\xadtive pat\xadterns"),Object(o.a)("li",{parentName:"ul"},"Event sourc\xading pat\xadterns"),Object(o.a)("li",{parentName:"ul"},"Asyn\xadchro\xadnous RPC on the clus\xadtered event bus"),Object(o.a)("li",{parentName:"ul"},"Var\xadi\xadous type of ser\xadvices (e.g. HTTP end\xadpoint, mes\xadsage source, event bus ser\xadvice)"),Object(o.a)("li",{parentName:"ul"},"Vert.x Ser\xadvice Dis\xadcov\xadery"),Object(o.a)("li",{parentName:"ul"},"Vert.x Cir\xadcuit Breaker"),Object(o.a)("li",{parentName:"ul"},"Mi\xadcroser\xadvice with poly\xadglot per\xadsis\xadtence"),Object(o.a)("li",{parentName:"ul"},"How to im\xadple\xadment an API Gate\xadway"),Object(o.a)("li",{parentName:"ul"},"Global au\xadthen\xadti\xadca\xadtion (OAuth 2 + Key\xadcloak)")),Object(o.a)("p",null,"And many more things\u2026"),Object(o.a)("p",null,"The tu\xadto\xadr\xadial are:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Eng\xadlish ver\xadsion",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-microservice/index.html"}),"Vert.x Mi\xadcroser\xadvice Blue\xadprint Tu\xadto\xadr\xadial - De\xadvel\xadop\xadment")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-microservice/api-gateway.html"}),"Vert.x Mi\xadcroser\xadvice Blue\xadprint Tu\xadto\xadr\xadial - API Gate\xadway")))),Object(o.a)("li",{parentName:"ul"},"Chi\xadnese ver\xadsion",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-microservice/cn/index.html"}),"Vert.x \u84dd\u56fe - Micro Shop \u5fae\u670d\u52a1\u5b9e\u6218 (\u5f00\u53d1\u7bc7)")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://sczyh30.github.io/vertx-blueprint-microservice/cn/api-gateway.html"}),"Vert.x \u84dd\u56fe - Micro Shop \u5fae\u670d\u52a1\u5b9e\u6218 (API Gate\xadway)"))))),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"https://raw.githubusercontent.com/sczyh30/vertx-blueprint-microservice/master/docs/images/shopping-spa-product-detail.png",alt:null}))),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"https://raw.githubusercontent.com/sczyh30/vertx-blueprint-microservice/master/docs/images/monitor-dashboard.png",alt:null}))),Object(o.a)("p",null,"Enjoy the code car\xadni\xadval with Vert.x!"))}m.isMDXComponent=!0},kxuk:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Dynamic Routing in Serverless Microservice with Vert.x Event Bus",category:"guides",authors:[{name:"Rowell Belen",github_id:"bytekast"}],summary:"The Serverless Framework has become the de facto toolkit for building and deploying serverless functions or applications."}),i=[{term:"function",tf:11},{term:"serverless",tf:8},{term:"event",tf:8},{term:"lambda",tf:7},{term:"api",tf:6},{term:"handler",tf:6},{term:"singl",tf:5},{term:"line",tf:5},{term:"build",tf:4},{term:"deploi",tf:4},{term:"applic",tf:4},{term:"aw",tf:4},{term:"microservic",tf:4},{term:"user",tf:4},{term:"bu",tf:4},{term:"framework",tf:3},{term:"toolkit",tf:3},{term:"commun",tf:3},{term:"code",tf:3},{term:"will",tf:3},{term:"exampl",tf:3},{term:"request",tf:3},{term:"us",tf:3},{term:"block",tf:3},{term:"asynchron",tf:3}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"[NOTE this is a re-\u200bpublication of the fol\xadlow\xading ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.rowellbelen.com/dynamic-routing-in-serverless-microservice-with-vert-x-event-bus/"}),"blog post"),"]"),Object(o.a)("h2",{id:"serverless-framework"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#serverless-framework"})),"Serverless framework"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://serverless.com"}),"Server\xadless Frame\xadwork")," has be\xadcome the ",Object(o.a)("em",{parentName:"p"},"De Facto")," toolkit for build\xading and de\xadploy\xading Server\xadless func\xadtions or ap\xadpli\xadca\xadtions. Its com\xadmu\xadnity has done a great job ad\xadvanc\xading the tools around Server\xadless ar\xadchi\xadtec\xadture."),Object(o.a)("p",null,"How\xadever, in the Server\xadless com\xadmu\xadnity there is de\xadbate among de\xadvel\xadop\xaders on whether a sin\xadgle ",Object(o.a)("strong",{parentName:"p"},"AWS Lambda")," func\xadtion should only be re\xadspon\xadsi\xadble for a sin\xadgle API end\xadpoint. My an\xadswer, based on my real-\u200bworld pro\xadduc\xadtion ex\xadpe\xadri\xadence, is ",Object(o.a)("strong",{parentName:"p"},"NO"),". "),Object(o.a)("p",null,"Imag\xadine if you are build\xading a set of APIs with ",Object(o.a)("strong",{parentName:"p"},"10")," end\xadpoints and you need to de\xadploy the APIs to ",Object(o.a)("strong",{parentName:"p"},"DEV"),", ",Object(o.a)("strong",{parentName:"p"},"STAGE")," and ",Object(o.a)("strong",{parentName:"p"},"PROD")," en\xadvi\xadron\xadments. Now you are look\xading at ",Object(o.a)("strong",{parentName:"p"},"30")," dif\xadfer\xadent func\xadtions to ver\xadsion, de\xadploy and man\xadage - not to men\xadtion the ",Object(o.a)("em",{parentName:"p"},"Copy & Paste")," code and con\xadfig\xadu\xadra\xadtion that will re\xadsult from this type of set-\u200bup. ",Object(o.a)("strong",{parentName:"p"},"NO THANKS!!!")," "),Object(o.a)("p",null,"I be\xadlieve a more prag\xadmatic ap\xadproach is ",Object(o.a)("strong",{parentName:"p"},"1 Lambda Func\xadtion")," == ",Object(o.a)("strong",{parentName:"p"},"1 Mi\xadcroser\xadvice"),"."),Object(o.a)("p",null,"For ex\xadam\xadple, if you were build\xading a ",Object(o.a)("strong",{parentName:"p"},"User Mi\xadcroser\xadvice")," with basic ",Object(o.a)("strong",{parentName:"p"},"CRUD")," func\xadtion\xadal\xadity, you should im\xadple\xadment ",Object(o.a)("inlineCode",{parentName:"p"},"CREATE"),", ",Object(o.a)("inlineCode",{parentName:"p"},"READ"),", ",Object(o.a)("inlineCode",{parentName:"p"},"UPDATE")," and ",Object(o.a)("inlineCode",{parentName:"p"},"DELETE")," in a ",Object(o.a)("strong",{parentName:"p"},"sin\xadgle")," Lambda func\xadtion. In the code, you should re\xadsolve the de\xadsired ac\xadtion by in\xadspect\xading the re\xadquest or the con\xadtext."),Object(o.a)("h2",{id:"vertx-to-the-rescue"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-to-the-rescue"})),"Vert.x to the rescue"),Object(o.a)("p",null,"There are many ben\xade\xadfits to using ",Object(o.a)("strong",{parentName:"p"},"Vert.x")," in any ap\xadpli\xadca\xadtion. With ",Object(o.a)("strong",{parentName:"p"},"Vert.x"),", you get a rock-\u200bsolid and light\xadweight toolkit for build\xading ",Object(o.a)("strong",{parentName:"p"},"re\xadac\xadtive"),", ",Object(o.a)("strong",{parentName:"p"},"highly per\xadfor\xadmant"),", ",Object(o.a)("strong",{parentName:"p"},"event-\u200bdriven")," and ",Object(o.a)("strong",{parentName:"p"},"non-\u200bblocking")," ap\xadpli\xadca\xadtions. The toolkit even pro\xadvides asyn\xadchro\xadnous ",Object(o.a)("em",{parentName:"p"},"APIs")," for ac\xadcess\xading tra\xaddi\xadtional block\xading dri\xadvers such as ",Object(o.a)("strong",{parentName:"p"},Object(o.a)("a",Object(n.a)({parentName:"strong"},{href:"http://vertx.io/docs/vertx-jdbc-client/groovy/"}),"JDBC")),"."),Object(o.a)("p",null,"How\xadever, for this ex\xadam\xadple, we will mainly focus on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-core/groovy/#event_bus"}),"Event Bus"),". The event bus al\xadlows dif\xadfer\xadent parts of your ap\xadpli\xadca\xadtion to com\xadmu\xadni\xadcate with each other via event mes\xadsages. It sup\xadports ",Object(o.a)("em",{parentName:"p"},"pub\xadlish/sub\xadscribe"),", ",Object(o.a)("em",{parentName:"p"},"point to point"),", and ",Object(o.a)("em",{parentName:"p"},"request-\u200bresponse mes\xadsag\xading"),"."),Object(o.a)("p",null,"For the ",Object(o.a)("strong",{parentName:"p"},"User Mi\xadcroser\xadvice")," ex\xadam\xadple above, we could treat the com\xadbi\xadna\xadtion of the ",Object(o.a)("inlineCode",{parentName:"p"},"HTTP METHOD")," and ",Object(o.a)("inlineCode",{parentName:"p"},"RESOURCE PATH")," as a unique event chan\xadnel, and reg\xadis\xadter the sub\xadscribers/han\xaddlers to re\xadspond ap\xadpro\xadpri\xadately."),Object(o.a)("p",null,"Let\u2019s dive right in."),Object(o.a)("h2",{id:"goal"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#goal"})),"Goal"),Object(o.a)("p",null,"Cre\xadate a ",Object(o.a)("em",{parentName:"p"},"re\xadac\xadtive"),", ",Object(o.a)("em",{parentName:"p"},"message-\u200bdriven"),", ",Object(o.a)("em",{parentName:"p"},"asyn\xadchro\xadnous")," ",Object(o.a)("strong",{parentName:"p"},"User Mi\xadcroser\xadvice")," with ",Object(o.a)("inlineCode",{parentName:"p"},"GET"),", ",Object(o.a)("inlineCode",{parentName:"p"},"POST"),", ",Object(o.a)("inlineCode",{parentName:"p"},"DELETE"),", ",Object(o.a)("inlineCode",{parentName:"p"},"PUT")," CRUD op\xader\xada\xadtions in a ",Object(o.a)("em",{parentName:"p"},"sin\xadgle")," ",Object(o.a)("strong",{parentName:"p"},Object(o.a)("a",Object(n.a)({parentName:"strong"},{href:"aws.amazon.com/lambda"}),"AWS Lambda Func\xadtion"))," using the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://serverless.com"}),"Server\xadless Frame\xadwork")),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"Serverless stack definition"),":"),Object(o.a)("script",{src:"https://gist.github.com/bytekast/48daa2ca479156c98d2735cca181ef30.js"}),Object(o.a)("h2",{id:"solution"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#solution"})),"Solution"),Object(o.a)("p",null,"Use ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io"}),"Vert.x"),"\u2019s ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-core/groovy/#event_bus"}),"Event Bus")," to han\xaddle ",Object(o.a)("strong",{parentName:"p"},"dy\xadnamic rout\xading")," to ",Object(o.a)("strong",{parentName:"p"},"event han\xaddlers")," based on ",Object(o.a)("em",{parentName:"p"},"HTTP method")," and ",Object(o.a)("em",{parentName:"p"},"re\xadsource path")," from the API input."),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"Lambda Handler"),":"),Object(o.a)("script",{src:"https://gist.github.com/bytekast/d5a544f8cdcd327a12010100b2ba2d66.js"}),Object(o.a)("h2",{id:"code-review"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#code-review"})),"Code review"),Object(o.a)("p",null,"Lines ",Object(o.a)("inlineCode",{parentName:"p"},"14-19")," ini\xadtial\xadizes the ",Object(o.a)("strong",{parentName:"p"},"Vert.x")," in\xadstance. AWS Lambda will hold on to this in\xadstance for the life of the con\xadtainer/",Object(o.a)("strong",{parentName:"p"},"JVM"),". It is reused in sub\xadse\xadquent re\xadquests."),Object(o.a)("p",null,"Line ",Object(o.a)("inlineCode",{parentName:"p"},"17")," reg\xadis\xadters the ",Object(o.a)("strong",{parentName:"p"},"User Ser\xadvice")," ",Object(o.a)("em",{parentName:"p"},"han\xaddlers")),Object(o.a)("p",null,"Line ",Object(o.a)("inlineCode",{parentName:"p"},"22")," de\xadfines the ",Object(o.a)("strong",{parentName:"p"},"main han\xaddler")," method that is called when the ",Object(o.a)("strong",{parentName:"p"},"Lambda func\xadtion")," is in\xadvoked."),Object(o.a)("p",null,"Line ",Object(o.a)("inlineCode",{parentName:"p"},"27")," sends the Lambda func\xadtion input to the (dy\xadnamic) ",Object(o.a)("strong",{parentName:"p"},"ad\xaddress")," where han\xaddlers are wait\xading to re\xadspond. "),Object(o.a)("p",null,"Lines ",Object(o.a)("inlineCode",{parentName:"p"},"44-66")," de\xadfines the spe\xadcific ",Object(o.a)("em",{parentName:"p"},"han\xaddlers")," and binds them to the ap\xadpro\xadpri\xadate ",Object(o.a)("em",{parentName:"p"},"chan\xadnels")," (http method + re\xadsource path)"),Object(o.a)("h2",{id:"summary"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#summary"})),"Summary"),Object(o.a)("p",null,"As you can see, ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io"}),"Vert.x"),"\u2019s ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-core/groovy/#event_bus"}),"Event Bus")," makes it very easy to dy\xadnam\xadi\xadcally sup\xadport mul\xadti\xadple routes in a sin\xadgle ",Object(o.a)("strong",{parentName:"p"},"Server\xadless")," func\xadtion. This re\xadduces the num\xadber of func\xadtions you have to man\xadage, de\xadploy and main\xadtain in ",Object(o.a)("strong",{parentName:"p"},"AWS"),". In ad\xaddi\xadtion, you gain ac\xadcess to asyn\xadchro\xadnous, non-\u200bblocking APIs that come stan\xaddard with ",Object(o.a)("strong",{parentName:"p"},"Vert.x"),"."),Object(o.a)("blockquote",null,Object(o.a)("p",{parentName:"blockquote"},"Server\xadless + Vert.x = BLISS")))}m.isMDXComponent=!0},lWra:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"The RSS reader tutorial (Step 3)",category:"guides",authors:[{name:"Pavel Drankov",github_id:"Sammers21"}],summary:"This is the third installment of our Vert.x Cassandra Client tutorial. We will implement the last RSS endpoint serving a list of articles related to a specific channel."}),i=[{term:"implement",tf:8},{term:"rss",tf:6},{term:"endpoint",tf:5},{term:"articl",tf:4},{term:"reader",tf:3},{term:"channel",tf:3},{term:"link",tf:3},{term:"cassandra",tf:2},{term:"client",tf:2},{term:"step",tf:2},{term:"app",tf:2},{term:"3rd",tf:2},{term:"relat",tf:2},{term:"request",tf:2},{term:"statement",tf:2},{term:"seri",tf:2},{term:"releas",tf:1},{term:"perfect",tf:1},{term:"time",tf:1},{term:"conclud",tf:1},{term:"tutori",tf:1},{term:"previou",tf:1},{term:"successfulli",tf:1},{term:"second",tf:1},{term:"exampl",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Now that ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/eclipse-vert-x-3-6-0-released/"}),"Vert.x 3.6.0 has been re\xadleased"),", it\u2019s the per\xadfect time to con\xadclude our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-cassandra-client/java/"}),"Vert.x Cas\xadsan\xaddra Client")," tu\xadto\xadr\xadial!"),Object(o.a)("p",null,"In ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/blog/the-rss-reader-tutorial-step-2/"}),"the pre\xadvi\xadous step"),", we have suc\xadcess\xadfully im\xadple\xadmented the sec\xadond end\xadpoint\nof the RSS reader app."),Object(o.a)("p",null,"The RSS reader ex\xadam\xadple as\xadsumes im\xadple\xadment\xading three end\xadpoints. This ar\xadti\xadcle is ded\xadi\xadcated to im\xadple\xadment\xading the last ",Object(o.a)("inlineCode",{parentName:"p"},"GET /articles/by_rss_link?link={rss_link}")," end\xadpoint."),Object(o.a)("p",null,"Be\xadfore com\xadplet\xading this step, make sure your are in the ",Object(o.a)("inlineCode",{parentName:"p"},"step_3")," git branch:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-better-shell"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"$"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"bash"})," git checkout step_3"),"\n")),Object(o.a)("h2",{id:"implementing-the-3rd-endpoint"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implementing-the-3rd-endpoint"})),"Implementing the 3rd endpoint"),Object(o.a)("p",null,"The 3rd end\xadpoint serves a list of ar\xadti\xadcles re\xadlated to a spe\xadcific RSS chan\xadnel. In a re\xadquest, we spec\xadify RSS chan\xadnel by pro\xadvid\xading a link. On the ap\xadpli\xadca\xadtion side, after re\xadceiv\xading a re\xadquest we ex\xade\xadcute the fol\xadlow\xading query:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-sql"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"SELECT")," title, article_link, description, pubDate ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"FROM")," articles_by_rss_link ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"WHERE")," rss_link = RSS_LINK_FROM_REQUEST ;\n")),Object(o.a)("h2",{id:"implementation"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#implementation"})),"Implementation"),Object(o.a)("p",null,"For ob\xadtain\xading ar\xadti\xadcles by RSS link we need to pre\xadpare a re\xadlated state\xadment first. Change ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle#prepareSelectArticlesByRssLink")," in this way:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," Future<Void> ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"prepareSelectArticlesByRssLink"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," Util.prepareQueryAndSetReference(client,\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT title, article_link, description, pubDate FROM articles_by_rss_link WHERE rss_link = ? ;"'),",\n            selectArticlesByRssLink\n    );\n}\n")),Object(o.a)("p",null,"And now, we can im\xadple\xadment the ",Object(o.a)("inlineCode",{parentName:"p"},"AppVerticle#getArticles")," method. Ba\xadsi\xadcally, it will use the ",Object(o.a)("inlineCode",{parentName:"p"},"selectArticlesByRssLink")," state\xadment for find\xading ar\xadti\xadcles by the given link. Here\u2019s the im\xadple\xadmen\xadta\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getArticles"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext ctx)")," "),"{\n    String link = ctx.request().getParam(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"link"'),");\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (link == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n        responseWithInvalidRequest(ctx);\n    } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n        client.executeWithFullFetch(selectArticlesByRssLink.bind(link), handler -> {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (handler.succeeded()) {\n                List<Row> rows = handler.result();\n\n                JsonObject responseJson = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject();\n                JsonArray articles = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonArray();\n\n                rows.forEach(eachRow -> articles.add(\n                        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()\n                                .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"title"'),", eachRow.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"))\n                                .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"link"'),", eachRow.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1"),"))\n                                .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),", eachRow.getString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"2"),"))\n                                .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"pub_date"'),", eachRow.getTimestamp(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"3"),").getTime())\n                ));\n\n                responseJson.put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"articles"'),", articles);\n                ctx.response().end(responseJson.toString());\n            } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n                log.error(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"failed to get articles for "')," + link, handler.cause());\n                ctx.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"500"),").end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Unable to retrieve the info from C*"'),");\n            }\n        });\n    }\n}\n")),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"Dur\xading the se\xadries, we have shown how the RSS reader app can be im\xadple\xadmented with the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-cassandra-client"}),"Vert.x Cas\xadsan\xaddra client"),"."),Object(o.a)("p",null,"Thanks for read\xading this. I hope you en\xadjoyed this se\xadries. See you soon on our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"Git\xadter chan\xadnel"),"!"))}m.isMDXComponent=!0},lihu:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vertx 3 and Keycloak tutorial",category:"guides",authors:[{name:"Paulo Lopes",github_id:"pmlopes"}],summary:"With the upcoming release of Vert.x 3.3 securing your application with Keycloak is even easier than before."}),i=[{term:"keycloak",tf:7},{term:"secur",tf:3},{term:"applic",tf:3},{term:"setup",tf:2},{term:"app",tf:2},{term:"screencast",tf:2},{term:"follow",tf:2},{term:"upcom",tf:1},{term:"releas",tf:1},{term:"even",tf:1},{term:"easier",tf:1},{term:"describ",tf:1},{term:"open",tf:1},{term:"sourc",tf:1},{term:"ident",tf:1},{term:"access",tf:1},{term:"manag",tf:1},{term:"modern",tf:1},{term:"servic",tf:1},{term:"quickli",tf:1},{term:"add",tf:1},{term:"authent",tf:1},{term:"author",tf:1},{term:"easi",tf:1},{term:"realm",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"With the up\xadcom\xading re\xadlease of Vert.x 3.3 se\xadcur\xading your ap\xadpli\xadca\xadtion with Key\xadcloak is even eas\xadier than be\xadfore."),Object(o.a)("h2",{id:"about-keycloak"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#about-keycloak"})),"About Keycloak"),Object(o.a)("p",null,"Key\xadcloak de\xadscribes it\xadself as an ",Object(o.a)("em",{parentName:"p"},"Open Source Iden\xadtity and Ac\xadcess Man\xadage\xadment For Mod\xadern Ap\xadpli\xadca\xadtions and Ser\xadvices"),"."),Object(o.a)("p",null,"With Key\xadcloak you can quickly add ",Object(o.a)("em",{parentName:"p"},"Au\xadthen\xadti\xadca\xadtion")," and ",Object(o.a)("em",{parentName:"p"},"Au\xadtho\xadriza\xadtion")," to your vert.x ap\xadpli\xadca\xadtion. The easy way is to\nsetup a realm on key\xadcloak and once you\u2019re done, ex\xadport the con\xadfig\xadu\xadra\xadtion to your vert.x app."),Object(o.a)("p",null,"This how you would se\xadcure your app:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"cre\xadate a ",Object(o.a)("inlineCode",{parentName:"li"},"OAuth2Auth")," in\xadstance with ",Object(o.a)("inlineCode",{parentName:"li"},"OAuth2Auth.createKeycloak(...)")),Object(o.a)("li",{parentName:"ol"},"copy your con\xadfig from the key\xadcloak admin GUI"),Object(o.a)("li",{parentName:"ol"},"setup your call\xadback ac\xadcord\xading to what you en\xadtered on key\xadcloak"),Object(o.a)("li",{parentName:"ol"},"se\xadcure your re\xadsource with ",Object(o.a)("inlineCode",{parentName:"li"},'router.route("/protected/*").handler(oauth2)'))),Object(o.a)("h2",{id:"screencast"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#screencast"})),"Screencast"),Object(o.a)("p",null,"The fol\xadlow\xading screen\xadcast ex\xadplains how you can do this from scratch:"),Object(o.a)("div",{className:"youtube-embed"},Object(o.a)("iframe",{src:"https://www.youtube.com/embed/c20igjL69Mo",frameBorder:"0",allowFullScreen:!0})),Object(o.a)("p",null,"Don\u2019t for\xadget to fol\xadlow our ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA"}),"youtube chan\xadnel"),"!"))}m.isMDXComponent=!0},lybm:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 3.8.3",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This new version is a minor bug fix release that addresses issues reported in Eclipse Vert.x 3.8.2. We would like to thank you all for reporting these bugs."}),i=[{term:"http",tf:6},{term:"releas",tf:5},{term:"com",tf:4},{term:"wiki",tf:4},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"deprec",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"note",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We have just re\xadleased Vert.x 3.8.3, a bug fix re\xadlease of Vert.x 3.8.x."),Object(o.a)("p",null,"Since the re\xadlease of Vert.x 3.8.2, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"Vert.x 3.8.3 dep\xadre\xadca\xadtions and break\xading changes")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.3-Deprecations-and-breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.3-\u200bDeprecations-and-breaking-changes")))),Object(o.a)("p",null,"Vert.x 3.8.3 re\xadlease notes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.3-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.3-\u200bRelease-Notes"))),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.3%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.3/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.3 project using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},mBXf:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Checklist for Migrating from Vert.x 2.1.x to Vert.x 3 - Part One",category:"guides",authors:[{name:"Mark Spritzler",github_id:"bytor99999"}],summary:"So while upgrading our application, I thought I should note down all the changes that we had to do in the process. Since Vert.x 3 is a major upgrade from the previous version, with so many changes."}),i=[{term:"test",tf:22},{term:"us",tf:21},{term:"chang",tf:16},{term:"class",tf:14},{term:"method",tf:13},{term:"call",tf:12},{term:"need",tf:11},{term:"on",tf:10},{term:"remov",tf:8},{term:"applic",tf:7},{term:"new",tf:7},{term:"just",tf:7},{term:"will",tf:7},{term:"code",tf:7},{term:"depend",tf:7},{term:"jar",tf:7},{term:"creat",tf:7},{term:"post",tf:6},{term:"thing",tf:6},{term:"work",tf:6},{term:"first",tf:6},{term:"import",tf:6},{term:"file",tf:6},{term:"messag",tf:6},{term:"note",tf:5}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"This blog post presents feed\xadbacks from a project mi\xadgra\xadtion using Vert.x 2 to Vert.x 3."),Object(o.a)("h2",{id:"we-are-in-the-process-of-converting-our-vertx-215-application-to-vertx-30"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#we-are-in-the-process-of-converting-our-vertx-215-application-to-vertx-30"})),"We are in the process of converting our Vert.x 2.1.5 application to Vert.x 3.0."),Object(o.a)("p",null,"So while up\xadgrad\xading our ap\xadpli\xadca\xadtion, I thought I should note down all the changes that we had to do in the process. Since Vert.x 3 is a major up\xadgrade from the pre\xadvi\xadous ver\xadsion, with so many changes."),Object(o.a)("p",null,"It re\xadquires re-\u200bthinking your cur\xadrent 2.x Vert.x ap\xadpli\xadca\xadtion. There are new classes, new apis, and a new pack\xadage struc\xadture that has greatly sim\xadpli\xadfied things that we used to have to work around. There\xadfore in our up\xadgrade it re\xadquired us to refac\xadtor and re\xadmove any un\xadnec\xades\xadsary ",Object(o.a)("em",{parentName:"p"},"\u201chacks\u201d")," that weren\u2019t avail\xadable in 2 that are now a part of Vert.x 3 that you re\xadally want and need to take ad\xadvan\xadtage of. (I don\u2019t mean there are hacks in 3.x, just that we had in our ap\xadpli\xadca\xadtion with Vert.x 2.x)"),Object(o.a)("p",null,"There are ",Object(o.a)("em",{parentName:"p"},"Met\xadrics"),", and ",Object(o.a)("em",{parentName:"p"},"Clus\xadtered shared data"),", with lock\xading and many more fea\xadtures that are amaz\xading new ad\xaddi\xadtions. These are things we had to hack into our ap\xadpli\xadca\xadtion with Vert.x 2.x. We added our own ",Object(o.a)("inlineCode",{parentName:"p"},"MetricsRegistry")," from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://dropwizard.github.io/metrics/3.1.0/getting-started/"}),"Drop\xadWiz\xadard")," which meant mak\xading our own ",Object(o.a)("inlineCode",{parentName:"p"},"Main")," class that called Vert.x\u2019s ",Object(o.a)("inlineCode",{parentName:"p"},"Starter")," class after start\xading up the reg\xadistry, but only in our ",Object(o.a)("em",{parentName:"p"},"De\xadvops")," server de\xadploys, not our de\xadvel\xadoper ma\xadchines. And we had to build our own dis\xadtrib\xaduted locked of clus\xadtered data that also re\xadquired writ\xading a com\xadpre\xadhen\xadsive dis\xadtrib\xaduted timers. (The timers got fixed with a bet\xadter actor model). But now we can use what Vert.x gives us in\xadter\xadnally for those use cases."),Object(o.a)("p",null,"This blog post is part one, as I am sure there will be some new changes that we need to do that we haven\u2019t got\xadten to yet. Which as we go, will post in part two. Also that this post is a work in progress in that when\xadever you are up\xadgrad\xading and refac\xadtor\xading your code, it doesn\u2019t leave much time for tak\xading de\xadtailed notes, or writ\xading beau\xadti\xadful prose. I am a ter\xadri\xadble writer even when I can fully con\xadcen\xadtrate on it. So the first draft will just be a list of my notes. These notes are not in any par\xadtic\xadu\xadlar order, but some things like tests you might want to save for last. (Just DON\u2019T delete your tests, tests are very im\xadpor\xadtant)"),Object(o.a)("p",null,"One of the first things that Vert.x has changed is the whole ",Object(o.a)("em",{parentName:"p"},"class\xadloader")," setup. Read the Vert.x Docs for more in\xadfor\xadma\xadtion but ba\xadsi\xadcally, we have a flat ",Object(o.a)("em",{parentName:"p"},"class\xadloader")," sys\xadtem now. YAY! And one of the first things I no\xadticed that is gone is the ",Object(o.a)("inlineCode",{parentName:"p"},"Platform")," mod\xadule."),Object(o.a)("h2",{id:"changes-we-have-made"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#changes-we-have-made"})),"Changes we have made."),Object(o.a)("h3",{id:"dependency-changes"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#dependency-changes"})),"Dependency changes"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"So the first thing we did was to re\xadmove the ",Object(o.a)("inlineCode",{parentName:"p"},"vert.x-platform")," de\xadpen\xaddency from our ",Object(o.a)("inlineCode",{parentName:"p"},"pom")," file (Build de\xadpen\xaddency file of what\xadever build sys\xadtem you use) This also means that you will be re\xadmov\xading any im\xadport state\xadments from your code that has ",Object(o.a)("inlineCode",{parentName:"p"},".platform"),". Which leads us to the next point.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"Change all the im\xadports for Vertx. from ",Object(o.a)("inlineCode",{parentName:"p"},"org.vertx")," to ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx"),". This could be a lot of work, as it is in every class you use Vert.x in. We had at least 250 lo\xadca\xadtions to change here. Some classes have moved pack\xadages and \u201cjars\u201d that have them, so there will be some new jars to in\xadclude as de\xadpen\xadden\xadcies and dif\xadfer\xadent im\xadport state\xadments for them.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"If using a lan\xadguage other than Java, change the de\xadpen\xaddency to ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-lang-<<language>>"))),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"Re\xadmove any mod\xadules ref\xader\xadences that are using Vert.x 2.x stuff. You can get an odd error like\n",Object(o.a)("em",{parentName:"p"},"The type org.vertx.java.core.json.JsonOb\xadject can\xadnot be re\xadsolved. It is in\xaddi\xadrectly ref\xader\xadenced from re\xadquired .class files"),".")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},Object(o.a)("inlineCode",{parentName:"p"},"testtools")," de\xadpen\xaddency is gone. There is now Vertx-\u200bunit. So all your pre\xadvi\xadous tests need to be com\xadpletely re-\u200bwritten in the new style. This can be re\xadally dif\xadfi\xadcult and time con\xadsum\xading as the tests you al\xadready have writ\xadten re\xadally do need to be re-\u200bwritten from scratch. But these tests are also the back\xadbone in know\xading if your code is work\xading. So this could take months if you have a re\xadally full set of test suites al\xadready. Also note the list below is to con\xadvert your JUnit In\xadte\xadgra\xadtion tests. as vertx-\u200bunit first and fore\xadmost pro\xadvides its own test\xading frame\xadwork/suite but it also works in JUnit, and if you are using JUnit you need to do the fol\xadlow\xading"))),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Re\xadmove all the im\xadports to ",Object(o.a)("inlineCode",{parentName:"li"},"TestTools"),", in\xadclud\xading ",Object(o.a)("inlineCode",{parentName:"li"},"VertxAssert"),". I would do a find/re\xadplace to re\xadplace all the ",Object(o.a)("inlineCode",{parentName:"li"},"VertxAssert")," to ",Object(o.a)("inlineCode",{parentName:"li"},"testContext")," for when you have to add ",Object(o.a)("inlineCode",{parentName:"li"},"TestContext")," to all your ",Object(o.a)("inlineCode",{parentName:"li"},"@Test")," meth\xadods. I rec\xadom\xadmend nam\xading the pa\xadra\xadme\xadter ",Object(o.a)("inlineCode",{parentName:"li"},"testContext"),", just to put more con\xadtext, into your con\xadtext. Be\xadcause if you just have ",Object(o.a)("inlineCode",{parentName:"li"},"context")," as your pa\xadra\xadme\xadter name, how do you know what con\xadtext the con\xadtext is? Sorry, that was too much fun. Ba\xadsi\xadcally, what I am say\xading is if you have say ",Object(o.a)("inlineCode",{parentName:"li"},"Spring ApplicationContext")," in with your in\xadte\xadgra\xadtion tests with Vert.x what does ",Object(o.a)("inlineCode",{parentName:"li"},"context")," rep\xadre\xadsent? Spring or Vert.x test con\xadtext."),Object(o.a)("li",{parentName:"ul"},"Add ",Object(o.a)("inlineCode",{parentName:"li"},"@RunWith(VertxUnitRunner.class)")," above your test class"),Object(o.a)("li",{parentName:"ul"},"Re\xadmove any ",Object(o.a)("inlineCode",{parentName:"li"},"VertxAssert.testComplete()")," those are gone. It needs ",Object(o.a)("inlineCode",{parentName:"li"},"TestContext.async().complete()"),". It is also im\xadpor\xadtant to un\xadder\xadstand what ",Object(o.a)("inlineCode",{parentName:"li"},"async()")," means. When to call it, when to com\xadplete it. It also al\xadlows you to do mul\xadti\xadple ",Object(o.a)("inlineCode",{parentName:"li"},"async()")," calls and nested ones. I think I needed that when I had a test that was a longer use case of many mes\xadsages being sent, but only after re\xadsponses to other ones oc\xadcurred. For in\xadstance, to do chat in our app, you have to con\xadnect, sub\xadscribe, friend some\xadone, then you can send a chat mes\xadsage. So that is 4 total Vert.x Mes\xadsages sent from the Test client. And you can sub\xadscribe until con\xadnect com\xadpleted, and you can send or re\xadceive mes\xadsages un\xadless you are sub\xadscribed and have a friend. So we need to have a few ",Object(o.a)("inlineCode",{parentName:"li"},"async()")," calls in that sce\xadnario."),Object(o.a)("li",{parentName:"ul"},"What is in your ",Object(o.a)("inlineCode",{parentName:"li"},"start")," method over\xadride. Make that an ",Object(o.a)("inlineCode",{parentName:"li"},"@Before"),"."),Object(o.a)("li",{parentName:"ul"},"What is in your ",Object(o.a)("inlineCode",{parentName:"li"},"stop")," method over\xadride. Make that an ",Object(o.a)("inlineCode",{parentName:"li"},"@After"),"."),Object(o.a)("li",{parentName:"ul"},"If you have your as\xadser\xadtions have cus\xadtom mes\xadsage ",Object(o.a)("em",{parentName:"li"},"strings")," to log out when they fail, that pa\xadra\xadme\xadter is now at the end of the ",Object(o.a)("inlineCode",{parentName:"li"},"assert")," method call. Yes, this one can be painful.")),Object(o.a)("h3",{id:"build-changes"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#build-changes"})),"Build Changes"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"Re\xadmove all ",Object(o.a)("em",{parentName:"p"},"vertx maven plugin")," code to gen\xader\xadate mod\xadules, in\xadstead cre\xadate ",Object(o.a)("em",{parentName:"p"},"fat")," jars, which re\xadquires adding the ",Object(o.a)("em",{parentName:"p"},"Shade maven plugin")," to put all jar files into a big fat jar. The vertx-\u200bexamples project has ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/tree/master/maven-simplest"}),"simplest-\u200bmaven")," which has the stuff to cre\xadate the fat jar. ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/tree/master/gradle-simplest"}),"simplest-\u200bgradle")," is the gra\xaddle equiv\xada\xadlent.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"If you were run\xadning your ap\xadpli\xadca\xadtion with ",Object(o.a)("inlineCode",{parentName:"p"},"runMod")," or some\xadthing like that then you need to cre\xadate a ",Object(o.a)("em",{parentName:"p"},"fat")," jar, chang\xading the build file as in ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/blob/master/maven-simplest/pom.xml"}),"this one")," and cre\xadate a Main class like here ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/blob/master/maven-simplest/src/main/java/io/vertx/example/HelloWorldEmbedded.java"}),"this one"),"."))),Object(o.a)("h3",{id:"classcode-changes"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#classcode-changes"})),"Class/Code Changes"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},Object(o.a)("inlineCode",{parentName:"p"},"Verticle")," is now an in\xadter\xadface and not a class to ex\xadtend, so using Groovy as an ex\xadam\xadple you now ex\xadtend ",Object(o.a)("inlineCode",{parentName:"p"},"GroovyVerticle"),". In Java ex\xadtend ",Object(o.a)("inlineCode",{parentName:"p"},"AbstractVerticle")," in\xadstead.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"There is no ",Object(o.a)("inlineCode",{parentName:"p"},"registerHandler")," on the event\xadBus any\xadmore. So every\xadwhere you do that has to change to cre\xadate/call ",Object(o.a)("inlineCode",{parentName:"p"},"consumer()")," and to un\xadreg\xadis\xadter that han\xaddler, you have to have a ref\xader\xadence to the ",Object(o.a)("inlineCode",{parentName:"p"},"MessageConsumer")," that ",Object(o.a)("inlineCode",{parentName:"p"},"consumer()")," call re\xadturns and call its ",Object(o.a)("inlineCode",{parentName:"p"},"unregister")," method.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},Object(o.a)("inlineCode",{parentName:"p"},"JsonObject.toMap()")," changed to ",Object(o.a)("inlineCode",{parentName:"p"},"JsonObject.getMap()"))),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},Object(o.a)("inlineCode",{parentName:"p"},"JsonObject")," also re\xadmoved all the ",Object(o.a)("inlineCode",{parentName:"p"},"putXXX")," meth\xadods with just one ",Object(o.a)("inlineCode",{parentName:"p"},"put")," method with over\xadloaded ver\xadsions for dif\xadfer\xadent types.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},Object(o.a)("inlineCode",{parentName:"p"},"JsonObjectMessage")," no longer ex\xadists. What re\xadplaces de\xadpends on what you are doing. Mean\xading, if it is an ",Object(o.a)("inlineCode",{parentName:"p"},"async")," call\xadback to a de\xadploy, you will get a ",Object(o.a)("inlineCode",{parentName:"p"},"Message")," in\xadstance back that has ",Object(o.a)("inlineCode",{parentName:"p"},"succeeded()")," or ",Object(o.a)("inlineCode",{parentName:"p"},"failed()")," meth\xadods as well as ",Object(o.a)("inlineCode",{parentName:"p"},"body()")," to check any re\xadsults. If it is a ",Object(o.a)("inlineCode",{parentName:"p"},"Consumer"),", it is typ\xadi\xadcally a straight for\xadward\n",Object(o.a)("inlineCode",{parentName:"p"},"JsonObject"),". If you are in Groovy it is also a ",Object(o.a)("inlineCode",{parentName:"p"},"JsonObject"),", but the ",Object(o.a)("inlineCode",{parentName:"p"},"body()")," is a ",Object(o.a)("inlineCode",{parentName:"p"},"Map")," which you can use di\xadrectly now, in\xadstead of hav\xading to con\xadvert from ",Object(o.a)("inlineCode",{parentName:"p"},"JsonObject")," to ",Object(o.a)("inlineCode",{parentName:"p"},"Map"),".")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"There isn\u2019t a ",Object(o.a)("inlineCode",{parentName:"p"},"container")," vari\xadable in ",Object(o.a)("inlineCode",{parentName:"p"},"Verticles")," any\xadmore for de\xadploy\xading ver\xadti\xadcles and also a con\xadfig file. You need to use ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.getOrCreateContext().config()")," to get to it. I used that in the SockJS Ex\xadam\xadple code below.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},Object(o.a)("inlineCode",{parentName:"p"},"SharedData")," no longer has shared sets. It has a ",Object(o.a)("inlineCode",{parentName:"p"},"Map")," of ",Object(o.a)("inlineCode",{parentName:"p"},"SharedData"),", so an entry in that ",Object(o.a)("inlineCode",{parentName:"p"},"Map")," of shared data could be the name of the set as the key, and a ",Object(o.a)("inlineCode",{parentName:"p"},"Set")," as the value. It ac\xadtu\xadally gives you more flex\xadi\xadbil\xadity of what you put into Shared data, so this is ac\xadtu\xadally a big win for us.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"Get\xadting the ",Object(o.a)("inlineCode",{parentName:"p"},"writeHandlerID")," from a Socket type, is now a method call in\xadstead of ",Object(o.a)("inlineCode",{parentName:"p"},".writeHandlerID"),", so ",Object(o.a)("inlineCode",{parentName:"p"},".writeHandlerID()"))),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},Object(o.a)("inlineCode",{parentName:"p"},"SockJSSocket")," is in ",Object(o.a)("em",{parentName:"p"},"vertx-\u200bweb")," pack\xadage now, so in\xadclude it to get the class.")),Object(o.a)("li",{parentName:"ol"},Object(o.a)("p",{parentName:"li"},"There isn\u2019t a ",Object(o.a)("inlineCode",{parentName:"p"},"SockJSServer")," class any\xadmore ei\xadther. So you will cre\xadate a ",Object(o.a)("inlineCode",{parentName:"p"},"WebServer"),", a ",Object(o.a)("inlineCode",{parentName:"p"},"Router"),"\nand set SSL (if you are using SSL on the Web\xadServer) then cre\xadate a ",Object(o.a)("inlineCode",{parentName:"p"},"SockJSHandler")," to as\xadsign to the router via the ",Object(o.a)("inlineCode",{parentName:"p"},"route()")," method and ",Object(o.a)("inlineCode",{parentName:"p"},"handler()")," meth\xadods in the Router api.\nHere is an ex\xadam\xadple of our code. Al\xadthough I haven\u2019t tested it yet. ;)"))),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-groovy"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"MyVerticle")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"GroovyVerticle")," {"),"\n  Router router\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"void")," start() ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"throws")," Exception {\n     router = Router.router(vertx)\n     (Map<String, Object>) sslConfig =\n        (Map<String, Object>)vertx.getOrCreateContext()\n          .config().get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'ssl'"),")\n\n     HttpServer sslHttpServer = vertx.createHttpServer(\n         ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"SSL:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),",\n         ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"keyStorePath:")," sslConfig.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"keystore"'),"),\n         ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),"keyStorePassword:")," sslConfig.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"password"'),"))\n\n     startWebApiServer(sslHttpServer)\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"void")," startWebApiServer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"final")," HttpServer httpServer) {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"def")," sockHandler = SockJSHandler.create(vertx, [:])\n    sockHandler.socketHandler {\n      SockJSSocket ws -> sockJSConnectHandler(ws)\n    }\n    router.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/hdpoker"'),").handler(sockHandler)\n    httpServer.requestHandler(router.&accept)\n    httpServer.listen()\n  }\n\n}\n")),Object(o.a)("h4",{id:"more-testing-change"},Object(o.a)("a",Object(n.a)({parentName:"h4"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#more-testing-change"})),"More testing change"),Object(o.a)("p",null,"Test\xading mes\xadsages in In\xadte\xadgra\xadtion Tests. To tell the test method that this has async calls put\n",Object(o.a)("inlineCode",{parentName:"p"},"Async async = testContext.async()")," as the first line in the test method. Yes, this is a lit\xadtle re\xaddun\xaddant from above, but I al\xadways for\xadgot to put ",Object(o.a)("inlineCode",{parentName:"p"},"async()")," calls in my in\xadte\xadgra\xadtion tests and they would pass so quickly, with\xadout send\xading any\xadthing out, be\xadcause it wasn\u2019t wait\xading any\xadmore"),Object(o.a)("h3",{id:"runtime-changes"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#runtime-changes"})),"Runtime changes"),Object(o.a)("p",null,"If you don\u2019t use Vert.x built-\u200bin Log\xadging and need to use slf4j, then re\xadmem\xadber that you should set a sys\xadtem prop\xaderty called ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.logger-delegate-factory-class-name")," with the name of a Java class which im\xadple\xadments the in\xadter\xadface ",Object(o.a)("inlineCode",{parentName:"p"},"LoggerFactory"),". Vert.x pro\xadvides pre-\u200bbuilt im\xadple\xadmen\xadta\xadtions for Log4J and SLF4J with the class names ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.core.logging.Log4jLogDelegateFactory")," and ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.core.logging.SLF4JLogDelegateFactory"),"."),Object(o.a)("h2",{id:"still-working"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#still-working"})),"Still working"),Object(o.a)("p",null,"Well, that is all I have for you folks so far. We are still not done, as we haven\u2019t got\xadten our ap\xadpli\xadca\xadtion run\xadning with real clients just yet. But we do have all our in\xadte\xadgra\xadtion tests from be\xadfore com\xadpletely pass\xading\nso, if some\xadthing does come up, it should be a small one (KNOCK ON WOOD)"),Object(o.a)("p",null,"Please feel free to post on the Vert.x Google Group with any com\xadments or sug\xadges\xadtions on what to add to this blog post or for Part Two."),Object(o.a)("p",null,"Thanks"),Object(o.a)("p",null,"Mark S"))}m.isMDXComponent=!0},mT7v:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x meets GraphQL",category:"guides",authors:[{name:"Johannes Sch\xfcth",github_id:"jotschi"}],summary:"In this blog post, we will look at an example application written in Vert.x that uses the new GraphQL API of Gentics Mesh."}),i=[{term:"queri",tf:24},{term:"us",tf:21},{term:"graphql",tf:18},{term:"graph",tf:17},{term:"data",tf:15},{term:"will",tf:12},{term:"exampl",tf:10},{term:"element",tf:10},{term:"not",tf:8},{term:"type",tf:8},{term:"load",tf:7},{term:"databas",tf:7},{term:"access",tf:6},{term:"class",tf:6},{term:"schema",tf:6},{term:"provid",tf:5},{term:"contain",tf:5},{term:"travers",tf:5},{term:"need",tf:5},{term:"object",tf:5},{term:"context",tf:5},{term:"ad",tf:4},{term:"support",tf:4},{term:"api",tf:4},{term:"json",tf:4}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"I re\xadcently added GraphQL sup\xadport to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/gentics/mesh"}),"Gen\xadtics Mesh")," and I thought it would be a good idea to boil down the essence of my im\xadple\xadmen\xadta\xadtion in ex\xadam\xadple so that I could share it in a sim\xadpler form.\nThe ex\xadam\xadple I\u2019m about to show will not cover all as\xadpects that I have added to the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://getmesh.io/docs/beta/graphql.html"}),"Gen\xadtics Mesh API")," (e.g. pag\xading, search and error han\xaddling) but it will give you a basic overview of the parts that I put to\xadgether.\nGraphQL does not re\xadquire a GraphDB even if the name might sug\xadgest it."),Object(o.a)("p",null,"Using a graphdb in com\xadbi\xadna\xadtion with GraphQL does nev\xader\xadthe\xadless pro\xadvide you with some ad\xadvan\xadtages which I will high\xadlight later on."),Object(o.a)("h2",{id:"what-is-graphql-what-is-it-good-for"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#what-is-graphql-what-is-it-good-for"})),"What is GraphQL? What is it good for?"),Object(o.a)("p",null,"GraphQL as the name sug\xadgests is a new query lan\xadguage which can be used to load ex\xadactly the amount of data which you ask for. "),Object(o.a)("p",null,"The query is de\xadfined in way that the query fields cor\xadre\xadlate to the JSON data that is being re\xadtrieved.\nIn our Star\xadWars Demo do\xadmain model this query will load the name of human 1001 which is Darth Vader."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-css"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"vader"),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"human"),"(id: ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1001"),") {\n    name\n  }\n}\n")),Object(o.a)("p",null,"Would re\xadsult in:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"data"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"vader"'),": {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"name"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Darth Vader"'),"\n    }\n  }\n}\n")),Object(o.a)("h2",{id:"the-demo-app"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#the-demo-app"})),"The Demo App"),Object(o.a)("p",null,"The demo ap\xadpli\xadca\xadtion I build makes use of the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/graphql-java/graphql-java"}),"graphql-\u200bjava")," li\xadbrary. The data is being stored in a graph data\xadbase.\nI use ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://orientdb.com/orientdb/"}),"Ori\xadentDB")," in com\xadbi\xadna\xadtion with the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Syncleus/Ferma"}),"OGM Ferma")," to pro\xadvide a data ac\xadcess layer.\nGraphQL does not nec\xades\xadsar\xadily re\xadquire a graph data\xadbase but in this ex\xadam\xadple I will make use of one and high\xadlight the ben\xade\xadfits of using a GraphDB for my use\xadcase."),Object(o.a)("p",null,"You can find the sources here: ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graphql-example"}),"https://github.com/Jotschi/vertx-\u200bgraphql-example")),Object(o.a)("h3",{id:"data"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#data"})),"Data"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/data/StarWarsData.java"}),"Star\xadWars\xadData")," class cre\xadates a Graph which con\xadtains the Star Wars Movies and Char\xadac\xadters, Plan\xadets and their re\xadla\xadtions.\nThe model is fairly sim\xadple. There is a sin\xadgle Star\xadWars\xadRoot ver\xadtex which acts as a start el\xade\xadment for var\xadi\xadous ag\xadgre\xadga\xadtion ver\xadtices: Movies are stored in Movie\xadRoot, Plan\xadets in Plan\xadet\xads\xadRoot, Char\xadac\xadters are stored in Hu\xadman\xads\xadRoot and Droid\xads\xadRoot."),Object(o.a)("p",null,"The model classes are used for wrap\xadpers of the spe\xadcific graph ver\xadtices. The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://syncleus.com/Ferma/"}),"Ferma OGM")," is used to pro\xadvide these wrap\xadpers. Each class con\xadtains meth\xadods which can be used to tra\xadverse the graph to lo\xadcate the needed ver\xadtices.\nThe found ver\xadtices are in turn again wrapped and can be used to lo\xadcate other graph el\xade\xadments."),Object(o.a)("h3",{id:"schema"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#schema"})),"Schema"),Object(o.a)("p",null,"The next thing we need is the GraphQL schema. The schema de\xadscribes each el\xade\xadment which can be re\xadtrieved. It also de\xadscribes the prop\xader\xadties and re\xadla\xadtion\xadships for these el\xade\xadments."),Object(o.a)("p",null,"The graphql-\u200bjava li\xadbrary pro\xadvides an API to cre\xadate the ob\xadject types and schema in\xadfor\xadma\xadtion."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-clojure"}),"private GraphQLObjectType createMovieType() {\n  return newObject().name(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Movie"'),")\n    .description(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"One of the films in the Star Wars universe."'),")\n\n    // .title\n    .field(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"newFieldDefinition"),"().name(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"title"'),")\n        .description(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Title of the episode."'),")\n        .type(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"GraphQLString"),")\n        .dataFetcher((",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"env"),") -> {\n          Movie movie = env.getSource()",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n          return movie.getName()",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n        }))\n\n    // .description\n    .field(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"newFieldDefinition"),"().name(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"description"'),")\n        .description(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Description of the episode."'),")\n        .type(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-name"}),"GraphQLString"),"))\n\n    .build()",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),";"),"\n}\n")),Object(o.a)("p",null,"A type can be ref\xader\xadenced via a ",Object(o.a)("inlineCode",{parentName:"p"},"GraphQLTypeReference")," once it has been cre\xadated and added to the schema. This is es\xadpe\xadcially im\xadpor\xadtant if you need to add fields which ref\xader\xadence other types.\nData fetch\xaders are used to ac\xadcess the con\xadtext, tra\xadverse the graph and re\xadtrieve prop\xader\xadties from graph el\xade\xadments."),Object(o.a)("p",null,"An\xadother great source to learn more about the schema op\xadtions is the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/graphql-java/graphql-java/blob/master/src/test/groovy/graphql/GarfieldSchema.java"}),"Garfield\xadSchema")," ex\xadam\xadple."),Object(o.a)("p",null,"Fi\xadnally all the cre\xadated types must be ref\xader\xadenced by a cen\xadtral ob\xadject type ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/data/StarWarsSchema.java#L204"}),"Query\xadType"),".\nThe query type ob\xadject is ba\xadsi\xadcally the root ob\xadject for the query.\nIt de\xadfines what query op\xadtions are ini\xadtially pos\xadsi\xadble. In our case it is pos\xadsi\xadble to load the hero of the sage, spe\xadcific movies, hu\xadmans or droids."),Object(o.a)("h3",{id:"verticle"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#verticle"})),"Verticle"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/GraphQLVerticle.java"}),"GraphQLVer\xadti\xadcle")," is used to ac\xadcept the GraphQL re\xadquest and process it."),Object(o.a)("p",null,"The ver\xadti\xadcle also con\xadtains a Sta\xadticHan\xaddler to pro\xadvide the Graphiql Browser web in\xadter\xadface. This in\xadter\xadface will allow you to quickly dis\xadcover and ex\xadper\xadi\xadment with GraphQL."),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/main/java/de/jotschi/vertx/GraphQLVerticle.java#L77"}),"query han\xaddler")," ac\xadcepts the query JSON data. "),Object(o.a)("p",null,"An Ori\xadentDB trans\xadac\xadtion is being opened and the query is ex\xade\xadcuted:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"demoData.getGraph().asyncTx((tx) -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Invoke the query and handle the resulting JSON"),"\n  GraphQL graphQL = newGraphQL(schema).build();\n  ExecutionInput input = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," ExecutionInput(query, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),", queryJson, demoData.getRoot(), extractVariables(queryJson));\n  tx.complete(graphQL.execute(input));\n}, (AsyncResult<ExecutionResult> rh) -> {\n  ...\n});\n")),Object(o.a)("p",null,"The ex\xade\xadcute method ini\xadtially needs a con\xadtext vari\xadable. This con\xadtext passed along with the query.\nIn our case the con\xadtext is the root el\xade\xadment of the graph ",Object(o.a)("inlineCode",{parentName:"p"},"demoData.getRoot()"),".\nThis con\xadtext el\xade\xadment also serves as the ini\xadtial source for our data fetch\xaders."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),".dataFetcher((env) -> {\n  StarWarsRoot root = env.getSource();\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," root.getHero();\n}))\n")),Object(o.a)("p",null,"The data fetch\xaders for the hero type on the other hand will be able to ac\xadcess the hero el\xade\xadment since the fetcher above re\xadturned the el\xade\xadment.\nUsing this mech\xada\xadnism it is pos\xadsi\xadble to tra\xadverse the graph. It is im\xadpor\xadtant to note that each in\xadvo\xadca\xadtion on the do\xadmain model meth\xadods will di\xadrectly ac\xadcess the graph data\xadbase.\nThis way it is pos\xadsi\xadble to in\xadflu\xadence the graph data\xadbase query down to the low\xadest level. When omit\xadting a prop\xaderty from the graphql query it will not be loaded from the graph.\nThus there is no need to write an ad\xaddi\xadtional data ac\xadcess layer. All op\xader\xada\xadtions are di\xadrectly mapped to graph data\xadbase."),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"StarWarsRoot")," Ferma class ",Object(o.a)("inlineCode",{parentName:"p"},"getHero()")," method in turn de\xadfines a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://tinkerpop.apache.org/docs/3.3.0/tutorials/getting-started/#_graph_traversal_staying_simple"}),"Tin\xadker\xadPop Grem\xadlin tra\xadver\xadsal")," which is used to load the Ver\xadtex which rep\xadre\xadsents the hero of the Star Wars saga."),Object(o.a)("p",null,"[INFO Apache Tin\xadker\xadPop | ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://tinkerpop.apache.org/"}),"Apache Tin\xadker\xadPop")," is an open source, vendor-\u200bagnostic, graph frame\xadwork / API which is sup\xadported by many graph data\xadbase ven\xaddors.\nOne part of Tin\xadker\xadPop is the Grem\xadlin tra\xadver\xadsal lan\xadguage which is great to query graph data\xadbases.]"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"...\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," Droid ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getHero"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"()")," "),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Follow the HAS_ROOT edge and return the first found Vertex which could be found. "),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Wrap the Vertex explicitly in the Droid Ferma class.  "),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," traverse((g) -> g.out(HAS_HERO)).nextOrDefaultExplicit(Droid.class, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),");\n}\n...\n")),Object(o.a)("p",null,"Once the query has been ex\xade\xadcuted the re\xadsult han\xaddler is being in\xadvoked. It con\xadtains some code to process the re\xadsult data and po\xadten\xadtial er\xadrors.\nIt is im\xadpor\xadtant to note that a GraphQL query will al\xadways be an\xadswered with a 2xx HTTP sta\xadtus code.\nIf an el\xade\xadment which is being ref\xader\xadenced in the query can\u2019t be loaded an error will be added to the re\xadsponse JSON ob\xadject."),Object(o.a)("h3",{id:"testing"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#testing"})),"Testing"),Object(o.a)("p",null,"Test\xading is fairly straight for\xadward. Al\xadthough there are mul\xadti\xadple ap\xadproaches. One ap\xadproach is to use unit test\xading di\xadrectly on the GraphQL types.\nAn\xadother op\xadtion is to run queries against the end\xadpoint.  "),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/test/java/de/jotschi/vertx/GraphQLTest.java"}),"GraphQL\xadTest class")," I wrote will run mul\xadti\xadple queries against the end\xadpoint.\nA Pa\xadra\xadme\xadter\xadized JUnit test is used it\xader\xadate over the queries."),Object(o.a)("p",null,"A ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Jotschi/vertx-graphql-example/blob/master/src/test/resources/graphql/full-query"}),"typ\xadi\xadcal query")," does not only con\xadtain the query data.\nThe as\xadser\xadtions on the re\xadsponse JSON are di\xadrectly in\xadcluded in query using plain com\xadments."),Object(o.a)("p",null,"I build an ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://joel-costigliola.github.io/assertj/"}),"As\xadsertJ")," as\xadser\xadtion to check the com\xadments of a query and ver\xadify that the as\xadser\xadtion matches the re\xadsponse."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"  assertThat(response).compliesToAssertions(queryName);\n")),Object(o.a)("h2",{id:"run-the-example"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#run-the-example"})),"Run the example"),Object(o.a)("p",null,"You can run the ex\xadam\xadple by ex\xade\xadcut\xading the ",Object(o.a)("inlineCode",{parentName:"p"},"GraphQLServer")," class and ac\xadcess the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://localhost:3000/browser/?query=%7B%0A%20%20movies%20%7B%0A%20%20%20%20title%0A%20%20%7D%0A%20%20hero%20%7B%0A%20%20%20%20name%0A%20%20%7D%0A%7D%0A"}),"Graphiql browser on http://lo\xadcal\xadhost:3000/browser/")),Object(o.a)("h2",{id:"where-to-go-from-here"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#where-to-go-from-here"})),"Where to go from here?"),Object(o.a)("p",null,"The ex\xadam\xadple is read-\u200bonly. GraphQL also sup\xadports data mu\xadta\xadtion which can be used to ac\xadtu\xadally mod\xadify and store data.\nI have not yet ex\xadplored that part of GraphQL but I as\xadsume it might not be that hard to add mu\xadta\xadtion sup\xadport to the ex\xadam\xadple."),Object(o.a)("p",null,"Ad\xaddi\xadtion\xadally it does not cover how to ac\xadtu\xadally make use of such API. I re\xadcently ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/gentics/mesh-vertx-example/"}),"up\xaddated my Vert.x ex\xadam\xadple")," which shows how to use Vert.x tem\xadplate han\xaddlers to build a small server which ren\xadders some pages using data which was loaded via GraphQL."),Object(o.a)("p",null,"Thanks for read\xading. If you have any fur\xadther ques\xadtions or feed\xadback don\u2019t hes\xadi\xadtate to send me a tweet to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://twitter.com/Jotschi/"}),"@Jotschi")," or ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://twitter.com/genticsmesh/"}),"@gen\xadtic\xadsmesh"),"."))}m.isMDXComponent=!0},nY3K:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3.2.0 is released!",category:"releases",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"We are pleased to announce the release of Vert.x 3.2.0!"}),i=[{term:"releas",tf:5},{term:"http",tf:5},{term:"bu",tf:4},{term:"com",tf:4},{term:"wiki",tf:4},{term:"bridg",tf:3},{term:"event",tf:3},{term:"us",tf:3},{term:"hawkular",tf:3},{term:"metric",tf:3},{term:"distribut",tf:3},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"ceylon",tf:2},{term:"tcp",tf:2},{term:"let",tf:2},{term:"applic",tf:2},{term:"implement",tf:2},{term:"manag",tf:2},{term:"compon",tf:2},{term:"jgroup",tf:2},{term:"note",tf:2},{term:"break",tf:2},{term:"chang",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We are pleased to an\xadnounce the re\xadlease of Vert.x 3.2.0!"),Object(o.a)("p",null,"Some of the high\xadlights of this re\xadlease in\xadclude:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-core/ceylon"}),"vertx-\u200blang-ceylon"),": the sup\xadport of the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://ceylon-lang.org/"}),"Cey\xadlon lan\xadguage"),"!")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-tcp-eventbus-bridge/java/"}),"vertx-\u200btcp-bridge"),": an event bus bridge that lets any TCP-\u200bcapable ap\xadpli\xadca\xadtion to in\xadter\xadact with vert.x ap\xadpli\xadca\xadtions using the event bus.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-hawkular-metrics/java/"}),"vertx-\u200bhawkular-metric"),": an im\xadple\xadmen\xadta\xadtion of the vert.x met\xadrics for ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://www.hawkular.org/"}),"Hawku\xadlar"),". In ad\xaddi\xadtion, it lets you re\xadport your own met\xadrics to hawku\xadlar.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},"A new ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-stack-manager/stack-manager/"}),"stack man\xadager")," to con\xadfig\xadure the vert.x dis\xadtri\xadb\xadu\xadtion with the con\xadtent you want.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-shell/java/"}),"vertx-\u200bshell")," is now an of\xadfi\xadcial com\xadpo\xadnent.")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("p",{parentName:"li"},Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-jgroups/java/"}),"vertx-\u200bjgroups"),": an al\xadter\xadna\xadtive im\xadple\xadmen\xadta\xadtion of the vert.x clus\xadter man\xadager using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://jgroups.org/"}),"JGroups"),". This com\xadpo\xadnent is a tech\xadni\xadcal pre\xadview."))),Object(o.a)("p",null,"The re\xadlease also con\xadtains many bug fixes and a ton of im\xadprove\xadments. Full re\xadlease notes can be found here:"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.2.0---Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.2.0-\u200b\u2014Release-Notes")),Object(o.a)("p",null,"Break\xading changes are here:"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.2.0-Breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.2.0-\u200bBreaking-changes")),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Dock\xaders im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),"\nThe vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan"),"."),Object(o.a)("p",null,"Many thanks to all the com\xadmit\xadters and com\xadmu\xadnity whose con\xadtri\xadbu\xadtions made this pos\xadsi\xadble."),Object(o.a)("p",null,"Next stop is Vert.x 3.3.0 which we hope to have out in March 2016."),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.2.0%22"}),"Maven Cen\xadtral"),"\nand you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.2.0/view"}),"Bin\xadtray"),"."))}m.isMDXComponent=!0},oTZn:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Presentation of the Vert.x-Swagger project",category:"guides",authors:[{name:"Florent Chamfroy",github_id:"phiz71"}],summary:"This post is an introduction to the Vert.x-Swagger project, and describe how to use the Swagger-Codegen plugin and the SwaggerRouter class."}),i=[{term:"swagger",tf:32},{term:"us",tf:13},{term:"file",tf:11},{term:"api",tf:10},{term:"codegen",tf:10},{term:"project",tf:9},{term:"creat",tf:8},{term:"router",tf:7},{term:"gener",tf:6},{term:"class",tf:5},{term:"server",tf:4},{term:"definit",tf:4},{term:"verticl",tf:4},{term:"plugin",tf:3},{term:"start",tf:3},{term:"java",tf:3},{term:"provid",tf:3},{term:"tool",tf:3},{term:"base",tf:3},{term:"languag",tf:3},{term:"on",tf:3},{term:"note",tf:3},{term:"rout",tf:3},{term:"paramet",tf:3},{term:"post",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"This post is an in\xadtro\xadduc\xadtion to the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/phiz71/vertx-swagger"}),"Vert.x-\u200bSwagger")," project, and de\xadscribe how to use the ",Object(o.a)("inlineCode",{parentName:"p"},"Swagger-Codegen")," plug\xadin and the ",Object(o.a)("inlineCode",{parentName:"p"},"SwaggerRouter")," class."),Object(o.a)("h2",{id:"eclipse-vertx--swagger"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#eclipse-vertx--swagger"})),"Eclipse Vert.x & Swagger"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-core/java/"}),"Vert.x")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-web/java/"}),"Vert.x Web")," are very con\xadve\xadnient to write REST API and es\xadpe\xadcially the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/Router.html"}),"Router")," which is very use\xadful to man\xadage all re\xadsources of an API."),Object(o.a)("p",null,"But when I start a new API, I usu\xadally use the \u201cdesign-\u200bfirst\u201d ap\xadproach and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://swagger.io/specification/"}),"Swag\xadger")," is my best friend to de\xadfine what my API is sup\xadposed to do. And then, comes the \u201cbor\xading\u201d part of the job : con\xadvert the swag\xadger file con\xadtent into java code. That\u2019s al\xadways the same : re\xadsources, op\xader\xada\xadtions, mod\xadels\u2026"),Object(o.a)("p",null,"For\xadtu\xadnately, Swag\xadger pro\xadvides a code\xadgen tool : ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/swagger-api/swagger-codegen"}),"Swagger-\u200bCodegen"),". With this tool, you can gen\xader\xadate a server stub based on your swag\xadger de\xadf\xadi\xadn\xadi\xadtion file.\nHow\xadever, even if this gen\xader\xada\xadtor pro\xadvides many dif\xadfer\xadent lan\xadguages and frame\xadwork, Vert.X is miss\xading."),Object(o.a)("p",null,"This is where the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/phiz71/vertx-swagger"}),"Vert.x-\u200bSwagger")," project comes in."),Object(o.a)("h2",{id:"the-project"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#the-project"})),"The project"),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"Vert.x-\u200bSwagger")," is a maven project pro\xadvid\xading 2 mod\xadules."),Object(o.a)("h3",{id:"vertx-swagger-codegen"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-swagger-codegen"})),"vertx-swagger-codegen"),Object(o.a)("p",null,"It\u2019s a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/swagger-api/swagger-codegen"}),"Swagger-\u200bCodegen")," plug\xadin, which add the ca\xadpa\xadbil\xadity of gen\xader\xadat\xading a Java Vert.x Web\xadServer to the gen\xader\xada\xadtor."),Object(o.a)("p",null,"The gen\xader\xadated server mainly con\xadtains :"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"POJOs for ",Object(o.a)("inlineCode",{parentName:"li"},"definitions")),Object(o.a)("li",{parentName:"ul"},"one Ver\xadti\xadcle per ",Object(o.a)("inlineCode",{parentName:"li"},"tag")),Object(o.a)("li",{parentName:"ul"},"one Main\xadVer\xadti\xadcle, which man\xadage oth\xaders APIVer\xadti\xadcle and start an HttpServer.")),Object(o.a)("p",null,"[NOTE the Main\xadVer\xadti\xadcle use ",Object(o.a)("em",{parentName:"p"},"vertx-\u200bswagger-router"),"]"),Object(o.a)("h3",{id:"vertx-swagger-router"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-swagger-router"})),"vertx-swagger-router"),Object(o.a)("p",null,"The main class of this mod\xadule is ",Object(o.a)("inlineCode",{parentName:"p"},"SwaggerRouter"),". It\u2019s more or less a ",Object(o.a)("em",{parentName:"p"},"Fac\xadtory")," (and maybe I should re\xadname the class) that can cre\xadate a ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/Router.html"}),"Router"),", using the swag\xadger de\xadf\xadi\xadn\xadi\xadtion file to con\xadfig\xadure all the routes. For each route, it ex\xadtracts pa\xadra\xadme\xadters from the re\xadquest (",Object(o.a)("inlineCode",{parentName:"p"},"Query"),", ",Object(o.a)("inlineCode",{parentName:"p"},"Path"),", ",Object(o.a)("inlineCode",{parentName:"p"},"Header"),", ",Object(o.a)("inlineCode",{parentName:"p"},"Body"),", ",Object(o.a)("inlineCode",{parentName:"p"},"Form"),") and send them on the event\xadBus, using ei\xadther the ",Object(o.a)("inlineCode",{parentName:"p"},"operationId")," as the ad\xaddress or a com\xadputed id (just a pa\xadra\xadme\xadter in the con\xadstruc\xadtor)."),Object(o.a)("h2",{id:"let-see-how-it-works"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#let-see-how-it-works"})),"Let see how it works"),Object(o.a)("p",null,"[INFO For this post, I will use a sim\xadpli\xadfied swag\xadger file but you can find a more com\xadplex ex\xadam\xadple ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/phiz71/vertx-swagger/tree/master/sample/petstore-vertx-server"}),"here")," based on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://petstore.swagger.io/"}),"pet\xadstore")," swag\xadger file]"),Object(o.a)("h3",{id:"generating-the-server"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#generating-the-server"})),"Generating the server"),Object(o.a)("p",null,"First, choose your swag\xadger de\xadf\xadi\xadn\xadi\xadtion. Here\u2019s a YAML File, but it could be a JSON file :"),Object(o.a)("script",{src:"https://gist.github.com/phiz71/6c654f3da2d4124d3fe65e5aaaaedf55.js"}),Object(o.a)("p",null,"Then, down\xadload these li\xadbraries :"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://central.maven.org/maven2/io/swagger/swagger-codegen-cli/2.2.2/swagger-codegen-cli-2.2.2.jar"}),"swagger-\u200bcodegen-cli")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://central.maven.org/maven2/com/github/phiz71/vertx-swagger-codegen/1.0.0/vertx-swagger-codegen-1.0.0.jar"}),"vertx-\u200bswagger-codegen"))),Object(o.a)("p",null,"Fi\xadnally, run this com\xadmand"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"java -cp /path/to/swagger-codegen-cli-2.2.2.jar:/path/to/vertx-swagger-codegen-1.0.0.jar io.swagger.codegen.SwaggerCodegen generate \\\n  -l java-vertx \\\n  -o path/to/destination/folder \\\n  -i path/to/swagger/definition \\\n  --group-id your.group.id \\\n  --artifact-id your.artifact.id\n")),Object(o.a)("p",null,"[INFO For more In\xadfor\xadma\xadtion about how Swag\xadger\xadCode\xadgen works | you can read this https://github.com/swagger-\u200bapi/swagger-\u200bcodegen#getting-\u200bstarted]"),Object(o.a)("p",null,"You should have some\xadthing like that in your con\xadsole:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-gradle"}),"[main] INFO io.swagger.parser.Swagger20Parser - reading ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"from")," ./wineCellarSwagger.yaml\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"java",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/io/"),"swagger",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/server/"),"api",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/model/"),"Bottle.java\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"java",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/io/"),"swagger",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/server/"),"api",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/model/"),"CellarInformation.java\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"java",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/io/"),"swagger",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/server/"),"api",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/verticle/"),"BottlesApi.java\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"java",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/io/"),"swagger",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/server/"),"api",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/verticle/"),"BottlesApiVerticle.java\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"java",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/io/"),"swagger",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/server/"),"api",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/verticle/I"),"nformationApi.java\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"java",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/io/"),"swagger",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/server/"),"api",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/verticle/I"),"nformationApiVerticle.java\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"resources/swagger.json\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"java",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/io/"),"swagger",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/server/"),"api/MainApiVerticle.java\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"src",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/main/"),"resources/vertx-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"default"),"-jul-logging.properties\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"pom.xml\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),"README.md\n[main] INFO io.swagger.codegen.AbstractGenerator - writing ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"file")," [path",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/to/"),"destination",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-regexp"}),"/folder]/"),".swagger-codegen-ignore\n")),Object(o.a)("p",null,"And this in your des\xadti\xadna\xadtion folder:"),Object(o.a)("p",null,Object(o.a)("img",Object(n.a)({parentName:"p"},{src:"/assets/blog/vertx-swagger-presentation/GeneratedProject.png",alt:"Generated sources"}))),Object(o.a)("h3",{id:"what-have-been-created-"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#what-have-been-created-"})),"What have been created ?"),Object(o.a)("p",null,"As you can see in ",Object(o.a)("strong",{parentName:"p"},"1"),",  the ",Object(o.a)("em",{parentName:"p"},"vertx-\u200bswagger-codegen")," plug\xadin has cre\xadated one POJO by ",Object(o.a)("inlineCode",{parentName:"p"},"definition")," in the swag\xadger file."),Object(o.a)("h4",{id:"example--the-bottle-definition"},Object(o.a)("a",Object(n.a)({parentName:"h4"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#example--the-bottle-definition"})),"Example : the bottle definition"),Object(o.a)("script",{src:"https://gist.github.com/phiz71/eabafda440b24881126089128d677121.js"}),Object(o.a)("p",null,"In ",Object(o.a)("strong",{parentName:"p"},"2a")," and ",Object(o.a)("strong",{parentName:"p"},"2b")," you can find :"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"an in\xadter\xadface which con\xadtains a func\xadtion per ",Object(o.a)("inlineCode",{parentName:"li"},"operation")),Object(o.a)("li",{parentName:"ul"},"a ver\xadti\xadcle which de\xadfines all ",Object(o.a)("inlineCode",{parentName:"li"},"operationId")," and cre\xadate ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-core/java/#_the_event_bus_api"}),"Event\xadBus")," con\xadsumers ")),Object(o.a)("h4",{id:"example--the-bottles-interface"},Object(o.a)("a",Object(n.a)({parentName:"h4"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#example--the-bottles-interface"})),"Example : the Bottles interface"),Object(o.a)("script",{src:"https://gist.github.com/phiz71/be1ca2f550f44aea7fb2710b383e26ed.js"}),Object(o.a)("h4",{id:"example--the-bottles-verticle"},Object(o.a)("a",Object(n.a)({parentName:"h4"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#example--the-bottles-verticle"})),"Example : the Bottles verticle"),Object(o.a)("script",{src:"https://gist.github.com/phiz71/c0aadbb4f26ebed8e2e145d0b4a8d210.js"}),Object(o.a)("h3",{id:"-and-now-"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#-and-now-"})),"\u2026 and now ?"),Object(o.a)("p",null,"Line ",Object(o.a)("inlineCode",{parentName:"p"},"23")," of ",Object(o.a)("inlineCode",{parentName:"p"},"BottlesApiVerticle.java"),", you can see this"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"BottlesApi service = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," BottlesApiImpl();\n")),Object(o.a)("p",null,"This line will not com\xadpile until the ",Object(o.a)("inlineCode",{parentName:"p"},"BottlesApiImpl")," class is cre\xadated."),Object(o.a)("p",null,"In all ",Object(o.a)("strong",{parentName:"p"},"XXXAPI"),"Ver\xadti\xadcles, you will find a vari\xadable called ",Object(o.a)("em",{parentName:"p"},"ser\xadvice"),". It is a ",Object(o.a)("strong",{parentName:"p"},"XXXAPI")," type and it is in\xadstan\xadci\xadated with a ",Object(o.a)("strong",{parentName:"p"},"XXXAPI"),"Impl con\xadtruc\xadtor. This class does not exist yet since it is the busi\xadness of your API."),Object(o.a)("p",null,Object(o.a)("strong",{parentName:"p"},"And so you will have to cre\xadate these im\xadple\xadmen\xadta\xadtions.")),Object(o.a)("h2",{id:"fine-but-what-if-i-dont-want-to-build-my-api-like-this-"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#fine-but-what-if-i-dont-want-to-build-my-api-like-this-"})),"Fine, but what if I don\u2019t want to build my API like this ?"),Object(o.a)("p",null,"Well, Vert.x is ",Object(o.a)("strong",{parentName:"p"},"un\xadopin\xadion\xadated")," but the way the ",Object(o.a)("em",{parentName:"p"},"vertx-\u200bswagger-codegen")," cre\xadates the server stub ",Object(o.a)("strong",{parentName:"p"},"is not"),".\nSo if you want to im\xadple\xadment your API the way you want, while en\xadjoy\xading dy\xadnamic rout\xading based on a swag\xadger file, the ",Object(o.a)("em",{parentName:"p"},"vertx-\u200bswagger-router")," li\xadbrary can be used stand\xadalone. "),Object(o.a)("p",null,"Just im\xadport this jar into your project :"),Object(o.a)("script",{src:"https://gist.github.com/phiz71/56e723362a1d1370c7262bff246fb087.js"}),Object(o.a)("p",null,"You will be able to cre\xadate your ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/apidocs/io/vertx/ext/web/Router.html"}),"Router")," like this:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"FileSystem vertxFileSystem = vertx.fileSystem();\nvertxFileSystem.readFile(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"***YOUR_SWAGGER_FILE***"'),", readFile -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (readFile.succeeded()) {\n        Swagger swagger = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," SwaggerParser().parse(readFile.result().toString(Charset.forName(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"utf-8"'),"))); \n        Router swaggerRouter = SwaggerRouter.swaggerRouter(Router.router(vertx), swagger, vertx.eventBus(), ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," OperationIdServiceIdResolver());\n        [...]\n   } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n        [...]\n   }\n});\n")),Object(o.a)("p",null,"[NOTE You can ig\xadnore the last pa\xadra\xadme\xadter in ",Object(o.a)("inlineCode",{parentName:"p"},"SwaggerRouter.swaggerRouter(...)"),". As a re\xadsult, ad\xaddresses will be com\xadputed in\xadstead of using ",Object(o.a)("inlineCode",{parentName:"p"},"operationId")," from the swag\xadger file.\nFor in\xadstance, ",Object(o.a)("inlineCode",{parentName:"p"},"GET /bottles/{bottle_id}")," will be\xadcome ",Object(o.a)("em",{parentName:"p"},"GET_bot\xadtles_bottle-\u200bid"),"]"),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"Vert.x and Swag\xadger are great tools to build and doc\xadu\xadment an API but using both in the same project can be painful. The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/phiz71/vertx-swagger"}),"Vert.x-\u200bSwagger")," project was made to save time, let\xadting the de\xadvel\xadop\xaders fo\xadcus\xading on busi\xadness code.\nIt can be seen as an API frame\xadwork over Vert.X."),Object(o.a)("p",null,"You can also use the ",Object(o.a)("inlineCode",{parentName:"p"},"SwaggerRouter")," in your own project with\xadout using Swagger-\u200bCodegen."),Object(o.a)("p",null,"In fu\xadture re\xadleases, more in\xadfor\xadma\xadtion from the swag\xadger file will be used to con\xadfig\xadure the router and cer\xadtainly oth\xaders lan\xadguages will be sup\xadported."),Object(o.a)("p",null,"[NOTE Though Vert.x is poly\xadglot, Vert.x-\u200bSwagger project only sup\xadports Java. If you want to con\xadtribute to sup\xadport more lan\xadguages, you\u2019re wel\xadcome :) ]"," "),Object(o.a)("p",null,"Thanks for read\xading."))}m.isMDXComponent=!0},"oY/r":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Centralized logging for Vert.x applications using the ELK stack",category:"guides",authors:[{name:"Ricardo Hernandez",github_id:"ricardohmon"}],summary:"This post entry describes a solution to achieve centralized logging of Vert.x applications using the ELK stack (Logstash, Elasticsearch, and Kibana)."}),i=[{term:"log",tf:56},{term:"logstash",tf:26},{term:"filebeat",tf:18},{term:"configur",tf:17},{term:"elasticsearch",tf:15},{term:"us",tf:13},{term:"applic",tf:12},{term:"output",tf:11},{term:"ship",tf:11},{term:"data",tf:11},{term:"elk",tf:10},{term:"stack",tf:10},{term:"log4j",tf:10},{term:"demo",tf:10},{term:"index",tf:10},{term:"set",tf:9},{term:"sourc",tf:8},{term:"allow",tf:8},{term:"solut",tf:7},{term:"kibana",tf:7},{term:"follow",tf:7},{term:"format",tf:7},{term:"plugin",tf:7},{term:"specifi",tf:7},{term:"field",tf:7}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,c=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,c,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"This post entry de\xadscribes a so\xadlu\xadtion to achieve cen\xadtral\xadized log\xadging of Vert.x ap\xadpli\xadca\xadtions using the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.elastic.co/webinars/introduction-elk-stack"}),"ELK stack"),", a set of tools in\xadclud\xading Logstash, Elas\xadtic\xadsearch, and Kibana that are well known to work to\xadgether seam\xadlessly."),Object(o.a)("h2",{id:"preamble"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#preamble"})),"Preamble"),Object(o.a)("p",null,"This post was writ\xadten in con\xadtext of the project ti\xadtled \u201c",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://summerofcode.withgoogle.com/projects/#4858492141699072"}),"De\xadvOps tool\xading for Vert.x ap\xadpli\xadca\xadtions"),"\u201d, one of the Vert.x projects tak\xading place dur\xading the 2016 edi\xadtion of ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://summerofcode.withgoogle.com/about/"}),"Google Sum\xadmer of Code"),", a pro\xadgram that aims to bring to\xadgether stu\xaddents with open source or\xadga\xadni\xadza\xadtions, in order to help them to gain ex\xadpo\xadsure to soft\xadware de\xadvel\xadop\xadment prac\xadtices and real-\u200bworld chal\xadlenges."),Object(o.a)("h2",{id:"introduction"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#introduction"})),"Introduction"),Object(o.a)("p",null,"Cen\xadtral\xadized log\xadging is an im\xadpor\xadtant topic while build\xading a Mi\xadcroser\xadvices ar\xadchi\xadtec\xadture and it is a step for\xadward to adopt\xading the De\xadvOps cul\xadture. Hav\xading an over\xadall so\xadlu\xadtion par\xadti\xadtioned into a set of ser\xadvices dis\xadtrib\xaduted across the In\xadter\xadnet can rep\xadre\xadsent a chal\xadlenge when try\xading to mon\xadi\xadtor the log out\xadput of each of them, hence, a tool that helps to ac\xadcom\xadplish this re\xadsults very help\xadful."),Object(o.a)("h2",{id:"overview"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#overview"})),"Overview"),Object(o.a)("p",null,"As shown in the di\xada\xadgram below, the gen\xaderal cen\xadtral\xadized log\xadging so\xadlu\xadtion com\xadprises two main el\xade\xadments: the ap\xadpli\xadca\xadtion server, which runs our Vert.x ap\xadpli\xadca\xadtion; and a sep\xada\xadrate server, host\xading the ELK stack. Both el\xade\xadments are linked by File\xadbeat, a highly con\xadfig\xadurable tool ca\xadpa\xadble of ship\xadping our ap\xadpli\xadca\xadtion logs to the Logstash in\xadstance, i.e., our gate\xadway to the ELK stack."),Object(o.a)("img",{src:t("Uhhe"),alt:"Overview of centralized logging with ELK"}),Object(o.a)("h2",{id:"app-logging-configuration"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#app-logging-configuration"})),"App logging configuration"),Object(o.a)("p",null,"The ap\xadproach de\xadscribed here is based on a File\xadbeat + Logstash con\xadfig\xadu\xadra\xadtion, that means first we need to make sure our app logs to a file, whose records will be shipped to Logstash by File\xadbeat. Luck\xadily, Vert.x pro\xadvides the means to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-core/java/#_logging"}),"con\xadfig\xadure")," al\xadter\xadna\xadtive log\xadging frame\xadworks (e.g., Log4j, Log4j2 and SLF4J) be\xadsides the de\xadfault JUL log\xadging. How\xadever, we can use File\xadbeat in\xadde\xadpen\xaddently of the log\xadging frame\xadwork cho\xadsen."),Object(o.a)("h3",{id:"log4j-logging"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#log4j-logging"})),"Log4j Logging"),Object(o.a)("p",null,"The demo that ac\xadcom\xadpa\xadnies this post re\xadlies on Log4j2 as the log\xadging frame\xadwork. We in\xadstructed Vert.x to use this frame\xadwork fol\xadlow\xading the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-core/java/#_logging"}),"guide\xadlines")," and we made sure our log\xadging calls are made asyn\xadchro\xadnous, since we don\u2019t want them to block our ap\xadpli\xadca\xadtion. For this pur\xadpose, we opted for the ",Object(o.a)("inlineCode",{parentName:"p"},"AsyncAppender")," and this was in\xadcluded in the Log4J con\xadfig\xadu\xadra\xadtion to\xadgether with the log out\xadput for\xadmat de\xadscribed in a XML con\xadfig\xadu\xadra\xadtion avail\xadable in the ap\xadpli\xadca\xadtion\u2019s ",Object(o.a)("em",{parentName:"p"},"Re\xadsource")," folder."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Configuration"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Appenders"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"RollingFile")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"name"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"vertx_logs"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"append"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"true"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"fileName"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"/var/log/vertx.log"')," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"filePattern"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"/var/log/vertx/$${date:yyyy-MM}/vertx-%d{MM-dd-yyyy}-%i.log.gz"'),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"PatternLayout")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"pattern"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"%d{ISO8601} %-5p %c:%L - %m%n"')," />"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"RollingFile"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Async")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"name"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"vertx_async"'),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"AppenderRef")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"ref"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"vertx_logs"'),"/>"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Async"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Appenders"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Loggers"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Root")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"level"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"DEBUG"'),">"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"AppenderRef")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-attr"}),"ref"),"=",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),'"vertx_async"')," />"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Root"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Loggers"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"Configuration"),">"),"\n")),Object(o.a)("h3",{id:"filebeat-configuration"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#filebeat-configuration"})),"Filebeat configuration"),Object(o.a)("p",null,"Now that we have con\xadfig\xadured the log out\xadput of our Vert.x ap\xadpli\xadca\xadtion to be stored in the file sys\xadtem, we del\xade\xadgate to File\xadbeat the task of for\xadward\xading the logs to the Logstash in\xadstance. File\xadbeat can be con\xadfig\xadured through a YAML file con\xadtain\xading the logs out\xadput lo\xadca\xadtion and the pat\xadtern to in\xadter\xadpret mul\xadti\xadline logs (i.e., stack traces). Also, the Logstash out\xadput plug\xadin is con\xadfig\xadured with the host lo\xadca\xadtion and a se\xadcure con\xadnec\xadtion is en\xadforced using the cer\xadtifi\xadcate from the ma\xadchine host\xading Logstash. We set the ",Object(o.a)("inlineCode",{parentName:"p"},"document_type")," to the type of in\xadstance that this log be\xadlongs to, which could later help us while in\xaddex\xading our logs in\xadside Elas\xadtic\xadsearch."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-yaml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"filebeat:"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"prospectors:"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"document_type:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"trader_dashboard"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"paths:"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"/var/log/vertx.log"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"multiline:"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"pattern:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"^[0-9]+"'),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"negate:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"match:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"after"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"output:"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"logstash:"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"enabled:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"hosts:"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"elk:5044"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"timeout:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"15"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"tls:"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"insecure:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"certificate_authoritites:"),"\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"/etc/pki/tls/certs/logstash-beats.crt"),"\n")),Object(o.a)("h2",{id:"elk-configuration"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#elk-configuration"})),"ELK configuration"),Object(o.a)("p",null,"To take fully ad\xadvan\xadtage of the ELK stack with re\xadspect to Vert.x and our app logs, we need to con\xadfig\xadure each of its in\xaddi\xadvid\xadual com\xadpo\xadnents, namely Logstash, Elas\xadtic\xadsearch and Kibana."),Object(o.a)("h3",{id:"logstash"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#logstash"})),"Logstash"),Object(o.a)("p",null,"Logstash is the com\xadpo\xadnent within the ELK stack that is in charge of ag\xadgre\xadgat\xading the logs from each of the sources and for\xadward\xading them to the Elas\xadtic\xadsearch in\xadstance.",Object(o.a)("br",{parentName:"p"}),"\n","Con\xadfig\xadur\xading Logstash is straight\xadfor\xadward with the help of the spe\xadcific input and out\xadput plu\xadg\xadins for Beats and Elas\xadtic\xadsearch, re\xadspec\xadtively.\nIn the pre\xadvi\xadous sec\xadtion we men\xadtioned that File\xadbeat could be eas\xadily cou\xadpled with Logstash. Now, we see that this can be done by just spec\xadi\xadfy\xading ",Object(o.a)("inlineCode",{parentName:"p"},"Beat")," as the input plug\xadin and set the pa\xadra\xadme\xadters needed to be reached by our ship\xadpers (lis\xadten\xading port, ssl key and cer\xadtifi\xadcate lo\xadca\xadtion)."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"input {\n  beats {\n    port => 5044\n    ssl => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n    ssl_certificate => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/etc/pki/tls/certs/logstash-beats.crt"'),"\n    ssl_key => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/etc/pki/tls/private/logstash-beats.key"'),"\n  }\n}\n")),Object(o.a)("p",null,"Now that we are ready to re\xadceive logs from the app, we can use Logstash fil\xadter\xading ca\xadpa\xadbil\xadi\xadties to spec\xadify the for\xadmat of our logs and ex\xadtract the fields so they can be in\xaddexed more ef\xadfi\xadciently by Elas\xadtic\xadsearch.",Object(o.a)("br",{parentName:"p"}),"\n","The ",Object(o.a)("inlineCode",{parentName:"p"},"grok")," fil\xadter\xading plug\xadin comes handy in this sit\xadu\xada\xadtion. This plug\xadin al\xadlows to de\xadclare the logs for\xadmat using pre\xadde\xadfined and cus\xadtomized pat\xadterns based in reg\xadu\xadlar ex\xadpres\xadsions al\xadlow\xading to de\xadclare new fields from the in\xadfor\xadma\xadtion ex\xadtracted from each log line. In the fol\xadlow\xading block, we in\xadstruct Logstash to rec\xadog\xadnize our Log4j pat\xadtern in\xadside a ",Object(o.a)("inlineCode",{parentName:"p"},"message")," field, which con\xadtains the log mes\xadsage shipped by File\xadbeat. After that, the ",Object(o.a)("inlineCode",{parentName:"p"},"date")," fil\xadter\xading plug\xadin parses the ",Object(o.a)("inlineCode",{parentName:"p"},"timestamp")," field ex\xadtracted in the pre\xadvi\xadous step and re\xadplaces it for the one set by File\xadbeat after read\xading the log out\xadput file."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"filter {\n  grok {\n    break_on_match => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),"\n    match =>  [ ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"message"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"%{LOG4J}"'),"]\n  }\n  date{\n    match => [ ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"timestamp_string"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"ISO8601"'),"]\n    remove_field => [ ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"timestamp_string"')," ]\n  }\n}\n")),Object(o.a)("p",null,"The Log4j pat\xadtern is not in\xadcluded within the Logstash con\xadfig\xadu\xadra\xadtion, how\xadever, we can spec\xadify it using pre\xadde\xadfined data for\xadmats shipped with Logstash and adapt it to the spe\xadcific log for\xadmats re\xadquired in our ap\xadpli\xadca\xadtion, as shown next."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-ruby"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"# Pattern to match our Log4j format"),"\nSPACING (?",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),":"),"[\\s]+)\nLOGGER (?",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),":"),"[a-zA-Z$_][a-zA-Z$_0-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"9"),"]*\\.)*[a-zA-Z$_][a-zA-Z$_0-",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"9"),"]*\nLINE ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"%{INT}"),"?\nLOG4J ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"%{TIMESTAMP_ISO8601:timestamp_string}")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"%{LOGLEVEL:log_level}"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"%{SPACING}"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"%{LOGGER:logger_name}"),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-symbol"}),":",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-string"}),"%{LINE:loc_line}"))," - ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"%{JAVALOGMESSAGE:log_message}"),"\n")),Object(o.a)("p",null,"Fi\xadnally, we take a look at Logstash\u2019s out\xadput con\xadfig\xadu\xadra\xadtion. This sim\xadply points to our elas\xadtic\xadsearch in\xadstance, in\xadstructs it to pro\xadvide a list of all clus\xadter nodes (",Object(o.a)("inlineCode",{parentName:"p"},"sniffing"),"), de\xadfines the name pat\xadtern for our in\xaddices, as\xadsigns the doc\xadu\xadment type ac\xadcord\xading to the meta\xaddata com\xading from File\xadbeat, and al\xadlows to de\xadfine a cus\xadtom index tem\xadplate for our data."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-puppet"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"output")," {\n  elasticsearch {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"hosts")," => [",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),"]\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"sniffing")," => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"manage_template")," => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"index")," => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"%{[@metadata][beat]}-%{+YYYY.MM.dd}"'),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"document_type")," => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"%{[@metadata][type]}"'),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"template")," => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/etc/filebeat/vertx_app_filebeat.json"'),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"template_overwrite")," => ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"\n  }\n}\n")),Object(o.a)("h3",{id:"elasticsearch"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#elasticsearch"})),"Elasticsearch"),Object(o.a)("p",null,"Elas\xadtic\xadsearch is the cen\xadtral com\xadpo\xadnent that en\xadables the ef\xadfi\xadcient in\xaddex\xading and real-\u200btime search ca\xadpa\xadbil\xadi\xadties of the stack. To take the most ad\xadvan\xadtage of Elas\xadtic\xadsearch, we can pro\xadvide an in\xaddex\xading tem\xadplate of our in\xadcom\xading logs, which can help to op\xadti\xadmize the data stor\xadage and match the queries is\xadsued by Kibana at a later point.",Object(o.a)("br",{parentName:"p"}),"\n","In the ex\xadam\xadple below, we see an index tem\xadplate that would be ap\xadplied to any index match\xading the pat\xadtern ",Object(o.a)("inlineCode",{parentName:"p"},"filebeat-*"),". Ad\xaddi\xadtion\xadally, we de\xadclare our new log fields ",Object(o.a)("inlineCode",{parentName:"p"},"type"),", ",Object(o.a)("inlineCode",{parentName:"p"},"host"),", ",Object(o.a)("inlineCode",{parentName:"p"},"log_level"),", ",Object(o.a)("inlineCode",{parentName:"p"},"logger_name"),", and ",Object(o.a)("inlineCode",{parentName:"p"},"log_message"),", which are set as ",Object(o.a)("inlineCode",{parentName:"p"},"not_analyzed")," ex\xadcept for the last two that are set as ",Object(o.a)("inlineCode",{parentName:"p"},"analyzed")," al\xadlow\xading to per\xadform queries based on reg\xadu\xadlar ex\xadpres\xadsions and not re\xadstricted to query the full text."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"mappings"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"_default_"'),": {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"_all"'),": {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"enabled"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),",\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"norms"'),": {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"enabled"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"false"),"\n        }\n      },\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"dynamic_templates"'),": [\n        {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"template1"'),": {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"mapping"'),": {\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"doc_values"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),",\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"ignore_above"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1024"),",\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"index"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"not_analyzed"'),",\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"{dynamic_type}"'),"\n            },\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"match"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"*"'),"\n          }\n        }\n      ],\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"properties"'),": {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"@timestamp"'),": {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"date"'),"\n        },\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"offset"'),": {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"long"'),",\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"doc_values"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"true"'),"\n        },\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": { ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"string"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"index"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"not_analyzed"')," },\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"host"'),": { ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"string"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"index"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"not_analyzed"')," },\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"log_level"'),": { ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"string"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"index"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"not_analyzed"')," },\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"logger_name"'),": { ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"string"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"index"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"analyzed"')," },\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"log_message"'),": { ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"type"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"string"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"index"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"analyzed"')," }\n      }\n    }\n  },\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"settings"'),": {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"index.refresh_interval"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"5s"'),"\n  },\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"template"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"filebeat-*"'),"\n}\n")),Object(o.a)("h3",{id:"kibana"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#kibana"})),"Kibana"),Object(o.a)("p",null,"Al\xadthough we could fetch all our logs from Elas\xadtic\xadsearch through its API, Kibana is a pow\xader\xadful tool that al\xadlows a more friendly query and vi\xadsu\xadal\xadiza\xadtion.\nBe\xadsides the op\xadtion to query our data through the avail\xadable in\xaddexed field names and search boxes al\xadlow\xading typ\xading spe\xadcific queries, Kibana al\xadlows cre\xadat\xading our own ",Object(o.a)("em",{parentName:"p"},"Vi\xadsu\xadal\xadiza\xadtions")," and ",Object(o.a)("em",{parentName:"p"},"Dash\xadboards"),". Com\xadbined, they rep\xadre\xadsent a pow\xader\xadful way to dis\xadplay data and gain in\xadsight in a cus\xadtomized man\xadner.\nThe ac\xadcom\xadpa\xadnied demo ships with a cou\xadple of sam\xadple dash\xadboards and vi\xadsu\xadal\xadiza\xadtions that take ad\xadvan\xadtage of the log fields that we spec\xadi\xadfied in our index tem\xadplate and throw valu\xadable in\xadsight. This in\xadcludes: vi\xadsu\xadal\xadiz\xading the num\xadber of log mes\xadsages re\xadceived by ELK, ob\xadserve the pro\xadpor\xadtion of mes\xadsages that each log source pro\xadduces, and di\xadrectly find out the sources of error logs."),Object(o.a)("img",{src:t("ghJH"),alt:"Kibana Dashboard",width:"550"}),Object(o.a)("h2",{id:"log-shipping-challenge"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#log-shipping-challenge"})),"Log shipping challenge"),Object(o.a)("p",null,"The so\xadlu\xadtion pre\xadsented here re\xadlied on File\xadbeat to ship log data to Logstash. How\xadever, if you are fa\xadmil\xadiar with the Log4j frame\xadwork you may be aware that there ex\xadists a ",Object(o.a)("em",{parentName:"p"},"Sock\xade\xadtAp\xadpen\xadder")," that al\xadlows to write log events di\xadrectly to a re\xadmote server using a TCP con\xadnec\xadtion. Al\xadthough in\xadclud\xading the File\xadbeat + Logstash com\xadbi\xadna\xadtion  may sound an un\xadnec\xades\xadsary over\xadhead to the log\xadging pipeline, they pro\xadvide a num\xadber of ben\xade\xadfits in com\xadpar\xadi\xadson to the Log4j socket al\xadter\xadna\xadtive:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"The Sock\xade\xadtAp\xadpen\xadder re\xadlies on the spe\xadcific se\xadri\xadal\xadiza\xadtion of Log4j\u2019s ",Object(o.a)("em",{parentName:"li"},"Lo\xadgEvent")," ob\xadjects, which is no an in\xadter\xadchange\xadable for\xadmat as JSON, which is used by the Beats so\xadlu\xadtion. Al\xadthough there are ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/majikthys/log4j2-logstash-jsonevent-layout"}),"at\xadtempts")," to out\xadput the logs in a JSON for\xadmat for Logstash, it doesn\u2019t sup\xadport mul\xadti\xadline logs, which re\xadsults in mes\xadsages being split into dif\xadfer\xadent events by Logstash. On the other hand, there is no of\xadfi\xadcial nor sta\xadble ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.elastic.co/guide/en/logstash/current/input-plugins.html"}),"input plugin")," for Log4j ver\xadsion 2."),Object(o.a)("li",{parentName:"ul"},"While en\xadabling Log4j\u2019s async log\xadging mode in an ap\xadpli\xadca\xadtion del\xade\xadgates log\xadging op\xader\xada\xadtions to sep\xada\xadrate threads, given their co\xadex\xadis\xadtence in the same JVM there is still the risk of data loss in case of a sud\xadden JVM ter\xadmi\xadna\xadtion with\xadout proper log chan\xadnel clos\xading."),Object(o.a)("li",{parentName:"ul"},"File\xadbeat is a data ship\xadper de\xadsigned to deal with many con\xadstraints that arise in dis\xadtrib\xaduted en\xadvi\xadron\xadments in a re\xadli\xadable man\xadner, there\xadfore it pro\xadvides op\xadtions to tai\xadlor and scale this op\xader\xada\xadtion to our needs: the pos\xadsi\xadbil\xadity to load bal\xadance be\xadtween mul\xadti\xadple Logstash in\xadstances, spec\xadify the num\xadber of si\xadmul\xadta\xadne\xadous File\xadbeat work\xaders that ship log files, and spec\xadify a com\xadpres\xadsion level in order to re\xadduce the con\xadsumed band\xadwidth. Be\xadsides that, logs can be shipped in spe\xadcific batch sizes, with max\xadi\xadmum amount of re\xadtries, and spec\xadi\xadfy\xading a con\xadnec\xadtion time\xadout."),Object(o.a)("li",{parentName:"ul"},"Lastly, al\xadthough File\xadbeat can for\xadward logs di\xadrectly to Elas\xadtic\xadsearch, using Logstash as an in\xadter\xadme\xaddi\xadary of\xadfers the pos\xadsi\xadbil\xadity to col\xadlect logs from di\xadverse sources (e.g., sys\xadtem met\xadrics).")),Object(o.a)("h2",{id:"demo"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#demo"})),"Demo"),Object(o.a)("p",null,"This post is ac\xadcom\xadpa\xadnied by a demo based on the Vert.x Mi\xadcroser\xadvices ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx-lab.dynamis-technologies.com/"}),"work\xadshop"),", where each of them is shipped in a Docker con\xadtainer sim\xadu\xadlat\xading a dis\xadtrib\xaduted sys\xadtem com\xadposed of in\xadde\xadpen\xaddent ad\xaddress\xadable nodes.",Object(o.a)("br",{parentName:"p"}),"\n","Also, the ELK stack is pro\xadvi\xadsioned using a pre\xadcon\xadfig\xadured Docker image by ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/spujadas"}),"S\xe9bastien Pu\xadjadas"),"."),Object(o.a)("p",null,"Fol\xadlow\xading the guide\xadlines in this post, this demo con\xadfig\xadures each of the Mi\xadcroser\xadvices of the work\xadshop, sets up a File\xadbeat process on each of them to ship the logs to a cen\xadtral con\xadtainer host\xading the ELK stack."),Object(o.a)("h3",{id:"installation"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#installation"})),"Installation"),Object(o.a)("p",null,"In order to run this demo, it is nec\xades\xadsary to have Docker in\xadstalled, then pro\xadceed with:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Cloning or down\xadload\xading the demo ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/ricardohmon/vertx-elk"}),"repos\xadi\xadtory"),"."),Object(o.a)("li",{parentName:"ul"},"Sep\xada\xadrately, ob\xadtain\xading the source code of the ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/ricardohmon/vertx-microservices-workshop/tree/elk-demo"}),"branch")," of the Mi\xadcroser\xadvices work\xadshop adapted for this demo.")),Object(o.a)("h3",{id:"building-the-example"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#building-the-example"})),"Building the example"),Object(o.a)("p",null,"The Docker im\xadages be\xadlong\xading to the Vert.x Mi\xadcroser\xadvices work\xadshop need to be built sep\xada\xadrately to this project be\xadfore this project can be launched."),Object(o.a)("h3",{id:"building-the-vertx-microservices-workshop-docker-images"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#building-the-vertx-microservices-workshop-docker-images"})),"Building the Vert.x Microservices workshop Docker images."),Object(o.a)("p",null,"Build the ",Object(o.a)("em",{parentName:"p"},"root")," project and the ",Object(o.a)("em",{parentName:"p"},"Trader Dash\xadboard")," fol\xadlowed by each of the mod\xadules con\xadtained in the so\xadlu\xadtion folder. Issue the fol\xadlow\xading com\xadmands for this:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"mvn clean install\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"cd")," trader-dashboard\nmvn package docker:build\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"cd")," ../solution/audit-service\nmvn package docker:build\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"cd")," ../compulsive-traders\nmvn package docker:build\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"cd")," ../portfolio-service\nmvn package docker:build\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-built_in"}),"cd")," ../quote-generator/\nmvn package docker:build\n")),Object(o.a)("h3",{id:"running-the-example"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#running-the-example"})),"Running the example"),Object(o.a)("p",null,"After build\xading the pre\xadvi\xadous im\xadages, build and run the ex\xadam\xadple in ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-elk")," using the fol\xadlow\xading com\xadmand:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-ebnf"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attribute"}),"docker-compose up"),"\n")),Object(o.a)("h3",{id:"the-demo"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#the-demo"})),"The demo"),Object(o.a)("p",null,"You can watch the demo in ac\xadtion in the fol\xadlow\xading screen\xadcast:"),Object(o.a)("div",{className:"youtube-embed"},Object(o.a)("iframe",{src:"https://www.youtube.com/embed/8P-MgXSujes",frameBorder:"0",allowFullScreen:!0})),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"The ELK stack is a pow\xader\xadful set of tools that ease the ag\xadgre\xadga\xadtion of logs com\xading from dis\xadtrib\xaduted ser\xadvices into a cen\xadtral server. Its main pil\xadlar, Elas\xadtic\xadsearch, pro\xadvides the in\xaddex\xading and search ca\xadpa\xadbil\xadi\xadties of our log data. Also, it is ac\xadcom\xadpa\xadnied by the con\xadve\xadnient input/out\xadput com\xadpo\xadnents: Logstash, which can be flex\xadi\xadbly con\xadfig\xadured to ac\xadcept dif\xadfer\xadent data sources; and Kibana, which can be cus\xadtomized to present the in\xadfor\xadma\xadtion in the most con\xadve\xadnient way."),Object(o.a)("p",null,"Logstash has been de\xadsigned to work seam\xadlessly with File\xadbeat, the log ship\xadper which rep\xadre\xadsents a ro\xadbust so\xadlu\xadtion that can be adapted to our ap\xadpli\xadca\xadtions with\xadout hav\xading to make ",Object(o.a)("em",{parentName:"p"},"sig\xadnif\xadi\xadcant")," changes to our ar\xadchi\xadtec\xadture. In ad\xaddi\xadtion, Logstash can ac\xadcept var\xadied types of sources, fil\xadter the data, and process it be\xadfore de\xadliv\xader\xading to Elas\xadtic\xadsearch. This flex\xadi\xadbil\xadity comes with the price of hav\xading extra el\xade\xadments in our log ag\xadgre\xadga\xadtion pipeline, which can rep\xadre\xadsent an in\xadcrease of pro\xadcess\xading over\xadhead or a point-\u200bof-failure. This ad\xaddi\xadtional over\xadhead could be avoided if an ap\xadpli\xadca\xadtion would be ca\xadpa\xadble of de\xadliv\xader\xading its log out\xadput di\xadrectly to Elas\xadtic\xadsearch."),Object(o.a)("p",null,"Happy log\xadging!"))}m.isMDXComponent=!0},odkl:function(e,a){e.exports="/_next/static/images/rpi-16e40eae23f1df32a41e83ddb5af8904.png"},"pJo+":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x metrics now with Micrometer.io",category:"guides",authors:[{name:"Joel Takvorian",github_id:"jotak"}],summary:"The new vertx-micrometer-metrics module provides support for collecting metrics with Micrometer.io and storing them in backends such as Graphite or InfluxDB."}),i=[{term:"metric",tf:36},{term:"prometheu",tf:14},{term:"backend",tf:13},{term:"micromet",tf:12},{term:"will",tf:11},{term:"time",tf:10},{term:"influxdb",tf:10},{term:"configur",tf:10},{term:"us",tf:9},{term:"http",tf:9},{term:"exampl",tf:8},{term:"server",tf:8},{term:"provid",tf:7},{term:"sever",tf:7},{term:"etc",tf:7},{term:"registri",tf:6},{term:"queri",tf:6},{term:"modul",tf:5},{term:"implement",tf:5},{term:"collect",tf:5},{term:"support",tf:5},{term:"jmx",tf:5},{term:"dimens",tf:5},{term:"sent",tf:5},{term:"maven",tf:5}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Vert.x has al\xadready been pro\xadvid\xading met\xadrics for some time, through the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-dropwizard-metrics/java/"}),"vertx-\u200bdropwizard-metrics")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-hawkular-metrics/java/"}),"vertx-\u200bhawkular-metrics")," mod\xadules. Both of them im\xadple\xadment a ser\xadvice provider in\xadter\xadface (SPI) to col\xadlect the Vert.x met\xadrics and make them avail\xadable to their re\xadspec\xadtive back\xadends."),Object(o.a)("p",null,"A new mod\xadule, ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-micrometer-metrics/java/"}),"vertx-\u200bmicrometer-metrics"),", is now added to the fam\xadily. It im\xadple\xadments the same SPI, which means that it is able to pro\xadvide the same met\xadrics.\n",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://micrometer.io/"}),Object(o.a)("em",{parentName:"a"},"Mi\xadcrom\xade\xadter.io"))," is a pretty new met\xadrics li\xadbrary, quite com\xadpa\xadra\xadble to ",Object(o.a)("em",{parentName:"p"},"drop\xadwiz\xadard met\xadrics")," in that it col\xadlects met\xadrics in a local, in-\u200bmemory reg\xadistry and is able to store them in var\xadi\xadous back\xadends such as ",Object(o.a)("em",{parentName:"p"},"Graphite")," or ",Object(o.a)("em",{parentName:"p"},"In\xadfluxDB"),". It has sev\xaderal ad\xadvan\xadtages as we will see below."),Object(o.a)("h2",{id:"tell-me-more-about-micrometer"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#tell-me-more-about-micrometer"})),"Tell me more about Micrometer"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://micrometer.io/"}),Object(o.a)("em",{parentName:"a"},"Mi\xadcrom\xade\xadter.io"))," de\xadscribes it\xadself as a a vendor-\u200bneutral ap\xadpli\xadca\xadtion met\xadrics fa\xadcade.\nIt pro\xadvides a well de\xadsigned API, in Java, to de\xadfine ",Object(o.a)("em",{parentName:"p"},"gauges"),", ",Object(o.a)("em",{parentName:"p"},"coun\xadters"),", ",Object(o.a)("em",{parentName:"p"},"timers")," and ",Object(o.a)("em",{parentName:"p"},"dis\xadtri\xadb\xadu\xadtion sum\xadmaries"),"."),Object(o.a)("p",null,"Among the avail\xadable back\xadends, Mi\xadcrom\xade\xadter na\xadtively sup\xadports ",Object(o.a)("em",{parentName:"p"},"Graphite"),", ",Object(o.a)("em",{parentName:"p"},"In\xadfluxDB"),", ",Object(o.a)("em",{parentName:"p"},"JMX"),", ",Object(o.a)("em",{parentName:"p"},"Prometheus")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://micrometer.io/docs"}),"sev\xaderal oth\xaders"),". Prometheus is very pop\xadu\xadlar in the Ku\xadber\xadnetes and mi\xadcroser\xadvices ecosys\xadtems, so its sup\xadport by Mi\xadcrom\xade\xadter was a strong mo\xadti\xadva\xadtion for im\xadple\xadment\xading it in Vert.x."),Object(o.a)("p",null,"For the the mo\xadment, our im\xadple\xadmen\xadta\xadtion in Vert.x sup\xadports ",Object(o.a)("em",{parentName:"p"},"Prometheus"),", ",Object(o.a)("em",{parentName:"p"},"In\xadfluxDB")," and ",Object(o.a)("em",{parentName:"p"},"JMX"),". More should quickly come in the near fu\xadture."),Object(o.a)("h3",{id:"dimensionality"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#dimensionality"})),"Dimensionality"),Object(o.a)("p",null,"An\xadother in\xadter\xadest\xading as\xadpect in Mi\xadcrom\xade\xadter is that it han\xaddles met\xadrics ",Object(o.a)("em",{parentName:"p"},"di\xadmen\xadsion\xadal\xadity"),": met\xadrics can be as\xadso\xadci\xadated with a set of key/value pairs (some\xadtimes ref\xadered as ",Object(o.a)("em",{parentName:"p"},"tags"),", some\xadtimes as ",Object(o.a)("em",{parentName:"p"},"la\xadbels"),"). Every value brings a new di\xadmen\xadsion to the met\xadric, so that in Prometheus or any other back\xadend that sup\xadports di\xadmen\xadsion\xadal\xadity, we can query for dat\xada\xadpoints of one or sev\xaderal di\xadmen\xadsions, or query for dat\xada\xadpoints ag\xadgre\xadgated over sev\xaderal di\xadmen\xadsions."),Object(o.a)("p",null,"  ",Object(o.a)("em",{parentName:"p"},"Ex\xadam\xadple: our met\xadric ",Object(o.a)("inlineCode",{parentName:"em"},"vertx_http_server_connections")," ac\xadcepts la\xadbels ",Object(o.a)("inlineCode",{parentName:"em"},"local")," and ",Object(o.a)("inlineCode",{parentName:"em"},"remote"),", that are used to store ad\xaddresses on HTTP con\xadnec\xadtions")),Object(o.a)("p",null,"[NOTE | Prometheus is used in the fol\xadlow\xading ex\xadam\xadples, but equiv\xada\xadlent queries can be per\xadformed with ",Object(o.a)("em",{parentName:"p"},"In\xadfluxDB"),".]"),Object(o.a)("p",null,"In Prometheus, the query ",Object(o.a)("inlineCode",{parentName:"p"},"vertx_http_server_connections")," will re\xadturn as many time\xadseries as there are com\xadbi\xadna\xadtions of ",Object(o.a)("inlineCode",{parentName:"p"},"local")," and ",Object(o.a)("inlineCode",{parentName:"p"},"remote")," val\xadues. Ex\xadam\xadple:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-basic"}),"vertx_http_server_connections{local=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0.0.0.0:8080"'),",",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'remote="1.1.1.1"}'),"\nvertx_http_server_connections{local=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0.0.0.0:8080"'),",",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'remote="2.2.2.2"}'),"\nvertx_http_server_connections{local=",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"0.0.0.0:8080"'),",",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'remote="3.3.3.3"}'),"\n")),Object(o.a)("p",null,"To query on a sin\xadgle di\xadmen\xadsion, we must pro\xadvide the la\xadbels:"),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},'vertx_http_server_connections{local="0.0.0.0:8080",remote="1.1.1.1"}'),". It will re\xadturn a sin\xadgle time\xadseries."),Object(o.a)("p",null,"To get an ag\xadgre\xadgate, Prometheus (PromQL) pro\xadvides sev\xaderal ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators"}),"ag\xadgre\xadga\xadtion op\xader\xada\xadtors"),":"),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"sum(vertx_http_server_connections)")," will re\xadturn the sum across all di\xadmen\xadsions."),Object(o.a)("h2",{id:"so-what-are-the-vertx-metrics"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#so-what-are-the-vertx-metrics"})),"So what are the Vert.x metrics?"),Object(o.a)("p",null,"Peo\xadple al\xadready fa\xadmil\xadiar with the ex\xadist\xading met\xadrics mod\xadules (",Object(o.a)("em",{parentName:"p"},"drop\xadwiz\xadard")," or ",Object(o.a)("em",{parentName:"p"},"hawku\xadlar"),") will not be too dis\xadori\xadented. They are roughly the same. The main dif\xadfer\xadence is where pre\xadvi\xadously, some met\xadric names could have a vari\xadable part within - such as ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.eventbus.handlers.myaddress")," - here we take ad\xadvan\xadtage of di\xadmen\xadsion\xadal\xadity and we will have ",Object(o.a)("inlineCode",{parentName:"p"},'vertx_eventbus_handlers{address="myaddress"}'),"."),Object(o.a)("p",null,"Some other met\xadrics are no longer use\xadful, for in\xadstance the drop\xadwiz\xadard\u2019s ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.eventbus.messages.pending"),", ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.eventbus.messages.pending-local")," and ",Object(o.a)("inlineCode",{parentName:"p"},"vertx.eventbus.messages.pending-remote")," are now just ",Object(o.a)("inlineCode",{parentName:"p"},"vertx_eventbus_pending{side=local}")," and ",Object(o.a)("inlineCode",{parentName:"p"},"vertx_eventbus_pending{side=remote}")," in mi\xadcrom\xade\xadter. The sum of them can eas\xadily be com\xadputed at query time."),Object(o.a)("p",null,"The met\xadrics pro\xadvided by Vert.x are dis\xadpatched into eight big fam\xadi\xadlies:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"Net client"),": dis\xadtri\xadb\xadu\xadtion sum\xadmaries of bytes sent and re\xadceived, num\xadber of con\xadnec\xadtions, etc."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"Net server"),": dis\xadtri\xadb\xadu\xadtion sum\xadmaries of bytes sent and re\xadceived, num\xadber of con\xadnec\xadtions, etc."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"HTTP client"),": counter of re\xadquests, re\xadsponse times, etc."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"HTTP server"),": counter of re\xadquests, pro\xadcess\xading times, etc."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"Event bus"),": counter of han\xaddlers, mes\xadsages sent and re\xadceived, etc."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"Pool"),": for worker pools and some data\xadsource pools, queue size and wait\xading time, pro\xadcess\xading time, etc."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"Ver\xadti\xadcles"),": num\xadber of ver\xadti\xadcles de\xadployed.")),Object(o.a)("p",null,"The full list of col\xadlected met\xadrics is ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-micrometer-metrics/java/#_vert_x_core_tools_metrics"}),"avail\xadable here"),"."),Object(o.a)("h2",{id:"getting-started"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#getting-started"})),"Getting started"),Object(o.a)("p",null,"This sec\xadtion will guide you through a quick setup to run a Vert.x ap\xadpli\xadca\xadtion with Mi\xadcrom\xade\xadter. The code ex\xadam\xadples used here are taken from the ",Object(o.a)("inlineCode",{parentName:"p"},"micrometer-metrics-example")," in ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-examples")," repos\xadi\xadtory, in Java, using ",Object(o.a)("em",{parentName:"p"},"maven"),". But the same could be done with other Vert.x sup\xadported lan\xadguages, as well as ",Object(o.a)("em",{parentName:"p"},"gra\xaddle")," in\xadstead of ",Object(o.a)("em",{parentName:"p"},"maven"),"."),Object(o.a)("h3",{id:"maven-configuration"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#maven-configuration"})),"Maven configuration"),Object(o.a)("p",null,"The con\xadfig\xadu\xadra\xadtion and the maven im\xadports will vary ac\xadcord\xading to the back\xadend stor\xadage that will be used. For maven, the com\xadmon part is al\xadways:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-micrometer-metrics",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.5.1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Then, to re\xadport to In\xadfluxDB:")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.micrometer",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"micrometer-registry-influx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Or Prometheus:")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.micrometer",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"micrometer-registry-prometheus",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-web",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.5.1",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"Re\xadmark that, since Prometheus pulls met\xadrics from their source, they must be ex\xadposed on an HTTP end\xadpoint. That\u2019s why ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-web")," is im\xadported here. It is not ",Object(o.a)("em",{parentName:"p"},"ab\xadsolutely")," nec\xades\xadsary (it\u2019s pos\xadsi\xadble to get the met\xadrics reg\xadistry con\xadtent and ex\xadpose it in any other way) but it\u2019s prob\xada\xadbly the eas\xadi\xadest way to do."),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Or JMX:")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.micrometer",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"micrometer-registry-jmx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"1.0.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"[NOTE Note | At the mo\xadment, it is not pos\xadsi\xadble to re\xadport met\xadrics to sev\xaderal back\xadends at the same time. ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16"}),"It might be soon im\xadple\xadmented"),"]."),Object(o.a)("h3",{id:"setting-up-vertx-options"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#setting-up-vertx-options"})),"Setting up Vert.x options"),Object(o.a)("p",null,"A ",Object(o.a)("inlineCode",{parentName:"p"},"MicrometerMetricsOptions")," ob\xadject must be cre\xadated and passed to ",Object(o.a)("inlineCode",{parentName:"p"},"VertxOptions"),", with one back\xadend con\xadfig\xadured (though hav\xading no back\xadend is pos\xadsi\xadble: you would get met\xadrics sent to a de\xadfault Mi\xadcrom\xade\xadter reg\xadistry, but with\xadout any per\xadsis\xadtent stor\xadage)."),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"In\xadfluxDB ex\xadam\xadple:")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// Default InfluxDB options will push metrics to localhost:8086, db "default"'),"\nMicrometerMetricsOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MicrometerMetricsOptions()\n  .setInfluxDbOptions(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxInfluxDbOptions().setEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"))\n  .setEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\nVertx vertx = Vertx.vertx(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxOptions().setMetricsOptions(options));\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Then deploy verticles with this vertx instance"),"\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Prometheus ex\xadam\xadple:")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Deploy with embedded server: prometheus metrics will be automatically exposed,"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// independently from any other HTTP server defined"),"\nMicrometerMetricsOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MicrometerMetricsOptions()\n  .setPrometheusOptions(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxPrometheusOptions()\n    .setStartEmbeddedServer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),")\n    .setEmbeddedServerOptions(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," HttpServerOptions().setPort(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8081"),"))\n    .setEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"))\n  .setEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\nVertx vertx = Vertx.vertx(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxOptions().setMetricsOptions(options));\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Then deploy verticles with this vertx instance"),"\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Or Prometheus with the ",Object(o.a)("inlineCode",{parentName:"li"},"/metrics")," end\xadpoint bound to an ex\xadist\xading HTTP server:")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// Deploy without embedded server: we need to "manually" expose the prometheus metrics'),"\nMicrometerMetricsOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MicrometerMetricsOptions()\n  .setPrometheusOptions(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxPrometheusOptions().setEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"))\n  .setEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\nVertx vertx = Vertx.vertx(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxOptions().setMetricsOptions(options));\n\nRouter router = Router.router(vertx);\nPrometheusMeterRegistry registry = (PrometheusMeterRegistry) BackendRegistries.getDefaultNow();\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Setup a route for metrics"),"\nrouter.route(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/metrics"'),").handler(ctx -> {\n  String response = registry.scrape();\n  ctx.response().end(response);\n});\nvertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"JMX ex\xadam\xadple:")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),'// Default JMX options will publish MBeans under domain "metrics"'),"\nMicrometerMetricsOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," MicrometerMetricsOptions()\n  .setJmxMetricsOptions(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxJmxMetricsOptions().setEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),"))\n  .setEnabled(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),");\nVertx vertx = Vertx.vertx(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," VertxOptions().setMetricsOptions(options));\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Then deploy verticles with this vertx instance"),"\n")),Object(o.a)("h3",{id:"setup-the-backend-server"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#setup-the-backend-server"})),"Setup the backend server"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.influxdata.com/"}),"In\xadfluxDB"),", by de\xadfault, is ex\xadpected to run on ",Object(o.a)("inlineCode",{parentName:"li"},"localhost:8086")," with\xadout au\xadthen\xadti\xadca\xadtion, data\xadbase \u201cde\xadfault\u201d. It is con\xadfig\xadurable in ",Object(o.a)("inlineCode",{parentName:"li"},"VertxInfluxDbOptions"),".\nIf you don\u2019t have a run\xadning in\xadstance of In\xadfluxDB, the short\xadest way to start is cer\xadtainly with docker, just run:")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),"docker run -p 8086:8086 influxdb\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://prometheus.io/docs/prometheus/latest/getting_started/"}),"Prometheus")," needs some con\xadfig\xadu\xadra\xadtion since it pulls met\xadrics from the sources. Once it is in\xadstalled, con\xadfig\xadure the scrape end\xadpoints in ",Object(o.a)("inlineCode",{parentName:"li"},"prometheus.yml"),":")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-yaml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"job_name:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'vertx-8081'"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"static_configs:"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"targets:")," [",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'localhost:8081'"),"]\n")),Object(o.a)("p",null,"or, when using ",Object(o.a)("inlineCode",{parentName:"p"},"/metrics")," end\xadpoint bound to an ex\xadist\xading HTTP server:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-yaml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"job_name:")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'vertx-8080'"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"static_configs:"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-bullet"}),"-")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),"targets:")," [",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"'localhost:8080'"),"]\n")),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"For JMX there is noth\xading spe\xadcial to con\xadfig\xadure.")),Object(o.a)("h3",{id:"collecting-vertx-metrics"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#collecting-vertx-metrics"})),"Collecting Vert.x metrics"),Object(o.a)("p",null,"From now on, all Vert.x met\xadrics will be col\xadlected and sent to the con\xadfig\xadured back\xadend. In our Vert.x ex\xadam\xadple, we setup an HTTP server met\xadrics:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Router router = Router.router(vertx);\nrouter.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(ctx -> {\n  ctx.response().end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello Micrometer from HTTP!"'),");\n});\nvertx.createHttpServer().requestHandler(router::accept).listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),");\n")),Object(o.a)("p",null," And some event bus ping-\u200bpong:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Producer side"),"\nvertx.setPeriodic(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1000"),", x -> {\n  vertx.eventBus().send(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"greeting"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello Micrometer from event bus!"'),");\n});\n")),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Consumer side"),"\nvertx.eventBus().<String>consumer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"greeting"'),", message -> {\n  String greeting = message.body();\n  System.out.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Received: "')," + greeting);\n  message.reply(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Hello back!"'),");\n});\n")),Object(o.a)("p",null,"To trig\xadger some ac\xadtiv\xadity on the HTTP server, we can write a small bash script:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-bash"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"while")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-literal"}),"true"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"do")," curl http://localhost:8080/\n    sleep .8\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"done"),"\n")),Object(o.a)("h3",{id:"viewing-the-results"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#viewing-the-results"})),"Viewing the results"),Object(o.a)("p",null,Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://grafana.com/"}),"Grafana")," can be used to dis\xadplay the In\xadfluxDB and Prometheus met\xadrics. The ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-examples")," repos\xadi\xadtory con\xadtains two dash\xadboards for that: ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-InfluxDB.json"}),"for In\xadfluxDB")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-Prometheus.json"}),"for Prometheus"),"."),Object(o.a)("h5",{id:"http-server-metrics"},Object(o.a)("a",Object(n.a)({parentName:"h5"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#http-server-metrics"})),"HTTP server metrics"),Object(o.a)("img",{alt:"HTTP server metrics",className:"img-fluid",src:"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/http-server-metrics.png"}),Object(o.a)("h5",{id:"event-bus-metrics"},Object(o.a)("a",Object(n.a)({parentName:"h5"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#event-bus-metrics"})),"Event bus metrics"),Object(o.a)("img",{alt:"Event bus metrics",className:"img-fluid",src:"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/eventbus-metrics.png"}),Object(o.a)("h2",{id:"going-further"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#going-further"})),"Going further"),Object(o.a)("p",null,"We\u2019ve seen the basic setup. There is a good bunch of op\xadtions avail\xadable, de\xadtailed ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-micrometer-metrics/java/"}),"in the doc\xadu\xadmen\xadta\xadtion"),": how to dis\xadable some met\xadrics do\xadmains, how to fil\xadter or re\xadarrange la\xadbels, how to ex\xadport met\xadrics snap\xadshots to Json ob\xadjects, how to add JVM or proces\xadsor in\xadstru\xadmen\xadta\xadtion, etc."),Object(o.a)("p",null,"Be\xadfore we fin\xadish, there is one im\xadpor\xadtant point that we can cover here: defin\xading cus\xadtom met\xadrics.\nBe\xadcause the mod\xadule gives you ac\xadcess to its Mi\xadcrom\xade\xadter reg\xadistry, you can add your cus\xadtom met\xadrics there."),Object(o.a)("p",null,"Get\xadting the de\xadfault reg\xadistry is straight\xadfor\xadward:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"MeterRegistry registry = BackendRegistries.getDefaultNow();\n")),Object(o.a)("p",null,"Then you have plain ac\xadcess to the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://micrometer.io/docs/concepts"}),"Mi\xadcrom\xade\xadter API"),"."),Object(o.a)("p",null,"For in\xadstance, here is how you can track the ex\xade\xadcu\xadtion time of a piece of code that is reg\xadu\xadlarly called:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"MeterRegistry registry = BackendRegistries.getDefaultNow();\nTimer timer = Timer\n  .builder(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"my.timer"'),")\n  .description(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Time tracker for my extremely sophisticated algorithm"'),")\n  .register(registry);\n\nvertx.setPeriodic(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"1000"),", l -> {\n  timer.record(() -> myExtremelySophisticatedAlgorithm());\n});\n")),Object(o.a)("p",null,"Since it is using the same reg\xadistry, there is no extra back\xadend con\xadfig\xadu\xadra\xadtion to do."),Object(o.a)("h2",{id:"whats-next"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#whats-next"})),"What\u2019s next?"),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-micrometer-metrics")," mod\xadule will con\xadtinue to be im\xadproved, with al\xadready two planned en\xadhance\xadments:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-micrometer-metrics/issues/15"}),"Adding more back\xadends"),", like Graphite."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16"}),"Allow to con\xadfig\xadure sev\xaderal back\xadends"),", and not only one at the same time.")),Object(o.a)("p",null,"Would you miss any fea\xadture, please ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-micrometer-metrics/issues"}),"ask on GitHub"),". Con\xadtri\xadbu\xadtions and bug fixes are also wel\xadcome!"),Object(o.a)("p",null,"Now is time to enter the Met\xadrics."))}m.isMDXComponent=!0},qUP3:function(e,a){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAEYCAMAAABC2jHqAAADAFBMVEUBAwstDANtKyReWGJwCGgcKnsPUqcIhMVDh8VQpeSjr7m0tbSurq6rq6umpqaPlqSDfH2fXzunUwmzcDrIhw7go1DZrHrMw7nJy8nLy8vS0tLd3t7c4eXg4uPk5OTl5OTl5eXl5ufn5+fp6enr6+vt7e3w8PDw8PDy8vLz9PP09PT19vb39/f39/f29vb14sf9yIf1zpb95Kn+8rz9/Mzu9dSKyfx5v/Ka0PCn4v3D7fjJ+/3d/fzp/v/y+vv4+Pj4+Pj5+fn5+fn6+vr6+vr7+/v7+/v8/Pz8/Pz9/fv+/uf//uX+/u3+/vf9/fv9/f39/f3+/v7+/v77/v76///7//////7///7///7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////98fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///92KjuaAAAACXBIWXMAAAsTAAALEwEAmpwYAAAUQ0lEQVR4AezSQQ3AMAgAwJojfS5TgX8HS/migO5Ow62Ai6xIuIfQCA1Cg9AgNEKD0CA0/D40CI3QIDQIDUKD0Aj9DpTQQ5/Mz1BSd0JX5x3j7CqdfOydf0/iSrjHgfpD05XWHxJbVheE0qaH4IpEReSGQLr9Qwhp4h+8g3n/7+A+35lhoFj23Jtd9SDzoZ15nmemw5p8MhmRnCPRQqvtObp2zM3DqYwivUkrtNDK54HrNGK2acSe47SG2miBFlr5HA/L7mY6kThuOIy10QotNHyOQhP5JhKZXjPSRiu00NNpjA2abSquGwzjeDpFrNFC49ONUWgGbFMJTC8cxdPmdSWLar3FtggtdAKfmzWTzTE4R2xzMMt+cxRX1+KxrUELjc+fo2HoXC2ERrNRRpdpix5Gler3bKpVn20JWuhEbNANM1oRur4wurPTY285P8S1hnYhd/DMJuf53cd08i5ER1Xaor2r72uoXm7J+VoLzX2mDVp+ZjfDZSAwWA1Gz/CSQieUJpTiKbq50DNen80SzMNzdwd96l6O78enD6y032/v9JaSrIUoIt4sNGOLfxETBdHzl11EXLTlQo5DW3Tz8vs6qgHbHrTQw6Zv+uRSwhJiZkAsAySAC01lugBVIBGExoVH+Do0gsH2Xp9aPPFzf3zcnU3O7lNJxkIkJUtWF6Lq4l+EOdRIkBQNK5lZRlEu5Jk1vzmsVNcKXWXbgBY6gdCjYVgxkwUGTCOYEFro2S7kdu8T6vK7PcRdLvTBcW7vOemc5nMH/aRUyO2387nc/dnDGJsyTJ7RNJUks/NDLL0M91R6y11PspkJk1VmGRZdatgs0xbduFwrdHnANF9faO5zNGwGTjlRTA1ltiyQi3c7XZK5e7fzKGql/VcIvdt7OXkYnx6+vpwe0qwp36EnZw/JbT63/wyH4T2SPoYp4V+OS3C/ZZqO1tfRWYZhLYbKZi1oDsvf13FVZ1uDFjr0zEEC0+hFGBTx0EBJ7NA/DxO4+XMf0zqnRn6vT3LSRfed8ZxM23vPpwdPvKcZd0ZvWjqQQi8SmqycJHjM34zDY/ESoUjVIK+pUS60WmhYvKIt+nr9IbqcsC1ACw2fW4HrUKAwVgMuNPXnDyV049MHj7xdFno6bR/0pzfHB0LoKc3DU8fd6eT0PpVM/xLiyKHS5MKpB61g/RZd9tk2oIWOo0Hom950Gk8JdLExTwzRySPHtG10qaO00B2fLwlNR47pC93TuG0800VHjtvdXlyiTXy/3zZ6qUS8CS70MU8ksayhtDQQy5Kagr5oWJC6qBaqf6v44eA3Z45Lpvn6QuMjjkFwaSYxMY0FRrwSkNDxbSG3+xjzrlfK5ywIHdOFu3Oczx38T4fPeDnBL4VxCfPizml+txunE/5Ga4G+y9k67CLaoq0KyTe3Hgxq5fVnjiHTfH2h+QbtlKmPgfL4VxxHvxBE8S8xFKGbz8Iosreki3Kh+P0XmpbNaz9suuvPHDWm+epC44+Eg7D+bRARpMuvX+iMiFwRQYSKJOahHOI9CkIuUZNT1EKL2R+wULN46YWDym+2aKb5+kJjg3YdcmIUKQyFyEeLQVUYiX6VUUYRhQ9YKDadGk7Ra43eAqG10BFt0J5ZIyMEXBURzFGhGuC2yUhkKhp93kJR9VuFtuiRV3adLNwW03x1oeGzXzaj0XD0/yX7ic9cKDpysUWPWtkMmebLCz0atALPLEPo4ZAUGgIViBZgXEzhmbpSkxB+5kJR+duVF7QGozhhW4kWulq5unRNE04M+CUCGSFAmMFianrC5y40Mo+c8uVVpVb3thBNLjKJC1doMoBABBrVqyCboWzVpM9cCNPdb+bWoslF2NeiUXPQbA7myIQXeNAUHYGCqokWASG7z19oFMkdfNGhByrhBR4MREegoGqi/ToL/Z032YCfORc1V4E8f45eaFMXWs8m/My5qNVqNlvUUEc3MhkD5PylYjmLd6IsngH/2YX0Qn/nTTbgZ4bQ70tTo/kwIHQYtnDjalGIGyCTiRzCHF7ik1OgnL1Q6BwVNZqPIheF70rLvRgwjeajeHehL4bsc9BooYMgoAYXNbgl6VTOSU1Cl7lQeME0mo8UOnhXtNCajRU6VMEnCq3RQvtBNsv19TPULMc2DMN2KLLfCh0VBT7TaN5VaD9Nwy5Ygb+W4OLICbLqVaNggIJdtwqLGXOhwyLalrVs9Nk+W8vLySG/NZo/ErphEIG/HvPCvMgo14xl3grtFxl9Wzm0WNH/m0KPS7ZtPWM+gj5jk1vqn5gKthAtdAMiE9R6BlFEPhdchrzFFNdxyWiZ4SUexXHDDJqBaQAMNFaFpu+OkNAw+o+Fbhs9EZTsp3GJREbTKVmv7NZ+im7tHkMwvoXrW4YWurFA+GwFjd/AjXb8lapDz13huaAohJ4TLISmr1KFFlGM/ljon7s9McvuMtahpg1123ZvUnrgVRQRPLJtQwvtkcdEw0v57OPCSEO2ns8LdFrmRqOKW160QZs+AssA9ATKaaHp7+BehSiGy0KXCrncATbSu+N8jjy9NfLIpdDnPGHjc8zqM3ZznKf+LJejqbQpK6FLltBbCd22sWbpkG0dWmgFtAQFgcVFV4POEYe+Pe+6jumkB+kp3lsGZzGohLaSUJBY/pLQ57uPr53TvR67Kxw8j0uk5uM/nZN9KXTh4bVdOGSTs92n15uT/f4dFW6sPt+hZyUK6FAxoZPGpISteExt236aUZEGSH/earZTaGCk8VKYF47AJRwzPTiXOGiB0Pu/Ct0p0I6KlpJXNud8ry+E3sesvX57p4stfKeLAEBo9Uuh3aNuLvQMhS7TQhNaaMtYpuilcLnQ0ugL943Q18t5ltCBICW0/K/5nx2+nDwwzkvRKOTnQh8Ku3/u4fxAUyZnOet5SWj8Lji5sXpKaNqun2c3dlcLvcVC1+uexLfgcSi/EerXaWQ+WPf8QOC7Dr18quOqi54ePFJzUcGTaANHCd0QrBP6noG7Heupcb5OaBo/zR+8KqGFsKVDXPzs3LZ7oqzP0FsrdH2BMNqGi2vxHJP258ZK1aXnytxhii6XBvzfC31XuBdHjgmOHEJfNGmh1ZFDHjdWhbZeb+WnHEpo8SkHGs22Cg3+1WjvwnTg82qZ7+1V70eRejNbaE+Q+UvhM2sXDvvjUvfnbndSKqwIPf+l8LVtPY/PMXnnnk7L0NZqBLekLQX/dOxHUth6Cm5sfpZ+apb0iWMrha4R9dqS0R6VqMwvoEapX/FZjeETkgK9iOtsoWUlLfSkJD+QYzcn+Ihuck7t6g7NP7bbPezzj/b2eoz/z+F60LVTtG0L5+eOZduPr/wvhgjU3xA12yd0bZl6wzKKvJRNHeeNrHrNMgQWSb5gSWgJhNZo3k3o2gp+CGHX4vle9oDv0m5pF8s+krdC2wu00JoPEPqPqTeCwG/Ua5lCh5flSw71IdNo3k3oa06txjuZ4JKldDkdpePMheZCR6E/J4yYRvO+QlfphTYb1P+dzIUgtEbzsULDP9koIatKTtmrYHkaAjU7ayHfiZlG84FCV0C1SjehmnkVoIB7OcALE2QBceZCXrmmjdZ8uNCAO5mdIM7OsqkuokbZ+TA0mlz0g6hUrirUUMv58YNSNFcoqDHZoUck0x+YhMnZC117/oeh0eSiK4KkTPND3jJCS3IqKumZAr3Qf3mhP3+TzfiZIfSXQaPRQmu+mNDloy+D5n/ZO7vlxHUsjMoi/nF11UkHbOq8w1y0Y1zQPuAnAO54B73/G4y3LMRPYM7pyaSxmLWqEhEj9dVqlYK+7A290OZpAEBoQGgAhAZAaACEBoQGQGgAhAZAaACEBoQGeB6hK5VL2USzHaqMu6FUSmVrAxCc0PFk3Qu9L9JuO8vcYMrU7IqkMwChCZ2Uq17ohVS4rV9+DMO6TIeCnwDBCf0j64q8ku24efljGNpe6O0sPRiA4ITuyuVHoZWtDgoQoNB1VuS1PWtMfgyDHDkAAhV6N5vmu1nebf1gwhUaENpUUW4a2wvQDSMSGoCLFUBoAIQGQGgAhAZAaEDoSqm0H+pI/dNo0rBC4MM+GMfn0BIf9ZSpf35FsRLVPz4vgxQaEDoPRWhA6N2Q7L8UWh4may+uFTo71FrFq35G2r+7PK7Y9z9ECA0PF1oJeW/rYVfmV0IXWbcr085vwI1uq3Tx8tMsdNuvXB1k1rBinmzkBcAodujtVPWkl0Jv31pjbPR/eJTW3/MqrdKDrLAz/EljN13aFwCjEFrcFf6z0PM/X6v8ptDbUQkNnKELe4C+ceQoxF9LHX/vylkuR476pb0U2hRp967HIjQgdDOLlFqacjh5VDIknTwU0QfqqN+Wo5V51ypeupXmuKKZqmSO0MBNIQBCAyA0IDQAQgMgNABCA1wLXSilPlSxK5WSVBJAeELn5iNSfXSWG4BQhXaXgm6wxRpXptF2o96+/aFVsjEAYRw5ks7WAJvlbjBnxRrL3GynyVrSRwCh7NA2U1clbuhswfP0sJWAR2rClxkQ2g6S2g9PaEDo3dSWHXXD0JIiM0VyWOjwhAaENouh7Kgb3Bl6oVU8R2jgYgUAoQEQGgChAaEBEBoAoQE+IfRiFuXGs53rUzXGoeDdwQAEI3Qz+TbNTzcsZVaeCV1l3UKvDEBAR47tSWjhXGj3GCBwoQvVY81udGsAQhO6jlRPvB6EvnzzWQB26GaaHwzAk5yhG83+DGEJPVQ6Xw5C+1qijtKdQwC4WAFAaIBHCA2A0AAIDYDQgNC+B72jjDfmmmL4fM8EEFgCqo+Wd4X2bKehCA1UHxWh7+OFBghH6MVLKzXANnWkkm7oSK/aS6HdycNPdV3v3VSAMR05RO99/+XaataT9a0dWgY31Xe9l6kAYzty1MlGCjY6oZtp8vNfN4X2U13XezcVYFxC797aKjNO6J4f3/XyttBuqu96P0wFGJXQpspn7ZnQcqq4LbSb6rve+6kAjz9D+9xo85YdzLF5vQzi60XS1A3Hqa7rvZsKwE0hwJcLDYDQAAgNgNAACA0ILaG7z08F+F1CV/KBc/sZS+fZeIQGhE66/Tz+TEyuTA3AiISWO+vz5vWn0jIuRWretVK5ObKYRvHKvtmvkO/ypptaZv2ba1lhnwL8fqFlkz12rS/SbiH1Ri/e3r4tjcfGkdyc3XQli8//JfVzX+QSlu6fHwzAY4Q+Nvm2Qi8vhZbj8evGPxr25KVp3voX+bXQqXwNQsvPAA84ckzzo9CVjlR+uBbaNHOdHZ/WEyv3vnffFHeE3k41NfHgQULvynjtutZfHC68pcK7fSE02hrfrzDvOpcpmw9Cy+sHAXxsl2188/q56lkZh0uRNlqpsw9Cah3J9vuuVVb2Qm9n/aZ+nOqEbqby04O3aOBiZSu/5VWfPyzIrk3xf3i40I1emf3/4Le5shdafrkEeKjQ9vPj7NMbtP04O17JURuAcBIAQgNCAxAfvV22tEo6QnfBQ3xUKJ9IaCA+ehI6QID4aDEUtuuG+OiZ0NJ21q2oJ2Wklv2obfma8QLER8u8eVlX6TE+6oW2FyluRR1lXRVv5J6mH8x4AeKjVVpPVmXu4qNeaCXLvNAva/kahF6bEQPER7P5t9dieYyP+h1azL0Sej/TkmoaMUB8dDH5vplNWh8f9WdoCXBcCk0V9PFDfLTRqSl9fNSVLbWflhTJxq1wQu+myq4MGyA+6rA7dJGasAHiow75r0EsOnyIjzqkQ5YcZJ4YIJwEgNAACA0IvZul3cfPPk5NYn+x17dM/Z0AQlc6vy+0o3n5RaEb3T5CaEDo/ezbZGPu44X+JWTBAwCEXkw20gy2eNUq2di/PxEdy+hVJ5tGS7mYSz9d8/qhwMzpCmZfRjJ1WCFTlLwpU2X1H1KLxmdTvw5A6Er6z/eWxu3Wh0EbnZXqz0FieVOEvm75fRXpr7JuX6YHt0IW+Knyz23kMtxlU78OQOjdbGnLLxa58dk50bFM+2+yCav0jtALnf08nG/bEuJwKy6Flh/ky2VTvw5A6EWketrbQkt+rrwntNn/mMX+cbGyg1txW2iXTf06AKGtr2V+W+giOSz0baEtO/vCmbyW4bhCji/XQks29UsBhLZKSojICT2EQY9CL7SK56n8ptfTXvawt1Oz7iK2kRu3woZC4rWb6oT22dTgAW4KL7Op4QMIfcqmhg8g9P1sKgDhJACEBoQGID4qF923pxa5eTxAfPT/V2ggPuqFFhA6QIiPuqmOejKP1MpPLV6lpb29TYwQOgSIj7qpDqk+Kru0m1rEf8nW7KrhjR8gPuqn+iPH9q31Quf+z7IQOgiIj9qpfyP0C0KHAvFRP9ULPY83l0JLvdJSI3QIEB91Ux1SyzRZ+6luW66HeqUA3BQCIDQgNABCAyA0AELD34PQt2N2ZXp6/X6z4JH9y+4h/SHQ6/vxILTtcLX6b4T2ty0lQo8GhBYrb4c9y/SfZURl4ogAhH73uVFTpbbr/L7/HqXXf7FS6+gsfxSpntwJLVfccuFI8/oRwJHjpzm17F4dqqSbu6jR5emiyO/t0PLtIO/TvH4McORozzocu4THDaHn+vWve0IvXtaN/Ezz+oeD0HJeuBB6e0toeT7X8v7NM3SxqjKa148Sdmj525J3/VFouxHfEbqeSP6Z5vUjgDN0a8560NunU5XM07M5Pa38bhgvr48cw0I5pshSmtc/B9wUSnyf5vXPA0LP4zXN658FhK6juKV5fXAgNABCAyA0AEIDQtf69Dl0PwYNIPR21vqqR8EDCO2u/J5HaEBoiX6WSsW0LQ4fhLb3eb7afuAAQovPVNd/GhC69D6/S0Y0dID4aI8tO5rgc/D8u106EAAAAAAA8n9thAZD19A1dA1dQzd0DV1D19A1dEPX0DV0DV1DN3QNXUPX0DV0Q9fQNXQNXUM3dA1dQ9fQBfKOTeZnamr2AAAAAElFTkSuQmCC"},quyA:function(e,a){var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},rXrF:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Using Hamcrest Matchers with Vert.x Unit",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"Vert.x Unit is a very elegant library to test asynchronous applications developed with vert.x. However because of this asynchronous aspect, reporting test failures is not natural for JUnit users."}),i=[{term:"test",tf:21},{term:"us",tf:17},{term:"unit",tf:13},{term:"method",tf:9},{term:"junit",tf:8},{term:"assert",tf:8},{term:"hamcrest",tf:7},{term:"report",tf:6},{term:"creat",tf:6},{term:"asynchron",tf:5},{term:"not",tf:5},{term:"matcher",tf:5},{term:"complet",tf:5},{term:"verticl",tf:5},{term:"librari",tf:4},{term:"need",tf:4},{term:"let",tf:4},{term:"implement",tf:4},{term:"check",tf:4},{term:"class",tf:4},{term:"provid",tf:4},{term:"applic",tf:3},{term:"just",tf:3},{term:"add",tf:3},{term:"http",tf:3}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Vert.x Unit is a very el\xade\xadgant li\xadbrary to test asyn\xadchro\xadnous ap\xadpli\xadca\xadtions de\xadvel\xadoped with vert.x. How\xadever be\xadcause of this asyn\xadchro\xadnous as\xadpect, re\xadport\xading test fail\xadures is not nat\xadural for JUnit users.  This is be\xadcause, the failed as\xadser\xadtions need to be re\xadported to the ",Object(o.a)("em",{parentName:"p"},"test con\xadtext"),", con\xadtrol\xadling the ex\xade\xadcu\xadtion (and so the out\xadcome) of the test. In other words, in a Vert.x Unit test you can\xadnot use the reg\xadu\xadlar Junit as\xadser\xadtions and as\xadser\xadtion li\xadbraries. In this blog post, we pro\xadpose a way to let you using Ham\xadcrest match\xaders in Vert.x Unit tests."),Object(o.a)("h2",{id:"using-vertx-unit"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#using-vertx-unit"})),"Using Vert.x Unit"),Object(o.a)("p",null,"Vert.x Unit is a test li\xadbrary made to en\xadsure the be\xadhav\xadior of vert.x ap\xadpli\xadca\xadtions. It lets you im\xadple\xadment tests check\xading asyn\xadchro\xadnous be\xadhav\xadior."),Object(o.a)("p",null,"Vert.x Unit can be used with Junit. For this, you just need to add the fol\xadlow\xading de\xadpen\xaddency to your project:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-unit",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.2.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"test",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"scope"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"If you are using Gra\xaddle, the de\xadpen\xaddency is:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-gradle"}),"testCompile \u2018io.vertx:vertx-unit:",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"3.2"),".",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"\u2019\n")),Object(o.a)("p",null,"If you are using an IDE, just add the vertx-\u200bunit jar to your project class\xadpath."),Object(o.a)("p",null,"Ob\xadvi\xadously, you would need to add JUnit too."),Object(o.a)("p",null,"No\xadtice that vertx-\u200bunit does not need JUnit, and can be used with\xadout it. Check the Vert.x Unit ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-unit/java/"}),"doc\xadu\xadmen\xadta\xadtion")," for more de\xadtails."),Object(o.a)("h2",{id:"vertx-unit-example"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-unit-example"})),"Vert.x Unit example"),Object(o.a)("p",null,"Let\u2019s con\xadsider this very sim\xadple ",Object(o.a)("inlineCode",{parentName:"p"},"Verticle"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"MyFirstVerticle")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"extends")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"AbstractVerticle")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Override"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"start"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"final")," Future future)")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"throws")," Exception "),"{\n    vertx.createHttpServer()\n        .requestHandler(req -> req.response().end(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hello vert.x"'),"))\n        .listen(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", done -> {\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (done.failed()) {\n            future.fail(done.cause());\n          } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n            future.complete();\n          }\n        });\n  }\n}\n")),Object(o.a)("p",null,"It just cre\xadates a new HTTP server and when launched it no\xadti\xadfies the ",Object(o.a)("inlineCode",{parentName:"p"},"future")," of the com\xadple\xadtion."),Object(o.a)("p",null,"To test this ver\xadti\xadcle with Vert.x Unit you would write some\xadthing like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@RunWith(VertxUnitRunner.class)"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"MyFirstVerticleTest")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"private")," Vertx vertx;\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Before"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"setUp"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n    vertx = Vertx.vertx();\n    vertx.deployVerticle(MyFirstVerticle.class.getName(),\n      context.asyncAssertSuccess());\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"test"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n    Async async = context.async();\n    vertx.createHttpClient().get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),")\n      .handler(response -> {\n        context.assertEquals(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),", response.statusCode());\n        response.bodyHandler(buffer -> {\n          context.assertEquals(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hello vert.x"'),", buffer.toString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"utf-8"'),"));\n          async.complete();\n        });\n      })\n      .end();\n  }\n}\n")),Object(o.a)("p",null,"First, the test class is an\xadno\xadtated with ",Object(o.a)("inlineCode",{parentName:"p"},"@RunWith(VertxUnitRunner.class)"),", in\xadstruct\xading JUnit to use this spe\xadcial run\xadner. This run\xadner lets you in\xadject a ",Object(o.a)("inlineCode",{parentName:"p"},"TestContext")," pa\xadra\xadme\xadter into every test meth\xadods (as well as ",Object(o.a)("inlineCode",{parentName:"p"},"@Before")," and ",Object(o.a)("inlineCode",{parentName:"p"},"@After"),") to han\xaddle the asyn\xadchro\xadnous as\xadpect of the test."),Object(o.a)("p",null,"In the ",Object(o.a)("inlineCode",{parentName:"p"},"setUp")," method, it cre\xadates a new in\xadstance of ",Object(o.a)("inlineCode",{parentName:"p"},"Vertx")," and de\xadploy the ver\xadti\xadcle. Thanks to ",Object(o.a)("inlineCode",{parentName:"p"},"context.asyncAssertSuccess()"),", it waits until the suc\xadcess\xadful com\xadple\xadtion of the ver\xadti\xadcle de\xadploy\xadment. In\xaddeed, the de\xadploy\xadment is asyn\xadchro\xadnous, and we must be sure that the ver\xadti\xadcle has been de\xadployed and has com\xadpleted its ini\xadtial\xadiza\xadtion be\xadfore start\xading to test it."),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"test()")," method cre\xadates an ",Object(o.a)("inlineCode",{parentName:"p"},"Async")," ob\xadject that will be used to re\xadport when the test has been com\xadpleted. Then it cre\xadates an HTTP client to emit a re\xadquest on the server from our ver\xadti\xadcle and check that:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"the HTTP code is ",Object(o.a)("inlineCode",{parentName:"li"},"200 (OK)")),Object(o.a)("li",{parentName:"ol"},"the body is ",Object(o.a)("inlineCode",{parentName:"li"},"hello vert.x"))),Object(o.a)("p",null,"As you can see, to im\xadple\xadment the checks, the as\xadser\xadtions method are called on the ",Object(o.a)("inlineCode",{parentName:"p"},"TestContext")," ob\xadject, which con\xadtrol the test ex\xade\xadcu\xadtion. When every\xadthing has been tested, we call ",Object(o.a)("inlineCode",{parentName:"p"},"async.complete()")," to end the test. If an as\xadser\xadtion failed, the test is ob\xadvi\xadously stopped. This would not be the case if you would use reg\xadu\xadlar Junit as\xadser\xadtions."),Object(o.a)("h2",{id:"using-the-hamcrest-matchers"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#using-the-hamcrest-matchers"})),"Using the Hamcrest Matchers"),Object(o.a)("p",null,"In the pre\xadvi\xadous ex\xadam\xadple, we used the the as\xadser\xadtions avail\xadable from the ",Object(o.a)("inlineCode",{parentName:"p"},"TestContext")," in\xadstance. How\xadever it pro\xadvides a lim\xadited set of meth\xadods. Ham\xadcrest is a li\xadbrary of match\xaders, which can be com\xadbined in to cre\xadate flex\xadi\xadble ex\xadpres\xadsions of in\xadtent in tests. It is very con\xadve\xadnient when test\xading com\xadplex ap\xadpli\xadca\xadtions."),Object(o.a)("p",null,"Ham\xadcrest can\xadnot be used di\xadrectly as it would not re\xadport the fail\xadure on the ",Object(o.a)("inlineCode",{parentName:"p"},"TestContext"),". For this pur\xadpose we cre\xadate a ",Object(o.a)("inlineCode",{parentName:"p"},"VertxMatcherAssert")," class:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-class"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"class")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"VertxMatcherAssert")," "),"{\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," <T> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"assertThat"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context, T actual,\n    Matcher<? ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"super")," T> matcher)")," "),"{\n    assertThat(context, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'""'),", actual, matcher);\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," <T> ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"assertThat"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context, String reason,\n    T actual, Matcher<? ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"super")," T> matcher)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!matcher.matches(actual)) {\n      Description description = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," StringDescription();\n      description.appendText(reason)\n          .appendText(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"\\nExpected: "'),")\n          .appendDescriptionOf(matcher)\n          .appendText(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"\\n     but: "'),");\n      matcher.describeMismatch(actual, description);\n      context.fail(description.toString());\n    }\n  }\n\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"static")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"assertThat"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context, String reason,\n    ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"boolean")," assertion)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!assertion) {\n      context.fail(reason);\n    }\n  }\n}\n")),Object(o.a)("p",null,"This class pro\xadvides ",Object(o.a)("inlineCode",{parentName:"p"},"assertThat")," method that re\xadports error on the given ",Object(o.a)("inlineCode",{parentName:"p"},"TestContext"),". The com\xadplete code is avail\xadable ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gist.github.com/cescoffier/5cbf4c69aa094ac9b1a6"}),"here"),"."),Object(o.a)("p",null,"With this class, we can re-\u200bimplement our test as fol\xadlows:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-meta"}),"@Test"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"testWithHamcrest"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(TestContext context)")," "),"{\n  Async async = context.async();\n  vertx.createHttpClient().get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"/"'),").handler(response -> {\n    assertThat(context, response.statusCode(), is(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"200"),"));\n    response.bodyHandler(buffer -> {\n      assertThat(context, buffer.toString(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"utf-8"'),"), is(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"hello vert.x"'),"));\n      async.complete();\n    });\n  }).end();\n}\n")),Object(o.a)("p",null,"To ease the usage, I\u2019ve added two ",Object(o.a)("em",{parentName:"p"},"im\xadport sta\xadtic"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," io.vertx.unit.example.VertxMatcherAssert.assertThat;\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"import")," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"static")," org.hamcrest.core.Is.is;\n")),Object(o.a)("p",null,"You can use any Ham\xadcrest matcher, or even im\xadple\xadment your own as soon as you use the ",Object(o.a)("inlineCode",{parentName:"p"},"assertThat")," method pro\xadvided by ",Object(o.a)("inlineCode",{parentName:"p"},"VertxMatcherAssert"),"."),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"In this post we have seen how you can com\xadbine Ham\xadcrest and Vert.x Unit. So, you are not lim\xadited any\xadmore by the set of as\xadsert meth\xadods pro\xadvided by Vert.x Unit, and can use the whole ex\xadpres\xadsive\xadness of Ham\xadcrest Match\xaders."),Object(o.a)("p",null,"Don\u2019t for\xadget that you still can\u2019t use the ",Object(o.a)("inlineCode",{parentName:"p"},"assert")," meth\xadods from Junit, as they don\u2019t re\xadport on the ",Object(o.a)("inlineCode",{parentName:"p"},"TestContext"),"."))}m.isMDXComponent=!0},swLC:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Vert.x 3.3.0 is released !",category:"releases",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"That was a long run \u2026 but here we are. We are very pleased to announce the release of Vert.x 3.3.0!"}),i=[{term:"http",tf:7},{term:"client",tf:6},{term:"releas",tf:5},{term:"avail",tf:5},{term:"us",tf:5},{term:"new",tf:4},{term:"com",tf:4},{term:"wiki",tf:4},{term:"bu",tf:4},{term:"bridg",tf:4},{term:"featur",tf:3},{term:"github",tf:3},{term:"x3",tf:3},{term:"event",tf:3},{term:"version",tf:3},{term:"support",tf:3},{term:"apach",tf:3},{term:"integr",tf:3},{term:"applic",tf:3},{term:"amqp",tf:3},{term:"possibl",tf:3},{term:"run",tf:2},{term:"improv",tf:2},{term:"highlight",tf:2},{term:"note",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"That was a long run \u2026 but here we are. We are very pleased to an\xadnounce the re\xadlease of Vert.x 3.3.0!"),Object(o.a)("p",null,"This re\xadlease is huge with lots of new fea\xadtures, im\xadprove\xadments, and ob\xadvi\xadously bug fixes. We won\u2019t de\xadtail all the new fea\xadtures here (some are high\xadlighted below), and full re\xadlease notes are avail\xadable: ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.3.0---Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.3.0-\u200b\u2014Release-Notes")),Object(o.a)("p",null,"Break\xading changes are there: ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/wiki/wiki/3.3.0---Breaking-Changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.3.0-\u200b\u2014Breaking-Changes"),". Be sure to read them be\xadfore mi\xadgrat\xading."),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"Let\u2019s high\xadlight some of the major fea\xadtures shipped with this re\xadlease."),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Vertx 3.3.0 is the first ver\xadsion to sup\xadport ",Object(o.a)("strong",{parentName:"li"},"HTTP2")," (client and server). You can now con\xadfig\xadure HTTP servers and clients to use HTTP2. Proxy sup\xadport for TCP and HTTP client has also been added."),Object(o.a)("li",{parentName:"ul"},"This ver\xadsion shows also the in\xadtro\xadduc\xadtion of a bridge with ",Object(o.a)("strong",{parentName:"li"},"Apache Camel"),". So, in\xadte\xadgrat\xading Vert.x ap\xadpli\xadca\xadtions with legacy sys\xadtems (using EIP) has never been so easy."),Object(o.a)("li",{parentName:"ul"},"Sev\xaderal new com\xadpo\xadnents have been de\xadvel\xadoped to im\xadple\xadment microservice-\u200bbased ap\xadpli\xadca\xadtions. First, a plug\xadgable ",Object(o.a)("strong",{parentName:"li"},"ser\xadvice dis\xadcov\xadery")," is now avail\xadable. An im\xadple\xadmen\xadta\xadtion of the ",Object(o.a)("strong",{parentName:"li"},"cir\xadcuit breaker")," pat\xadtern has also been pro\xadvided."),Object(o.a)("li",{parentName:"ul"},Object(o.a)("strong",{parentName:"li"},"AMQP 1.0")," sup\xadport has been also in\xadte\xadgrated thanks to a bridge to send and re\xadceive mes\xadsages from AMQP. A client has also been shipped to in\xadter\xadact di\xadrectly with an AMQP bro\xadker or router."),Object(o.a)("li",{parentName:"ul"},"New met\xadrics has also been in\xadtro\xadduced to ease the mon\xadi\xadtor\xading of run\xadning ap\xadpli\xadca\xadtions. For in\xadstance, it\u2019s now pos\xadsi\xadble to mon\xadi\xadtor the thread usage in the ",Object(o.a)("strong",{parentName:"li"},"worker thread pool")," and in the ",Object(o.a)("strong",{parentName:"li"},"JDBC con\xadnec\xadtion pools"),"."),Object(o.a)("li",{parentName:"ul"},"With this ver\xadsion, you can con\xadfig\xadure the TCP as\xadpects of the event bus for, for in\xadstance, use SSL. Also no\xadtice a bridge be\xadtween the  event bus of Vert.x 2 and  the one from Vert.x 3."),Object(o.a)("li",{parentName:"ul"},"Most of the de\xadliv\xadered com\xadpo\xadnents are now de\xadploy\xadable in ",Object(o.a)("strong",{parentName:"li"},"OSGi")," en\xadvi\xadron\xadments. So you can eas\xadily in\xadte\xadgrate Vert.x in Apache Karaf, Ser\xadvice Mix, or Apache Sling."),Object(o.a)("li",{parentName:"ul"},"Vert.x Unit us\xadabil\xadity has been greatly im\xadproved. It is now pos\xadsi\xadble to write test using Ham\xadcrest, As\xadsertJ, Rest As\xadsured, or any as\xadser\xadtion li\xadbraries you want.")),Object(o.a)("p",null,"Many thanks to all the com\xadmit\xadters and com\xadmu\xadnity whose con\xadtri\xadbu\xadtions made this pos\xadsi\xadble, es\xadpe\xadcially to Alex Lehman, Paul Bakker, Rob\xadbie Gem\xadmel, Claus Ibsen, Michael Kre\xadmer, and many many other!"),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.3.0%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.3.0/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"Just a word about the fu\xadture. As we did last, year, a poll will be or\xadga\xadnized in the next few weeks to col\xadlect ideas and pri\xador\xadi\xadtize the Vert.x 3.4 and be\xadyond roadmap. Stay tuned, we love hear\xading about your ideas and is\xadsues."),Object(o.a)("p",null,"Happy cod\xading !"))}m.isMDXComponent=!0},uYRw:function(e,a,t){var n={"./2015-06-30-vert-x-2-1-6-released.mdx":"h9Ra","./2015-07-01-vert-x3-web-easy-as-pi.mdx":"9LB0","./2015-07-02-vert-x-3-init-d-script.mdx":"j61u","./2015-07-03-vert-x3-and-postgresql-json-type.mdx":"/V1q","./2015-07-06-checklist-for-migrating-from-vert-x-2-1-x-to-vert-x-3-part-one.mdx":"mBXf","./2015-07-13-vert-x3-says-hello-to-npm-users.mdx":"kFeL","./2015-07-14-my-first-vert-x-3-application.mdx":"cmAP","./2015-07-20-vert-x-application-configuration.mdx":"gcZK","./2015-07-27-some-rest-with-vert-x.mdx":"Dc8p","./2015-08-03-unit-and-integration-tests.mdx":"cLI+","./2015-08-31-vert-x3-real-time-web-apps.mdx":"dAKA","./2015-09-14-writing-secure-vert-x-web-apps.mdx":"5B1d","./2015-09-17-contract-driven-rest-services-with-vert-x3.mdx":"KM6s","./2015-10-08-vert-x-3-1-0-is-released.mdx":"EomW","./2015-10-19-using-the-asynchronous-sql-client.mdx":"zDbz","./2015-11-25-vert-x-es6-back-to-the-future.mdx":"KJRa","./2015-11-30-combine-vert-x-and-mongo-to-build-a-giant.mdx":"Z82Q","./2015-12-15-vert-x-3-2-0-is-released.mdx":"nY3K","./2015-12-20-automatic-redeployment-in-eclipse-ide.mdx":"a69w","./2016-01-03-ecmascript-6-7-on-the-jvm-with-typescript-and-vert-x.mdx":"VCtW","./2016-01-15-real-time-bidding-with-websockets-and-vert-x.mdx":"+g7z","./2016-01-18-using-hamcrest-matchers-with-vert-x-unit.mdx":"rXrF","./2016-01-25-intro-to-vert-x-shell.mdx":"8HTu","./2016-02-05-vert-x-3-2-1-is-released.mdx":"TiEF","./2016-03-17-vertx-3-and-azure-cloud-platform-tutorial.mdx":"Hx7l","./2016-03-30-vertx-3-and-keycloak-tutorial.mdx":"lihu","./2016-06-24-vert-x-3-3-0-is-released.mdx":"swLC","./2016-07-12-vert-x-3-3-2-is-released.mdx":"2Ici","./2016-08-26-vert-x-fall-conferences.mdx":"34c/","./2016-09-01-vert-x-blueprint-tutorials.mdx":"kixY","./2016-09-08-centralized-logging-for-vert-x-applications-using-the-elk-stack.mdx":"oY/r","./2016-09-12-vert-x-3-3-3-is-released.mdx":"9Sms","./2017-04-14-dynamic-routing-in-serverless-microservice-with-vert-x-event-bus.mdx":"kxuk","./2017-04-26-building-a-real-time-web-app-with-angular-ngrx-and-vert-x.mdx":"00pu","./2017-05-09-time-scheduling-with-chime.mdx":"LFoy","./2017-05-22-presentation-of-the-vert-x-swagger-project.mdx":"oTZn","./2017-06-09-preview-of-a-guide-for-java-developers.mdx":"NH4K","./2017-07-04-openapi-fka-swagger-3-support-in-eclipse-vert-x-now-in-test-stage.mdx":"xhNl","./2017-08-21-introducing-vert-x-mqtt-client.mdx":"hE7a","./2017-09-28-an-eclipse-vert-x-gradle-plugin.mdx":"GoqC","./2017-11-14-eclipse-vert-x-meets-graphql.mdx":"mT7v","./2017-12-20-tcp-client-using-eclipse-vert-x-kotlin-and-gradle-build.mdx":"+dJJ","./2017-12-21-eclipse-vert-x-based-framework-url-shortener-backend.mdx":"NuQH","./2018-03-13-google-summer-of-code-2018.mdx":"/93W","./2018-04-09-eclipse-vert-x-metrics-now-with-micrometer-io.mdx":"pJo+","./2018-04-13-new-community-channels.mdx":"zj+8","./2018-04-23-eclipse-vert-x-rabbitmq-client-gets-a-new-consumer-api.mdx":"Pc3Q","./2018-06-04-eclipse-vert-x-goes-native.mdx":"WjdI","./2018-07-02-simplified-database-transaction-management-with-the-vert-x-rxjava-api.mdx":"wjlg","./2018-08-20-the-rss-reader-tutorial.mdx":"BuQJ","./2018-09-05-the-rss-reader-tutorial-step-2.mdx":"GOOg","./2018-12-06-the-rss-reader-tutorial-step-3.mdx":"lWra","./2018-12-10-http-response-validation-with-the-vert-x-web-client.mdx":"eHGC","./2018-12-13-vertx-web-api-service.mdx":"ZJXT","./2019-07-26-eclipse-vert-x-4-milestone-1-released.mdx":"i72n","./2019-08-23-eclipse-vert-x-3-8-1.mdx":"dRkU","./2019-08-26-eclipse-vert-x-4-milestone-2-released.mdx":"OrTX","./2019-08-30-eclipse-vert-x-for-scala-next-steps.mdx":"NL1R","./2019-09-19-eclipse-vert-x-4-milestone-3-released.mdx":"hkBy","./2019-10-07-eclipse-vert-x-3-8-2.mdx":"/pBu","./2019-10-18-eclipse-vert-x-3-8-3.mdx":"lybm","./2019-10-22-send-web-requests-and-assert-results-with-vertx-junit5-web-client.mdx":"4PoU","./2019-11-28-eclipse-vert-x-3-8-4.mdx":"AiqT","./2019-12-13-eclipse-vert-x-4-milestone-4-released.mdx":"4Sve","./2020-01-24-eclipse-vert-x-3-8-5.mdx":"xDq6","./2020-03-16-easy-sso-for-vert-x-with-keycloak.mdx":"HAnQ","./2020-04-02-eclipse-vert-x-3-9-0-released.mdx":"4nW3","./2020-05-22-eclipse-vert-x-3-9-1-released.mdx":"+/MD"};function s(e){var a=c(e);return t(a)}function c(e){if(!t.o(n,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=c,e.exports=s,s.id="uYRw"},wjlg:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Simplified database transaction management with the Vert.x RxJava API",category:"guides",authors:[{name:"Thomas Segismont",github_id:"tsegismont"}],summary:"As of Vert.x 3.5, managing database transactions requires a lot of boilerplate code. Vert.x 3.6 provides helpers to easily make a reactive flow transactional."}),i=[{term:"transact",tf:11},{term:"manag",tf:4},{term:"databas",tf:4},{term:"provid",tf:4},{term:"transform",tf:4},{term:"queri",tf:4},{term:"code",tf:3},{term:"api",tf:3},{term:"connect",tf:3},{term:"sourc",tf:3},{term:"lot",tf:2},{term:"boilerpl",tf:2},{term:"will",tf:2},{term:"helper",tf:2},{term:"reactiv",tf:2},{term:"flow",tf:2},{term:"rxifi",tf:2},{term:"on",tf:2},{term:"develop",tf:2},{term:"implement",tf:2},{term:"execut",tf:2},{term:"commit",tf:2},{term:"rollback",tf:2},{term:"chang",tf:2},{term:"around",tf:2}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,Object(o.a)("em",{parentName:"p"},"TL;DR As of 3.5, man\xadag\xading data\xadbase trans\xadac\xadtions with Vert.x re\xadquires a lot of boil\xader\xadplate code."),"\n",Object(o.a)("em",{parentName:"p"},"Vert.x 3.6 will pro\xadvide helpers and ",Object(o.a)("inlineCode",{parentName:"em"},"Observable")," trans\xadform\xaders to eas\xadily make a re\xadac\xadtive flow trans\xadac\xadtional.")),Object(o.a)("h2",{id:"simple-queries-with-the-rxified-api"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#simple-queries-with-the-rxified-api"})),"Simple queries with the ",Object(o.a)("em",{parentName:"h2"},"\u201cRxified\u201d")," API"),Object(o.a)("p",null,"The ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/vertx-rx/java2/"}),"Vert.x API for Rx\xadJava")," is one of the most pop\xadu\xadlar mod\xadules in the Vert.x stack."),Object(o.a)("p",null,"So we make sure the ",Object(o.a)("em",{parentName:"p"},"\u201cRx\xadi\xadfied\u201d")," API is easy to use for com\xadmon pro\xadgram\xadming tasks, such as read\xading rows from a re\xadla\xadtional data\xadbase and send\xading the re\xadsult to the client:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"dbClient.rxQuery(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"SELECT name, duration FROM tracks WHERE album = 'The Israelites'\""),")\n  .map(ResultSet::getResults)\n  .map(rows -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Transform DB rows into a client-friendly JSON object"),"\n  })\n  .subscribe(json -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send JSON to the client"),"\n  }, t -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send error to the client"),"\n  });\n")),Object(o.a)("h2",{id:"managing-transactions-with-vertx-35"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#managing-transactions-with-vertx-35"})),"Managing transactions with Vert.x 3.5"),Object(o.a)("p",null,"But very often, de\xadvel\xadop\xaders have to im\xadple\xadment com\xadplex in\xadter\xadac\xadtions with the data\xadbase, run\xadning in\xadside a sin\xadgle trans\xadac\xadtion.\nTo do so, the im\xadple\xadmen\xadta\xadtion must fol\xadlow this process:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"get a con\xadnec\xadtion from the pool,"),Object(o.a)("li",{parentName:"ul"},"start a trans\xadac\xadtion,"),Object(o.a)("li",{parentName:"ul"},"ex\xade\xadcute queries,"),Object(o.a)("li",{parentName:"ul"},"if all queries suc\xadceed, com\xadmit the trans\xadac\xadtion,"),Object(o.a)("li",{parentName:"ul"},"oth\xader\xadwise, roll\xadback the changes.")),Object(o.a)("p",null,"How does that trans\xadlate to code?"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Get a connection from the pool"),"\ndbClient.rxGetConnection().flatMap(sqlConnection -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Setting auto-commit mode to false implicitely starts a transaction"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," sqlConnection.rxSetAutoCommit(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"false"),")\n    .andThen(\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Database queries"),"\n      sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO albums (name) VALUES ('The Israelites')\""),")\n        .andThen(sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Israelites')\""),"))\n        .andThen(sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Too Much Too Soon')\""),"))\n        .andThen(sqlConnection.rxQuery(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"SELECT name FROM tracks WHERE album = 'The Israelites'\""),").map(ResultSet::getResults))\n    )\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Commit if all queries succeed"),"\n    .flatMap(rows -> sqlConnection.rxCommit().andThen(Single.just(rows)))\n    .onErrorResumeNext(throwable -> {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// On error, rollback the changes"),"\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," sqlConnection.rxRollback().onErrorComplete()\n        .andThen(sqlConnection.rxSetAutoCommit(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),").onErrorComplete())\n        .andThen(Single.error(throwable));\n    }).flatMap(rows -> sqlConnection.rxSetAutoCommit(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"true"),").andThen(Single.just(rows)))\n    .doFinally(sqlConnection::close);\n}).map(rows -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Transform DB rows into a client-friendly JSON object"),"\n}).subscribe(json -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send JSON to the client"),"\n}, t -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send error to the client"),"\n});\n")),Object(o.a)("p",null,"That is a lot of boil\xader\xadplate around the spe\xadcific data\xadbase queries\u2026\nIt would be bet\xadter to re\xadlieve the de\xadvel\xadoper from main\xadtain\xading it."),Object(o.a)("h2",{id:"vertx-36-tools-for-transaction-management"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#vertx-36-tools-for-transaction-management"})),"Vert.x 3.6 tools for transaction management"),Object(o.a)("p",null,"That is why Vert.x 3.6 will pro\xadvide ",Object(o.a)("em",{parentName:"p"},Object(o.a)("inlineCode",{parentName:"em"},"Observable")," trans\xadform\xaders")," that can be ap\xadplied to re\xadac\xadtive flows with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://reactivex.io/RxJava/javadoc/io/reactivex/Flowable.html#compose-io.reactivex.FlowableTransformer-"}),Object(o.a)("inlineCode",{parentName:"a"},"compose"))," to make them trans\xadac\xadtional:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txFlowableTransformer")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txObservableTransformer")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txSingleTransformer")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txMaybeTransformer")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("inlineCode",{parentName:"li"},"SQLClientHelper#txCompletableTransformer"))),Object(o.a)("p",null,"These ",Object(o.a)("em",{parentName:"p"},"trans\xadform\xaders")," wrap the cor\xadre\xadspond\xading source of events with SQL trans\xadac\xadtion man\xadage\xadment."),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"dbClient.rxGetConnection().flatMap(sqlConnection -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO albums (name) VALUES ('The Israelites')\""),")\n    .andThen(sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Israelites')\""),"))\n    .andThen(sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Too Much Too Soon')\""),"))\n    .andThen(sqlConnection.rxQuery(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"SELECT name FROM tracks WHERE album = 'The Israelites'\""),").map(ResultSet::getResults))\n    .compose(SQLClientHelper.txSingleTransformer(sqlConnection))\n    .doFinally(sqlConnection::close);\n}).map(rows -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Transform DB rows into a client-friendly JSON object"),"\n}).subscribe(json -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send JSON to the client"),"\n}, t -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send error to the client"),"\n});\n")),Object(o.a)("p",null,"Source ",Object(o.a)("em",{parentName:"p"},"trans\xadform\xaders")," pro\xadvide max\xadi\xadmum flex\xadi\xadbil\xadity: you are still able to ex\xade\xadcute op\xader\xada\xadtions with the con\xadnec\xadtion after the trans\xadac\xadtion com\xadpletes."),Object(o.a)("p",null,"How\xadever, you usu\xadally do not need the con\xadnec\xadtion after the changes are ",Object(o.a)("em",{parentName:"p"},"com\xadmited")," or ",Object(o.a)("em",{parentName:"p"},"roll\xadbacked"),".\nIn this case, you may sim\xadply cre\xadate you source ob\xadserv\xadable with one of the trans\xadac\xadtional helper meth\xadods in ",Object(o.a)("inlineCode",{parentName:"p"},"io.vertx.reactivex.ext.sql.SQLClientHelper"),"."),Object(o.a)("p",null,"Let\u2019s rewrite the pre\xadvi\xadous ex\xadam\xadple:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"SQLClientHelper.inTransactionSingle(client, sqlConnection -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return")," sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO albums (name) VALUES ('The Israelites')\""),")\n    .andThen(sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Israelites')\""),"))\n    .andThen(sqlConnection.rxExecute(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"INSERT INTO tracks (album, name) VALUES ('The Israelites', 'Too Much Too Soon')\""),"))\n    .andThen(sqlConnection.rxQuery(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),"\"SELECT name FROM tracks WHERE album = 'The Israelites'\""),").map(ResultSet::getResults))\n}).map(rows -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Transform DB rows into a client-friendly JSON object"),"\n}).subscribe(json -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send JSON to the client"),"\n}, t -> {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Send error to the client"),"\n});\n")),Object(o.a)("h2",{id:"give-it-a-try"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#give-it-a-try"})),"Give it a try"),Object(o.a)("p",null,"Vert.x 3.6 is ex\xadpected around fall, but the code is al\xadready in mas\xadter and ",Object(o.a)("em",{parentName:"p"},"snap\xadshots")," are reg\xadu\xadlarly pub\xadlished to Sonatype\u2019s OSS repos."),Object(o.a)("p",null,"So give it a try and feel free to pro\xadvide your fee\xadback on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},wx14:function(e,a,t){"use strict";function n(){return(n=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}t.d(a,"a",(function(){return n}))},wy8a:function(e,a,t){var n=t("KxBF");e.exports=function(e,a,t){var s=e.length;return t=void 0===t?s:t,!a&&t>=s?e:n(e,a,t)}},xDq6:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"Eclipse Vert.x 3.8.5",category:"releases",authors:[{name:"Julien Viet",github_id:"vietj"}],summary:"This version is a minor bug fix release addressing issues found in Vert.x 3.8.4. We would like to thank you all for reporting these issues."}),i=[{term:"http",tf:6},{term:"releas",tf:5},{term:"com",tf:4},{term:"wiki",tf:4},{term:"github",tf:3},{term:"x3",tf:3},{term:"avail",tf:3},{term:"bug",tf:2},{term:"report",tf:2},{term:"deprec",tf:2},{term:"break",tf:2},{term:"chang",tf:2},{term:"note",tf:2},{term:"distribut",tf:2},{term:"us",tf:2},{term:"bu",tf:2},{term:"client",tf:2},{term:"bower",tf:2},{term:"webjar",tf:2},{term:"www",tf:2},{term:"docker",tf:2},{term:"just",tf:1},{term:"fix",tf:1},{term:"quit",tf:1},{term:"thank",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"We have just re\xadleased Vert.x 3.8.5, a bug fix re\xadlease of Vert.x 3.8.x."),Object(o.a)("p",null,"Since the re\xadlease of Vert.x 3.8.4, quite a few bugs have been re\xadported. We would like to thank you all for re\xadport\xading these is\xadsues."),Object(o.a)("p",null,"Vert.x 3.8.5 dep\xadre\xadca\xadtions and break\xading changes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.5-Deprecations-and-breaking-changes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.5-\u200bDeprecations-and-breaking-changes"))),Object(o.a)("p",null,"Vert.x 3.8.5 re\xadlease notes"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/wiki/wiki/3.8.5-Release-Notes"}),"https://github.com/vert-\u200bx3/wiki/wiki/3.8.5-\u200bRelease-Notes"))),Object(o.a)("p",null,"The ar\xadti\xadfacts have been de\xadployed to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22io.vertx%22%20AND%20v%3A%223.8.%22"}),"Maven Cen\xadtral")," and you can get the dis\xadtri\xadb\xadu\xadtion on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://bintray.com/vertx/downloads/distribution/3.8.4/view"}),"Bin\xadtray"),"."),Object(o.a)("p",null,"You can boot\xadstrap a Vert.x 3.8.5 project using ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://start.vertx.io"}),"https://start.vertx.io"),"."),Object(o.a)("p",null,"The event bus client using the SockJS bridge are avail\xadable from NPM, Bower and as a We\xadb\xadJar:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://www.npmjs.com/package/vertx3-eventbus-client"}),"https://www.npmjs.com/pack\xadage/vertx3-\u200beventbus-client")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/vert-x3/vertx-bus-bower"}),"https://github.com/vert-\u200bx3/vertx-\u200bbus-bower")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://www.webjars.org/"}),"http://www.we\xadb\xadjars.org/"))),Object(o.a)("p",null,"Docker im\xadages are also avail\xadable on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://hub.docker.com/u/vertx/"}),"Docker Hub"),". The Vert.x dis\xadtri\xadb\xadu\xadtion is also avail\xadable from ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://sdkman.io/index.html"}),"SD\xadKMan")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://brew.sh/"}),"Home\xadBrew"),"."),Object(o.a)("p",null,"Happy cod\xading and see you soon on our user or dev ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"chan\xadnels"),"."))}m.isMDXComponent=!0},xhNl:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"OpenAPI (fka Swagger) 3 support in Eclipse Vert.x now in test stage!",category:"guides",authors:[{name:"Francesco Guardiani",github_id:"slinkydeveloper"}],summary:"As GSoC 2017's student, I'm working on an embedded support to OpenAPI 3 standard inside Eclipse Vert.x framework. Now, after a lot of work, you can try it!"}),i=[{term:"handler",tf:21},{term:"valid",tf:12},{term:"object",tf:11},{term:"paramet",tf:11},{term:"support",tf:9},{term:"openapi",tf:9},{term:"us",tf:9},{term:"secur",tf:8},{term:"schema",tf:7},{term:"automat",tf:7},{term:"request",tf:7},{term:"mount",tf:7},{term:"will",tf:7},{term:"add",tf:7},{term:"specif",tf:6},{term:"load",tf:6},{term:"oper",tf:6},{term:"defin",tf:6},{term:"everi",tf:6},{term:"name",tf:5},{term:"give",tf:5},{term:"router",tf:5},{term:"factori",tf:5},{term:"provid",tf:5},{term:"type",tf:5}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"[IM\xadPOR\xadTANT Now on up\xadstream! | We have pub\xadlished this pack\xadage with name ",Object(o.a)("inlineCode",{parentName:"p"},"vertx-web-api-contract")," ]"),Object(o.a)("p",null,"As GSoC 2017\u2019s stu\xaddent, I\u2019m ac\xadtu\xadally work\xading on an em\xadbed\xadded sup\xadport to Ope\xadnAPI 3 stan\xaddard in\xadside Eclipse Vert.x frame\xadwork. Now, after a lot of work, you can try it!"),Object(o.a)("h2",{id:"why-openapi-3"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#why-openapi-3"})),"Why OpenAPI 3?"),Object(o.a)("p",null,"Ope\xadnAPI 2 is the most im\xadpor\xadtant industry-\u200bgrade stan\xaddard for API Spec\xadi\xadfi\xadca\xadtions. As you can see on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://www.openapis.org/blog/2017/05/25/the-open-api-initiative-is-sending-you-a-save-the-date-card?utm_source=Blog&utm_medium=Twitter&utm_campaign=SaveTheDate"}),"of\xadfi\xadcial blog of Ope\xadnAPI Ini\xadtia\xadtive"),", the re\xadlease of ver\xadsion 3 is be\xadhind the cor\xadner, so we want to give to our com\xadmu\xadnity the lat\xadest tools for the lat\xadest stan\xaddards!"),Object(o.a)("p",null,"Vert.x project ob\xadjec\xadtive is to give you more in\xadte\xadgrated tools. With this new sup\xadport, it gives you the abil\xadity to use the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://swaggerhub.com/blog/api-design/design-first-or-code-first-api-development/"}),"De\xadsign Dri\xadven")," (or De\xadsign First) ap\xadproach ",Object(o.a)("strong",{parentName:"p"},"with\xadout load\xading any thirds par\xadties li\xadbraries"),"."),Object(o.a)("h2",{id:"features"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#features"})),"Features"),Object(o.a)("p",null,"The ac\xadtu\xadally sup\xadported fea\xadtures are the fol\xadlow\xading (we reefer to Ope\xadnAPI ver\xadsion 3.0.0):"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Ope\xadnAPI 3 com\xadpli\xadant API spec\xadi\xadfi\xadca\xadtion val\xadi\xadda\xadtion with ",Object(o.a)("strong",{parentName:"li"},"load\xading of ex\xadter\xadnal Json schemas")),Object(o.a)("li",{parentName:"ul"},"Au\xadto\xadmatic re\xadquest val\xadi\xadda\xadtion"),Object(o.a)("li",{parentName:"ul"},"Au\xadto\xadmatic mount of se\xadcu\xadrity val\xadi\xadda\xadtion han\xaddlers"),Object(o.a)("li",{parentName:"ul"},"Au\xadto\xadmatic 501 re\xadsponse for not im\xadple\xadmented op\xader\xada\xadtions"),Object(o.a)("li",{parentName:"ul"},"Router fac\xadtory to pro\xadvide all this fea\xadtures to users")),Object(o.a)("p",null,"Au\xadto\xadmatic re\xadquest val\xadi\xadda\xadtion is pro\xadvided by a new han\xaddler: ",Object(o.a)("inlineCode",{parentName:"p"},"ValidationHandler"),". You can also de\xadfine your own ",Object(o.a)("inlineCode",{parentName:"p"},"ValidationHandler")," with\xadout API spec\xadi\xadfi\xadca\xadtions, but I will dis\xadcuss it later."),Object(o.a)("p",null,"The re\xadquest val\xadi\xadda\xadtion (pro\xadvided by sub\xadclass ",Object(o.a)("inlineCode",{parentName:"p"},"OpenAPI3RequestValidationHandler"),") ac\xadtu\xadally sup\xadports:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Pa\xadra\xadme\xadters de\xadfined in ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/OAI/OpenAPI-Specification/blob/OpenAPI.next/versions/3.0.md#parameter-object"}),"Pa\xadra\xadme\xadter ob\xadject"),". We sup\xadport every type of pa\xadra\xadme\xadter, in\xadclud\xading ",Object(o.a)("inlineCode",{parentName:"li"},"object")," and ",Object(o.a)("inlineCode",{parentName:"li"},"array"),". We also sup\xadport every type de\xadscrip\xadtion field (for ex\xadam\xadple ",Object(o.a)("inlineCode",{parentName:"li"},"format"),", ",Object(o.a)("inlineCode",{parentName:"li"},"minimum"),", ",Object(o.a)("inlineCode",{parentName:"li"},"maximum"),", etc). Also, at the mo\xadment, we sup\xadport every com\xadbi\xadna\xadtion of ",Object(o.a)("inlineCode",{parentName:"li"},"style")," and ",Object(o.a)("inlineCode",{parentName:"li"},"explode")," field (ex\xadcluded styles ",Object(o.a)("inlineCode",{parentName:"li"},"matrix")," and ",Object(o.a)("inlineCode",{parentName:"li"},"label"),")"),Object(o.a)("li",{parentName:"ul"},"Body de\xadfined in new ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/OAI/OpenAPI-Specification/blob/OpenAPI.next/versions/3.0.md#request-body-object"}),"Re\xadquest\xadBody ob\xadject"),". In par\xadtic\xadu\xadlar:",Object(o.a)("ul",{parentName:"li"},Object(o.a)("li",{parentName:"ul"},"For ",Object(o.a)("inlineCode",{parentName:"li"},"application/json")," the val\xadi\xadda\xadtion han\xaddler will take schema that you have de\xadfined in ",Object(o.a)("inlineCode",{parentName:"li"},"schema")," ob\xadject and will val\xadi\xaddate json bod\xadies with it"),Object(o.a)("li",{parentName:"ul"},"For ",Object(o.a)("inlineCode",{parentName:"li"},"application/x-www-form-urlencoded")," and ",Object(o.a)("inlineCode",{parentName:"li"},"multipart/form-data")," the val\xadi\xadda\xadtion han\xaddler will take care of val\xadi\xaddate every pa\xadra\xadme\xadters in form at\xadtrib\xadutes. It ac\xadtu\xadally sup\xadports only comma sep\xada\xadrated val\xadues for ",Object(o.a)("inlineCode",{parentName:"li"},"object")," and ",Object(o.a)("inlineCode",{parentName:"li"},"arrays")),Object(o.a)("li",{parentName:"ul"},"For other pa\xadra\xadme\xadter types it will check ",Object(o.a)("inlineCode",{parentName:"li"},"Content-Type")," header")))),Object(o.a)("p",null,"Re\xadquest val\xadi\xadda\xadtion er\xadrors will be car\xadried with ",Object(o.a)("inlineCode",{parentName:"p"},"RoutingContext")," en\xadcap\xadsu\xadlated in an ob\xadject called ",Object(o.a)("inlineCode",{parentName:"p"},"ValidationHandler"),", so you have to at\xadtach fail\xadure han\xaddler to check if some\xadthing went wrong dur\xading val\xadi\xadda\xadtion. Also the ",Object(o.a)("inlineCode",{parentName:"p"},"RoutingContext")," carry a new ob\xadject called ",Object(o.a)("inlineCode",{parentName:"p"},"RequestParameters")," that en\xadcap\xadsu\xadlate all re\xadquest pa\xadra\xadme\xadters de\xadse\xadri\xadal\xadized and parsed."),Object(o.a)("p",null,"Router fac\xadtory is in\xadtended to give you a re\xadally sim\xadple user in\xadter\xadface to use Ope\xadnAPI 3 sup\xadport. Most im\xadpor\xadtant fea\xadtures are:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"Async load\xading of spec\xadi\xadfi\xadca\xadtion and its schema de\xadpen\xadden\xadcies"),Object(o.a)("li",{parentName:"ul"},"Au\xadto\xadmatic con\xadvert Ope\xadnAPI style paths to Vert.x style paths"),Object(o.a)("li",{parentName:"ul"},"Lazy meth\xadods: op\xader\xada\xadtions (com\xadbi\xadna\xadtion of paths and HTTP meth\xadods) are mounted in de\xadf\xadi\xadn\xadi\xadtion order in\xadside spec\xadi\xadfi\xadca\xadtion"),Object(o.a)("li",{parentName:"ul"},"Au\xadto\xadmatic mount of se\xadcu\xadrity val\xadi\xadda\xadtion han\xaddlers")),Object(o.a)("p",null,"Also, it\u2019s planned to re\xadlease a ",Object(o.a)("strong",{parentName:"p"},"project skele\xadton gen\xader\xada\xadtor")," based on API spec."),Object(o.a)("h2",{id:"startup-your-project"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#startup-your-project"})),"Startup your project"),Object(o.a)("p",null,"We are in a test\xading stage, so the vertx-\u200bweb of\xadfi\xadcial repo doesn\u2019t con\xadtain it. To in\xadclude the mod\xadi\xadfied ver\xadsion of vertx-\u200bweb re\xadplace your vertx-\u200bweb maven de\xadpen\xaddency with this one:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-web-api-contract",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.6.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"Now you can start using Ope\xadnAPI 3 in\xadside your Vert.x pow\xadered app!"),Object(o.a)("p",null,"First of all you need to load the spec\xadi\xadfi\xadca\xadtion and con\xadstruct the router fac\xadtory:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Load the api spec. This operation is asynchronous"),"\nOpenAPI3RouterFactory.create(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"this"),".vertx, ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"src/main/resources/petstore.yaml"'),", ar -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.succeeded()) {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Spec loaded with success"),"\n        OpenAPI3RouterFactory routerFactory = ar.result();\n    } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Something went wrong during router factory initialization"),"\n        Throwable exception = ar.cause();\n        logger.error(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Ops!"'),", exception);\n    }\n});\n")),Object(o.a)("h2",{id:"handlers-mounting"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#handlers-mounting"})),"Handlers mounting"),Object(o.a)("p",null,"Now load han\xaddlers to your op\xader\xada\xadtions. Use ",Object(o.a)("inlineCode",{parentName:"p"},"addHandlerByOperationId(String operationId, Handler<RoutingContext> handler)")," to add an han\xaddler to a route that matches the ",Object(o.a)("inlineCode",{parentName:"p"},"operationId"),". To add a fail\xadure han\xaddler use ",Object(o.a)("inlineCode",{parentName:"p"},"addFailureHandlerByOperationId(String operationId, Handler<RoutingContext> failureHandler) ")),Object(o.a)("p",null,"You can, of course, ",Object(o.a)("strong",{parentName:"p"},"add mul\xadti\xadple han\xaddlers to same op\xader\xada\xadtion"),", with\xadout over\xadwrit\xading the ex\xadist\xading ones."),Object(o.a)("p",null,"This is an ex\xadam\xadple of ",Object(o.a)("inlineCode",{parentName:"p"},"addHandlerByOperationId()"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Add an handler with operationId"),"\nrouterFactory.addHandlerByOperationId(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"listPets"'),", routingContext -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Handle listPets operation (GET /pets)"),"\n}, routingContext -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Handle failure"),"\n});\n")),Object(o.a)("h2",{id:"request-parameters"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#request-parameters"})),"Request parameters"),Object(o.a)("p",null,"Now you can freely use re\xadquest pa\xadra\xadme\xadters. To get the ",Object(o.a)("inlineCode",{parentName:"p"},"RequestParameters")," ob\xadject:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"RequestParameters params = routingContext.get(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"parsedParameters"'),");\n")),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"RequestParameters")," ob\xadject pro\xadvides all meth\xadods to ac\xadcess to query, cookie, header, path, form and en\xadtire body pa\xadra\xadme\xadters. Here are some ex\xadam\xadples of how to use this ob\xadject."),Object(o.a)("p",null,"Pa\xadra\xadme\xadter with name ",Object(o.a)("inlineCode",{parentName:"p"},"awesomeParameter")," with type ",Object(o.a)("inlineCode",{parentName:"p"},"integer")," in ",Object(o.a)("inlineCode",{parentName:"p"},"query"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"RequestParameter awesomeParameter = params.queryParameter(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"awesomeParameter"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (awesomeParameter != ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),") {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// awesomeParameter parameter exists, but we are not sure that is empty or not (query parameters can be empty with allowEmptyValue: true)"),"\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (!awesomeParameter.isEmpty()) {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Now we are sure that it exists and it's not empty, so we can extract it"),"\n      Integer awesome = awesomeParameter.getInteger();\n    } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Parameter exists, but it's empty value"),"\n    }\n} ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Parameter doesn't exist (it's not required)"),"\n}\n")),Object(o.a)("p",null,"As you can see, every pa\xadra\xadme\xadter is mapped in re\xadspec\xadtive ob\xadjects (",Object(o.a)("inlineCode",{parentName:"p"},"integer")," in ",Object(o.a)("inlineCode",{parentName:"p"},"Integer"),", ",Object(o.a)("inlineCode",{parentName:"p"},"integer")," with ",Object(o.a)("inlineCode",{parentName:"p"},"format: int64")," in ",Object(o.a)("inlineCode",{parentName:"p"},"Long"),", ",Object(o.a)("inlineCode",{parentName:"p"},"float")," in ",Object(o.a)("inlineCode",{parentName:"p"},"Float")," and so on)"),Object(o.a)("p",null,"Comma sep\xada\xadrated array with name ",Object(o.a)("inlineCode",{parentName:"p"},"awesomeParameters")," with type ",Object(o.a)("inlineCode",{parentName:"p"},"integer")," in ",Object(o.a)("inlineCode",{parentName:"p"},"query"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"RequestParameter awesomeParameters = params.queryParameter(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"awesomeParameters"'),");\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (awesomeParameters != ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null")," && !awesomeParameters.isEmpty()) {\n    List<RequestParameter> awesomeList = awesomeParameters.getArray();\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"for")," (RequestParameter awesome : awesomeList) {\n      Integer a = awesome.getInteger();\n    }\n} ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// awesomeParameters not found or empty string"),"\n}\n")),Object(o.a)("p",null,"JSON Body:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"RequestParameter body = params.body();\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (body != ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"null"),")\n  JsonObject jsonBody = body.getJsonObject();\n")),Object(o.a)("h2",{id:"security-handling"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#security-handling"})),"Security handling"),Object(o.a)("p",null,"You can mount only one se\xadcu\xadrity han\xaddler for a com\xadbi\xadna\xadtion of schema and scope."),Object(o.a)("p",null,"To add a se\xadcu\xadrity han\xaddler only with a schema name:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"routerFactory.addSecurityHandler(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"security_scheme_name"'),", routingContext -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Handle security here and then call next()"),"\n    routingContext.next();\n});\n")),Object(o.a)("p",null,"To add a se\xadcu\xadrity han\xaddler with a com\xadbi\xadna\xadtion of schema name and scope:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"routerFactory.addSecuritySchemaScopeValidator(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"security_scheme_name"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"scope_name"'),", routingContext -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Handle security here and then call next()"),"\n    routingContext.next();\n});\n")),Object(o.a)("p",null,"[NOTE You can de\xadfine se\xadcu\xadrity han\xaddlers where you want but de\xadfine it! | Dur\xading Router in\xadstan\xadti\xada\xadtion, if fac\xadtory finds a path that re\xadquire a se\xadcu\xadrity schema with\xadout an as\xadsigned han\xaddler, It will throw a ",Object(o.a)("inlineCode",{parentName:"p"},"RouterFactoryException")," ]"),Object(o.a)("h2",{id:"error-handling"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#error-handling"})),"Error handling"),Object(o.a)("p",null,"Every time you add an han\xaddler for an op\xader\xada\xadtion you can add a fail\xadure han\xaddler. To han\xaddle a ",Object(o.a)("inlineCode",{parentName:"p"},"ValidationException"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Throwable failure = routingContext.failure();\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (failure ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"instanceof")," ValidationException)\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Handle Validation Exception"),"\n    routingContext.response().setStatusCode(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"400"),").setStatusMessage(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"ValidationError"'),").end(failure.getMessage());\n")),Object(o.a)("p",null,"Also the router fac\xadtory pro\xadvides two other tools:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"It au\xadto\xadmat\xadi\xadcally mounts a 501 ",Object(o.a)("inlineCode",{parentName:"li"},"Not Implemented")," han\xaddler for op\xader\xada\xadtions where you haven\u2019t mounted any han\xaddler"),Object(o.a)("li",{parentName:"ul"},"It can load a de\xadfault ",Object(o.a)("inlineCode",{parentName:"li"},"ValidationException")," fail\xadure han\xaddler")),Object(o.a)("p",null,"Both these op\xadtions are con\xadfig\xadurable with ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/apidocs/io/vertx/ext/web/api/contract/RouterFactoryOptions.html"}),Object(o.a)("inlineCode",{parentName:"a"},"RouterFactoryOptions"))),Object(o.a)("h2",{id:"and-now-use-it"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#and-now-use-it"})),"And now use it!"),Object(o.a)("p",null,"Now you are ready to gen\xader\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"Router"),"!"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"Router router = routerFactory.getRouter();\n\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Now you can use your Router instance"),"\nHttpServer server = vertx.createHttpServer(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," HttpServerOptions().setPort(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8080"),").setHost(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"localhost"'),"));\nserver.requestHandler(router::accept).listen();\n")),Object(o.a)("p",null,"[NOTE Lazy meth\xadods! | ",Object(o.a)("inlineCode",{parentName:"p"},"getRouter()")," gen\xader\xadate the ",Object(o.a)("inlineCode",{parentName:"p"},"Router")," ob\xadject, so you don\u2019t have to care about code de\xadf\xadi\xadn\xadi\xadtion order]"),Object(o.a)("h2",{id:"and-now"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#and-now"})),"And now?"),Object(o.a)("p",null,"You can find a com\xadplete ex\xadam\xadple on ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/vert-x3/vertx-examples/tree/master/web-examples#http-request-validation-and-openapi-3-router-factory"}),Object(o.a)("inlineCode",{parentName:"a"},"vertx-examples"))),Object(o.a)("p",null,"You can ac\xadcess to ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/#web"}),"doc\xadu\xadmen\xadta\xadtion here")," and ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/docs/apidocs/io/vertx/ext/web/api/contract/package-summary.html"}),"Javadoc here")),Object(o.a)("p",null,"[IM\xadPOR\xadTANT We want you! | Please give us your feed\xadback open\xading an issue ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/slinkydeveloper/vertx-web/issues"}),"here")," ]"))}m.isMDXComponent=!0},zDbz:function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return m})),t.d(a,"__tfidf__terms",(function(){return j})),t.d(a,"default",(function(){return h}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=t("a1bP"),i=t("YFqc"),p=t.n(i),m=(r.a.createElement,{title:"Using the asynchronous SQL client",category:"guides",authors:[{name:"Clement Escoffier",github_id:"cescoffier"}],summary:"Finally, back... This post is the fifth post of the introduction to vert.x blog series, after a not-that-small break. In this post we are going to see how we can use JDBC in a vert.x application."}),j=[{term:"us",tf:22},{term:"jdbc",tf:20},{term:"method",tf:19},{term:"applic",tf:17},{term:"let",tf:16},{term:"post",tf:15},{term:"databas",tf:13},{term:"result",tf:13},{term:"asynchron",tf:12},{term:"start",tf:11},{term:"api",tf:9},{term:"provid",tf:9},{term:"client",tf:9},{term:"test",tf:9},{term:"call",tf:8},{term:"need",tf:8},{term:"not",tf:7},{term:"creat",tf:7},{term:"driver",tf:6},{term:"look",tf:6},{term:"file",tf:6},{term:"sql",tf:6},{term:"back",tf:5},{term:"time",tf:5},{term:"configur",tf:5}],b={meta:m,__tfidf__terms:j};function h(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},b,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Fi\xadnally, back\u2026 This post is the fifth post of the in\xadtro\xadduc\xadtion to vert.x blog se\xadries, after a not-\u200bthat-small break. In this post we are going to see how we can use JDBC in a vert.x ap\xadpli\xadca\xadtion, and this, using the asyn\xadchro\xadnous API pro\xadvided by the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-jdbc-client/java/"}),"vertx-\u200bjdbc-client"),"."),Object(o.a)("h2",{id:"previously-in-the-introduction-to-vertx-series"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#previously-in-the-introduction-to-vertx-series"})),"Previously in the introduction to vert.x series"),Object(o.a)("p",null,"As it was quite some time since the last post, let\u2019s start by re\xadfresh\xading our mind about the four pre\xadvi\xadous posts:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/my-first-vert-x-3-application/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"first post"))," has de\xadscribed how to build a vert.x ap\xadpli\xadca\xadtion with Maven and ex\xade\xadcute unit tests."),Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/vert-x-application-configuration/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"sec\xadond post"))," has de\xadscribed how this ap\xadpli\xadca\xadtion can be\xadcome con\xadfig\xadurable."),Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/some-rest-with-vert-x/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"third post"))," has in\xadtro\xadduced ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"http://vertx.io/docs/vertx-web/java/"}),"vertx-\u200bweb"),", and a small col\xadlec\xadtion man\xadage\xadment ap\xadpli\xadca\xadtion has been de\xadvel\xadoped. This ap\xadpli\xadca\xadtion of\xadfers a REST API used by a HTML/JavaScript fron\xadtend."),Object(o.a)("li",{parentName:"ol"},"The ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/unit-and-integration-tests/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"pre\xadvi\xadous post"))," has pre\xadsented how you can run in\xadte\xadgra\xadtion tests to en\xadsure the be\xadhav\xadior of your ap\xadpli\xadca\xadtion.")),Object(o.a)("p",null,"In this post, back to code. The cur\xadrent ap\xadpli\xadca\xadtion uses an in-\u200bmemory map to store the prod\xaducts. It\u2019s time to use a data\xadbase. In this post we are going to use ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://hsqldb.org/"}),"HSQL"),", but you can use any data\xadbase pro\xadvid\xading a JDBC dri\xadver. In\xadter\xadac\xadtions with the data\xadbase will be asyn\xadchro\xadnous and made using the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"http://vertx.io/docs/vertx-jdbc-client/java/"}),"vertx-\u200bjdbc-client"),"."),Object(o.a)("p",null,"The code of this post are avail\xadable on this Github ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app"}),"project"),", in the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/cescoffier/my-vertx-first-app/tree/post-5"}),"post-5 branch")," branch."),Object(o.a)("h2",{id:"asynchronous"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#asynchronous"})),"Asynchronous?"),Object(o.a)("p",null,"One of the vert.x char\xadac\xadter\xadis\xadtics is being asyn\xadchro\xadnous. With an asyn\xadchro\xadnous API, you don\u2019t wait for a re\xadsult, but you are no\xadti\xadfied when this re\xadsult is ready. Just to il\xadlus\xadtrate this, let\u2019s take a very sim\xadple ex\xadam\xadple."),Object(o.a)("p",null,"Let\u2019s imag\xadine an ",Object(o.a)("inlineCode",{parentName:"p"},"add")," method. Tra\xaddi\xadtion\xadally, you would use it like this: ",Object(o.a)("inlineCode",{parentName:"p"},"int r = add(1, 1)"),". This is a syn\xadchro\xadnous API as you are wait\xading for the re\xadsult. An asyn\xadchro\xadnous ver\xadsion of this API would be: ",Object(o.a)("inlineCode",{parentName:"p"},"add(1, 1, r -> { /* do something with the result */ })"),". In this ver\xadsion, you pass a ",Object(o.a)("inlineCode",{parentName:"p"},"Handler")," called when the re\xadsult has been com\xadputed. The method does not re\xadturn any\xadthing, and could be im\xadple\xadmented as:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"public")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"add"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," a, ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"int")," b, Handler<Integer> resultHandler)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"int")," r = a + b;\n    resultHandler.handle(r);\n}\n")),Object(o.a)("p",null,"Just to avoid mis\xadcon\xadcep\xadtions, asyn\xadchro\xadnous API are not about threads. As we can see in the ",Object(o.a)("inlineCode",{parentName:"p"},"add")," ex\xadam\xadple, there are no threads in\xadvolved."),Object(o.a)("h2",{id:"jdbc-yes-but-asynchronous"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#jdbc-yes-but-asynchronous"})),"JDBC yes, but asynchronous"),Object(o.a)("p",null,"So, now that we have seen some ba\xadsics about asyn\xadchro\xadnous API, let\u2019s have a look to the vertx-\u200bjdbc-client. This com\xadpo\xadnent lets us in\xadter\xadact with a data\xadbase through a JDBC dri\xadver. These in\xadter\xadac\xadtions are asyn\xadchro\xadnous, so when you were doing:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"String sql = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT * FROM Products"'),";\nResultSet rs = stmt.executeQuery(sql);\n")),Object(o.a)("p",null,"it will be:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"connection.query(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT * FROM Products"'),", result -> {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// do something with the result"),"\n});\n")),Object(o.a)("p",null,"This model is more ef\xadfi\xadcient as it avoids wait\xading for the re\xadsult. You are no\xadti\xadfied when the re\xadsult is avail\xadable."),Object(o.a)("p",null,"Let\u2019s now mod\xadify our ap\xadpli\xadca\xadtion to use a data\xadbase to store our prod\xaducts."),Object(o.a)("h2",{id:"some-maven-dependencies"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#some-maven-dependencies"})),"Some maven dependencies"),Object(o.a)("p",null,"The first things we need to do it to de\xadclare two new Maven de\xadpen\xadden\xadcies in our ",Object(o.a)("inlineCode",{parentName:"p"},"pom.xml")," file:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-xml"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"io.vertx",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"vertx-jdbc-client",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"3.1.0",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"org.hsqldb",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"groupId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"hsqldb",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"artifactId"),">"),"\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"<",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"2.3.3",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"version"),">"),"\n",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-tag"}),"</",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-name"}),"dependency"),">"),"\n")),Object(o.a)("p",null,"The first de\xadpen\xaddency pro\xadvides the vertx-\u200bjdbc-client, while the sec\xadond one pro\xadvide the HSQL JDBC dri\xadver. If you want to use an\xadother data\xadbase, change this de\xadpen\xaddency. You will also need to change the JDBC url and JDBC dri\xadver class name later."),Object(o.a)("h2",{id:"initializing-the-jdbc-client"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#initializing-the-jdbc-client"})),"Initializing the JDBC client"),Object(o.a)("p",null,"Now that we have added these de\xadpen\xadden\xadcies, it\u2019s time to cre\xadate our JDBC client:"),Object(o.a)("p",null,"In the ",Object(o.a)("inlineCode",{parentName:"p"},"MyFirstVerticle")," class, de\xadclare a new field ",Object(o.a)("inlineCode",{parentName:"p"},"JDBCClient jdbc;"),", and add the fol\xadlow\xading line at the be\xadgin\xadning of the ",Object(o.a)("inlineCode",{parentName:"p"},"start")," method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"jdbc = JDBCClient.createShared(vertx, config(), ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"My-Whisky-Collection"'),");\n")),Object(o.a)("p",null,"This cre\xadates an in\xadstance of JDBC client, con\xadfig\xadured with the con\xadfig\xadu\xadra\xadtion pro\xadvided to the ver\xadti\xadcle. To work cor\xadrectly this con\xadfig\xadu\xadra\xadtion needs to pro\xadvide:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("em",{parentName:"li"},"url")," - the JDBC url such as ",Object(o.a)("inlineCode",{parentName:"li"},"jdbc:hsqldb:mem:db?shutdown=true")),Object(o.a)("li",{parentName:"ul"},Object(o.a)("em",{parentName:"li"},"dri\xadver_class")," - the JDBC dri\xadver class such as ",Object(o.a)("inlineCode",{parentName:"li"},"org.hsqldb.jdbcDriver"))),Object(o.a)("p",null,"Ok, we have the client, we need a con\xadnec\xadtion to the data\xadbase. This is achieved using the ",Object(o.a)("inlineCode",{parentName:"p"},"jdbc.getConnection")," that take a ",Object(o.a)("inlineCode",{parentName:"p"},"Handler<AsyncResult<SQLConnection>>")," as pa\xadra\xadme\xadter. Let\u2019s have a deeper look to this type. It\u2019s a ",Object(o.a)("inlineCode",{parentName:"p"},"Handler"),", so it is called when the re\xadsult is ready. This re\xadsult is an in\xadstance of ",Object(o.a)("inlineCode",{parentName:"p"},"AsyncResult<SQLConnection>"),". ",Object(o.a)("inlineCode",{parentName:"p"},"AsyncResult")," is a struc\xadture pro\xadvided by vert.x that lets us know if the op\xader\xada\xadtion was com\xadpleted suc\xadcess\xadfully or failed. In case of suc\xadcess, it pro\xadvides the re\xadsult, here an in\xadstance of ",Object(o.a)("inlineCode",{parentName:"p"},"SQLConnection"),"."),Object(o.a)("p",null,"When you re\xadceive an in\xadstance of ",Object(o.a)("inlineCode",{parentName:"p"},"AsyncResult"),", your code gen\xader\xadally looks like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.failed()) {\n  System.err.println(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"The operation has failed...: "'),"\n      + ar.cause().getMessage());\n} ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Use the result:"),"\n  result = ar.result();\n }\n")),Object(o.a)("p",null,"So, let\u2019s go back to our ",Object(o.a)("inlineCode",{parentName:"p"},"SQLConnection"),". We need to re\xadtrieve it, and then start the rest of the ap\xadpli\xadca\xadtion. This changes how we start the ap\xadpli\xadca\xadtion, as it will be\xadcome asyn\xadchro\xadnous. So, if we di\xadvide our startup se\xadquence into small chunks it would be some\xadthing like:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"startBackend(\n (connection) -> createSomeData(connection,\n     (nothing) -> startWebApp(\n         (http) -> completeStartup(http, fut)\n     ), fut\n ), fut);\n")),Object(o.a)("p",null,"with:"),Object(o.a)("ol",null,Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"startBackend")," - re\xadtrieves a ",Object(o.a)("inlineCode",{parentName:"li"},"SQLConnection")," and then calls the next step"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"createSomeData")," - ini\xadtial\xadizes the data\xadbase and in\xadserts some data. When done, it calls the next step"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"startWebApp")," - starts our web ap\xadpli\xadca\xadtion"),Object(o.a)("li",{parentName:"ol"},Object(o.a)("inlineCode",{parentName:"li"},"completeStartup")," - fi\xadnal\xadizes our start se\xadquence")),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"fut")," is the com\xadple\xadtion fu\xadture passed by vert.x that let us re\xadport when we are started, or if an issue has been en\xadcoun\xadtered while start\xading."),Object(o.a)("p",null,"Let\u2019s have a look to ",Object(o.a)("inlineCode",{parentName:"p"},"startBackend"),":"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"startBackend"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Handler<AsyncResult<SQLConnection>> next, Future<Void> fut)")," "),"{\n  jdbc.getConnection(ar -> {\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.failed()) {\n      fut.fail(ar.cause());\n    } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n      next.handle(Future.succeededFuture(ar.result()));\n    }\n  });\n}\n")),Object(o.a)("p",null,"This method re\xadtrieves a ",Object(o.a)("inlineCode",{parentName:"p"},"SQLConnection"),", check whether this op\xader\xada\xadtion suc\xadceeded. If so, it calls the next step. In case of fail\xadure, it re\xadports it."),Object(o.a)("p",null,"The other meth\xadods fol\xadlow the same pat\xadtern: 1) check if the last op\xader\xada\xadtion has suc\xadceeded, 2) do the task, 3) call the next step."),Object(o.a)("h3",{id:"a-bit-of-sql"},Object(o.a)("a",Object(n.a)({parentName:"h3"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#a-bit-of-sql"})),"A bit of SQL\u2026"),Object(o.a)("p",null,"Our client is ready, let\u2019s now write some SQL state\xadments. Let\u2019s start by the ",Object(o.a)("inlineCode",{parentName:"p"},"createSomeData")," method that is part of the startup se\xadquence:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"createSomeData"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(AsyncResult<SQLConnection> result,\n    Handler<AsyncResult<Void>> next, Future<Void> fut)")," "),"{\n    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (result.failed()) {\n      fut.fail(result.cause());\n    } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n      SQLConnection connection = result.result();\n      connection.execute(\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"CREATE TABLE IF NOT EXISTS Whisky (id INTEGER IDENTITY, name varchar(100), "')," +\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"origin varchar(100))"'),",\n          ar -> {\n            ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.failed()) {\n              fut.fail(ar.cause());\n              connection.close();\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n            }\n            connection.query(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT * FROM Whisky"'),", select -> {\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (select.failed()) {\n                fut.fail(ar.cause());\n                connection.close();\n                ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n              }\n              ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (select.result().getNumRows() == ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),") {\n                insert(\n                    ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Bowmore 15 Years Laimrig"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Islay"'),"),\n                    connection,\n                    (v) -> insert(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Talisker 57\xb0 North"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"Scotland, Island"'),"),\n                        connection,\n                        (r) -> {\n                          next.handle(Future.<Void>succeededFuture());\n                          connection.close();\n                        }));                                                    \n              } ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"else")," {\n                next.handle(Future.<Void>succeededFuture());\n                connection.close();\n              }\n            });\n          });\n    }\n  }\n")),Object(o.a)("p",null,"This method checks that the ",Object(o.a)("inlineCode",{parentName:"p"},"SQLConnection")," is avail\xadable and then start ex\xade\xadcut\xading some SQL state\xadments. First, it cre\xadates the ta\xadbles if there are not there yet. As you can see, the method called is struc\xadtured as fol\xadlows:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"connection.execute(\n    SQL statement,\n    handler called when the statement has been executed\n)\n")),Object(o.a)("p",null,"The han\xaddler re\xadceives an ",Object(o.a)("inlineCode",{parentName:"p"},"AsyncResult<Void>"),", ",Object(o.a)("em",{parentName:"p"},"i.e.")," a no\xadti\xadfi\xadca\xadtion of the com\xadple\xadtion with\xadout an ac\xadtual re\xadsult."),Object(o.a)(l.a,{info:!0,title:"Closing connection",mdxType:"Alert"},Object(o.a)("p",null,"Don\u2019t for\xadget to close the SQL con\xadnec\xadtion when you are done. The con\xadnec\xadtion will be given back to the con\xadnec\xadtion pool and be reused.")),Object(o.a)("p",null,"In the code of this han\xaddler, we check whether or not the state\xadment has been ex\xade\xadcuted cor\xadrectly, and if so we check to see if the table al\xadready con\xadtains some data, if not, it in\xadserts data using the ",Object(o.a)("inlineCode",{parentName:"p"},"insert")," method:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"insert"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(Whisky whisky, SQLConnection connection, Handler<AsyncResult<Whisky>> next)")," "),"{\n  String sql = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"INSERT INTO Whisky (name, origin) VALUES ?, ?"'),";\n  connection.updateWithParams(sql,\n      ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonArray().add(whisky.getName()).add(whisky.getOrigin()),\n      (ar) -> {\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"if")," (ar.failed()) {\n          next.handle(Future.failedFuture(ar.cause()));\n          ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"return"),";\n        }\n        UpdateResult result = ar.result();\n        ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Build a new whisky instance with the generated id."),"\n        Whisky w = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," Whisky(result.getKeys().getInteger(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"0"),"), whisky.getName(), whisky.getOrigin());\n        next.handle(Future.succeededFuture(w));\n      });\n}\n")),Object(o.a)("p",null,"This method uses the ",Object(o.a)("inlineCode",{parentName:"p"},"updateWithParams")," method with an ",Object(o.a)("em",{parentName:"p"},"IN\xadSERT")," state\xadment, and pass val\xadues. This ap\xadproach avoids SQL in\xadjec\xadtion. Once the the state\xadment has been ex\xade\xadcuted, we cre\xadates a new ",Object(o.a)("inlineCode",{parentName:"p"},"Whisky")," ob\xadject with the cre\xadated (auto-\u200bgenerated) id."),Object(o.a)("h2",{id:"some-rest-with-a-pinch-of-sql"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#some-rest-with-a-pinch-of-sql"})),"Some REST with a pinch of SQL"),Object(o.a)("p",null,"The method de\xadscribed  above is part of our start se\xadquence. But what about the method in\xadvoked by our REST API. Let\u2019s have a look to the ",Object(o.a)("inlineCode",{parentName:"p"},"getAll")," method. This method is called by the web front-\u200bend to re\xadtrieve all stored prod\xaducts:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"})," ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-function"}),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"private")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-keyword"}),"void")," ",Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-title"}),"getAll"),Object(o.a)("span",Object(n.a)({parentName:"span"},{className:"hljs-params"}),"(RoutingContext routingContext)")," "),"{\n    jdbc.getConnection(ar -> {\n      SQLConnection connection = ar.result();\n      connection.query(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"SELECT * FROM Whisky"'),", result -> {\n        List<Whisky> whiskies = result.result().getRows().stream().map(Whisky::",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new"),").collect(Collectors.toList());\n        routingContext.response()\n            .putHeader(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"content-type"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"application/json; charset=utf-8"'),")\n            .end(Json.encodePrettily(whiskies));\n        connection.close(); ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-comment"}),"// Close the connection     "),"\n      });\n    });\n  }\n")),Object(o.a)("p",null,"This method gets a ",Object(o.a)("inlineCode",{parentName:"p"},"SQLConnection"),", and then issue a query. Once the re\xadsult has been re\xadtrieved it writes the HTTP re\xadsponse as be\xadfore. The ",Object(o.a)("inlineCode",{parentName:"p"},"getOne"),", ",Object(o.a)("inlineCode",{parentName:"p"},"deleteOne"),", ",Object(o.a)("inlineCode",{parentName:"p"},"updateOne")," and ",Object(o.a)("inlineCode",{parentName:"p"},"addOne")," meth\xadods fol\xadlow the same pat\xadtern. No\xadtice that the con\xadnec\xadtion can be closed after the re\xadsponse has been writ\xadten."),Object(o.a)("p",null,"Let\u2019s have a look to the re\xadsult pro\xadvided to the han\xaddler passed to the ",Object(o.a)("inlineCode",{parentName:"p"},"query")," method. It gets a ",Object(o.a)("inlineCode",{parentName:"p"},"ResultSet"),", which con\xadtains the query re\xadsult. Each row is a ",Object(o.a)("inlineCode",{parentName:"p"},"JsonObject"),", so if your data ob\xadject has a con\xadstruc\xadtor tak\xading a ",Object(o.a)("inlineCode",{parentName:"p"},"JsonObject")," as unique ar\xadgu\xadment, cre\xadat\xading there ob\xadjects is straight\xadfor\xadward."),Object(o.a)("h2",{id:"test-test-and-test-again"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#test-test-and-test-again"})),"Test, test, and test again"),Object(o.a)("p",null,"We need to slightly up\xaddate our tests to con\xadfig\xadure the ",Object(o.a)("inlineCode",{parentName:"p"},"JDBCClient"),". In the ",Object(o.a)("inlineCode",{parentName:"p"},"MyFirstVertilceTest")," class, change the ",Object(o.a)("inlineCode",{parentName:"p"},"DeploymentOption")," ob\xadject cre\xadated in the ",Object(o.a)("inlineCode",{parentName:"p"},"setUp")," method to be:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-java"}),"DeploymentOptions options = ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," DeploymentOptions()\n    .setConfig(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-keyword"}),"new")," JsonObject()\n        .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"http.port"'),", port)\n        .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"url"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"jdbc:hsqldb:mem:test?shutdown=true"'),")\n        .put(",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"driver_class"'),", ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"org.hsqldb.jdbcDriver"'),")\n    );\n")),Object(o.a)("p",null,"In ad\xaddi\xadtion to the ",Object(o.a)("inlineCode",{parentName:"p"},"http.port"),", we also put the JDBC url and the class of the JDBC dri\xadver. We use an in-\u200bmemory data\xadbase for tests."),Object(o.a)("p",null,"The same mod\xadi\xadfi\xadca\xadtion needs to be done in the ",Object(o.a)("inlineCode",{parentName:"p"},"src/test/resources/my-it-config.json")," file:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"http.port"'),": ${http.port},\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"url"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"jdbc:hsqldb:mem:it-test?shutdown=true"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"driver_class"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"org.hsqldb.jdbcDriver"'),"\n}\n")),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"src/main/conf/my-application-conf.json")," file also needs to be up\xaddated, not for the tests, but to run the ap\xadpli\xadca\xadtion:"),Object(o.a)("pre",null,Object(o.a)("code",Object(n.a)({parentName:"pre"},{className:"hljs language-json"}),"{\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"http.port"')," : ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-number"}),"8082"),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"url"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"jdbc:hsqldb:file:db/whiskies"'),",\n  ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-attr"}),'"driver_class"'),": ",Object(o.a)("span",Object(n.a)({parentName:"code"},{className:"hljs-string"}),'"org.hsqldb.jdbcDriver"'),"\n}\n")),Object(o.a)("p",null,"The JDBC url is a bit dif\xadfer\xadent in this last file, as we store the data\xadbase on the file sys\xadtem."),Object(o.a)("h2",{id:"show-time"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#show-time"})),"Show time!"),Object(o.a)("p",null,"Let\u2019s now build our ap\xadpli\xadca\xadtion:"),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"mvn clean package")),Object(o.a)("p",null,"As we didn\u2019t change the API (nei\xadther the pub\xadlic java one nor the REST), test should run smoothly."),Object(o.a)("p",null,"Then launch the ap\xadpli\xadca\xadtion with:"),Object(o.a)("p",null,Object(o.a)("inlineCode",{parentName:"p"},"java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar -conf src/main/conf/my-application-conf.json ")),Object(o.a)("p",null,"Open your browser to ",Object(o.a)("inlineCode",{parentName:"p"},"http://localhost:8082/assets/index.html"),", and you should see the ap\xadpli\xadca\xadtion using the data\xadbase. This time the prod\xaducts are stored in a data\xadbase per\xadsisted on the file sys\xadtem. So, if we stop and restart the ap\xadpli\xadca\xadtion, the data is re\xadstored."),Object(o.a)("h2",{id:"conclusion"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#conclusion"})),"Conclusion"),Object(o.a)("p",null,"In this post, we saw how you can use JDBC data\xadbase with vert.x, and thus with\xadout too much bur\xadden. You may have been sur\xadprised by the asyn\xadchro\xadnous de\xadvel\xadop\xadment model, but once you start using it, it\u2019s hard to come back."),Object(o.a)("p",null,"In the ",Object(o.a)(p.a,{href:"/blog/[[...slug]]",as:"/blog/combine-vert-x-and-mongo-to-build-a-giant/",passHref:!0,mdxType:"Link"},Object(o.a)("a",null,"next post")),", we see how the same ap\xadpli\xadca\xadtion can use Mon\xadgoDB in\xadstead of HSQL."),Object(o.a)("p",null,"Stay tuned, and happy cod\xading!"))}h.isMDXComponent=!0},zTRB:function(e,a){e.exports="/_next/static/images/nocookie-d15899ad905f390faf1d146d883a6c1b.png"},"zj+8":function(e,a,t){"use strict";t.r(a),t.d(a,"meta",(function(){return l})),t.d(a,"__tfidf__terms",(function(){return i})),t.d(a,"default",(function(){return m}));var n=t("wx14"),s=t("Ff2n"),c=t("q1tI"),r=t.n(c),o=t("7ljp"),l=(r.a.createElement,{title:"New community channels",category:"news",authors:[{name:"Thomas Segismont",github_id:"tsegismont"}],summary:"In order to better support the community, we (the core team and module maintainers) now also provide help on Stack Overflow and Gitter."}),i=[{term:"user",tf:6},{term:"question",tf:5},{term:"gitter",tf:4},{term:"channel",tf:4},{term:"github",tf:4},{term:"commun",tf:3},{term:"ask",tf:3},{term:"not",tf:3},{term:"websit",tf:2},{term:"stack",tf:2},{term:"overflow",tf:2},{term:"chat",tf:2},{term:"modul",tf:2},{term:"maintain",tf:2},{term:"answer",tf:2},{term:"wherev",tf:2},{term:"support",tf:2},{term:"rule",tf:2},{term:"group",tf:2},{term:"irc",tf:2},{term:"issu",tf:2},{term:"new",tf:2},{term:"peopl",tf:2},{term:"74",tf:1},{term:"visit",tf:1}],p={meta:l,__tfidf__terms:i};function m(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.a)("wrapper",Object(n.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,"If you vis\xadited the Eclipse Vert.x web\xadsite re\xadcently, you might have no\xadticed a cou\xadple of nov\xadel\xadties on the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://vertx.io/community"}),"com\xadmu\xadnity")," page:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"the Stack Over\xadflow ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://stackoverflow.com/questions/tagged/vert.x?sort=newest&pageSize=15"}),"vert.x")," tag for user ques\xadtions"),Object(o.a)("li",{parentName:"ul"},"the ",Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"vertx-\u200busers")," Git\xadter chan\xadnel to chat with other users and mod\xadule main\xadtain\xaders")),Object(o.a)("p",null,"Won\xadder\xading why?"),Object(o.a)("h2",{id:"answering-questions-wherever-they-are-asked"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#answering-questions-wherever-they-are-asked"})),"Answering questions wherever they are asked"),Object(o.a)("p",null,"In order to help us sup\xadport the com\xadmu\xadnity, we (the core team and mod\xadule main\xadtain\xaders) have tried so far to stick to a few rules:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},Object(o.a)("a",Object(n.a)({parentName:"li"},{href:"https://groups.google.com/forum/?fromgroups#!forum/vertx"}),"user group")," for ques\xadtions"),Object(o.a)("li",{parentName:"ul"},"IRC to chat"),Object(o.a)("li",{parentName:"ul"},"bugs and is\xadsues re\xadported on GitHub")),Object(o.a)("p",null,"These rules were doc\xadu\xadmented on the web\xadsite, but ad\xadmit\xadtedly they are hard (if pos\xadsi\xadble at all) to en\xadforce.\nAnd let\u2019s face it: many new users like to ask ques\xadtions on Stack\xadover\xadflow and GitHub."),Object(o.a)("p",null,"So we now an\xadswer ques\xadtions wher\xadever they are asked.\nWe keep the user group as the main chan\xadnel though: some con\xadver\xadsa\xadtions just don\u2019t fit the Stack Over\xadflow model, and not every\xadone in the com\xadmu\xadnity watches the GitHub repos\xadi\xadto\xadries."),Object(o.a)("h2",{id:"moving-from-irc-to-gitter"},Object(o.a)("a",Object(n.a)({parentName:"h2"},{"aria-hidden":!0,tabIndex:-1,className:"heading-anchor",href:"#moving-from-irc-to-gitter"})),"Moving from IRC to Gitter"),Object(o.a)("p",null,"The ",Object(o.a)("inlineCode",{parentName:"p"},"#vertx")," chan\xadnel is recorded on ",Object(o.a)("inlineCode",{parentName:"p"},"echelog")," but it\u2019s not con\xadve\xadnient to search or browse.\nAnd shar\xading code, logs, is\xadsues is sim\xadply awful com\xadpared to mod\xadern al\xadter\xadna\xadtives like Git\xadter or Slack."),Object(o.a)("p",null,"Git\xadter got our pref\xader\xadence be\xadcause:"),Object(o.a)("ul",null,Object(o.a)("li",{parentName:"ul"},"it\u2019s free, with\xadout lim\xadits"),Object(o.a)("li",{parentName:"ul"},"it\u2019s not re\xadsource hun\xadgry (on a browser at least)"),Object(o.a)("li",{parentName:"ul"},"it\u2019s well in\xadte\xadgrated with GitHub"),Object(o.a)("li",{parentName:"ul"},"it sup\xadports ad\xadvanced for\xadmat\xadting")),Object(o.a)("p",null,"Since the ",Object(o.a)("a",Object(n.a)({parentName:"p"},{href:"https://gitter.im/eclipse-vertx/vertx-users"}),"chan\xadnel")," was opened, new peo\xadple are join\xading every day.\nAt the time of writ\xading, there are 74 peo\xadple reg\xadis\xadtered al\xadready.\nWe hope you will be the next one!"),Object(o.a)("p",null,"See you soon on\xadline."))}m.isMDXComponent=!0}},[["QYtG",0,2,1,4,3]]]);