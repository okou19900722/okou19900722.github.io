<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><title>Eclipse Vert.x metrics now with Micrometer.io | Blog | Eclipse Vert.x</title><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/styles.065337ce.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.065337ce.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-b6e20584df76f29b6f35.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.fcef98db13e2318579fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.6a5cc0a07ce13c54adf1.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" as="script"/><link rel="preload" href="/_next/static/chunks/5e2acbba0c73eb7c5c0e969bcd552d3808de9969.4d0eb9c3d4239c66cc89.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-e52c21bde616652a406f.js" as="script"/></head><body><div id="__next"><main class="page"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><a class="navbar-menu-item" href="/introduction-to-vertx-and-reactive/">Intro</a><a class="navbar-menu-item" href="/docs/">Docs</a><a class="navbar-menu-item" href="/faq/">FAQ</a><a class="navbar-menu-item" href="/blog/">Blog</a><a class="navbar-menu-item" href="/community/">Community</a></div><div class="navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" class="navbar-social-link" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link" title="Stack Overflow" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>Stack Overflow</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" class="navbar-social-link" title="YouTube" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>YouTube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a href="https://discord.gg/KzEMwP2" class="navbar-social-link" title="Discord" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>Discord</title><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" class="navbar-social-link" title="Vert.x User Group" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x User Group</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a></div></div></div></div></header><div class="page-content"><div class="container"><div class="blog-post"><div class="blog-navbar"><h2>Blog</h2><ul><li><a href="/blog/">All posts</a></li><li><a href="/blog/category/releases/">releases</a></li><li><a href="/blog/category/guides/">guides</a></li><li><a href="/blog/category/news/">news</a></li></ul></div><div class="blog-post-main"><div class="blog-post-content"><h1>Eclipse Vert.x metrics now with Micrometer.io</h1><span><p>Vert.x has al­ready been pro­vid­ing met­rics for some time, through the <a href="/docs/vertx-dropwizard-metrics/java/">vertx-​dropwizard-metrics</a> and <a href="/docs/vertx-hawkular-metrics/java/">vertx-​hawkular-metrics</a> mod­ules. Both of them im­ple­ment a ser­vice provider in­ter­face (SPI) to col­lect the Vert.x met­rics and make them avail­able to their re­spec­tive back­ends.</p><p>A new mod­ule, <a href="/docs/vertx-micrometer-metrics/java/">vertx-​micrometer-metrics</a>, is now added to the fam­ily. It im­ple­ments the same SPI, which means that it is able to pro­vide the same met­rics.
<a href="http://micrometer.io/"><em>Mi­crom­e­ter.io</em></a> is a pretty new met­rics li­brary, quite com­pa­ra­ble to <em>drop­wiz­ard met­rics</em> in that it col­lects met­rics in a local, in-​memory reg­istry and is able to store them in var­i­ous back­ends such as <em>Graphite</em> or <em>In­fluxDB</em>. It has sev­eral ad­van­tages as we will see below.</p><h2 id="tell-me-more-about-micrometer"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#tell-me-more-about-micrometer"></a>Tell me more about Micrometer</h2><p><a href="http://micrometer.io/"><em>Mi­crom­e­ter.io</em></a> de­scribes it­self as a a vendor-​neutral ap­pli­ca­tion met­rics fa­cade.
It pro­vides a well de­signed API, in Java, to de­fine <em>gauges</em>, <em>coun­ters</em>, <em>timers</em> and <em>dis­tri­b­u­tion sum­maries</em>.</p><p>Among the avail­able back­ends, Mi­crom­e­ter na­tively sup­ports <em>Graphite</em>, <em>In­fluxDB</em>, <em>JMX</em>, <em>Prometheus</em> and <a href="http://micrometer.io/docs">sev­eral oth­ers</a>. Prometheus is very pop­u­lar in the Ku­ber­netes and mi­croser­vices ecosys­tems, so its sup­port by Mi­crom­e­ter was a strong mo­ti­va­tion for im­ple­ment­ing it in Vert.x.</p><p>For the the mo­ment, our im­ple­men­ta­tion in Vert.x sup­ports <em>Prometheus</em>, <em>In­fluxDB</em> and <em>JMX</em>. More should quickly come in the near fu­ture.</p><h3 id="dimensionality"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#dimensionality"></a>Dimensionality</h3><p>An­other in­ter­est­ing as­pect in Mi­crom­e­ter is that it han­dles met­rics <em>di­men­sion­al­ity</em>: met­rics can be as­so­ci­ated with a set of key/value pairs (some­times ref­ered as <em>tags</em>, some­times as <em>la­bels</em>). Every value brings a new di­men­sion to the met­ric, so that in Prometheus or any other back­end that sup­ports di­men­sion­al­ity, we can query for dat­a­points of one or sev­eral di­men­sions, or query for dat­a­points ag­gre­gated over sev­eral di­men­sions.</p><p>  <em>Ex­am­ple: our met­ric <code>vertx_http_server_connections</code> ac­cepts la­bels <code>local</code> and <code>remote</code>, that are used to store ad­dresses on HTTP con­nec­tions</em></p><div class="alert info"><p>Prometheus is used in the fol­low­ing ex­am­ples, but equiv­a­lent queries can be per­formed with <em>In­fluxDB</em>.</p></div><p>In Prometheus, the query <code>vertx_http_server_connections</code> will re­turn as many time­series as there are com­bi­na­tions of <code>local</code> and <code>remote</code> val­ues. Ex­am­ple:</p><pre><code class="hljs language-basic">vertx_http_server_connections{local=<span class="hljs-string">&quot;0.0.0.0:8080&quot;</span>,<span class="hljs-comment">remote=&quot;1.1.1.1&quot;}</span>
vertx_http_server_connections{local=<span class="hljs-string">&quot;0.0.0.0:8080&quot;</span>,<span class="hljs-comment">remote=&quot;2.2.2.2&quot;}</span>
vertx_http_server_connections{local=<span class="hljs-string">&quot;0.0.0.0:8080&quot;</span>,<span class="hljs-comment">remote=&quot;3.3.3.3&quot;}</span>
</code></pre><p>To query on a sin­gle di­men­sion, we must pro­vide the la­bels:</p><p><code>vertx_http_server_connections{local=&quot;0.0.0.0:8080&quot;,remote=&quot;1.1.1.1&quot;}</code>. It will re­turn a sin­gle time­series.</p><p>To get an ag­gre­gate, Prometheus (PromQL) pro­vides sev­eral <a href="https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators">ag­gre­ga­tion op­er­a­tors</a>:</p><p><code>sum(vertx_http_server_connections)</code> will re­turn the sum across all di­men­sions.</p><h2 id="so-what-are-the-vertx-metrics"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#so-what-are-the-vertx-metrics"></a>So what are the Vert.x metrics?</h2><p>Peo­ple al­ready fa­mil­iar with the ex­ist­ing met­rics mod­ules (<em>drop­wiz­ard</em> or <em>hawku­lar</em>) will not be too dis­ori­ented. They are roughly the same. The main dif­fer­ence is where pre­vi­ously, some met­ric names could have a vari­able part within - such as <code>vertx.eventbus.handlers.myaddress</code> - here we take ad­van­tage of di­men­sion­al­ity and we will have <code>vertx_eventbus_handlers{address=&quot;myaddress&quot;}</code>.</p><p>Some other met­rics are no longer use­ful, for in­stance the drop­wiz­ard’s <code>vertx.eventbus.messages.pending</code>, <code>vertx.eventbus.messages.pending-local</code> and <code>vertx.eventbus.messages.pending-remote</code> are now just <code>vertx_eventbus_pending{side=local}</code> and <code>vertx_eventbus_pending{side=remote}</code> in mi­crom­e­ter. The sum of them can eas­ily be com­puted at query time.</p><p>The met­rics pro­vided by Vert.x are dis­patched into eight big fam­i­lies:</p><ul><li><strong>Net client</strong>: dis­tri­b­u­tion sum­maries of bytes sent and re­ceived, num­ber of con­nec­tions, etc.</li><li><strong>Net server</strong>: dis­tri­b­u­tion sum­maries of bytes sent and re­ceived, num­ber of con­nec­tions, etc.</li><li><strong>HTTP client</strong>: counter of re­quests, re­sponse times, etc.</li><li><strong>HTTP server</strong>: counter of re­quests, pro­cess­ing times, etc.</li><li><strong>Event bus</strong>: counter of han­dlers, mes­sages sent and re­ceived, etc.</li><li><strong>Pool</strong>: for worker pools and some data­source pools, queue size and wait­ing time, pro­cess­ing time, etc.</li><li><strong>Ver­ti­cles</strong>: num­ber of ver­ti­cles de­ployed.</li></ul><p>The full list of col­lected met­rics is <a href="/docs/vertx-micrometer-metrics/java/#_vert_x_core_tools_metrics">avail­able here</a>.</p><h2 id="getting-started"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#getting-started"></a>Getting started</h2><p>This sec­tion will guide you through a quick setup to run a Vert.x ap­pli­ca­tion with Mi­crom­e­ter. The code ex­am­ples used here are taken from the <code>micrometer-metrics-example</code> in <code>vertx-examples</code> repos­i­tory, in Java, using <em>maven</em>. But the same could be done with other Vert.x sup­ported lan­guages, as well as <em>gra­dle</em> in­stead of <em>maven</em>.</p><h3 id="maven-configuration"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#maven-configuration"></a>Maven configuration</h3><p>The con­fig­u­ra­tion and the maven im­ports will vary ac­cord­ing to the back­end stor­age that will be used. For maven, the com­mon part is al­ways:</p><pre><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-micrometer-metrics<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><ul><li>Then, to re­port to In­fluxDB:</li></ul><pre><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.micrometer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>micrometer-registry-influx<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><ul><li>Or Prometheus:</li></ul><pre><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.micrometer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>micrometer-registry-prometheus<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><p>Re­mark that, since Prometheus pulls met­rics from their source, they must be ex­posed on an HTTP end­point. That’s why <code>vertx-web</code> is im­ported here. It is not <em>ab­solutely</em> nec­es­sary (it’s pos­si­ble to get the met­rics reg­istry con­tent and ex­pose it in any other way) but it’s prob­a­bly the eas­i­est way to do.</p><ul><li>Or JMX:</li></ul><pre><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.micrometer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>micrometer-registry-jmx<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><div class="alert info"><p>At the mo­ment, it is not pos­si­ble to re­port met­rics to sev­eral back­ends at the same time. <a href="https://github.com/vert-x3/vertx-micrometer-metrics/issues/16">It might be soon im­ple­mented</a>.</p></div><h3 id="setting-up-vertx-options"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#setting-up-vertx-options"></a>Setting up Vert.x options</h3><p>A <code>MicrometerMetricsOptions</code> ob­ject must be cre­ated and passed to <code>VertxOptions</code>, with one back­end con­fig­ured (though hav­ing no back­end is pos­si­ble: you would get met­rics sent to a de­fault Mi­crom­e­ter reg­istry, but with­out any per­sis­tent stor­age).</p><ul><li>In­fluxDB ex­am­ple:</li></ul><pre><code class="hljs language-java"><span class="hljs-comment">// Default InfluxDB options will push metrics to localhost:8086, db &quot;default&quot;</span>
MicrometerMetricsOptions options = <span class="hljs-keyword">new</span> MicrometerMetricsOptions()
  .setInfluxDbOptions(<span class="hljs-keyword">new</span> VertxInfluxDbOptions().setEnabled(<span class="hljs-keyword">true</span>))
  .setEnabled(<span class="hljs-keyword">true</span>);
Vertx vertx = Vertx.vertx(<span class="hljs-keyword">new</span> VertxOptions().setMetricsOptions(options));
<span class="hljs-comment">// Then deploy verticles with this vertx instance</span>
</code></pre><ul><li>Prometheus ex­am­ple:</li></ul><pre><code class="hljs language-java"><span class="hljs-comment">// Deploy with embedded server: prometheus metrics will be automatically exposed,</span>
<span class="hljs-comment">// independently from any other HTTP server defined</span>
MicrometerMetricsOptions options = <span class="hljs-keyword">new</span> MicrometerMetricsOptions()
  .setPrometheusOptions(<span class="hljs-keyword">new</span> VertxPrometheusOptions()
    .setStartEmbeddedServer(<span class="hljs-keyword">true</span>)
    .setEmbeddedServerOptions(<span class="hljs-keyword">new</span> HttpServerOptions().setPort(<span class="hljs-number">8081</span>))
    .setEnabled(<span class="hljs-keyword">true</span>))
  .setEnabled(<span class="hljs-keyword">true</span>);
Vertx vertx = Vertx.vertx(<span class="hljs-keyword">new</span> VertxOptions().setMetricsOptions(options));
<span class="hljs-comment">// Then deploy verticles with this vertx instance</span>
</code></pre><ul><li>Or Prometheus with the <code>/metrics</code> end­point bound to an ex­ist­ing HTTP server:</li></ul><pre><code class="hljs language-java"><span class="hljs-comment">// Deploy without embedded server: we need to &quot;manually&quot; expose the prometheus metrics</span>
MicrometerMetricsOptions options = <span class="hljs-keyword">new</span> MicrometerMetricsOptions()
  .setPrometheusOptions(<span class="hljs-keyword">new</span> VertxPrometheusOptions().setEnabled(<span class="hljs-keyword">true</span>))
  .setEnabled(<span class="hljs-keyword">true</span>);
Vertx vertx = Vertx.vertx(<span class="hljs-keyword">new</span> VertxOptions().setMetricsOptions(options));

Router router = Router.router(vertx);
PrometheusMeterRegistry registry = (PrometheusMeterRegistry) BackendRegistries.getDefaultNow();
<span class="hljs-comment">// Setup a route for metrics</span>
router.route(<span class="hljs-string">&quot;/metrics&quot;</span>).handler(ctx -&gt; {
  String response = registry.scrape();
  ctx.response().end(response);
});
vertx.createHttpServer().requestHandler(router::accept).listen(<span class="hljs-number">8080</span>);
</code></pre><ul><li>JMX ex­am­ple:</li></ul><pre><code class="hljs language-java"><span class="hljs-comment">// Default JMX options will publish MBeans under domain &quot;metrics&quot;</span>
MicrometerMetricsOptions options = <span class="hljs-keyword">new</span> MicrometerMetricsOptions()
  .setJmxMetricsOptions(<span class="hljs-keyword">new</span> VertxJmxMetricsOptions().setEnabled(<span class="hljs-keyword">true</span>))
  .setEnabled(<span class="hljs-keyword">true</span>);
Vertx vertx = Vertx.vertx(<span class="hljs-keyword">new</span> VertxOptions().setMetricsOptions(options));
<span class="hljs-comment">// Then deploy verticles with this vertx instance</span>
</code></pre><h3 id="setup-the-backend-server"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#setup-the-backend-server"></a>Setup the backend server</h3><ul><li><a href="https://www.influxdata.com/">In­fluxDB</a>, by de­fault, is ex­pected to run on <code>localhost:8086</code> with­out au­then­ti­ca­tion, data­base “de­fault”. It is con­fig­urable in <code>VertxInfluxDbOptions</code>.
If you don’t have a run­ning in­stance of In­fluxDB, the short­est way to start is cer­tainly with docker, just run:</li></ul><pre><code class="hljs language-bash">docker run -p 8086:8086 influxdb
</code></pre><ul><li><a href="https://prometheus.io/docs/prometheus/latest/getting_started/">Prometheus</a> needs some con­fig­u­ra­tion since it pulls met­rics from the sources. Once it is in­stalled, con­fig­ure the scrape end­points in <code>prometheus.yml</code>:</li></ul><pre><code class="hljs language-yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">&#x27;vertx-8081&#x27;</span>
  <span class="hljs-attr">static_configs:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">&#x27;localhost:8081&#x27;</span>]
</code></pre><p>or, when using <code>/metrics</code> end­point bound to an ex­ist­ing HTTP server:</p><pre><code class="hljs language-yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">&#x27;vertx-8080&#x27;</span>
  <span class="hljs-attr">static_configs:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">&#x27;localhost:8080&#x27;</span>]
</code></pre><ul><li>For JMX there is noth­ing spe­cial to con­fig­ure.</li></ul><h3 id="collecting-vertx-metrics"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#collecting-vertx-metrics"></a>Collecting Vert.x metrics</h3><p>From now on, all Vert.x met­rics will be col­lected and sent to the con­fig­ured back­end. In our Vert.x ex­am­ple, we setup an HTTP server met­rics:</p><pre><code class="hljs language-java">Router router = Router.router(vertx);
router.get(<span class="hljs-string">&quot;/&quot;</span>).handler(ctx -&gt; {
  ctx.response().end(<span class="hljs-string">&quot;Hello Micrometer from HTTP!&quot;</span>);
});
vertx.createHttpServer().requestHandler(router::accept).listen(<span class="hljs-number">8080</span>);
</code></pre><p> And some event bus ping-​pong:</p><pre><code class="hljs language-java"><span class="hljs-comment">// Producer side</span>
vertx.setPeriodic(<span class="hljs-number">1000</span>, x -&gt; {
  vertx.eventBus().send(<span class="hljs-string">&quot;greeting&quot;</span>, <span class="hljs-string">&quot;Hello Micrometer from event bus!&quot;</span>);
});
</code></pre><pre><code class="hljs language-java"><span class="hljs-comment">// Consumer side</span>
vertx.eventBus().&lt;String&gt;consumer(<span class="hljs-string">&quot;greeting&quot;</span>, message -&gt; {
  String greeting = message.body();
  System.out.println(<span class="hljs-string">&quot;Received: &quot;</span> + greeting);
  message.reply(<span class="hljs-string">&quot;Hello back!&quot;</span>);
});
</code></pre><p>To trig­ger some ac­tiv­ity on the HTTP server, we can write a small bash script:</p><pre><code class="hljs language-bash"><span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>
<span class="hljs-keyword">do</span> curl http://localhost:8080/
    sleep .8
<span class="hljs-keyword">done</span>
</code></pre><h3 id="viewing-the-results"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#viewing-the-results"></a>Viewing the results</h3><p><a href="https://grafana.com/">Grafana</a> can be used to dis­play the In­fluxDB and Prometheus met­rics. The <code>vertx-examples</code> repos­i­tory con­tains two dash­boards for that: <a href="https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-InfluxDB.json">for In­fluxDB</a> and <a href="https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-Prometheus.json">for Prometheus</a>.</p><h5 id="http-server-metrics"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#http-server-metrics"></a>HTTP server metrics</h5><p><img src="https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/http-server-metrics.png" alt="HTTP server metrics"/></p><h5 id="event-bus-metrics"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#event-bus-metrics"></a>Event bus metrics</h5><p><img src="https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/eventbus-metrics.png" alt="Event bus metrics"/></p><h2 id="going-further"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#going-further"></a>Going further</h2><p>We’ve seen the basic setup. There is a good bunch of op­tions avail­able, de­tailed <a href="/docs/vertx-micrometer-metrics/java/">in the doc­u­men­ta­tion</a>: how to dis­able some met­rics do­mains, how to fil­ter or re­arrange la­bels, how to ex­port met­rics snap­shots to Json ob­jects, how to add JVM or proces­sor in­stru­men­ta­tion, etc.</p><p>Be­fore we fin­ish, there is one im­por­tant point that we can cover here: defin­ing cus­tom met­rics.
Be­cause the mod­ule gives you ac­cess to its Mi­crom­e­ter reg­istry, you can add your cus­tom met­rics there.</p><p>Get­ting the de­fault reg­istry is straight­for­ward:</p><pre><code class="hljs language-java">MeterRegistry registry = BackendRegistries.getDefaultNow();
</code></pre><p>Then you have plain ac­cess to the <a href="https://micrometer.io/docs/concepts">Mi­crom­e­ter API</a>.</p><p>For in­stance, here is how you can track the ex­e­cu­tion time of a piece of code that is reg­u­larly called:</p><pre><code class="hljs language-java">MeterRegistry registry = BackendRegistries.getDefaultNow();
Timer timer = Timer
  .builder(<span class="hljs-string">&quot;my.timer&quot;</span>)
  .description(<span class="hljs-string">&quot;Time tracker for my extremely sophisticated algorithm&quot;</span>)
  .register(registry);

vertx.setPeriodic(<span class="hljs-number">1000</span>, l -&gt; {
  timer.record(() -&gt; myExtremelySophisticatedAlgorithm());
});
</code></pre><p>Since it is using the same reg­istry, there is no extra back­end con­fig­u­ra­tion to do.</p><h2 id="whats-next"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#whats-next"></a>What’s next?</h2><p>The <code>vertx-micrometer-metrics</code> mod­ule will con­tinue to be im­proved, with al­ready two planned en­hance­ments:</p><ul><li><a href="https://github.com/vert-x3/vertx-micrometer-metrics/issues/15">Adding more back­ends</a>, like Graphite.</li><li><a href="https://github.com/vert-x3/vertx-micrometer-metrics/issues/16">Allow to con­fig­ure sev­eral back­ends</a>, and not only one at the same time.</li></ul><p>Would you miss any fea­ture, please <a href="https://github.com/vert-x3/vertx-micrometer-metrics/issues">ask on GitHub</a>. Con­tri­bu­tions and bug fixes are also wel­come!</p><p>Now is time to enter the Met­rics.</p></span></div><div class="blog-post-sidebar"><div class="blog-post-author"><img class="blog-post-author-avatar" src="https://github.com/jotak.png?size=160"/><div class="blog-post-author-name">by <a href="https://github.com/jotak" target="_blank" rel="noopener noreferrer">Joel Takvorian</a></div></div><div class="blog-post-sidebar-date">Posted on <!-- -->9 April 2018</div>in <a class="blog-post-sidebar-category" href="/blog/category/guides/">guides</a><div class="blog-post-sidebar-reading-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <!-- -->8 min read</div><div class="blog-post-sidebar-share-icons"><a href="https://twitter.com/intent/tweet?text=Eclipse%20Vert.x%20metrics%20now%20with%20Micrometer.io&amp;url=https%3A%2F%2Fokou19900722.github.com%2Fvertx-web-site.github.io%2Fblog%2Feclipse-vert-x-metrics-now-with-micrometer-io&amp;via=vertx_project" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fokou19900722.github.com%2Fvertx-web-site.github.io%2Fblog%2Feclipse-vert-x-metrics-now-with-micrometer-io" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fokou19900722.github.com%2Fvertx-web-site.github.io%2Fblog%2Feclipse-vert-x-metrics-now-with-micrometer-io" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Facebook</title><path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg></a></div></div></div><div class="blog-post-next-prev"><div class="blog-post-next-prev-entry"><h5>Next post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">13 April 2018</span>​<a class="blog-entry-category" href="/blog/category/news/">news</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/new-community-channels/">New community channels</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/tsegismont.png?size=50"/><a href="https://github.com/tsegismont" target="_blank" rel="noopener noreferrer">Thomas Segismont</a></li></ul></span><p class="blog-entry-summary">In order to better support the community, we (the core team and module maintainers) now also provide help on Stack Overflow and Gitter.</p><span class="read-more-link"><a href="/blog/new-community-channels/">Read more</a></span></div></div><div class="blog-post-next-prev-entry"><h5>Previous post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">13 March 2018</span>​<a class="blog-entry-category" href="/blog/category/news/">news</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/google-summer-of-code-2018/">Google Summer of Code 2018</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/tsegismont.png?size=50"/><a href="https://github.com/tsegismont" target="_blank" rel="noopener noreferrer">Thomas Segismont</a></li></ul></span><p class="blog-entry-summary">It&#x27;s this time of year again! Google Summer of Code 2018 submission period has just started!</p><span class="read-more-link"><a href="/blog/google-summer-of-code-2018/">Read more</a></span></div></div></div><div class="blog-post-related"><h5>Related posts</h5><div class="blog-post-related-posts"><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">14 November 2017</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/eclipse-vert-x-meets-graphql/">Eclipse Vert.x meets GraphQL</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/jotschi.png?size=50"/><a href="https://github.com/jotschi" target="_blank" rel="noopener noreferrer">Johannes Schüth</a></li></ul></span><p class="blog-entry-summary">In this blog post, we will look at an example application written in Vert.x that uses the new GraphQL API of Gentics Mesh.</p><span class="read-more-link"><a href="/blog/eclipse-vert-x-meets-graphql/">Read more</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">30 November 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/combine-vert-x-and-mongo-to-build-a-giant/">Combine vert.x and mongo to build a giant</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">This blog post is part of the introduction to Vert.x series. We are now going to replace this JDBC client by the vertx-mongo-client, and thus connect to a Mongo database.</p><span class="read-more-link"><a href="/blog/combine-vert-x-and-mongo-to-build-a-giant/">Read more</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">7 December 2016</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/getting-started-with-new-fabric8-vert-x-maven-plugin/">Getting started with new fabric8 Vert.x Maven Plugin</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/kameshsampath.png?size=50"/><a href="https://github.com/kameshsampath" target="_blank" rel="noopener noreferrer">Kamesh Sampath</a></li></ul></span><p class="blog-entry-summary">The all new fabric8 Vert.x Maven Plugin allows you to setup, package, run, start, stop and redeploy easily with a very little configuration resulting in a less verbose pom.xml.</p><span class="read-more-link"><a href="/blog/getting-started-with-new-fabric8-vert-x-maven-plugin/">Read more</a></span></div></div></div></div></div></div><footer><div class="container"><div class="footer-nav-section"><div class="footer-nav-list footer-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="footer-nav-list"><h5>Eclipse Vert.x</h5><ul class=""><li><a class="navbar-menu-item" href="/docs/">Docs</a></li><li><a href="/download/">Download</a></li><li><a href="/faq/">FAQ</a></li><li><a href="/blog/">Blog</a></li><li><a href="/community/">Community</a></li><li><a href="/channels/">Channels</a></li></ul></div><div class="footer-nav-list"><h5>Eclipse</h5><ul class=""><li><a href="https://www.eclipse.org/">Eclipse Foundation</a></li><li><a href="https://www.eclipse.org/legal/privacy.php">Privacy Policy</a></li><li><a href="https://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li><li><a href="https://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li><li><a href="https://www.eclipse.org/legal/">Legal Resources</a></li></ul></div></div><div class="footer-copyright"><div class="footer-copyright-remarks">© <!-- -->2020<!-- --> Eclipse Vert.x<br/>Eclipse Vert.x is open source and dual-licensed under the <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer">Eclipse Public License 2.0</a> and the <a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache License 2.0</a>. <br class="footer-copyright-break"/>Website design by <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer">Michel Krämer</a>.</div><div class="footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyODEuMyA5MS4xIiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGU+LnN0MHtmaWxsOiNmNzk0MjJ9LnN0MXtmaWxsOiMzZDNjM2J9PC9zdHlsZT48ZyBpZD0iTGF5ZXJfMV8xXyI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTI2NS43IDg0TDI1NyA3M2gtMi43djE3LjdoMy4zdi0xMmw5LjMgMTJoMi4xVjczaC0zLjN2MTF6bS0zMi40LTguM2M0LjIgMCA1LjggMy4zIDUuOCA2LjNzLTEuNiA2LTUuOCA2LTUuNy0zLjEtNS44LTYgMS43LTYuMyA1LjgtNi4zem0wLTNjLTYuMSAwLTkuMSA0LjctOS4xIDkuMyAwIDQuNyAyLjkgOS4xIDkuMSA5LjFzOS00LjYgOS4xLTkuMi0zLTkuMi05LjEtOS4yem0tMjEuMiAxOFY3M2gtMy4zdjE3LjdoMy4zem0tMjMuNiAwaDMuM1Y3Nmg1LjZ2LTNoLTE0LjZ2M2g1LjZsLjEgMTQuN3ptLTE4LjktNi41SDE2M2wzLjMtNy42IDMuMyA3LjZ6bTIuOCA2LjVoMy42TDE2OC4yIDczaC0zLjZsLTggMTcuN2gzLjZsMS41LTMuM2g5LjNsMS40IDMuM3ptLTM4LTE0LjZoMy42YzMuOSAwIDUuNSAyLjggNS41IDUuNS4xIDIuOC0xLjUgNS44LTUuNSA1LjhoLTMuNlY3Ni4xem0zLjctMy4xaC02Ljl2MTcuN2g2LjljNi4yIDAgOC45LTQuNSA4LjktOXMtMi44LTguNy04LjktOC43em0tMjIuNCAxMUwxMDcgNzNoLTIuN3YxNy43aDMuM3YtMTJsOS4zIDEyaDIuMVY3M2gtMy4zdjExek04OC4yIDczdjEwLjJjMCAzLTEuNiA0LjktNC4zIDQuOXMtNC42LTEuNy00LjYtNC45VjczSDc2djEwLjFjMCA1LjMgMy42IDcuOSA3LjkgNy45IDQuNCAwIDcuNy0yLjcgNy43LTcuOVY3M2gtMy40em0tMzMgMi43YzQuMiAwIDUuOCAzLjMgNS44IDYuM3MtMS42IDYtNS44IDYtNS43LTMuMS01LjgtNiAxLjctNi4zIDUuOC02LjN6bTAtM2MtNi4xIDAtOS4xIDQuNy05LjEgOS4zczIuOSA5LjEgOS4xIDkuMSA5LTQuNiA5LjEtOS4yLTMtOS4yLTkuMS05LjJ6bS0yOS43IDE4di02LjVoOC45di0zLjFoLTguOXYtNC44aDkuNFY3M0gyMi4ydjE3LjZoMy4zeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjkuNCA1NC40aC0yMi4ydi04LjloMjEuNHYtNi45aC0yMS40di05LjFoMjIuMnYtNy4yaC0yOS42djM5LjVoMjkuNnYtNy40em0tNDAtMjUuNmMtMy02LjEtOS40LTcuOC0xNS41LTcuOC03LjMgMC0xNS4zIDMuNC0xNS4zIDExLjUgMCA4LjkgNy40IDExIDE1LjUgMTIgNS4yLjYgOS4xIDIuMSA5LjEgNS44IDAgNC4zLTQuNCA1LjktOS4xIDUuOXMtOS40LTEuOS0xMS4xLTYuM2wtNi4yIDMuMmMyLjkgNy4yIDkuMSA5LjcgMTcuMiA5LjcgOC44IDAgMTYuNi0zLjggMTYuNi0xMi42IDAtOS40LTcuNy0xMS42LTE1LjktMTIuNi00LjctLjYtOC44LTEuNS04LjgtNSAwLTIuOSAyLjYtNS4yIDguMi01LjIgNC4zIDAgOCAyLjIgOS40IDQuNGw1LjktM3pNMTc2IDIyLjJjLTYuMi0uMS0xMi40IDAtMTguNiAwdjM5LjVoNy40VjUwLjFIMTc2YzE5LjQgMCAxOS40LTI3LjkgMC0yNy45em0tMTEuMSA3LjFIMTc2YzkuNSAwIDkuNSAxNCAwIDE0aC0xMS4ybC4xLTE0em0tMTggMzIuNVYyMi4yaC03LjR2MzkuNWw3LjQuMXptLTQ0LTM5LjZ2MzkuNWgyNy43di02LjloLTIwLjNWMjIuMmgtNy40ek05MC43IDUxLjdjLTIuNyAyLjUtNi4yIDQtOS45IDQtOS44IDAtMTMuNS02LjgtMTMuNi0xMy40czQuMS0xMy43IDEzLjYtMTMuN2MzLjUtLjEgNyAxLjMgOS41IDMuN2w1LTQuOGMtMy44LTMuOS05LjEtNi0xNC41LTYtMTQuMyAwLTIxIDEwLjUtMjAuOSAyMC44czYuMyAyMC4zIDIwLjkgMjAuM2M1LjYuMSAxMS0yIDE1LTUuOWwtNS4xLTV6bS0zOSAyLjdIMjkuNXYtOC45aDIxLjR2LTYuOUgyOS41di05LjFoMjIuMnYtNy4ySDIyLjJ2MzkuNWgyOS42bC0uMS03LjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuOCAxOC4yQzE4LjggNC4xIDM2LjktLjggNTIuMSA2bC0xLS43QzM1LjctNC42IDE1LjItLjEgNS4zIDE1LjNzLTUuNCAzNS45IDEwIDQ1LjhsMS4xLjZDMy44IDUwLjguOCAzMi4zIDkuOCAxOC4yeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzIuMiAyNi4xYzAtMi41IDIuMS00LjYgNC42LTQuNiAyLjUgMCA0LjYgMi4xIDQuNiA0LjYgMCAyLjUtMi4xIDQuNi00LjYgNC42LTIuNiAwLTQuNi0yLjEtNC42LTQuNnptOC42IDBjMC0yLjItMS44LTQuMS00LTQuMXMtNC4xIDEuOC00LjEgNC4xYzAgMi4yIDEuNyA0IDMuOSA0LjFoLjFjMi4zIDAgNC4xLTEuOCA0LjEtNC4xem0tNi0yLjVoMi4zYzEuMSAwIDEuOS41IDEuOSAxLjYgMCAuNy0uNCAxLjMtMS4xIDEuNWwxLjIgMS43aC0xLjRsLTEtMS41aC0uN3YxLjVoLTEuMWwtLjEtNC44em0yLjIgMi4zYy41IDAgLjgtLjMuOC0uN3MtLjMtLjctLjgtLjdoLTF2MS4zbDEgLjF6Ii8+PC9nPjwvc3ZnPg==" alt="Eclipse foundation Logo"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"categories":["releases","guides","news"],"post":{"meta":{"title":"Eclipse Vert.x metrics now with Micrometer.io","category":"guides","authors":[{"name":"Joel Takvorian","github_id":"jotak"}],"summary":"The new vertx-micrometer-metrics module provides support for collecting metrics with Micrometer.io and storing them in backends such as Graphite or InfluxDB."},"date":"2018-04-09","slug":"eclipse-vert-x-metrics-now-with-micrometer-io","readingTime":{"text":"8 min read","minutes":7.365,"time":441900.00000000006,"words":1473},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Vert.x has al\\xADready been pro\\xADvid\\xADing met\\xADrics for some time, through the \", mdx(Link, {\n    href: \"/docs/vertx-dropwizard-metrics/java/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"vertx-\\u200Bdropwizard-metrics\")), \" and \", mdx(Link, {\n    href: \"/docs/vertx-hawkular-metrics/java/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"vertx-\\u200Bhawkular-metrics\")), \" mod\\xADules. Both of them im\\xADple\\xADment a ser\\xADvice provider in\\xADter\\xADface (SPI) to col\\xADlect the Vert.x met\\xADrics and make them avail\\xADable to their re\\xADspec\\xADtive back\\xADends.\"), mdx(\"p\", null, \"A new mod\\xADule, \", mdx(Link, {\n    href: \"/docs/vertx-micrometer-metrics/java/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"vertx-\\u200Bmicrometer-metrics\")), \", is now added to the fam\\xADily. It im\\xADple\\xADments the same SPI, which means that it is able to pro\\xADvide the same met\\xADrics.\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://micrometer.io/\"\n  }), mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Mi\\xADcrom\\xADe\\xADter.io\")), \" is a pretty new met\\xADrics li\\xADbrary, quite com\\xADpa\\xADra\\xADble to \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"drop\\xADwiz\\xADard met\\xADrics\"), \" in that it col\\xADlects met\\xADrics in a local, in-\\u200Bmemory reg\\xADistry and is able to store them in var\\xADi\\xADous back\\xADends such as \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Graphite\"), \" or \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"In\\xADfluxDB\"), \". It has sev\\xADeral ad\\xADvan\\xADtages as we will see below.\"), mdx(\"h2\", {\n    \"id\": \"tell-me-more-about-micrometer\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#tell-me-more-about-micrometer\"\n  })), \"Tell me more about Micrometer\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://micrometer.io/\"\n  }), mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Mi\\xADcrom\\xADe\\xADter.io\")), \" de\\xADscribes it\\xADself as a a vendor-\\u200Bneutral ap\\xADpli\\xADca\\xADtion met\\xADrics fa\\xADcade.\\nIt pro\\xADvides a well de\\xADsigned API, in Java, to de\\xADfine \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"gauges\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"coun\\xADters\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"timers\"), \" and \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"dis\\xADtri\\xADb\\xADu\\xADtion sum\\xADmaries\"), \".\"), mdx(\"p\", null, \"Among the avail\\xADable back\\xADends, Mi\\xADcrom\\xADe\\xADter na\\xADtively sup\\xADports \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Graphite\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"In\\xADfluxDB\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"JMX\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Prometheus\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://micrometer.io/docs\"\n  }), \"sev\\xADeral oth\\xADers\"), \". Prometheus is very pop\\xADu\\xADlar in the Ku\\xADber\\xADnetes and mi\\xADcroser\\xADvices ecosys\\xADtems, so its sup\\xADport by Mi\\xADcrom\\xADe\\xADter was a strong mo\\xADti\\xADva\\xADtion for im\\xADple\\xADment\\xADing it in Vert.x.\"), mdx(\"p\", null, \"For the the mo\\xADment, our im\\xADple\\xADmen\\xADta\\xADtion in Vert.x sup\\xADports \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Prometheus\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"In\\xADfluxDB\"), \" and \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"JMX\"), \". More should quickly come in the near fu\\xADture.\"), mdx(\"h3\", {\n    \"id\": \"dimensionality\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#dimensionality\"\n  })), \"Dimensionality\"), mdx(\"p\", null, \"An\\xADother in\\xADter\\xADest\\xADing as\\xADpect in Mi\\xADcrom\\xADe\\xADter is that it han\\xADdles met\\xADrics \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"di\\xADmen\\xADsion\\xADal\\xADity\"), \": met\\xADrics can be as\\xADso\\xADci\\xADated with a set of key/value pairs (some\\xADtimes ref\\xADered as \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"tags\"), \", some\\xADtimes as \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"la\\xADbels\"), \"). Every value brings a new di\\xADmen\\xADsion to the met\\xADric, so that in Prometheus or any other back\\xADend that sup\\xADports di\\xADmen\\xADsion\\xADal\\xADity, we can query for dat\\xADa\\xADpoints of one or sev\\xADeral di\\xADmen\\xADsions, or query for dat\\xADa\\xADpoints ag\\xADgre\\xADgated over sev\\xADeral di\\xADmen\\xADsions.\"), mdx(\"p\", null, \"  \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Ex\\xADam\\xADple: our met\\xADric \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"vertx_http_server_connections\"), \" ac\\xADcepts la\\xADbels \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"local\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"em\"\n  }, \"remote\"), \", that are used to store ad\\xADdresses on HTTP con\\xADnec\\xADtions\")), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"Prometheus is used in the fol\\xADlow\\xADing ex\\xADam\\xADples, but equiv\\xADa\\xADlent queries can be per\\xADformed with \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"In\\xADfluxDB\"), \".\")), mdx(\"p\", null, \"In Prometheus, the query \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_http_server_connections\"), \" will re\\xADturn as many time\\xADseries as there are com\\xADbi\\xADna\\xADtions of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"local\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"remote\"), \" val\\xADues. Ex\\xADam\\xADple:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-basic\"\n  }), \"vertx_http_server_connections{local=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"0.0.0.0:8080\\\"\"), \",\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"remote=\\\"1.1.1.1\\\"}\"), \"\\nvertx_http_server_connections{local=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"0.0.0.0:8080\\\"\"), \",\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"remote=\\\"2.2.2.2\\\"}\"), \"\\nvertx_http_server_connections{local=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"0.0.0.0:8080\\\"\"), \",\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"remote=\\\"3.3.3.3\\\"}\"), \"\\n\")), mdx(\"p\", null, \"To query on a sin\\xADgle di\\xADmen\\xADsion, we must pro\\xADvide the la\\xADbels:\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_http_server_connections{local=\\\"0.0.0.0:8080\\\",remote=\\\"1.1.1.1\\\"}\"), \". It will re\\xADturn a sin\\xADgle time\\xADseries.\"), mdx(\"p\", null, \"To get an ag\\xADgre\\xADgate, Prometheus (PromQL) pro\\xADvides sev\\xADeral \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators\"\n  }), \"ag\\xADgre\\xADga\\xADtion op\\xADer\\xADa\\xADtors\"), \":\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sum(vertx_http_server_connections)\"), \" will re\\xADturn the sum across all di\\xADmen\\xADsions.\"), mdx(\"h2\", {\n    \"id\": \"so-what-are-the-vertx-metrics\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#so-what-are-the-vertx-metrics\"\n  })), \"So what are the Vert.x metrics?\"), mdx(\"p\", null, \"Peo\\xADple al\\xADready fa\\xADmil\\xADiar with the ex\\xADist\\xADing met\\xADrics mod\\xADules (\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"drop\\xADwiz\\xADard\"), \" or \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"hawku\\xADlar\"), \") will not be too dis\\xADori\\xADented. They are roughly the same. The main dif\\xADfer\\xADence is where pre\\xADvi\\xADously, some met\\xADric names could have a vari\\xADable part within - such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.eventbus.handlers.myaddress\"), \" - here we take ad\\xADvan\\xADtage of di\\xADmen\\xADsion\\xADal\\xADity and we will have \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_eventbus_handlers{address=\\\"myaddress\\\"}\"), \".\"), mdx(\"p\", null, \"Some other met\\xADrics are no longer use\\xADful, for in\\xADstance the drop\\xADwiz\\xADard\\u2019s \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.eventbus.messages.pending\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.eventbus.messages.pending-local\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.eventbus.messages.pending-remote\"), \" are now just \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_eventbus_pending{side=local}\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx_eventbus_pending{side=remote}\"), \" in mi\\xADcrom\\xADe\\xADter. The sum of them can eas\\xADily be com\\xADputed at query time.\"), mdx(\"p\", null, \"The met\\xADrics pro\\xADvided by Vert.x are dis\\xADpatched into eight big fam\\xADi\\xADlies:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Net client\"), \": dis\\xADtri\\xADb\\xADu\\xADtion sum\\xADmaries of bytes sent and re\\xADceived, num\\xADber of con\\xADnec\\xADtions, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Net server\"), \": dis\\xADtri\\xADb\\xADu\\xADtion sum\\xADmaries of bytes sent and re\\xADceived, num\\xADber of con\\xADnec\\xADtions, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"HTTP client\"), \": counter of re\\xADquests, re\\xADsponse times, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"HTTP server\"), \": counter of re\\xADquests, pro\\xADcess\\xADing times, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Event bus\"), \": counter of han\\xADdlers, mes\\xADsages sent and re\\xADceived, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Pool\"), \": for worker pools and some data\\xADsource pools, queue size and wait\\xADing time, pro\\xADcess\\xADing time, etc.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Ver\\xADti\\xADcles\"), \": num\\xADber of ver\\xADti\\xADcles de\\xADployed.\")), mdx(\"p\", null, \"The full list of col\\xADlected met\\xADrics is \", mdx(Link, {\n    href: \"/docs/vertx-micrometer-metrics/java/#_vert_x_core_tools_metrics\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"avail\\xADable here\")), \".\"), mdx(\"h2\", {\n    \"id\": \"getting-started\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#getting-started\"\n  })), \"Getting started\"), mdx(\"p\", null, \"This sec\\xADtion will guide you through a quick setup to run a Vert.x ap\\xADpli\\xADca\\xADtion with Mi\\xADcrom\\xADe\\xADter. The code ex\\xADam\\xADples used here are taken from the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"micrometer-metrics-example\"), \" in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-examples\"), \" repos\\xADi\\xADtory, in Java, using \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"maven\"), \". But the same could be done with other Vert.x sup\\xADported lan\\xADguages, as well as \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"gra\\xADdle\"), \" in\\xADstead of \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"maven\"), \".\"), mdx(\"h3\", {\n    \"id\": \"maven-configuration\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#maven-configuration\"\n  })), \"Maven configuration\"), mdx(\"p\", null, \"The con\\xADfig\\xADu\\xADra\\xADtion and the maven im\\xADports will vary ac\\xADcord\\xADing to the back\\xADend stor\\xADage that will be used. For maven, the com\\xADmon part is al\\xADways:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"io.vertx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"vertx-micrometer-metrics\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"3.5.1\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Then, to re\\xADport to In\\xADfluxDB:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"io.micrometer\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"micrometer-registry-influx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"1.0.0\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Or Prometheus:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"io.micrometer\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"micrometer-registry-prometheus\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"1.0.0\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"io.vertx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"vertx-web\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"3.5.1\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n\")), mdx(\"p\", null, \"Re\\xADmark that, since Prometheus pulls met\\xADrics from their source, they must be ex\\xADposed on an HTTP end\\xADpoint. That\\u2019s why \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-web\"), \" is im\\xADported here. It is not \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"ab\\xADsolutely\"), \" nec\\xADes\\xADsary (it\\u2019s pos\\xADsi\\xADble to get the met\\xADrics reg\\xADistry con\\xADtent and ex\\xADpose it in any other way) but it\\u2019s prob\\xADa\\xADbly the eas\\xADi\\xADest way to do.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Or JMX:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"io.micrometer\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"micrometer-registry-jmx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"1.0.0\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n\")), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"At the mo\\xADment, it is not pos\\xADsi\\xADble to re\\xADport met\\xADrics to sev\\xADeral back\\xADends at the same time. \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16\"\n  }), \"It might be soon im\\xADple\\xADmented\"), \".\")), mdx(\"h3\", {\n    \"id\": \"setting-up-vertx-options\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#setting-up-vertx-options\"\n  })), \"Setting up Vert.x options\"), mdx(\"p\", null, \"A \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MicrometerMetricsOptions\"), \" ob\\xADject must be cre\\xADated and passed to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"VertxOptions\"), \", with one back\\xADend con\\xADfig\\xADured (though hav\\xADing no back\\xADend is pos\\xADsi\\xADble: you would get met\\xADrics sent to a de\\xADfault Mi\\xADcrom\\xADe\\xADter reg\\xADistry, but with\\xADout any per\\xADsis\\xADtent stor\\xADage).\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In\\xADfluxDB ex\\xADam\\xADple:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Default InfluxDB options will push metrics to localhost:8086, db \\\"default\\\"\"), \"\\nMicrometerMetricsOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" MicrometerMetricsOptions()\\n  .setInfluxDbOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxInfluxDbOptions().setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \"))\\n  .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \");\\nVertx vertx = Vertx.vertx(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxOptions().setMetricsOptions(options));\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Then deploy verticles with this vertx instance\"), \"\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Prometheus ex\\xADam\\xADple:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Deploy with embedded server: prometheus metrics will be automatically exposed,\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// independently from any other HTTP server defined\"), \"\\nMicrometerMetricsOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" MicrometerMetricsOptions()\\n  .setPrometheusOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxPrometheusOptions()\\n    .setStartEmbeddedServer(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \")\\n    .setEmbeddedServerOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" HttpServerOptions().setPort(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8081\"), \"))\\n    .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \"))\\n  .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \");\\nVertx vertx = Vertx.vertx(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxOptions().setMetricsOptions(options));\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Then deploy verticles with this vertx instance\"), \"\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Or Prometheus with the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"/metrics\"), \" end\\xADpoint bound to an ex\\xADist\\xADing HTTP server:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Deploy without embedded server: we need to \\\"manually\\\" expose the prometheus metrics\"), \"\\nMicrometerMetricsOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" MicrometerMetricsOptions()\\n  .setPrometheusOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxPrometheusOptions().setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \"))\\n  .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \");\\nVertx vertx = Vertx.vertx(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxOptions().setMetricsOptions(options));\\n\\nRouter router = Router.router(vertx);\\nPrometheusMeterRegistry registry = (PrometheusMeterRegistry) BackendRegistries.getDefaultNow();\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Setup a route for metrics\"), \"\\nrouter.route(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"/metrics\\\"\"), \").handler(ctx -\u003e {\\n  String response = registry.scrape();\\n  ctx.response().end(response);\\n});\\nvertx.createHttpServer().requestHandler(router::accept).listen(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8080\"), \");\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"JMX ex\\xADam\\xADple:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Default JMX options will publish MBeans under domain \\\"metrics\\\"\"), \"\\nMicrometerMetricsOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" MicrometerMetricsOptions()\\n  .setJmxMetricsOptions(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxJmxMetricsOptions().setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \"))\\n  .setEnabled(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"true\"), \");\\nVertx vertx = Vertx.vertx(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" VertxOptions().setMetricsOptions(options));\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Then deploy verticles with this vertx instance\"), \"\\n\")), mdx(\"h3\", {\n    \"id\": \"setup-the-backend-server\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#setup-the-backend-server\"\n  })), \"Setup the backend server\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://www.influxdata.com/\"\n  }), \"In\\xADfluxDB\"), \", by de\\xADfault, is ex\\xADpected to run on \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"localhost:8086\"), \" with\\xADout au\\xADthen\\xADti\\xADca\\xADtion, data\\xADbase \\u201Cde\\xADfault\\u201D. It is con\\xADfig\\xADurable in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"VertxInfluxDbOptions\"), \".\\nIf you don\\u2019t have a run\\xADning in\\xADstance of In\\xADfluxDB, the short\\xADest way to start is cer\\xADtainly with docker, just run:\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"docker run -p 8086:8086 influxdb\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://prometheus.io/docs/prometheus/latest/getting_started/\"\n  }), \"Prometheus\"), \" needs some con\\xADfig\\xADu\\xADra\\xADtion since it pulls met\\xADrics from the sources. Once it is in\\xADstalled, con\\xADfig\\xADure the scrape end\\xADpoints in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"prometheus.yml\"), \":\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-yaml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"job_name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'vertx-8081'\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"static_configs:\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"targets:\"), \" [\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'localhost:8081'\"), \"]\\n\")), mdx(\"p\", null, \"or, when using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/metrics\"), \" end\\xADpoint bound to an ex\\xADist\\xADing HTTP server:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-yaml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"job_name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'vertx-8080'\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"static_configs:\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"targets:\"), \" [\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'localhost:8080'\"), \"]\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"For JMX there is noth\\xADing spe\\xADcial to con\\xADfig\\xADure.\")), mdx(\"h3\", {\n    \"id\": \"collecting-vertx-metrics\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#collecting-vertx-metrics\"\n  })), \"Collecting Vert.x metrics\"), mdx(\"p\", null, \"From now on, all Vert.x met\\xADrics will be col\\xADlected and sent to the con\\xADfig\\xADured back\\xADend. In our Vert.x ex\\xADam\\xADple, we setup an HTTP server met\\xADrics:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"Router router = Router.router(vertx);\\nrouter.get(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"/\\\"\"), \").handler(ctx -\u003e {\\n  ctx.response().end(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Hello Micrometer from HTTP!\\\"\"), \");\\n});\\nvertx.createHttpServer().requestHandler(router::accept).listen(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8080\"), \");\\n\")), mdx(\"p\", null, \" And some event bus ping-\\u200Bpong:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Producer side\"), \"\\nvertx.setPeriodic(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"1000\"), \", x -\u003e {\\n  vertx.eventBus().send(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"greeting\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Hello Micrometer from event bus!\\\"\"), \");\\n});\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Consumer side\"), \"\\nvertx.eventBus().\u003cString\u003econsumer(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"greeting\\\"\"), \", message -\u003e {\\n  String greeting = message.body();\\n  System.out.println(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Received: \\\"\"), \" + greeting);\\n  message.reply(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Hello back!\\\"\"), \");\\n});\\n\")), mdx(\"p\", null, \"To trig\\xADger some ac\\xADtiv\\xADity on the HTTP server, we can write a small bash script:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"while\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-literal\"\n  }), \"true\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"do\"), \" curl http://localhost:8080/\\n    sleep .8\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"done\"), \"\\n\")), mdx(\"h3\", {\n    \"id\": \"viewing-the-results\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#viewing-the-results\"\n  })), \"Viewing the results\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://grafana.com/\"\n  }), \"Grafana\"), \" can be used to dis\\xADplay the In\\xADfluxDB and Prometheus met\\xADrics. The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-examples\"), \" repos\\xADi\\xADtory con\\xADtains two dash\\xADboards for that: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-InfluxDB.json\"\n  }), \"for In\\xADfluxDB\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-Prometheus.json\"\n  }), \"for Prometheus\"), \".\"), mdx(\"h5\", {\n    \"id\": \"http-server-metrics\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h5\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#http-server-metrics\"\n  })), \"HTTP server metrics\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/http-server-metrics.png\",\n    \"alt\": \"HTTP server metrics\"\n  }))), mdx(\"h5\", {\n    \"id\": \"event-bus-metrics\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h5\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#event-bus-metrics\"\n  })), \"Event bus metrics\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/eventbus-metrics.png\",\n    \"alt\": \"Event bus metrics\"\n  }))), mdx(\"h2\", {\n    \"id\": \"going-further\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#going-further\"\n  })), \"Going further\"), mdx(\"p\", null, \"We\\u2019ve seen the basic setup. There is a good bunch of op\\xADtions avail\\xADable, de\\xADtailed \", mdx(Link, {\n    href: \"/docs/vertx-micrometer-metrics/java/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"in the doc\\xADu\\xADmen\\xADta\\xADtion\")), \": how to dis\\xADable some met\\xADrics do\\xADmains, how to fil\\xADter or re\\xADarrange la\\xADbels, how to ex\\xADport met\\xADrics snap\\xADshots to Json ob\\xADjects, how to add JVM or proces\\xADsor in\\xADstru\\xADmen\\xADta\\xADtion, etc.\"), mdx(\"p\", null, \"Be\\xADfore we fin\\xADish, there is one im\\xADpor\\xADtant point that we can cover here: defin\\xADing cus\\xADtom met\\xADrics.\\nBe\\xADcause the mod\\xADule gives you ac\\xADcess to its Mi\\xADcrom\\xADe\\xADter reg\\xADistry, you can add your cus\\xADtom met\\xADrics there.\"), mdx(\"p\", null, \"Get\\xADting the de\\xADfault reg\\xADistry is straight\\xADfor\\xADward:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"MeterRegistry registry = BackendRegistries.getDefaultNow();\\n\")), mdx(\"p\", null, \"Then you have plain ac\\xADcess to the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://micrometer.io/docs/concepts\"\n  }), \"Mi\\xADcrom\\xADe\\xADter API\"), \".\"), mdx(\"p\", null, \"For in\\xADstance, here is how you can track the ex\\xADe\\xADcu\\xADtion time of a piece of code that is reg\\xADu\\xADlarly called:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"MeterRegistry registry = BackendRegistries.getDefaultNow();\\nTimer timer = Timer\\n  .builder(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"my.timer\\\"\"), \")\\n  .description(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Time tracker for my extremely sophisticated algorithm\\\"\"), \")\\n  .register(registry);\\n\\nvertx.setPeriodic(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"1000\"), \", l -\u003e {\\n  timer.record(() -\u003e myExtremelySophisticatedAlgorithm());\\n});\\n\")), mdx(\"p\", null, \"Since it is using the same reg\\xADistry, there is no extra back\\xADend con\\xADfig\\xADu\\xADra\\xADtion to do.\"), mdx(\"h2\", {\n    \"id\": \"whats-next\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#whats-next\"\n  })), \"What\\u2019s next?\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-micrometer-metrics\"), \" mod\\xADule will con\\xADtinue to be im\\xADproved, with al\\xADready two planned en\\xADhance\\xADments:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-micrometer-metrics/issues/15\"\n  }), \"Adding more back\\xADends\"), \", like Graphite.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16\"\n  }), \"Allow to con\\xADfig\\xADure sev\\xADeral back\\xADends\"), \", and not only one at the same time.\")), mdx(\"p\", null, \"Would you miss any fea\\xADture, please \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-micrometer-metrics/issues\"\n  }), \"ask on GitHub\"), \". Con\\xADtri\\xADbu\\xADtions and bug fixes are also wel\\xADcome!\"), mdx(\"p\", null, \"Now is time to enter the Met\\xADrics.\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cp\u003eVert.x has al­ready been pro­vid­ing met­rics for some time, through the \u003ca href=\"/docs/vertx-dropwizard-metrics/java/\"\u003evertx-​dropwizard-metrics\u003c/a\u003e and \u003ca href=\"/docs/vertx-hawkular-metrics/java/\"\u003evertx-​hawkular-metrics\u003c/a\u003e mod­ules. Both of them im­ple­ment a ser­vice provider in­ter­face (SPI) to col­lect the Vert.x met­rics and make them avail­able to their re­spec­tive back­ends.\u003c/p\u003e\u003cp\u003eA new mod­ule, \u003ca href=\"/docs/vertx-micrometer-metrics/java/\"\u003evertx-​micrometer-metrics\u003c/a\u003e, is now added to the fam­ily. It im­ple­ments the same SPI, which means that it is able to pro­vide the same met­rics.\n\u003ca href=\"http://micrometer.io/\"\u003e\u003cem\u003eMi­crom­e­ter.io\u003c/em\u003e\u003c/a\u003e is a pretty new met­rics li­brary, quite com­pa­ra­ble to \u003cem\u003edrop­wiz­ard met­rics\u003c/em\u003e in that it col­lects met­rics in a local, in-​memory reg­istry and is able to store them in var­i­ous back­ends such as \u003cem\u003eGraphite\u003c/em\u003e or \u003cem\u003eIn­fluxDB\u003c/em\u003e. It has sev­eral ad­van­tages as we will see below.\u003c/p\u003e\u003ch2 id=\"tell-me-more-about-micrometer\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#tell-me-more-about-micrometer\"\u003e\u003c/a\u003eTell me more about Micrometer\u003c/h2\u003e\u003cp\u003e\u003ca href=\"http://micrometer.io/\"\u003e\u003cem\u003eMi­crom­e­ter.io\u003c/em\u003e\u003c/a\u003e de­scribes it­self as a a vendor-​neutral ap­pli­ca­tion met­rics fa­cade.\nIt pro­vides a well de­signed API, in Java, to de­fine \u003cem\u003egauges\u003c/em\u003e, \u003cem\u003ecoun­ters\u003c/em\u003e, \u003cem\u003etimers\u003c/em\u003e and \u003cem\u003edis­tri­b­u­tion sum­maries\u003c/em\u003e.\u003c/p\u003e\u003cp\u003eAmong the avail­able back­ends, Mi­crom­e­ter na­tively sup­ports \u003cem\u003eGraphite\u003c/em\u003e, \u003cem\u003eIn­fluxDB\u003c/em\u003e, \u003cem\u003eJMX\u003c/em\u003e, \u003cem\u003ePrometheus\u003c/em\u003e and \u003ca href=\"http://micrometer.io/docs\"\u003esev­eral oth­ers\u003c/a\u003e. Prometheus is very pop­u­lar in the Ku­ber­netes and mi­croser­vices ecosys­tems, so its sup­port by Mi­crom­e­ter was a strong mo­ti­va­tion for im­ple­ment­ing it in Vert.x.\u003c/p\u003e\u003cp\u003eFor the the mo­ment, our im­ple­men­ta­tion in Vert.x sup­ports \u003cem\u003ePrometheus\u003c/em\u003e, \u003cem\u003eIn­fluxDB\u003c/em\u003e and \u003cem\u003eJMX\u003c/em\u003e. More should quickly come in the near fu­ture.\u003c/p\u003e\u003ch3 id=\"dimensionality\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#dimensionality\"\u003e\u003c/a\u003eDimensionality\u003c/h3\u003e\u003cp\u003eAn­other in­ter­est­ing as­pect in Mi­crom­e­ter is that it han­dles met­rics \u003cem\u003edi­men­sion­al­ity\u003c/em\u003e: met­rics can be as­so­ci­ated with a set of key/value pairs (some­times ref­ered as \u003cem\u003etags\u003c/em\u003e, some­times as \u003cem\u003ela­bels\u003c/em\u003e). Every value brings a new di­men­sion to the met­ric, so that in Prometheus or any other back­end that sup­ports di­men­sion­al­ity, we can query for dat­a­points of one or sev­eral di­men­sions, or query for dat­a­points ag­gre­gated over sev­eral di­men­sions.\u003c/p\u003e\u003cp\u003e  \u003cem\u003eEx­am­ple: our met­ric \u003ccode\u003evertx_http_server_connections\u003c/code\u003e ac­cepts la­bels \u003ccode\u003elocal\u003c/code\u003e and \u003ccode\u003eremote\u003c/code\u003e, that are used to store ad­dresses on HTTP con­nec­tions\u003c/em\u003e\u003c/p\u003e\u003cdiv class=\"alert info\"\u003e\u003cp\u003ePrometheus is used in the fol­low­ing ex­am­ples, but equiv­a­lent queries can be per­formed with \u003cem\u003eIn­fluxDB\u003c/em\u003e.\u003c/p\u003e\u003c/div\u003e\u003cp\u003eIn Prometheus, the query \u003ccode\u003evertx_http_server_connections\u003c/code\u003e will re­turn as many time­series as there are com­bi­na­tions of \u003ccode\u003elocal\u003c/code\u003e and \u003ccode\u003eremote\u003c/code\u003e val­ues. Ex­am­ple:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-basic\"\u003evertx_http_server_connections{local=\u003cspan class=\"hljs-string\"\u003e\u0026quot;0.0.0.0:8080\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-comment\"\u003eremote=\u0026quot;1.1.1.1\u0026quot;}\u003c/span\u003e\nvertx_http_server_connections{local=\u003cspan class=\"hljs-string\"\u003e\u0026quot;0.0.0.0:8080\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-comment\"\u003eremote=\u0026quot;2.2.2.2\u0026quot;}\u003c/span\u003e\nvertx_http_server_connections{local=\u003cspan class=\"hljs-string\"\u003e\u0026quot;0.0.0.0:8080\u0026quot;\u003c/span\u003e,\u003cspan class=\"hljs-comment\"\u003eremote=\u0026quot;3.3.3.3\u0026quot;}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eTo query on a sin­gle di­men­sion, we must pro­vide the la­bels:\u003c/p\u003e\u003cp\u003e\u003ccode\u003evertx_http_server_connections{local=\u0026quot;0.0.0.0:8080\u0026quot;,remote=\u0026quot;1.1.1.1\u0026quot;}\u003c/code\u003e. It will re­turn a sin­gle time­series.\u003c/p\u003e\u003cp\u003eTo get an ag­gre­gate, Prometheus (PromQL) pro­vides sev­eral \u003ca href=\"https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators\"\u003eag­gre­ga­tion op­er­a­tors\u003c/a\u003e:\u003c/p\u003e\u003cp\u003e\u003ccode\u003esum(vertx_http_server_connections)\u003c/code\u003e will re­turn the sum across all di­men­sions.\u003c/p\u003e\u003ch2 id=\"so-what-are-the-vertx-metrics\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#so-what-are-the-vertx-metrics\"\u003e\u003c/a\u003eSo what are the Vert.x metrics?\u003c/h2\u003e\u003cp\u003ePeo­ple al­ready fa­mil­iar with the ex­ist­ing met­rics mod­ules (\u003cem\u003edrop­wiz­ard\u003c/em\u003e or \u003cem\u003ehawku­lar\u003c/em\u003e) will not be too dis­ori­ented. They are roughly the same. The main dif­fer­ence is where pre­vi­ously, some met­ric names could have a vari­able part within - such as \u003ccode\u003evertx.eventbus.handlers.myaddress\u003c/code\u003e - here we take ad­van­tage of di­men­sion­al­ity and we will have \u003ccode\u003evertx_eventbus_handlers{address=\u0026quot;myaddress\u0026quot;}\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eSome other met­rics are no longer use­ful, for in­stance the drop­wiz­ard’s \u003ccode\u003evertx.eventbus.messages.pending\u003c/code\u003e, \u003ccode\u003evertx.eventbus.messages.pending-local\u003c/code\u003e and \u003ccode\u003evertx.eventbus.messages.pending-remote\u003c/code\u003e are now just \u003ccode\u003evertx_eventbus_pending{side=local}\u003c/code\u003e and \u003ccode\u003evertx_eventbus_pending{side=remote}\u003c/code\u003e in mi­crom­e­ter. The sum of them can eas­ily be com­puted at query time.\u003c/p\u003e\u003cp\u003eThe met­rics pro­vided by Vert.x are dis­patched into eight big fam­i­lies:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cstrong\u003eNet client\u003c/strong\u003e: dis­tri­b­u­tion sum­maries of bytes sent and re­ceived, num­ber of con­nec­tions, etc.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eNet server\u003c/strong\u003e: dis­tri­b­u­tion sum­maries of bytes sent and re­ceived, num­ber of con­nec­tions, etc.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eHTTP client\u003c/strong\u003e: counter of re­quests, re­sponse times, etc.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eHTTP server\u003c/strong\u003e: counter of re­quests, pro­cess­ing times, etc.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eEvent bus\u003c/strong\u003e: counter of han­dlers, mes­sages sent and re­ceived, etc.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003ePool\u003c/strong\u003e: for worker pools and some data­source pools, queue size and wait­ing time, pro­cess­ing time, etc.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eVer­ti­cles\u003c/strong\u003e: num­ber of ver­ti­cles de­ployed.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe full list of col­lected met­rics is \u003ca href=\"/docs/vertx-micrometer-metrics/java/#_vert_x_core_tools_metrics\"\u003eavail­able here\u003c/a\u003e.\u003c/p\u003e\u003ch2 id=\"getting-started\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#getting-started\"\u003e\u003c/a\u003eGetting started\u003c/h2\u003e\u003cp\u003eThis sec­tion will guide you through a quick setup to run a Vert.x ap­pli­ca­tion with Mi­crom­e­ter. The code ex­am­ples used here are taken from the \u003ccode\u003emicrometer-metrics-example\u003c/code\u003e in \u003ccode\u003evertx-examples\u003c/code\u003e repos­i­tory, in Java, using \u003cem\u003emaven\u003c/em\u003e. But the same could be done with other Vert.x sup­ported lan­guages, as well as \u003cem\u003egra­dle\u003c/em\u003e in­stead of \u003cem\u003emaven\u003c/em\u003e.\u003c/p\u003e\u003ch3 id=\"maven-configuration\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#maven-configuration\"\u003e\u003c/a\u003eMaven configuration\u003c/h3\u003e\u003cp\u003eThe con­fig­u­ra­tion and the maven im­ports will vary ac­cord­ing to the back­end stor­age that will be used. For maven, the com­mon part is al­ways:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-micrometer-metrics\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e3.5.1\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003eThen, to re­port to In­fluxDB:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.micrometer\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003emicrometer-registry-influx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e1.0.0\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003eOr Prometheus:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.micrometer\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003emicrometer-registry-prometheus\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e1.0.0\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-web\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e3.5.1\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eRe­mark that, since Prometheus pulls met­rics from their source, they must be ex­posed on an HTTP end­point. That’s why \u003ccode\u003evertx-web\u003c/code\u003e is im­ported here. It is not \u003cem\u003eab­solutely\u003c/em\u003e nec­es­sary (it’s pos­si­ble to get the met­rics reg­istry con­tent and ex­pose it in any other way) but it’s prob­a­bly the eas­i­est way to do.\u003c/p\u003e\u003cul\u003e\u003cli\u003eOr JMX:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.micrometer\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003emicrometer-registry-jmx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e1.0.0\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"alert info\"\u003e\u003cp\u003eAt the mo­ment, it is not pos­si­ble to re­port met­rics to sev­eral back­ends at the same time. \u003ca href=\"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16\"\u003eIt might be soon im­ple­mented\u003c/a\u003e.\u003c/p\u003e\u003c/div\u003e\u003ch3 id=\"setting-up-vertx-options\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#setting-up-vertx-options\"\u003e\u003c/a\u003eSetting up Vert.x options\u003c/h3\u003e\u003cp\u003eA \u003ccode\u003eMicrometerMetricsOptions\u003c/code\u003e ob­ject must be cre­ated and passed to \u003ccode\u003eVertxOptions\u003c/code\u003e, with one back­end con­fig­ured (though hav­ing no back­end is pos­si­ble: you would get met­rics sent to a de­fault Mi­crom­e­ter reg­istry, but with­out any per­sis­tent stor­age).\u003c/p\u003e\u003cul\u003e\u003cli\u003eIn­fluxDB ex­am­ple:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Default InfluxDB options will push metrics to localhost:8086, db \u0026quot;default\u0026quot;\u003c/span\u003e\nMicrometerMetricsOptions options = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MicrometerMetricsOptions()\n  .setInfluxDbOptions(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e VertxInfluxDbOptions().setEnabled(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e))\n  .setEnabled(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e);\nVertx vertx = Vertx.vertx(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e VertxOptions().setMetricsOptions(options));\n\u003cspan class=\"hljs-comment\"\u003e// Then deploy verticles with this vertx instance\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003ePrometheus ex­am­ple:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Deploy with embedded server: prometheus metrics will be automatically exposed,\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// independently from any other HTTP server defined\u003c/span\u003e\nMicrometerMetricsOptions options = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MicrometerMetricsOptions()\n  .setPrometheusOptions(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e VertxPrometheusOptions()\n    .setStartEmbeddedServer(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e)\n    .setEmbeddedServerOptions(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HttpServerOptions().setPort(\u003cspan class=\"hljs-number\"\u003e8081\u003c/span\u003e))\n    .setEnabled(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e))\n  .setEnabled(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e);\nVertx vertx = Vertx.vertx(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e VertxOptions().setMetricsOptions(options));\n\u003cspan class=\"hljs-comment\"\u003e// Then deploy verticles with this vertx instance\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003eOr Prometheus with the \u003ccode\u003e/metrics\u003c/code\u003e end­point bound to an ex­ist­ing HTTP server:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Deploy without embedded server: we need to \u0026quot;manually\u0026quot; expose the prometheus metrics\u003c/span\u003e\nMicrometerMetricsOptions options = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MicrometerMetricsOptions()\n  .setPrometheusOptions(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e VertxPrometheusOptions().setEnabled(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e))\n  .setEnabled(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e);\nVertx vertx = Vertx.vertx(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e VertxOptions().setMetricsOptions(options));\n\nRouter router = Router.router(vertx);\nPrometheusMeterRegistry registry = (PrometheusMeterRegistry) BackendRegistries.getDefaultNow();\n\u003cspan class=\"hljs-comment\"\u003e// Setup a route for metrics\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/metrics\u0026quot;\u003c/span\u003e).handler(ctx -\u0026gt; {\n  String response = registry.scrape();\n  ctx.response().end(response);\n});\nvertx.createHttpServer().requestHandler(router::accept).listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003eJMX ex­am­ple:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Default JMX options will publish MBeans under domain \u0026quot;metrics\u0026quot;\u003c/span\u003e\nMicrometerMetricsOptions options = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MicrometerMetricsOptions()\n  .setJmxMetricsOptions(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e VertxJmxMetricsOptions().setEnabled(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e))\n  .setEnabled(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e);\nVertx vertx = Vertx.vertx(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e VertxOptions().setMetricsOptions(options));\n\u003cspan class=\"hljs-comment\"\u003e// Then deploy verticles with this vertx instance\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"setup-the-backend-server\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#setup-the-backend-server\"\u003e\u003c/a\u003eSetup the backend server\u003c/h3\u003e\u003cul\u003e\u003cli\u003e\u003ca href=\"https://www.influxdata.com/\"\u003eIn­fluxDB\u003c/a\u003e, by de­fault, is ex­pected to run on \u003ccode\u003elocalhost:8086\u003c/code\u003e with­out au­then­ti­ca­tion, data­base “de­fault”. It is con­fig­urable in \u003ccode\u003eVertxInfluxDbOptions\u003c/code\u003e.\nIf you don’t have a run­ning in­stance of In­fluxDB, the short­est way to start is cer­tainly with docker, just run:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocker run -p 8086:8086 influxdb\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003e\u003ca href=\"https://prometheus.io/docs/prometheus/latest/getting_started/\"\u003ePrometheus\u003c/a\u003e needs some con­fig­u­ra­tion since it pulls met­rics from the sources. Once it is in­stalled, con­fig­ure the scrape end­points in \u003ccode\u003eprometheus.yml\u003c/code\u003e:\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ejob_name:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;vertx-8081\u0026#x27;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003estatic_configs:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etargets:\u003c/span\u003e [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;localhost:8081\u0026#x27;\u003c/span\u003e]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eor, when using \u003ccode\u003e/metrics\u003c/code\u003e end­point bound to an ex­ist­ing HTTP server:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ejob_name:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;vertx-8080\u0026#x27;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003estatic_configs:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etargets:\u003c/span\u003e [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;localhost:8080\u0026#x27;\u003c/span\u003e]\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003eFor JMX there is noth­ing spe­cial to con­fig­ure.\u003c/li\u003e\u003c/ul\u003e\u003ch3 id=\"collecting-vertx-metrics\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#collecting-vertx-metrics\"\u003e\u003c/a\u003eCollecting Vert.x metrics\u003c/h3\u003e\u003cp\u003eFrom now on, all Vert.x met­rics will be col­lected and sent to the con­fig­ured back­end. In our Vert.x ex­am­ple, we setup an HTTP server met­rics:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003eRouter router = Router.router(vertx);\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e).handler(ctx -\u0026gt; {\n  ctx.response().end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello Micrometer from HTTP!\u0026quot;\u003c/span\u003e);\n});\nvertx.createHttpServer().requestHandler(router::accept).listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e And some event bus ping-​pong:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Producer side\u003c/span\u003e\nvertx.setPeriodic(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e, x -\u0026gt; {\n  vertx.eventBus().send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;greeting\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello Micrometer from event bus!\u0026quot;\u003c/span\u003e);\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Consumer side\u003c/span\u003e\nvertx.eventBus().\u0026lt;String\u0026gt;consumer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;greeting\u0026quot;\u003c/span\u003e, message -\u0026gt; {\n  String greeting = message.body();\n  System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Received: \u0026quot;\u003c/span\u003e + greeting);\n  message.reply(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello back!\u0026quot;\u003c/span\u003e);\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eTo trig­ger some ac­tiv­ity on the HTTP server, we can write a small bash script:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003edo\u003c/span\u003e curl http://localhost:8080/\n    sleep .8\n\u003cspan class=\"hljs-keyword\"\u003edone\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"viewing-the-results\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#viewing-the-results\"\u003e\u003c/a\u003eViewing the results\u003c/h3\u003e\u003cp\u003e\u003ca href=\"https://grafana.com/\"\u003eGrafana\u003c/a\u003e can be used to dis­play the In­fluxDB and Prometheus met­rics. The \u003ccode\u003evertx-examples\u003c/code\u003e repos­i­tory con­tains two dash­boards for that: \u003ca href=\"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-InfluxDB.json\"\u003efor In­fluxDB\u003c/a\u003e and \u003ca href=\"https://github.com/vert-x3/vertx-examples/blob/master/micrometer-metrics-examples/grafana/Vertx-Prometheus.json\"\u003efor Prometheus\u003c/a\u003e.\u003c/p\u003e\u003ch5 id=\"http-server-metrics\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#http-server-metrics\"\u003e\u003c/a\u003eHTTP server metrics\u003c/h5\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/http-server-metrics.png\" alt=\"HTTP server metrics\"/\u003e\u003c/p\u003e\u003ch5 id=\"event-bus-metrics\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#event-bus-metrics\"\u003e\u003c/a\u003eEvent bus metrics\u003c/h5\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/jotak/vertx-examples/micrometer-example/micrometer-metrics-examples/grafana/eventbus-metrics.png\" alt=\"Event bus metrics\"/\u003e\u003c/p\u003e\u003ch2 id=\"going-further\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#going-further\"\u003e\u003c/a\u003eGoing further\u003c/h2\u003e\u003cp\u003eWe’ve seen the basic setup. There is a good bunch of op­tions avail­able, de­tailed \u003ca href=\"/docs/vertx-micrometer-metrics/java/\"\u003ein the doc­u­men­ta­tion\u003c/a\u003e: how to dis­able some met­rics do­mains, how to fil­ter or re­arrange la­bels, how to ex­port met­rics snap­shots to Json ob­jects, how to add JVM or proces­sor in­stru­men­ta­tion, etc.\u003c/p\u003e\u003cp\u003eBe­fore we fin­ish, there is one im­por­tant point that we can cover here: defin­ing cus­tom met­rics.\nBe­cause the mod­ule gives you ac­cess to its Mi­crom­e­ter reg­istry, you can add your cus­tom met­rics there.\u003c/p\u003e\u003cp\u003eGet­ting the de­fault reg­istry is straight­for­ward:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003eMeterRegistry registry = BackendRegistries.getDefaultNow();\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThen you have plain ac­cess to the \u003ca href=\"https://micrometer.io/docs/concepts\"\u003eMi­crom­e­ter API\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eFor in­stance, here is how you can track the ex­e­cu­tion time of a piece of code that is reg­u­larly called:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003eMeterRegistry registry = BackendRegistries.getDefaultNow();\nTimer timer = Timer\n  .builder(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.timer\u0026quot;\u003c/span\u003e)\n  .description(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Time tracker for my extremely sophisticated algorithm\u0026quot;\u003c/span\u003e)\n  .register(registry);\n\nvertx.setPeriodic(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e, l -\u0026gt; {\n  timer.record(() -\u0026gt; myExtremelySophisticatedAlgorithm());\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eSince it is using the same reg­istry, there is no extra back­end con­fig­u­ra­tion to do.\u003c/p\u003e\u003ch2 id=\"whats-next\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#whats-next\"\u003e\u003c/a\u003eWhat’s next?\u003c/h2\u003e\u003cp\u003eThe \u003ccode\u003evertx-micrometer-metrics\u003c/code\u003e mod­ule will con­tinue to be im­proved, with al­ready two planned en­hance­ments:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003ca href=\"https://github.com/vert-x3/vertx-micrometer-metrics/issues/15\"\u003eAdding more back­ends\u003c/a\u003e, like Graphite.\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://github.com/vert-x3/vertx-micrometer-metrics/issues/16\"\u003eAllow to con­fig­ure sev­eral back­ends\u003c/a\u003e, and not only one at the same time.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eWould you miss any fea­ture, please \u003ca href=\"https://github.com/vert-x3/vertx-micrometer-metrics/issues\"\u003eask on GitHub\u003c/a\u003e. Con­tri­bu­tions and bug fixes are also wel­come!\u003c/p\u003e\u003cp\u003eNow is time to enter the Met­rics.\u003c/p\u003e","scope":{}}},"prevPost":{"meta":{"title":"New community channels","category":"news","authors":[{"name":"Thomas Segismont","github_id":"tsegismont"}],"summary":"In order to better support the community, we (the core team and module maintainers) now also provide help on Stack Overflow and Gitter."},"date":"2018-04-13","slug":"new-community-channels"},"nextPost":{"meta":{"title":"Google Summer of Code 2018","category":"news","authors":[{"name":"Thomas Segismont","github_id":"tsegismont"}],"summary":"It's this time of year again! Google Summer of Code 2018 submission period has just started!"},"date":"2018-03-13","slug":"google-summer-of-code-2018"},"relatedPosts":[{"meta":{"title":"Eclipse Vert.x meets GraphQL","category":"guides","authors":[{"name":"Johannes Schüth","github_id":"jotschi"}],"summary":"In this blog post, we will look at an example application written in Vert.x that uses the new GraphQL API of Gentics Mesh."},"date":"2017-11-14","slug":"eclipse-vert-x-meets-graphql"},{"meta":{"title":"Combine vert.x and mongo to build a giant","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"This blog post is part of the introduction to Vert.x series. We are now going to replace this JDBC client by the vertx-mongo-client, and thus connect to a Mongo database."},"date":"2015-11-30","slug":"combine-vert-x-and-mongo-to-build-a-giant"},{"meta":{"title":"Getting started with new fabric8 Vert.x Maven Plugin","category":"guides","authors":[{"name":"Kamesh Sampath","github_id":"kameshsampath"}],"summary":"The all new fabric8 Vert.x Maven Plugin allows you to setup, package, run, start, stop and redeploy easily with a very little configuration resulting in a less verbose pom.xml."},"date":"2016-12-07","slug":"getting-started-with-new-fabric8-vert-x-maven-plugin"}]},"__N_SSG":true},"page":"/blog/[[...slug]]","query":{"slug":["eclipse-vert-x-metrics-now-with-micrometer-io"]},"buildId":"m3klvRkyYMk4-ivtNpK7B","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-7cde6f5ea12aaa40097b.js"></script><script src="/_next/static/chunks/main-b6e20584df76f29b6f35.js" async=""></script><script src="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" async=""></script><script src="/_next/static/chunks/framework.fcef98db13e2318579fb.js" async=""></script><script src="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" async=""></script><script src="/_next/static/chunks/styles.6a5cc0a07ce13c54adf1.js" async=""></script><script src="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" async=""></script><script src="/_next/static/chunks/5e2acbba0c73eb7c5c0e969bcd552d3808de9969.4d0eb9c3d4239c66cc89.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-e52c21bde616652a406f.js" async=""></script><script src="/_next/static/m3klvRkyYMk4-ivtNpK7B/_buildManifest.js" async=""></script><script src="/_next/static/m3klvRkyYMk4-ivtNpK7B/_ssgManifest.js" async=""></script></body></html>