<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><title>Vert.x featuring Continuous Delivery with Jenkins and Ansible | Blog | Eclipse Vert.x</title><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/styles.065337ce.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.065337ce.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-b6e20584df76f29b6f35.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.fcef98db13e2318579fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.6a5cc0a07ce13c54adf1.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" as="script"/><link rel="preload" href="/_next/static/chunks/5e2acbba0c73eb7c5c0e969bcd552d3808de9969.4d0eb9c3d4239c66cc89.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-34b27bd96ede68f3ef0e.js" as="script"/></head><body><div id="__next"><main class="page"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><a class="navbar-menu-item" href="/introduction-to-vertx-and-reactive/">Intro</a><a class="navbar-menu-item" href="/docs/">Docs</a><a class="navbar-menu-item" href="/faq/">FAQ</a><a class="navbar-menu-item" href="/blog/">Blog</a><a class="navbar-menu-item" href="/community/">Community</a></div><div class="navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" class="navbar-social-link" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link" title="Stack Overflow" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>Stack Overflow</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" class="navbar-social-link" title="YouTube" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>YouTube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a href="https://discord.gg/KzEMwP2" class="navbar-social-link" title="Discord" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>Discord</title><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" class="navbar-social-link" title="Vert.x User Group" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x User Group</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a></div></div></div></div></header><div class="page-content"><div class="container"><div class="blog-post"><div class="blog-navbar"><h2>Blog</h2><ul><li><a href="/blog/">All posts</a></li><li><a href="/blog/category/releases/">releases</a></li><li><a href="/blog/category/guides/">guides</a></li><li><a href="/blog/category/news/">news</a></li></ul></div><div class="blog-post-main"><div class="blog-post-content"><h1>Vert.x featuring Continuous Delivery with Jenkins and Ansible</h1><span><p>This blog entry de­scribes an ap­proach to adopt <em>Con­tin­u­ous De­liv­ery</em> for Vert.x ap­pli­ca­tions using Jenk­ins and An­si­ble by tak­ing ad­van­tage of the Jenk­ins Job DSL and An­si­ble plu­g­ins.</p><h2 id="preamble"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#preamble"></a>Preamble</h2><p>This post was writ­ten in con­text of the project ti­tled “<a href="https://summerofcode.withgoogle.com/projects/#4858492141699072">De­vOps tool­ing for Vert.x ap­pli­ca­tions</a>”, one of the projects at Vert.x tak­ing place dur­ing the 2016 edi­tion of <a href="https://summerofcode.withgoogle.com/about/">Google Sum­mer of Code</a>, a pro­gram that aims to bring stu­dents to­gether with open source or­ga­ni­za­tions in order to help them to gain ex­po­sure to soft­ware de­vel­op­ment prac­tices and real-​world chal­lenges.</p><h2 id="introduction"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#introduction"></a>Introduction</h2><p>Sys­tem con­fig­u­ra­tion man­age­ment (e.g., An­si­ble) has been re­ally hype in the re­cent years and there is a strong rea­son for that.
Con­fig­u­ra­tion man­age­ment fa­cil­i­tates con­fig­ur­ing a new en­vi­ron­ment fol­low­ing a fixed <em>recipe</em> or slightly vary­ing it with the help of pa­ra­me­ters. This has not only the ad­van­tage of being able to do it more fre­quently but re­duces the chance of er­rors than doing it man­u­ally.<br/>
<!-- -->Be­yond that, com­bin­ing it with <em>Con­tin­u­ous In­te­gra­tion</em> tools (e.g., Jenk­ins) al­lows mak­ing a de­ploy­ment as soon as a new code­base ver­sion is avail­able, which rep­re­sents the main build­ing block of a <em>Con­tin­u­ous De­liv­ery</em> pipeline, one of the ob­jec­tives of em­brac­ing a De­vOps cul­ture.</p><p>Given that Vert.x is a frame­work that con­sists in a few li­braries which can be shipped within a sin­gle <em>fat jar</em>, adopt­ing a De­vOps cul­ture while de­vel­op­ing a Vert.x-​based ap­pli­ca­tion is straight­for­ward.</p><h2 id="overview"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#overview"></a>Overview</h2><p>As seen in the di­a­gram below, this post de­scribes a method to de­fine a Jenk­ins build job which will react to changes in a code repos­i­tory. After suc­ces­fully build­ing the project, the job will ex­e­cute an An­si­ble <em>play­book</em> to de­ploy the new ap­pli­ca­tion ver­sion to the hosts spec­i­fied within the An­si­ble con­fig­u­ra­tion.</p><p><img src="/images/blog/continuous-delivery-jenkins-ansible/ansible-jenkins-overview.svg" alt="Overview of the continous delivery process"/></p><h2 id="creating-a-jenkins-build-job-using-job-dsl"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#creating-a-jenkins-build-job-using-job-dsl"></a>Creating a Jenkins build job using Job DSL</h2><p>Jenk­ins has cre­ated a con­ve­nient way to de­fine build jobs using a DSL. While this op­tion avoids the has­sle of con­fig­ur­ing build jobs man­u­ally, it sup­ports all fea­tures of the reg­u­lar in­ter­face through its <a href="https://jenkinsci.github.io/job-dsl-plugin/">API</a>. It is pos­si­ble to use An­si­ble to­gether with Jenk­ins with the help of the An­si­ble <a href="https://wiki.jenkins-ci.org/display/JENKINS/Ansible+Plugin/">plugin</a>, whose in­struc­tions are also in­cluded in the Job DSL <a href="https://github.com/jenkinsci/ansible-plugin/blob/master/README.md">API</a>. Al­ter­na­tively to the Job DSL Plu­gin, An­si­ble can be used in­side the de­f­i­n­i­tion of Jenk­ins Pipeline, one of tool’s most re­cent fea­tures.</p><p>Below is a sam­ple job de­f­i­n­i­tion which can be used after cre­at­ing a <em>freestyle</em> job (seed job) and adding a new build step with the DSL script. In the script, there are a few things to no­tice:</p><ul><li>A name for the job cre­ated by the seed job is given.</li><li>Spe­cific ver­sions of JDK, Maven, and An­si­ble (avail­able in the en­vi­ron­ment) are used.</li><li>Git is se­lected as the SCM plat­form and the tar­get repos­i­tory is de­fined. Also, the build job is trig­gered ac­cord­ing to a spe­cific in­ter­val.</li><li>The Maven <em>pack­age</em> goal is in­voked, which is in­structed to pack­age the ap­pli­ca­tion into a fat jar.</li><li>Lastly, An­si­ble is used to call a play­book avail­able in the filesys­tem. The app will be de­ployed to the de­fined tar­get hosts and the cre­den­tials (con­fig­ured in Jenk­ins) will be used to log into the tar­get hosts. Ad­di­tion­ally, en­abling the <code>colorizedOutput</code> op­tion will re­sult in a friend­lier for­mat­ting of the re­sults in the con­sole out­put. The con­tents of this play­book will be ad­dressed in the next sec­tion.</li></ul><pre><code class="hljs language-groovy">job(<span class="hljs-string">&#x27;vertx-microservices-workshop-job&#x27;</span>) {
    jdk(<span class="hljs-string">&#x27;JDK8&#x27;</span>)
    scm {
        git(<span class="hljs-string">&#x27;git://github.com/ricardohmon/vertx-microservices-workshop.git&#x27;</span>)
    }
    triggers {
        scm(<span class="hljs-string">&#x27;*/15 * * * *&#x27;</span>)
    }
    steps {

      <span class="hljs-keyword">def</span> mvnInst = <span class="hljs-string">&#x27;M3.3.9&#x27;</span>  
      maven {  
        goals(<span class="hljs-string">&#x27;package&#x27;</span>)  
        mavenInstallation(mvnInst)  
      }  
      ansiblePlaybook(<span class="hljs-string">&#x27;/ansible/playbook.yml&#x27;</span>) {  
        inventoryPath(<span class="hljs-string">&#x27;/ansible/hosts&#x27;</span>)  
        ansibleName(<span class="hljs-string">&#x27;Ansible2.0&#x27;</span>)  
        credentialsId(<span class="hljs-string">&#x27;vagrant-key&#x27;</span>)  
        colorizedOutput(<span class="hljs-literal">true</span>)  
      }  

    }  
}
</code></pre><h2 id="deploying-vertx-app-using-ansible"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#deploying-vertx-app-using-ansible"></a>Deploying Vert.x app using Ansible</h2><p>An An­si­ble Play­book re­sults quite con­ve­nient to de­ploy a Vert.x ap­pli­ca­tion to a num­ber of hosts while still tak­ing con­sid­er­a­tions for each of them. Below is a sam­ple play­book that de­ploys the re­spec­tive ap­pli­ca­tion to each of the hosts de­scribed in an <em>in­ven­tory</em> file. The play­book com­prises the fol­low­ing tasks and takes the listed con­sid­er­a­tions:</p><p>1) A task that tar­gets only hosts with a data­base.</p><ul><li>The tar­get hosts is spec­i­fied with the name of the host (or hosts group) de­fined in the in­ven­tory file.</li></ul><p>2) Ac­tual ap­pli­ca­tion de­ploy­ment task. Here, sev­eral con­sid­er­a­tions are done:</p><ul><li>The ap­pli­ca­tion may re­quire that only one host is up­dated at the time.<br/>This can be achieved with the <code>serial</code> op­tion, while the order of the de­ploy­ment to hosts can be en­forced in the <code>hosts</code> op­tion.</li></ul><div class="alert info"><div class="alert-title">Host processing order</div><p>Even though we could have de­clared <code>all</code> hosts, An­si­ble does not pro­vide an ex­plicit way to spec­ify the order.</p></div><ul><li>Java is a sys­tem re­quire­ment for our Vert.x ap­pli­ca­tions.<br/>Be­sides in­stalling it (keep read­ing), we need to de­clare the <code>JAVA_HOME</code> en­vi­ron­ment vari­able.</li><li>A de­ploy­ment may just rep­re­sent an up­date to an al­ready run­ning ap­pli­ca­tion (<em>Con­tin­u­ous De­ploy­ment</em>), hence it is con­ve­nient to stop the pre­vi­ous ap­pli­ca­tion in­side the <code>pre_tasks</code> and take post-​deployment ac­tions in the <code>post_tasks</code>.
Vert.x ships with the con­ve­nient <code>start</code>/<code>stop</code>/<code>list</code> com­mands that re­sult very help­ful here. We can use the <code>list</code> com­mand and ex­tract (using regex) the <code>id</code> of the run­ning ap­pli­ca­tion of its out­put to stop it be­fore de­ploy­ing a new ver­sion.</li></ul><div class="alert info"><p>If our so­lu­tion in­cludes a load bal­ancer or proxy, we could deal with them at this step as de­scribed in An­si­ble’s <a href="http://docs.ansible.com/ansible/playbooks_delegation.html">best prac­tices</a> for rolling up­dates</p></div><ul><li>Call to a <code>role</code> that makes the ac­tual ap­pli­ca­tion de­ploy­ment. The Jenk­ins An­si­ble Plu­gin in­cludes, be­tween oth­ers, a <code>WORKSPACE</code> en­vi­ron­ment vari­able, which may re­sult very help­ful in the fol­low­ing tasks, as shown later.</li></ul><pre><code class="hljs language-yaml">  <span class="hljs-comment"># 1) Special task for the service with a db</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">hosts:</span> <span class="hljs-string">audit-service</span>
  <span class="hljs-attr">remote_user:</span> <span class="hljs-string">vagrant</span>
  <span class="hljs-attr">become:</span> <span class="hljs-literal">yes</span>
  <span class="hljs-attr">roles:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">db-setup</span>

  <span class="hljs-comment"># 2) Common tasks for all hosts</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">hosts:</span> <span class="hljs-string">quote-generator:portfolio-service:compulsive-traders:audit-service:trader-dashboard</span>
  <span class="hljs-attr">remote_user:</span> <span class="hljs-string">vagrant</span>
  <span class="hljs-attr">become:</span> <span class="hljs-literal">yes</span>
  <span class="hljs-attr">serial:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">environment:</span>
    <span class="hljs-attr">JAVA_HOME:</span> <span class="hljs-string">/usr/lib/jvm/jre-1.8.0-openjdk/</span>

  <span class="hljs-attr">pre_tasks:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Check</span> <span class="hljs-string">if</span> <span class="hljs-string">the</span> <span class="hljs-string">app</span> <span class="hljs-string">jar</span> <span class="hljs-string">exists</span> <span class="hljs-string">in</span> <span class="hljs-string">the</span> <span class="hljs-string">target</span> <span class="hljs-string">already</span>
    <span class="hljs-attr">stat:</span> <span class="hljs-string">path=/usr/share/vertx_app/app-fatjar.jar</span>
    <span class="hljs-attr">register:</span> <span class="hljs-string">st</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">List</span> <span class="hljs-string">running</span> <span class="hljs-string">Vert.x</span> <span class="hljs-string">applications</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">java</span> <span class="hljs-string">-jar</span> <span class="hljs-string">/usr/share/vertx_app/app-fatjar.jar</span> <span class="hljs-string">list</span>
    <span class="hljs-attr">register:</span> <span class="hljs-string">running_app_list</span>
    <span class="hljs-attr">when:</span> <span class="hljs-string">st.stat.exists</span> <span class="hljs-string">==</span> <span class="hljs-literal">True</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Stop</span> <span class="hljs-string">app</span> <span class="hljs-string">if</span> <span class="hljs-string">it</span> <span class="hljs-string">is</span> <span class="hljs-string">already</span> <span class="hljs-string">running</span> <span class="hljs-string">(avoid</span> <span class="hljs-string">multiple</span> <span class="hljs-string">running</span> <span class="hljs-string">instances)</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">java</span> <span class="hljs-string">-jar</span> <span class="hljs-string">/usr/share/vertx_app/app-fatjar.jar</span> <span class="hljs-string">stop</span> {<span class="hljs-string">%</span> <span class="hljs-string">raw</span> <span class="hljs-string">%</span>}{{ <span class="hljs-string">item</span> <span class="hljs-string">|</span> <span class="hljs-string">regex_replace(&#x27;^(?P&lt;V_id&gt;.</span>[<span class="hljs-number">8</span>]<span class="hljs-string">-.</span>[<span class="hljs-number">4</span>]<span class="hljs-string">-.</span>[<span class="hljs-number">4</span>]<span class="hljs-string">.</span>[<span class="hljs-number">4</span>]<span class="hljs-string">.</span>[<span class="hljs-number">12</span>]<span class="hljs-string">)\t.*&#x27;</span>, <span class="hljs-string">&#x27;\\g&lt;V_id&gt;&#x27;</span><span class="hljs-string">)</span> }}{<span class="hljs-string">%</span> <span class="hljs-string">endraw</span> <span class="hljs-string">%</span>}
    <span class="hljs-attr">with_items:</span> <span class="hljs-string">&quot;{% raw %}<span class="hljs-template-variable">{{ running_app_list.stdout_lines|default([]) }}</span>{% endraw %}&quot;</span>
    <span class="hljs-attr">when:</span> <span class="hljs-string">st.stat.exists</span> <span class="hljs-string">==</span> <span class="hljs-literal">True</span> <span class="hljs-string">and</span> <span class="hljs-string">(item</span> <span class="hljs-string">|</span> <span class="hljs-string">regex_replace(&#x27;.*\t(.*)$&#x27;,</span> <span class="hljs-string">&#x27;\\1&#x27;</span><span class="hljs-string">)</span> <span class="hljs-string">|</span> <span class="hljs-string">match(&#x27;.*/app-fatjar.jar$&#x27;))</span>

  <span class="hljs-comment"># Main role</span>
  <span class="hljs-attr">roles:</span>
    <span class="hljs-bullet">-</span> { <span class="hljs-attr">role:</span> <span class="hljs-string">vertx-app-deployment</span>, <span class="hljs-attr">jenkins_job_workspace:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">{{ lookup(&#x27;env&#x27;, &#x27;WORKSPACE&#x27;) }}</span>&quot;</span> }

  <span class="hljs-attr">post_tasks:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">List</span> <span class="hljs-string">again</span> <span class="hljs-string">running</span> <span class="hljs-string">Vert.x</span> <span class="hljs-string">applications</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">java</span> <span class="hljs-string">-jar</span> <span class="hljs-string">/usr/share/vertx_app/app-fatjar.jar</span> <span class="hljs-string">list</span>
</code></pre><p>Once we took care of the ac­tions shown be­fore, the re­main­ing tasks (in­cluded in the main de­ploy­ment role) re­duce to the fol­low­ing:</p><p>1) Pre­pare the tar­get ma­chine with the proper en­vi­ron­ment to run our ap­pli­ca­tion. This in­cludes:</p><ul><li>Set up Java (pretty con­ve­nient to do it through a pack­age man­ager).</li><li>Copy the Vert.x ap­pli­ca­tion pack­age to the ap­pro­pri­ate folder (quite sim­ple using a fat jar). The ac­tual name and lo­ca­tion of the jar pack­age in the Jenk­ins en­vi­ron­ment can be de­fined using host-​specific <a href="http://docs.ansible.com/ansible/playbooks_delegation.html">vari­ables</a>.</li><li>In case nec­es­sary, copy the re­quired con­fig files.</li></ul><pre><code class="hljs language-yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Java</span> <span class="hljs-number">1.8</span> <span class="hljs-string">and</span> <span class="hljs-string">some</span> <span class="hljs-string">basic</span> <span class="hljs-string">dependencies</span>
  <span class="hljs-attr">yum:</span> <span class="hljs-string">name={%</span> <span class="hljs-string">raw</span> <span class="hljs-string">%}{{</span> <span class="hljs-string">item</span> <span class="hljs-string">}}{%</span> <span class="hljs-string">endraw</span> <span class="hljs-string">%}</span> <span class="hljs-string">state=present</span>
  <span class="hljs-attr">with_items:</span>
   <span class="hljs-bullet">-</span> <span class="hljs-string">java-1.8.0-openjdk</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Ensure</span> <span class="hljs-string">app</span> <span class="hljs-string">dir</span> <span class="hljs-string">exists</span>
  <span class="hljs-attr">file:</span> <span class="hljs-string">path=/usr/share/vertx_app/</span> <span class="hljs-string">recurse=yes</span> <span class="hljs-string">state=directory</span> <span class="hljs-string">mode=0744</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Copy</span> <span class="hljs-string">the</span> <span class="hljs-string">Vert.x</span> <span class="hljs-string">application</span> <span class="hljs-string">jar</span> <span class="hljs-string">package</span>
  <span class="hljs-attr">copy:</span> <span class="hljs-string">src={%</span> <span class="hljs-string">raw</span> <span class="hljs-string">%}{{</span> <span class="hljs-string">app_jar</span> <span class="hljs-string">}}{%</span> <span class="hljs-string">endraw</span> <span class="hljs-string">%}</span> <span class="hljs-string">dest=/usr/share/vertx_app/app-fatjar.jar</span> <span class="hljs-string">mode=0755</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Ensure</span> <span class="hljs-string">config</span> <span class="hljs-string">dir</span> <span class="hljs-string">exists</span>
  <span class="hljs-attr">file:</span> <span class="hljs-string">path=/etc/vertx_app/</span> <span class="hljs-string">recurse=yes</span> <span class="hljs-string">state=directory</span> <span class="hljs-string">mode=0744</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Copy</span> <span class="hljs-string">the</span> <span class="hljs-string">application</span> <span class="hljs-string">config</span> <span class="hljs-string">file</span> <span class="hljs-string">if</span> <span class="hljs-string">needed</span>
  <span class="hljs-attr">copy:</span> <span class="hljs-string">src={%</span> <span class="hljs-string">raw</span> <span class="hljs-string">%}{{</span> <span class="hljs-string">app_config</span> <span class="hljs-string">}}{%</span> <span class="hljs-string">endraw</span> <span class="hljs-string">%}</span> <span class="hljs-string">dest=/etc/vertx_app/config.json</span> <span class="hljs-string">mode=0755</span>
  <span class="hljs-attr">when:</span> <span class="hljs-string">app_config</span> <span class="hljs-string">is</span> <span class="hljs-string">defined</span>
</code></pre><p>2) Run the ap­pli­ca­tion as a ser­vice in the host­ing ma­chine.</p><ul><li>Make sure to ig­nore the hang up sig­nal with the help of <code>nohup</code> com­mand. Oth­er­wise, An­si­ble will be stuck at this step.</li></ul><pre><code class="hljs language-yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">Vert.x</span> <span class="hljs-string">application</span> <span class="hljs-string">as</span> <span class="hljs-string">a</span> <span class="hljs-string">service,</span> <span class="hljs-string">ignore</span> <span class="hljs-string">the</span> <span class="hljs-string">SIGHUP</span> <span class="hljs-string">signal</span>
  <span class="hljs-attr">shell:</span> <span class="hljs-string">nohup</span> <span class="hljs-string">java</span> {<span class="hljs-string">%</span> <span class="hljs-string">raw</span> <span class="hljs-string">%</span>}{{ <span class="hljs-string">vertx_opts</span> }}{<span class="hljs-string">%</span> <span class="hljs-string">endraw</span> <span class="hljs-string">%</span>} <span class="hljs-string">-jar</span> <span class="hljs-string">/usr/share/vertx_app/app-fatjar.jar</span> <span class="hljs-string">start</span> {<span class="hljs-string">%</span> <span class="hljs-string">raw</span> <span class="hljs-string">%</span>}{{ <span class="hljs-string">launch_params</span> }}{<span class="hljs-string">%</span> <span class="hljs-string">endraw</span> <span class="hljs-string">%</span>}
  <span class="hljs-attr">register:</span> <span class="hljs-string">svc_run_out</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Print</span> <span class="hljs-string">run</span> <span class="hljs-string">output</span>
  <span class="hljs-attr">debug:</span> <span class="hljs-string">var=svc_run_out.stdout_lines</span>
</code></pre><div class="alert info"><div class="alert-title">Launching the Vert.x app</div><p>This ex­am­ple uses the <code>start</code> com­mand to launch the ap­pli­ca­tion as a ser­vice. This method may re­sult more com­fort­able than cre­at­ing an <a href="/blog/vert-x-3-init-d-script/">init.d script</a> or call­ing Vert.x from <a href="https://github.com/vert-x3/vertx-examples/#running-at-the-command-line">com­mand line</a>, which would have re­quired to in­stall the Vert.x li­braries in an in­de­pen­dent An­si­ble task.</p></div><p>This de­scribes all the con­fig­u­ra­tion needed to be able to build from a repos­i­tory using Jenk­ins and de­ploy the re­sults to our hosts with An­si­ble.</p><h2 id="sample-sources-and-demo"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#sample-sources-and-demo"></a>Sample sources and demo</h2><p>The sam­ple con­fig­u­ra­tions pre­sented be­fore are part of a com­plete demo fo­cused on the Vert.x mi­croser­vices <a href="http://vertx-lab.dynamis-technologies.com/">work­shop</a> to ex­em­plify a basic Con­tin­u­ous De­liv­ery sce­nario. This set up is avail­able in a <a href="https://github.com/ricardohmon/vertx-ansible">repos­i­tory</a> and con­tains, in ad­di­tion, a pre-​configured Jenkins-​based demo ready to host the build job de­scribed the pre­vi­ous sec­tions. The demo sce­nario re­quires Va­grant and Vir­tu­al­box to be launched.</p><h3 id="launch-instructions"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#launch-instructions"></a>Launch instructions</h3><ul><li>Clone or down­load this repos­i­tory, and launch the demo using <code>vagrant up</code></li></ul><pre><code class="hljs language-awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/ricardohmon/</span>vertx-ansible.git
cd demo
vagrant up
</code></pre><p>This com­mand will launch a vir­tual ma­chine host­ing Jenk­ins with the re­quired plu­g­ins in­stalled (tools names needed) and also launch five ad­di­tional VMs that will host the mi­croser­vices de­ployed by Jenk­ins.</p><ul><li>Cre­ate a Jenk­ins freestyle build job using the DSL job script (seed job) found in <code>deployment-jobs/microservices_workshop_dsl.groovy</code> and build it.</li></ul><div class="alert info"><div class="alert-title">Tool configuration assumption</div><p>The DSL Job as­sumes the fol­low­ing tools (with names) have been con­fig­ured in Jenk­ins: Java 8 (<code>JDK8</code>), Maven (<code>M3.3.9</code>), An­si­ble (<code>Ansible2.0</code>)</p></div><ul><li>After build­ing the seed job, a new job (<code>vertx-microservices-workshop-job</code>) will be cre­ated, which will be in charge of pulling re­cent changes of the project, build­ing it, and de­ploy­ing it.</li></ul><h3 id="demo"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#demo"></a>Demo</h3><p>Watch the pre­vi­ous demo in ac­tion in the fol­low­ing screen­cast:</p><div class="youtube-embed"><iframe src="https://www.youtube.com/embed/GQd_Rfeu6Yo" frameBorder="0" allowfullscreen=""></iframe></div><h2 id="conclusion"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#conclusion"></a>Conclusion</h2><p>Con­tin­u­ous De­liv­ery ap­proach is a <em>must</em> in mod­ern soft­ware de­vel­op­ment life­cy­cles (in­clud­ing Vert.x-​based ap­pli­ca­tions) and a step fur­ther to­wards adopt­ing a De­vOps cul­ture. There are a num­ber of tools that en­able it and one ex­am­ple is the com­bi­na­tion of Jenk­ins + An­si­ble de­scribed in this post.<br/>
<!-- -->While Jenk­ins of­fers the pos­si­bil­ity to in­te­grate re­cent changes per­ceived in a code­base and build runnable ar­ti­facts, An­si­ble can help to de­ploy them to host­ing en­vi­ron­ments. The usage of both tools can be cou­pled eas­ily with the help of the Job DSL plug­in, a fea­ture of Jenk­ins that al­lows de­scrib­ing a build job using a <em>domain-​specific lan­guage</em>, which can help to in­te­grate ad­di­tional steps and tools to a <em>CD</em> pipeline.</p><p>Fur­ther en­hance­ments can be done to this basic pipeline, such as, in­te­grat­ing the re­cent <a href="https://wiki.jenkins-ci.org/display/JENKINS/Pipeline+Plugin">Pipeline plugin</a>, a fea­ture that al­lows a bet­ter or­ches­tra­tion of CD stages; in­clu­sion of no­ti­fi­ca­tion and alert­ing ser­vices; and, ul­ti­mately a zero-​downtime de­ploy­ment ap­proach, which could be achieved with the help of a proxy; plus, tons of op­tions avail­able trough Jenk­ins plu­g­ins.</p><p>Thanks for read­ing!</p></span></div><div class="blog-post-sidebar"><div class="blog-post-author"><img class="blog-post-author-avatar" src="https://github.com/ricardohmon.png?size=160"/><div class="blog-post-author-name">by <a href="https://github.com/ricardohmon" target="_blank" rel="noopener noreferrer">Ricardo Hernandez</a></div></div><div class="blog-post-sidebar-date">Posted on <!-- -->28 September 2016</div>in <a class="blog-post-sidebar-category" href="/blog/category/guides/">guides</a><div class="blog-post-sidebar-reading-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <!-- -->9 min read</div><div class="blog-post-sidebar-share-icons"><a href="https://twitter.com/intent/tweet?text=Vert.x%20featuring%20Continuous%20Delivery%20with%20Jenkins%20and%20Ansible&amp;url=https%3A%2F%2Fokou19900722.github.io%2Fblog%2Fvert-x-featuring-continuous-delivery-with-jenkins-and-ansible&amp;via=vertx_project" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fokou19900722.github.io%2Fblog%2Fvert-x-featuring-continuous-delivery-with-jenkins-and-ansible" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fokou19900722.github.io%2Fblog%2Fvert-x-featuring-continuous-delivery-with-jenkins-and-ansible" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Facebook</title><path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg></a></div></div></div><div class="blog-post-next-prev"><div class="blog-post-next-prev-entry"><h5>Next post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">2 December 2016</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/oauth2-got-easy/">OAuth2 got easy</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/pmlopes.png?size=50"/><a href="https://github.com/pmlopes" target="_blank" rel="noopener noreferrer">Paulo Lopes</a></li></ul></span><p class="blog-entry-summary">Oauth2 support exists in Eclipse Vert.x since version 3.2.0. The implementation follows the principles that rule the whole vert.x ecosystem.</p><span class="read-more-link"><a href="/blog/oauth2-got-easy/">Read more</a></span></div></div><div class="blog-post-next-prev-entry"><h5>Previous post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">12 September 2016</span>​<a class="blog-entry-category" href="/blog/category/releases/">releases</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/vert-x-3-3-3-is-released/">Vert.x 3.3.3 is released!</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">We have just released Vert.x 3.3.3, a bug fix release of Vert.x 3.3.x.</p><span class="read-more-link"><a href="/blog/vert-x-3-3-3-is-released/">Read more</a></span></div></div></div><div class="blog-post-related"><h5>Related posts</h5><div class="blog-post-related-posts"><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">8 September 2016</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/centralized-logging-for-vert-x-applications-using-the-elk-stack/">Centralized logging for Vert.x applications using the ELK stack</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/ricardohmon.png?size=50"/><a href="https://github.com/ricardohmon" target="_blank" rel="noopener noreferrer">Ricardo Hernandez</a></li></ul></span><p class="blog-entry-summary">This post entry describes a solution to achieve centralized logging of Vert.x applications using the ELK stack (Logstash, Elasticsearch, and Kibana).</p><span class="read-more-link"><a href="/blog/centralized-logging-for-vert-x-applications-using-the-elk-stack/">Read more</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">7 December 2016</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/getting-started-with-new-fabric8-vert-x-maven-plugin/">Getting started with new fabric8 Vert.x Maven Plugin</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/kameshsampath.png?size=50"/><a href="https://github.com/kameshsampath" target="_blank" rel="noopener noreferrer">Kamesh Sampath</a></li></ul></span><p class="blog-entry-summary">The all new fabric8 Vert.x Maven Plugin allows you to setup, package, run, start, stop and redeploy easily with a very little configuration resulting in a less verbose pom.xml.</p><span class="read-more-link"><a href="/blog/getting-started-with-new-fabric8-vert-x-maven-plugin/">Read more</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">3 August 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/unit-and-integration-tests/">Unit and Integration Tests</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API.</p><span class="read-more-link"><a href="/blog/unit-and-integration-tests/">Read more</a></span></div></div></div></div></div></div><footer><div class="container"><div class="footer-nav-section"><div class="footer-nav-list footer-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="footer-nav-list"><h5>Eclipse Vert.x</h5><ul class=""><li><a class="navbar-menu-item" href="/docs/">Docs</a></li><li><a href="/download/">Download</a></li><li><a href="/faq/">FAQ</a></li><li><a href="/blog/">Blog</a></li><li><a href="/community/">Community</a></li><li><a href="/channels/">Channels</a></li></ul></div><div class="footer-nav-list"><h5>Eclipse</h5><ul class=""><li><a href="https://www.eclipse.org/">Eclipse Foundation</a></li><li><a href="https://www.eclipse.org/legal/privacy.php">Privacy Policy</a></li><li><a href="https://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li><li><a href="https://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li><li><a href="https://www.eclipse.org/legal/">Legal Resources</a></li></ul></div></div><div class="footer-copyright"><div class="footer-copyright-remarks">© <!-- -->2020<!-- --> Eclipse Vert.x<br/>Eclipse Vert.x is open source and dual-licensed under the <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer">Eclipse Public License 2.0</a> and the <a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache License 2.0</a>. <br class="footer-copyright-break"/>Website design by <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer">Michel Krämer</a>.</div><div class="footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyODEuMyA5MS4xIiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGU+LnN0MHtmaWxsOiNmNzk0MjJ9LnN0MXtmaWxsOiMzZDNjM2J9PC9zdHlsZT48ZyBpZD0iTGF5ZXJfMV8xXyI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTI2NS43IDg0TDI1NyA3M2gtMi43djE3LjdoMy4zdi0xMmw5LjMgMTJoMi4xVjczaC0zLjN2MTF6bS0zMi40LTguM2M0LjIgMCA1LjggMy4zIDUuOCA2LjNzLTEuNiA2LTUuOCA2LTUuNy0zLjEtNS44LTYgMS43LTYuMyA1LjgtNi4zem0wLTNjLTYuMSAwLTkuMSA0LjctOS4xIDkuMyAwIDQuNyAyLjkgOS4xIDkuMSA5LjFzOS00LjYgOS4xLTkuMi0zLTkuMi05LjEtOS4yem0tMjEuMiAxOFY3M2gtMy4zdjE3LjdoMy4zem0tMjMuNiAwaDMuM1Y3Nmg1LjZ2LTNoLTE0LjZ2M2g1LjZsLjEgMTQuN3ptLTE4LjktNi41SDE2M2wzLjMtNy42IDMuMyA3LjZ6bTIuOCA2LjVoMy42TDE2OC4yIDczaC0zLjZsLTggMTcuN2gzLjZsMS41LTMuM2g5LjNsMS40IDMuM3ptLTM4LTE0LjZoMy42YzMuOSAwIDUuNSAyLjggNS41IDUuNS4xIDIuOC0xLjUgNS44LTUuNSA1LjhoLTMuNlY3Ni4xem0zLjctMy4xaC02Ljl2MTcuN2g2LjljNi4yIDAgOC45LTQuNSA4LjktOXMtMi44LTguNy04LjktOC43em0tMjIuNCAxMUwxMDcgNzNoLTIuN3YxNy43aDMuM3YtMTJsOS4zIDEyaDIuMVY3M2gtMy4zdjExek04OC4yIDczdjEwLjJjMCAzLTEuNiA0LjktNC4zIDQuOXMtNC42LTEuNy00LjYtNC45VjczSDc2djEwLjFjMCA1LjMgMy42IDcuOSA3LjkgNy45IDQuNCAwIDcuNy0yLjcgNy43LTcuOVY3M2gtMy40em0tMzMgMi43YzQuMiAwIDUuOCAzLjMgNS44IDYuM3MtMS42IDYtNS44IDYtNS43LTMuMS01LjgtNiAxLjctNi4zIDUuOC02LjN6bTAtM2MtNi4xIDAtOS4xIDQuNy05LjEgOS4zczIuOSA5LjEgOS4xIDkuMSA5LTQuNiA5LjEtOS4yLTMtOS4yLTkuMS05LjJ6bS0yOS43IDE4di02LjVoOC45di0zLjFoLTguOXYtNC44aDkuNFY3M0gyMi4ydjE3LjZoMy4zeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjkuNCA1NC40aC0yMi4ydi04LjloMjEuNHYtNi45aC0yMS40di05LjFoMjIuMnYtNy4yaC0yOS42djM5LjVoMjkuNnYtNy40em0tNDAtMjUuNmMtMy02LjEtOS40LTcuOC0xNS41LTcuOC03LjMgMC0xNS4zIDMuNC0xNS4zIDExLjUgMCA4LjkgNy40IDExIDE1LjUgMTIgNS4yLjYgOS4xIDIuMSA5LjEgNS44IDAgNC4zLTQuNCA1LjktOS4xIDUuOXMtOS40LTEuOS0xMS4xLTYuM2wtNi4yIDMuMmMyLjkgNy4yIDkuMSA5LjcgMTcuMiA5LjcgOC44IDAgMTYuNi0zLjggMTYuNi0xMi42IDAtOS40LTcuNy0xMS42LTE1LjktMTIuNi00LjctLjYtOC44LTEuNS04LjgtNSAwLTIuOSAyLjYtNS4yIDguMi01LjIgNC4zIDAgOCAyLjIgOS40IDQuNGw1LjktM3pNMTc2IDIyLjJjLTYuMi0uMS0xMi40IDAtMTguNiAwdjM5LjVoNy40VjUwLjFIMTc2YzE5LjQgMCAxOS40LTI3LjkgMC0yNy45em0tMTEuMSA3LjFIMTc2YzkuNSAwIDkuNSAxNCAwIDE0aC0xMS4ybC4xLTE0em0tMTggMzIuNVYyMi4yaC03LjR2MzkuNWw3LjQuMXptLTQ0LTM5LjZ2MzkuNWgyNy43di02LjloLTIwLjNWMjIuMmgtNy40ek05MC43IDUxLjdjLTIuNyAyLjUtNi4yIDQtOS45IDQtOS44IDAtMTMuNS02LjgtMTMuNi0xMy40czQuMS0xMy43IDEzLjYtMTMuN2MzLjUtLjEgNyAxLjMgOS41IDMuN2w1LTQuOGMtMy44LTMuOS05LjEtNi0xNC41LTYtMTQuMyAwLTIxIDEwLjUtMjAuOSAyMC44czYuMyAyMC4zIDIwLjkgMjAuM2M1LjYuMSAxMS0yIDE1LTUuOWwtNS4xLTV6bS0zOSAyLjdIMjkuNXYtOC45aDIxLjR2LTYuOUgyOS41di05LjFoMjIuMnYtNy4ySDIyLjJ2MzkuNWgyOS42bC0uMS03LjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuOCAxOC4yQzE4LjggNC4xIDM2LjktLjggNTIuMSA2bC0xLS43QzM1LjctNC42IDE1LjItLjEgNS4zIDE1LjNzLTUuNCAzNS45IDEwIDQ1LjhsMS4xLjZDMy44IDUwLjguOCAzMi4zIDkuOCAxOC4yeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzIuMiAyNi4xYzAtMi41IDIuMS00LjYgNC42LTQuNiAyLjUgMCA0LjYgMi4xIDQuNiA0LjYgMCAyLjUtMi4xIDQuNi00LjYgNC42LTIuNiAwLTQuNi0yLjEtNC42LTQuNnptOC42IDBjMC0yLjItMS44LTQuMS00LTQuMXMtNC4xIDEuOC00LjEgNC4xYzAgMi4yIDEuNyA0IDMuOSA0LjFoLjFjMi4zIDAgNC4xLTEuOCA0LjEtNC4xem0tNi0yLjVoMi4zYzEuMSAwIDEuOS41IDEuOSAxLjYgMCAuNy0uNCAxLjMtMS4xIDEuNWwxLjIgMS43aC0xLjRsLTEtMS41aC0uN3YxLjVoLTEuMWwtLjEtNC44em0yLjIgMi4zYy41IDAgLjgtLjMuOC0uN3MtLjMtLjctLjgtLjdoLTF2MS4zbDEgLjF6Ii8+PC9nPjwvc3ZnPg==" alt="Eclipse foundation Logo"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"categories":["releases","guides","news"],"post":{"meta":{"title":"Vert.x featuring Continuous Delivery with Jenkins and Ansible","category":"guides","authors":[{"name":"Ricardo Hernandez","github_id":"ricardohmon"}],"summary":"This blog entry describes an approach to adopt Continuous Delivery for Vert.x applications using Jenkins and Ansible by taking advantage of the Jenkins Job DSL and Ansible plugins."},"date":"2016-09-28","slug":"vert-x-featuring-continuous-delivery-with-jenkins-and-ansible","readingTime":{"text":"9 min read","minutes":8.965,"time":537900,"words":1793},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"This blog entry de\\xADscribes an ap\\xADproach to adopt \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Con\\xADtin\\xADu\\xADous De\\xADliv\\xADery\"), \" for Vert.x ap\\xADpli\\xADca\\xADtions using Jenk\\xADins and An\\xADsi\\xADble by tak\\xADing ad\\xADvan\\xADtage of the Jenk\\xADins Job DSL and An\\xADsi\\xADble plu\\xADg\\xADins.\"), mdx(\"h2\", {\n    \"id\": \"preamble\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#preamble\"\n  })), \"Preamble\"), mdx(\"p\", null, \"This post was writ\\xADten in con\\xADtext of the project ti\\xADtled \\u201C\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://summerofcode.withgoogle.com/projects/#4858492141699072\"\n  }), \"De\\xADvOps tool\\xADing for Vert.x ap\\xADpli\\xADca\\xADtions\"), \"\\u201D, one of the projects at Vert.x tak\\xADing place dur\\xADing the 2016 edi\\xADtion of \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://summerofcode.withgoogle.com/about/\"\n  }), \"Google Sum\\xADmer of Code\"), \", a pro\\xADgram that aims to bring stu\\xADdents to\\xADgether with open source or\\xADga\\xADni\\xADza\\xADtions in order to help them to gain ex\\xADpo\\xADsure to soft\\xADware de\\xADvel\\xADop\\xADment prac\\xADtices and real-\\u200Bworld chal\\xADlenges.\"), mdx(\"h2\", {\n    \"id\": \"introduction\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#introduction\"\n  })), \"Introduction\"), mdx(\"p\", null, \"Sys\\xADtem con\\xADfig\\xADu\\xADra\\xADtion man\\xADage\\xADment (e.g., An\\xADsi\\xADble) has been re\\xADally hype in the re\\xADcent years and there is a strong rea\\xADson for that.\\nCon\\xADfig\\xADu\\xADra\\xADtion man\\xADage\\xADment fa\\xADcil\\xADi\\xADtates con\\xADfig\\xADur\\xADing a new en\\xADvi\\xADron\\xADment fol\\xADlow\\xADing a fixed \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"recipe\"), \" or slightly vary\\xADing it with the help of pa\\xADra\\xADme\\xADters. This has not only the ad\\xADvan\\xADtage of being able to do it more fre\\xADquently but re\\xADduces the chance of er\\xADrors than doing it man\\xADu\\xADally.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Be\\xADyond that, com\\xADbin\\xADing it with \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Con\\xADtin\\xADu\\xADous In\\xADte\\xADgra\\xADtion\"), \" tools (e.g., Jenk\\xADins) al\\xADlows mak\\xADing a de\\xADploy\\xADment as soon as a new code\\xADbase ver\\xADsion is avail\\xADable, which rep\\xADre\\xADsents the main build\\xADing block of a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Con\\xADtin\\xADu\\xADous De\\xADliv\\xADery\"), \" pipeline, one of the ob\\xADjec\\xADtives of em\\xADbrac\\xADing a De\\xADvOps cul\\xADture.\"), mdx(\"p\", null, \"Given that Vert.x is a frame\\xADwork that con\\xADsists in a few li\\xADbraries which can be shipped within a sin\\xADgle \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"fat jar\"), \", adopt\\xADing a De\\xADvOps cul\\xADture while de\\xADvel\\xADop\\xADing a Vert.x-\\u200Bbased ap\\xADpli\\xADca\\xADtion is straight\\xADfor\\xADward.\"), mdx(\"h2\", {\n    \"id\": \"overview\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#overview\"\n  })), \"Overview\"), mdx(\"p\", null, \"As seen in the di\\xADa\\xADgram below, this post de\\xADscribes a method to de\\xADfine a Jenk\\xADins build job which will react to changes in a code repos\\xADi\\xADtory. After suc\\xADces\\xADfully build\\xADing the project, the job will ex\\xADe\\xADcute an An\\xADsi\\xADble \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"play\\xADbook\"), \" to de\\xADploy the new ap\\xADpli\\xADca\\xADtion ver\\xADsion to the hosts spec\\xADi\\xADfied within the An\\xADsi\\xADble con\\xADfig\\xADu\\xADra\\xADtion.\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"/images/blog/continuous-delivery-jenkins-ansible/ansible-jenkins-overview.svg\",\n    \"alt\": \"Overview of the continous delivery process\"\n  }))), mdx(\"h2\", {\n    \"id\": \"creating-a-jenkins-build-job-using-job-dsl\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#creating-a-jenkins-build-job-using-job-dsl\"\n  })), \"Creating a Jenkins build job using Job DSL\"), mdx(\"p\", null, \"Jenk\\xADins has cre\\xADated a con\\xADve\\xADnient way to de\\xADfine build jobs using a DSL. While this op\\xADtion avoids the has\\xADsle of con\\xADfig\\xADur\\xADing build jobs man\\xADu\\xADally, it sup\\xADports all fea\\xADtures of the reg\\xADu\\xADlar in\\xADter\\xADface through its \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://jenkinsci.github.io/job-dsl-plugin/\"\n  }), \"API\"), \". It is pos\\xADsi\\xADble to use An\\xADsi\\xADble to\\xADgether with Jenk\\xADins with the help of the An\\xADsi\\xADble \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://wiki.jenkins-ci.org/display/JENKINS/Ansible+Plugin/\"\n  }), \"plugin\"), \", whose in\\xADstruc\\xADtions are also in\\xADcluded in the Job DSL \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/jenkinsci/ansible-plugin/blob/master/README.md\"\n  }), \"API\"), \". Al\\xADter\\xADna\\xADtively to the Job DSL Plu\\xADgin, An\\xADsi\\xADble can be used in\\xADside the de\\xADf\\xADi\\xADn\\xADi\\xADtion of Jenk\\xADins Pipeline, one of tool\\u2019s most re\\xADcent fea\\xADtures.\"), mdx(\"p\", null, \"Below is a sam\\xADple job de\\xADf\\xADi\\xADn\\xADi\\xADtion which can be used after cre\\xADat\\xADing a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"freestyle\"), \" job (seed job) and adding a new build step with the DSL script. In the script, there are a few things to no\\xADtice:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A name for the job cre\\xADated by the seed job is given.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Spe\\xADcific ver\\xADsions of JDK, Maven, and An\\xADsi\\xADble (avail\\xADable in the en\\xADvi\\xADron\\xADment) are used.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Git is se\\xADlected as the SCM plat\\xADform and the tar\\xADget repos\\xADi\\xADtory is de\\xADfined. Also, the build job is trig\\xADgered ac\\xADcord\\xADing to a spe\\xADcific in\\xADter\\xADval.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The Maven \", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"pack\\xADage\"), \" goal is in\\xADvoked, which is in\\xADstructed to pack\\xADage the ap\\xADpli\\xADca\\xADtion into a fat jar.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Lastly, An\\xADsi\\xADble is used to call a play\\xADbook avail\\xADable in the filesys\\xADtem. The app will be de\\xADployed to the de\\xADfined tar\\xADget hosts and the cre\\xADden\\xADtials (con\\xADfig\\xADured in Jenk\\xADins) will be used to log into the tar\\xADget hosts. Ad\\xADdi\\xADtion\\xADally, en\\xADabling the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"colorizedOutput\"), \" op\\xADtion will re\\xADsult in a friend\\xADlier for\\xADmat\\xADting of the re\\xADsults in the con\\xADsole out\\xADput. The con\\xADtents of this play\\xADbook will be ad\\xADdressed in the next sec\\xADtion.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-groovy\"\n  }), \"job(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'vertx-microservices-workshop-job'\"), \") {\\n    jdk(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'JDK8'\"), \")\\n    scm {\\n        git(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'git://github.com/ricardohmon/vertx-microservices-workshop.git'\"), \")\\n    }\\n    triggers {\\n        scm(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'*/15 * * * *'\"), \")\\n    }\\n    steps {\\n\\n      \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"def\"), \" mvnInst = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'M3.3.9'\"), \"  \\n      maven {  \\n        goals(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'package'\"), \")  \\n        mavenInstallation(mvnInst)  \\n      }  \\n      ansiblePlaybook(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'/ansible/playbook.yml'\"), \") {  \\n        inventoryPath(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'/ansible/hosts'\"), \")  \\n        ansibleName(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'Ansible2.0'\"), \")  \\n        credentialsId(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'vagrant-key'\"), \")  \\n        colorizedOutput(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-literal\"\n  }), \"true\"), \")  \\n      }  \\n\\n    }  \\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"deploying-vertx-app-using-ansible\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#deploying-vertx-app-using-ansible\"\n  })), \"Deploying Vert.x app using Ansible\"), mdx(\"p\", null, \"An An\\xADsi\\xADble Play\\xADbook re\\xADsults quite con\\xADve\\xADnient to de\\xADploy a Vert.x ap\\xADpli\\xADca\\xADtion to a num\\xADber of hosts while still tak\\xADing con\\xADsid\\xADer\\xADa\\xADtions for each of them. Below is a sam\\xADple play\\xADbook that de\\xADploys the re\\xADspec\\xADtive ap\\xADpli\\xADca\\xADtion to each of the hosts de\\xADscribed in an \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"in\\xADven\\xADtory\"), \" file. The play\\xADbook com\\xADprises the fol\\xADlow\\xADing tasks and takes the listed con\\xADsid\\xADer\\xADa\\xADtions:\"), mdx(\"p\", null, \"1) A task that tar\\xADgets only hosts with a data\\xADbase.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The tar\\xADget hosts is spec\\xADi\\xADfied with the name of the host (or hosts group) de\\xADfined in the in\\xADven\\xADtory file.\")), mdx(\"p\", null, \"2) Ac\\xADtual ap\\xADpli\\xADca\\xADtion de\\xADploy\\xADment task. Here, sev\\xADeral con\\xADsid\\xADer\\xADa\\xADtions are done:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The ap\\xADpli\\xADca\\xADtion may re\\xADquire that only one host is up\\xADdated at the time.\", mdx(\"br\", {\n    parentName: \"li\"\n  }), \"This can be achieved with the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"serial\"), \" op\\xADtion, while the order of the de\\xADploy\\xADment to hosts can be en\\xADforced in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"hosts\"), \" op\\xADtion.\")), mdx(Alert, {\n    info: true,\n    title: \"Host processing order\",\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"Even though we could have de\\xADclared \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"all\"), \" hosts, An\\xADsi\\xADble does not pro\\xADvide an ex\\xADplicit way to spec\\xADify the order.\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Java is a sys\\xADtem re\\xADquire\\xADment for our Vert.x ap\\xADpli\\xADca\\xADtions.\", mdx(\"br\", {\n    parentName: \"li\"\n  }), \"Be\\xADsides in\\xADstalling it (keep read\\xADing), we need to de\\xADclare the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"JAVA_HOME\"), \" en\\xADvi\\xADron\\xADment vari\\xADable.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A de\\xADploy\\xADment may just rep\\xADre\\xADsent an up\\xADdate to an al\\xADready run\\xADning ap\\xADpli\\xADca\\xADtion (\", mdx(\"em\", {\n    parentName: \"li\"\n  }, \"Con\\xADtin\\xADu\\xADous De\\xADploy\\xADment\"), \"), hence it is con\\xADve\\xADnient to stop the pre\\xADvi\\xADous ap\\xADpli\\xADca\\xADtion in\\xADside the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"pre_tasks\"), \" and take post-\\u200Bdeployment ac\\xADtions in the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"post_tasks\"), \".\\nVert.x ships with the con\\xADve\\xADnient \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"start\"), \"/\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"stop\"), \"/\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"list\"), \" com\\xADmands that re\\xADsult very help\\xADful here. We can use the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"list\"), \" com\\xADmand and ex\\xADtract (using regex) the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"id\"), \" of the run\\xADning ap\\xADpli\\xADca\\xADtion of its out\\xADput to stop it be\\xADfore de\\xADploy\\xADing a new ver\\xADsion.\")), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"If our so\\xADlu\\xADtion in\\xADcludes a load bal\\xADancer or proxy, we could deal with them at this step as de\\xADscribed in An\\xADsi\\xADble\\u2019s \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://docs.ansible.com/ansible/playbooks_delegation.html\"\n  }), \"best prac\\xADtices\"), \" for rolling up\\xADdates\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Call to a \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"role\"), \" that makes the ac\\xADtual ap\\xADpli\\xADca\\xADtion de\\xADploy\\xADment. The Jenk\\xADins An\\xADsi\\xADble Plu\\xADgin in\\xADcludes, be\\xADtween oth\\xADers, a \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"WORKSPACE\"), \" en\\xADvi\\xADron\\xADment vari\\xADable, which may re\\xADsult very help\\xADful in the fol\\xADlow\\xADing tasks, as shown later.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-yaml\"\n  }), \"  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"# 1) Special task for the service with a db\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"hosts:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"audit-service\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"remote_user:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"vagrant\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"become:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-literal\"\n  }), \"yes\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"roles:\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"db-setup\"), \"\\n\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"# 2) Common tasks for all hosts\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"hosts:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"quote-generator:portfolio-service:compulsive-traders:audit-service:trader-dashboard\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"remote_user:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"vagrant\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"become:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-literal\"\n  }), \"yes\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"serial:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"1\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"environment:\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"JAVA_HOME:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"/usr/lib/jvm/jre-1.8.0-openjdk/\"), \"\\n\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"pre_tasks:\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Check\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"if\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"the\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"app\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"exists\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"in\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"the\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"target\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"already\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"stat:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"path=/usr/share/vertx_app/app-fatjar.jar\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"register:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"st\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"List\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"running\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Vert.x\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"applications\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"command:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"java\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"-jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"/usr/share/vertx_app/app-fatjar.jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"list\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"register:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"running_app_list\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"when:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"st.stat.exists\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"==\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-literal\"\n  }), \"True\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Stop\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"app\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"if\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"it\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"is\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"already\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"running\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"(avoid\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"multiple\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"running\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"instances)\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"command:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"java\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"-jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"/usr/share/vertx_app/app-fatjar.jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"stop\"), \" {\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"raw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \"}{{ \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"item\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"|\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"regex_replace('^(?P\u003cV_id\u003e.\"), \"[\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8\"), \"]\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"-.\"), \"[\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"4\"), \"]\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"-.\"), \"[\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"4\"), \"]\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \".\"), \"[\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"4\"), \"]\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \".\"), \"[\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"12\"), \"]\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \")\\\\t.*'\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'\\\\\\\\g\u003cV_id\u003e'\"), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \")\"), \" }}{\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"endraw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \"}\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"with_items:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"{% raw %}\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-template-variable\"\n  }), \"{{ running_app_list.stdout_lines|default([]) }}\"), \"{% endraw %}\\\"\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"when:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"st.stat.exists\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"==\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-literal\"\n  }), \"True\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"and\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"(item\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"|\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"regex_replace('.*\\\\t(.*)$',\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"'\\\\\\\\1'\"), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \")\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"|\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"match('.*/app-fatjar.jar$'))\"), \"\\n\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"# Main role\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"roles:\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" { \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"role:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"vertx-app-deployment\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"jenkins_job_workspace:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-template-variable\"\n  }), \"{{ lookup('env', 'WORKSPACE') }}\"), \"\\\"\"), \" }\\n\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"post_tasks:\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"List\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"again\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"running\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Vert.x\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"applications\"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"command:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"java\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"-jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"/usr/share/vertx_app/app-fatjar.jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"list\"), \"\\n\")), mdx(\"p\", null, \"Once we took care of the ac\\xADtions shown be\\xADfore, the re\\xADmain\\xADing tasks (in\\xADcluded in the main de\\xADploy\\xADment role) re\\xADduce to the fol\\xADlow\\xADing:\"), mdx(\"p\", null, \"1) Pre\\xADpare the tar\\xADget ma\\xADchine with the proper en\\xADvi\\xADron\\xADment to run our ap\\xADpli\\xADca\\xADtion. This in\\xADcludes:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Set up Java (pretty con\\xADve\\xADnient to do it through a pack\\xADage man\\xADager).\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Copy the Vert.x ap\\xADpli\\xADca\\xADtion pack\\xADage to the ap\\xADpro\\xADpri\\xADate folder (quite sim\\xADple using a fat jar). The ac\\xADtual name and lo\\xADca\\xADtion of the jar pack\\xADage in the Jenk\\xADins en\\xADvi\\xADron\\xADment can be de\\xADfined using host-\\u200Bspecific \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://docs.ansible.com/ansible/playbooks_delegation.html\"\n  }), \"vari\\xADables\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In case nec\\xADes\\xADsary, copy the re\\xADquired con\\xADfig files.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-yaml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Install\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Java\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"1.8\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"and\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"some\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"basic\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"dependencies\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"yum:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"name={%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"raw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%}{{\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"item\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"}}{%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"endraw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%}\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"state=present\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"with_items:\"), \"\\n   \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"java-1.8.0-openjdk\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Ensure\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"app\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"dir\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"exists\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"file:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"path=/usr/share/vertx_app/\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"recurse=yes\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"state=directory\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"mode=0744\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Copy\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"the\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Vert.x\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"application\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"package\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"copy:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"src={%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"raw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%}{{\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"app_jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"}}{%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"endraw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%}\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"dest=/usr/share/vertx_app/app-fatjar.jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"mode=0755\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Ensure\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"config\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"dir\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"exists\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"file:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"path=/etc/vertx_app/\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"recurse=yes\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"state=directory\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"mode=0744\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Copy\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"the\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"application\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"config\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"file\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"if\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"needed\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"copy:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"src={%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"raw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%}{{\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"app_config\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"}}{%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"endraw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%}\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"dest=/etc/vertx_app/config.json\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"mode=0755\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"when:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"app_config\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"is\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"defined\"), \"\\n\")), mdx(\"p\", null, \"2) Run the ap\\xADpli\\xADca\\xADtion as a ser\\xADvice in the host\\xADing ma\\xADchine.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Make sure to ig\\xADnore the hang up sig\\xADnal with the help of \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nohup\"), \" com\\xADmand. Oth\\xADer\\xADwise, An\\xADsi\\xADble will be stuck at this step.\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-yaml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Run\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Vert.x\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"application\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"as\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"a\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"service,\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"ignore\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"the\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"SIGHUP\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"signal\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"shell:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"nohup\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"java\"), \" {\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"raw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \"}{{ \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"vertx_opts\"), \" }}{\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"endraw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \"} \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"-jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"/usr/share/vertx_app/app-fatjar.jar\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"start\"), \" {\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"raw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \"}{{ \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"launch_params\"), \" }}{\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"endraw\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"%\"), \"}\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"register:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"svc_run_out\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-bullet\"\n  }), \"-\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"name:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"Print\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"run\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"output\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"debug:\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"var=svc_run_out.stdout_lines\"), \"\\n\")), mdx(Alert, {\n    info: true,\n    title: \"Launching the Vert.x app\",\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"This ex\\xADam\\xADple uses the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"start\"), \" com\\xADmand to launch the ap\\xADpli\\xADca\\xADtion as a ser\\xADvice. This method may re\\xADsult more com\\xADfort\\xADable than cre\\xADat\\xADing an \", mdx(Link, {\n    href: \"/blog/vert-x-3-init-d-script/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"init.d script\")), \" or call\\xADing Vert.x from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/vert-x3/vertx-examples/#running-at-the-command-line\"\n  }), \"com\\xADmand line\"), \", which would have re\\xADquired to in\\xADstall the Vert.x li\\xADbraries in an in\\xADde\\xADpen\\xADdent An\\xADsi\\xADble task.\")), mdx(\"p\", null, \"This de\\xADscribes all the con\\xADfig\\xADu\\xADra\\xADtion needed to be able to build from a repos\\xADi\\xADtory using Jenk\\xADins and de\\xADploy the re\\xADsults to our hosts with An\\xADsi\\xADble.\"), mdx(\"h2\", {\n    \"id\": \"sample-sources-and-demo\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#sample-sources-and-demo\"\n  })), \"Sample sources and demo\"), mdx(\"p\", null, \"The sam\\xADple con\\xADfig\\xADu\\xADra\\xADtions pre\\xADsented be\\xADfore are part of a com\\xADplete demo fo\\xADcused on the Vert.x mi\\xADcroser\\xADvices \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://vertx-lab.dynamis-technologies.com/\"\n  }), \"work\\xADshop\"), \" to ex\\xADem\\xADplify a basic Con\\xADtin\\xADu\\xADous De\\xADliv\\xADery sce\\xADnario. This set up is avail\\xADable in a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/ricardohmon/vertx-ansible\"\n  }), \"repos\\xADi\\xADtory\"), \" and con\\xADtains, in ad\\xADdi\\xADtion, a pre-\\u200Bconfigured Jenkins-\\u200Bbased demo ready to host the build job de\\xADscribed the pre\\xADvi\\xADous sec\\xADtions. The demo sce\\xADnario re\\xADquires Va\\xADgrant and Vir\\xADtu\\xADal\\xADbox to be launched.\"), mdx(\"h3\", {\n    \"id\": \"launch-instructions\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#launch-instructions\"\n  })), \"Launch instructions\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Clone or down\\xADload this repos\\xADi\\xADtory, and launch the demo using \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"vagrant up\"))), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-awk\"\n  }), \"git clone https:\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-regexp\"\n  }), \"//gi\"), \"thub.com\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-regexp\"\n  }), \"/ricardohmon/\"), \"vertx-ansible.git\\ncd demo\\nvagrant up\\n\")), mdx(\"p\", null, \"This com\\xADmand will launch a vir\\xADtual ma\\xADchine host\\xADing Jenk\\xADins with the re\\xADquired plu\\xADg\\xADins in\\xADstalled (tools names needed) and also launch five ad\\xADdi\\xADtional VMs that will host the mi\\xADcroser\\xADvices de\\xADployed by Jenk\\xADins.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Cre\\xADate a Jenk\\xADins freestyle build job using the DSL job script (seed job) found in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"deployment-jobs/microservices_workshop_dsl.groovy\"), \" and build it.\")), mdx(Alert, {\n    info: true,\n    title: \"Tool configuration assumption\",\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"The DSL Job as\\xADsumes the fol\\xADlow\\xADing tools (with names) have been con\\xADfig\\xADured in Jenk\\xADins: Java 8 (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JDK8\"), \"), Maven (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"M3.3.9\"), \"), An\\xADsi\\xADble (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Ansible2.0\"), \")\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"After build\\xADing the seed job, a new job (\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"vertx-microservices-workshop-job\"), \") will be cre\\xADated, which will be in charge of pulling re\\xADcent changes of the project, build\\xADing it, and de\\xADploy\\xADing it.\")), mdx(\"h3\", {\n    \"id\": \"demo\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#demo\"\n  })), \"Demo\"), mdx(\"p\", null, \"Watch the pre\\xADvi\\xADous demo in ac\\xADtion in the fol\\xADlow\\xADing screen\\xADcast:\"), mdx(\"div\", {\n    className: \"youtube-embed\"\n  }, mdx(\"iframe\", {\n    src: \"https://www.youtube.com/embed/GQd_Rfeu6Yo\",\n    frameBorder: \"0\",\n    allowFullScreen: true\n  })), mdx(\"h2\", {\n    \"id\": \"conclusion\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#conclusion\"\n  })), \"Conclusion\"), mdx(\"p\", null, \"Con\\xADtin\\xADu\\xADous De\\xADliv\\xADery ap\\xADproach is a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"must\"), \" in mod\\xADern soft\\xADware de\\xADvel\\xADop\\xADment life\\xADcy\\xADcles (in\\xADclud\\xADing Vert.x-\\u200Bbased ap\\xADpli\\xADca\\xADtions) and a step fur\\xADther to\\xADwards adopt\\xADing a De\\xADvOps cul\\xADture. There are a num\\xADber of tools that en\\xADable it and one ex\\xADam\\xADple is the com\\xADbi\\xADna\\xADtion of Jenk\\xADins + An\\xADsi\\xADble de\\xADscribed in this post.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"While Jenk\\xADins of\\xADfers the pos\\xADsi\\xADbil\\xADity to in\\xADte\\xADgrate re\\xADcent changes per\\xADceived in a code\\xADbase and build runnable ar\\xADti\\xADfacts, An\\xADsi\\xADble can help to de\\xADploy them to host\\xADing en\\xADvi\\xADron\\xADments. The usage of both tools can be cou\\xADpled eas\\xADily with the help of the Job DSL plug\\xADin, a fea\\xADture of Jenk\\xADins that al\\xADlows de\\xADscrib\\xADing a build job using a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"domain-\\u200Bspecific lan\\xADguage\"), \", which can help to in\\xADte\\xADgrate ad\\xADdi\\xADtional steps and tools to a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"CD\"), \" pipeline.\"), mdx(\"p\", null, \"Fur\\xADther en\\xADhance\\xADments can be done to this basic pipeline, such as, in\\xADte\\xADgrat\\xADing the re\\xADcent \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://wiki.jenkins-ci.org/display/JENKINS/Pipeline+Plugin\"\n  }), \"Pipeline plugin\"), \", a fea\\xADture that al\\xADlows a bet\\xADter or\\xADches\\xADtra\\xADtion of CD stages; in\\xADclu\\xADsion of no\\xADti\\xADfi\\xADca\\xADtion and alert\\xADing ser\\xADvices; and, ul\\xADti\\xADmately a zero-\\u200Bdowntime de\\xADploy\\xADment ap\\xADproach, which could be achieved with the help of a proxy; plus, tons of op\\xADtions avail\\xADable trough Jenk\\xADins plu\\xADg\\xADins.\"), mdx(\"p\", null, \"Thanks for read\\xADing!\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cp\u003eThis blog entry de­scribes an ap­proach to adopt \u003cem\u003eCon­tin­u­ous De­liv­ery\u003c/em\u003e for Vert.x ap­pli­ca­tions using Jenk­ins and An­si­ble by tak­ing ad­van­tage of the Jenk­ins Job DSL and An­si­ble plu­g­ins.\u003c/p\u003e\u003ch2 id=\"preamble\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#preamble\"\u003e\u003c/a\u003ePreamble\u003c/h2\u003e\u003cp\u003eThis post was writ­ten in con­text of the project ti­tled “\u003ca href=\"https://summerofcode.withgoogle.com/projects/#4858492141699072\"\u003eDe­vOps tool­ing for Vert.x ap­pli­ca­tions\u003c/a\u003e”, one of the projects at Vert.x tak­ing place dur­ing the 2016 edi­tion of \u003ca href=\"https://summerofcode.withgoogle.com/about/\"\u003eGoogle Sum­mer of Code\u003c/a\u003e, a pro­gram that aims to bring stu­dents to­gether with open source or­ga­ni­za­tions in order to help them to gain ex­po­sure to soft­ware de­vel­op­ment prac­tices and real-​world chal­lenges.\u003c/p\u003e\u003ch2 id=\"introduction\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#introduction\"\u003e\u003c/a\u003eIntroduction\u003c/h2\u003e\u003cp\u003eSys­tem con­fig­u­ra­tion man­age­ment (e.g., An­si­ble) has been re­ally hype in the re­cent years and there is a strong rea­son for that.\nCon­fig­u­ra­tion man­age­ment fa­cil­i­tates con­fig­ur­ing a new en­vi­ron­ment fol­low­ing a fixed \u003cem\u003erecipe\u003c/em\u003e or slightly vary­ing it with the help of pa­ra­me­ters. This has not only the ad­van­tage of being able to do it more fre­quently but re­duces the chance of er­rors than doing it man­u­ally.\u003cbr/\u003e\n\u003c!-- --\u003eBe­yond that, com­bin­ing it with \u003cem\u003eCon­tin­u­ous In­te­gra­tion\u003c/em\u003e tools (e.g., Jenk­ins) al­lows mak­ing a de­ploy­ment as soon as a new code­base ver­sion is avail­able, which rep­re­sents the main build­ing block of a \u003cem\u003eCon­tin­u­ous De­liv­ery\u003c/em\u003e pipeline, one of the ob­jec­tives of em­brac­ing a De­vOps cul­ture.\u003c/p\u003e\u003cp\u003eGiven that Vert.x is a frame­work that con­sists in a few li­braries which can be shipped within a sin­gle \u003cem\u003efat jar\u003c/em\u003e, adopt­ing a De­vOps cul­ture while de­vel­op­ing a Vert.x-​based ap­pli­ca­tion is straight­for­ward.\u003c/p\u003e\u003ch2 id=\"overview\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#overview\"\u003e\u003c/a\u003eOverview\u003c/h2\u003e\u003cp\u003eAs seen in the di­a­gram below, this post de­scribes a method to de­fine a Jenk­ins build job which will react to changes in a code repos­i­tory. After suc­ces­fully build­ing the project, the job will ex­e­cute an An­si­ble \u003cem\u003eplay­book\u003c/em\u003e to de­ploy the new ap­pli­ca­tion ver­sion to the hosts spec­i­fied within the An­si­ble con­fig­u­ra­tion.\u003c/p\u003e\u003cp\u003e\u003cimg src=\"/images/blog/continuous-delivery-jenkins-ansible/ansible-jenkins-overview.svg\" alt=\"Overview of the continous delivery process\"/\u003e\u003c/p\u003e\u003ch2 id=\"creating-a-jenkins-build-job-using-job-dsl\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#creating-a-jenkins-build-job-using-job-dsl\"\u003e\u003c/a\u003eCreating a Jenkins build job using Job DSL\u003c/h2\u003e\u003cp\u003eJenk­ins has cre­ated a con­ve­nient way to de­fine build jobs using a DSL. While this op­tion avoids the has­sle of con­fig­ur­ing build jobs man­u­ally, it sup­ports all fea­tures of the reg­u­lar in­ter­face through its \u003ca href=\"https://jenkinsci.github.io/job-dsl-plugin/\"\u003eAPI\u003c/a\u003e. It is pos­si­ble to use An­si­ble to­gether with Jenk­ins with the help of the An­si­ble \u003ca href=\"https://wiki.jenkins-ci.org/display/JENKINS/Ansible+Plugin/\"\u003eplugin\u003c/a\u003e, whose in­struc­tions are also in­cluded in the Job DSL \u003ca href=\"https://github.com/jenkinsci/ansible-plugin/blob/master/README.md\"\u003eAPI\u003c/a\u003e. Al­ter­na­tively to the Job DSL Plu­gin, An­si­ble can be used in­side the de­f­i­n­i­tion of Jenk­ins Pipeline, one of tool’s most re­cent fea­tures.\u003c/p\u003e\u003cp\u003eBelow is a sam­ple job de­f­i­n­i­tion which can be used after cre­at­ing a \u003cem\u003efreestyle\u003c/em\u003e job (seed job) and adding a new build step with the DSL script. In the script, there are a few things to no­tice:\u003c/p\u003e\u003cul\u003e\u003cli\u003eA name for the job cre­ated by the seed job is given.\u003c/li\u003e\u003cli\u003eSpe­cific ver­sions of JDK, Maven, and An­si­ble (avail­able in the en­vi­ron­ment) are used.\u003c/li\u003e\u003cli\u003eGit is se­lected as the SCM plat­form and the tar­get repos­i­tory is de­fined. Also, the build job is trig­gered ac­cord­ing to a spe­cific in­ter­val.\u003c/li\u003e\u003cli\u003eThe Maven \u003cem\u003epack­age\u003c/em\u003e goal is in­voked, which is in­structed to pack­age the ap­pli­ca­tion into a fat jar.\u003c/li\u003e\u003cli\u003eLastly, An­si­ble is used to call a play­book avail­able in the filesys­tem. The app will be de­ployed to the de­fined tar­get hosts and the cre­den­tials (con­fig­ured in Jenk­ins) will be used to log into the tar­get hosts. Ad­di­tion­ally, en­abling the \u003ccode\u003ecolorizedOutput\u003c/code\u003e op­tion will re­sult in a friend­lier for­mat­ting of the re­sults in the con­sole out­put. The con­tents of this play­book will be ad­dressed in the next sec­tion.\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-groovy\"\u003ejob(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;vertx-microservices-workshop-job\u0026#x27;\u003c/span\u003e) {\n    jdk(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;JDK8\u0026#x27;\u003c/span\u003e)\n    scm {\n        git(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;git://github.com/ricardohmon/vertx-microservices-workshop.git\u0026#x27;\u003c/span\u003e)\n    }\n    triggers {\n        scm(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;*/15 * * * *\u0026#x27;\u003c/span\u003e)\n    }\n    steps {\n\n      \u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e mvnInst = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;M3.3.9\u0026#x27;\u003c/span\u003e  \n      maven {  \n        goals(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;package\u0026#x27;\u003c/span\u003e)  \n        mavenInstallation(mvnInst)  \n      }  \n      ansiblePlaybook(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;/ansible/playbook.yml\u0026#x27;\u003c/span\u003e) {  \n        inventoryPath(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;/ansible/hosts\u0026#x27;\u003c/span\u003e)  \n        ansibleName(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Ansible2.0\u0026#x27;\u003c/span\u003e)  \n        credentialsId(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;vagrant-key\u0026#x27;\u003c/span\u003e)  \n        colorizedOutput(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)  \n      }  \n\n    }  \n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"deploying-vertx-app-using-ansible\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#deploying-vertx-app-using-ansible\"\u003e\u003c/a\u003eDeploying Vert.x app using Ansible\u003c/h2\u003e\u003cp\u003eAn An­si­ble Play­book re­sults quite con­ve­nient to de­ploy a Vert.x ap­pli­ca­tion to a num­ber of hosts while still tak­ing con­sid­er­a­tions for each of them. Below is a sam­ple play­book that de­ploys the re­spec­tive ap­pli­ca­tion to each of the hosts de­scribed in an \u003cem\u003ein­ven­tory\u003c/em\u003e file. The play­book com­prises the fol­low­ing tasks and takes the listed con­sid­er­a­tions:\u003c/p\u003e\u003cp\u003e1) A task that tar­gets only hosts with a data­base.\u003c/p\u003e\u003cul\u003e\u003cli\u003eThe tar­get hosts is spec­i­fied with the name of the host (or hosts group) de­fined in the in­ven­tory file.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e2) Ac­tual ap­pli­ca­tion de­ploy­ment task. Here, sev­eral con­sid­er­a­tions are done:\u003c/p\u003e\u003cul\u003e\u003cli\u003eThe ap­pli­ca­tion may re­quire that only one host is up­dated at the time.\u003cbr/\u003eThis can be achieved with the \u003ccode\u003eserial\u003c/code\u003e op­tion, while the order of the de­ploy­ment to hosts can be en­forced in the \u003ccode\u003ehosts\u003c/code\u003e op­tion.\u003c/li\u003e\u003c/ul\u003e\u003cdiv class=\"alert info\"\u003e\u003cdiv class=\"alert-title\"\u003eHost processing order\u003c/div\u003e\u003cp\u003eEven though we could have de­clared \u003ccode\u003eall\u003c/code\u003e hosts, An­si­ble does not pro­vide an ex­plicit way to spec­ify the order.\u003c/p\u003e\u003c/div\u003e\u003cul\u003e\u003cli\u003eJava is a sys­tem re­quire­ment for our Vert.x ap­pli­ca­tions.\u003cbr/\u003eBe­sides in­stalling it (keep read­ing), we need to de­clare the \u003ccode\u003eJAVA_HOME\u003c/code\u003e en­vi­ron­ment vari­able.\u003c/li\u003e\u003cli\u003eA de­ploy­ment may just rep­re­sent an up­date to an al­ready run­ning ap­pli­ca­tion (\u003cem\u003eCon­tin­u­ous De­ploy­ment\u003c/em\u003e), hence it is con­ve­nient to stop the pre­vi­ous ap­pli­ca­tion in­side the \u003ccode\u003epre_tasks\u003c/code\u003e and take post-​deployment ac­tions in the \u003ccode\u003epost_tasks\u003c/code\u003e.\nVert.x ships with the con­ve­nient \u003ccode\u003estart\u003c/code\u003e/\u003ccode\u003estop\u003c/code\u003e/\u003ccode\u003elist\u003c/code\u003e com­mands that re­sult very help­ful here. We can use the \u003ccode\u003elist\u003c/code\u003e com­mand and ex­tract (using regex) the \u003ccode\u003eid\u003c/code\u003e of the run­ning ap­pli­ca­tion of its out­put to stop it be­fore de­ploy­ing a new ver­sion.\u003c/li\u003e\u003c/ul\u003e\u003cdiv class=\"alert info\"\u003e\u003cp\u003eIf our so­lu­tion in­cludes a load bal­ancer or proxy, we could deal with them at this step as de­scribed in An­si­ble’s \u003ca href=\"http://docs.ansible.com/ansible/playbooks_delegation.html\"\u003ebest prac­tices\u003c/a\u003e for rolling up­dates\u003c/p\u003e\u003c/div\u003e\u003cul\u003e\u003cli\u003eCall to a \u003ccode\u003erole\u003c/code\u003e that makes the ac­tual ap­pli­ca­tion de­ploy­ment. The Jenk­ins An­si­ble Plu­gin in­cludes, be­tween oth­ers, a \u003ccode\u003eWORKSPACE\u003c/code\u003e en­vi­ron­ment vari­able, which may re­sult very help­ful in the fol­low­ing tasks, as shown later.\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e  \u003cspan class=\"hljs-comment\"\u003e# 1) Special task for the service with a db\u003c/span\u003e\n\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehosts:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eaudit-service\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eremote_user:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003evagrant\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ebecome:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eyes\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eroles:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edb-setup\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e# 2) Common tasks for all hosts\u003c/span\u003e\n\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehosts:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003equote-generator:portfolio-service:compulsive-traders:audit-service:trader-dashboard\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eremote_user:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003evagrant\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ebecome:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eyes\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eserial:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eenvironment:\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eJAVA_HOME:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/usr/lib/jvm/jre-1.8.0-openjdk/\u003c/span\u003e\n\n  \u003cspan class=\"hljs-attr\"\u003epre_tasks:\u003c/span\u003e\n  \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eCheck\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ethe\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ejar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexists\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ethe\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etarget\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ealready\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003estat:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epath=/usr/share/vertx_app/app-fatjar.jar\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eregister:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003est\u003c/span\u003e\n  \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eList\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erunning\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eVert.x\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapplications\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecommand:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ejava\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e-jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/usr/share/vertx_app/app-fatjar.jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elist\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eregister:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erunning_app_list\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ewhen:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003est.stat.exists\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e==\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e\n  \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eStop\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eit\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ealready\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erunning\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e(avoid\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emultiple\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erunning\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003einstances)\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecommand:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ejava\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e-jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/usr/share/vertx_app/app-fatjar.jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estop\u003c/span\u003e {\u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e}{{ \u003cspan class=\"hljs-string\"\u003eitem\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e|\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eregex_replace(\u0026#x27;^(?P\u0026lt;V_id\u0026gt;.\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e]\u003cspan class=\"hljs-string\"\u003e-.\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e]\u003cspan class=\"hljs-string\"\u003e-.\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e]\u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e]\u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e]\u003cspan class=\"hljs-string\"\u003e)\\t.*\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\\\\g\u0026lt;V_id\u0026gt;\u0026#x27;\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e)\u003c/span\u003e }}{\u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eendraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e}\n    \u003cspan class=\"hljs-attr\"\u003ewith_items:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;{% raw %}\u003cspan class=\"hljs-template-variable\"\u003e{{ running_app_list.stdout_lines|default([]) }}\u003c/span\u003e{% endraw %}\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ewhen:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003est.stat.exists\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e==\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e(item\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e|\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eregex_replace(\u0026#x27;.*\\t(.*)$\u0026#x27;,\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\\\\1\u0026#x27;\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e)\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e|\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ematch(\u0026#x27;.*/app-fatjar.jar$\u0026#x27;))\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e# Main role\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eroles:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e { \u003cspan class=\"hljs-attr\"\u003erole:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003evertx-app-deployment\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ejenkins_job_workspace:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u003cspan class=\"hljs-template-variable\"\u003e{{ lookup(\u0026#x27;env\u0026#x27;, \u0026#x27;WORKSPACE\u0026#x27;) }}\u003c/span\u003e\u0026quot;\u003c/span\u003e }\n\n  \u003cspan class=\"hljs-attr\"\u003epost_tasks:\u003c/span\u003e\n  \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eList\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eagain\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erunning\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eVert.x\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapplications\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ecommand:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ejava\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e-jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/usr/share/vertx_app/app-fatjar.jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elist\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOnce we took care of the ac­tions shown be­fore, the re­main­ing tasks (in­cluded in the main de­ploy­ment role) re­duce to the fol­low­ing:\u003c/p\u003e\u003cp\u003e1) Pre­pare the tar­get ma­chine with the proper en­vi­ron­ment to run our ap­pli­ca­tion. This in­cludes:\u003c/p\u003e\u003cul\u003e\u003cli\u003eSet up Java (pretty con­ve­nient to do it through a pack­age man­ager).\u003c/li\u003e\u003cli\u003eCopy the Vert.x ap­pli­ca­tion pack­age to the ap­pro­pri­ate folder (quite sim­ple using a fat jar). The ac­tual name and lo­ca­tion of the jar pack­age in the Jenk­ins en­vi­ron­ment can be de­fined using host-​specific \u003ca href=\"http://docs.ansible.com/ansible/playbooks_delegation.html\"\u003evari­ables\u003c/a\u003e.\u003c/li\u003e\u003cli\u003eIn case nec­es­sary, copy the re­quired con­fig files.\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eInstall\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eJava\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.8\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eand\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esome\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ebasic\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edependencies\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eyum:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ename={%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%}{{\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eitem\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e}}{%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eendraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%}\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estate=present\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ewith_items:\u003c/span\u003e\n   \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ejava-1.8.0-openjdk\u003c/span\u003e\n\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEnsure\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapp\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edir\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexists\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003efile:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epath=/usr/share/vertx_app/\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erecurse=yes\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estate=directory\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emode=0744\u003c/span\u003e\n\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eCopy\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ethe\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eVert.x\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapplication\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ejar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epackage\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ecopy:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esrc={%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%}{{\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapp_jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e}}{%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eendraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%}\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edest=/usr/share/vertx_app/app-fatjar.jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emode=0755\u003c/span\u003e\n\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEnsure\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econfig\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edir\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexists\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003efile:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epath=/etc/vertx_app/\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erecurse=yes\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estate=directory\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emode=0744\u003c/span\u003e\n\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eCopy\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ethe\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapplication\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econfig\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003efile\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eneeded\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ecopy:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esrc={%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%}{{\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapp_config\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e}}{%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eendraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%}\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edest=/etc/vertx_app/config.json\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emode=0755\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ewhen:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapp_config\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eis\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edefined\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2) Run the ap­pli­ca­tion as a ser­vice in the host­ing ma­chine.\u003c/p\u003e\u003cul\u003e\u003cli\u003eMake sure to ig­nore the hang up sig­nal with the help of \u003ccode\u003enohup\u003c/code\u003e com­mand. Oth­er­wise, An­si­ble will be stuck at this step.\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eRun\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eVert.x\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eapplication\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ea\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eservice,\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eignore\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ethe\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eSIGHUP\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esignal\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eshell:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enohup\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ejava\u003c/span\u003e {\u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e}{{ \u003cspan class=\"hljs-string\"\u003evertx_opts\u003c/span\u003e }}{\u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eendraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e} \u003cspan class=\"hljs-string\"\u003e-jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/usr/share/vertx_app/app-fatjar.jar\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estart\u003c/span\u003e {\u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e}{{ \u003cspan class=\"hljs-string\"\u003elaunch_params\u003c/span\u003e }}{\u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eendraw\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e}\n  \u003cspan class=\"hljs-attr\"\u003eregister:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esvc_run_out\u003c/span\u003e\n\u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ePrint\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erun\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eoutput\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edebug:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003evar=svc_run_out.stdout_lines\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"alert info\"\u003e\u003cdiv class=\"alert-title\"\u003eLaunching the Vert.x app\u003c/div\u003e\u003cp\u003eThis ex­am­ple uses the \u003ccode\u003estart\u003c/code\u003e com­mand to launch the ap­pli­ca­tion as a ser­vice. This method may re­sult more com­fort­able than cre­at­ing an \u003ca href=\"/blog/vert-x-3-init-d-script/\"\u003einit.d script\u003c/a\u003e or call­ing Vert.x from \u003ca href=\"https://github.com/vert-x3/vertx-examples/#running-at-the-command-line\"\u003ecom­mand line\u003c/a\u003e, which would have re­quired to in­stall the Vert.x li­braries in an in­de­pen­dent An­si­ble task.\u003c/p\u003e\u003c/div\u003e\u003cp\u003eThis de­scribes all the con­fig­u­ra­tion needed to be able to build from a repos­i­tory using Jenk­ins and de­ploy the re­sults to our hosts with An­si­ble.\u003c/p\u003e\u003ch2 id=\"sample-sources-and-demo\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#sample-sources-and-demo\"\u003e\u003c/a\u003eSample sources and demo\u003c/h2\u003e\u003cp\u003eThe sam­ple con­fig­u­ra­tions pre­sented be­fore are part of a com­plete demo fo­cused on the Vert.x mi­croser­vices \u003ca href=\"http://vertx-lab.dynamis-technologies.com/\"\u003ework­shop\u003c/a\u003e to ex­em­plify a basic Con­tin­u­ous De­liv­ery sce­nario. This set up is avail­able in a \u003ca href=\"https://github.com/ricardohmon/vertx-ansible\"\u003erepos­i­tory\u003c/a\u003e and con­tains, in ad­di­tion, a pre-​configured Jenkins-​based demo ready to host the build job de­scribed the pre­vi­ous sec­tions. The demo sce­nario re­quires Va­grant and Vir­tu­al­box to be launched.\u003c/p\u003e\u003ch3 id=\"launch-instructions\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#launch-instructions\"\u003e\u003c/a\u003eLaunch instructions\u003c/h3\u003e\u003cul\u003e\u003cli\u003eClone or down­load this repos­i­tory, and launch the demo using \u003ccode\u003evagrant up\u003c/code\u003e\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode class=\"hljs language-awk\"\u003egit clone https:\u003cspan class=\"hljs-regexp\"\u003e//gi\u003c/span\u003ethub.com\u003cspan class=\"hljs-regexp\"\u003e/ricardohmon/\u003c/span\u003evertx-ansible.git\ncd demo\nvagrant up\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis com­mand will launch a vir­tual ma­chine host­ing Jenk­ins with the re­quired plu­g­ins in­stalled (tools names needed) and also launch five ad­di­tional VMs that will host the mi­croser­vices de­ployed by Jenk­ins.\u003c/p\u003e\u003cul\u003e\u003cli\u003eCre­ate a Jenk­ins freestyle build job using the DSL job script (seed job) found in \u003ccode\u003edeployment-jobs/microservices_workshop_dsl.groovy\u003c/code\u003e and build it.\u003c/li\u003e\u003c/ul\u003e\u003cdiv class=\"alert info\"\u003e\u003cdiv class=\"alert-title\"\u003eTool configuration assumption\u003c/div\u003e\u003cp\u003eThe DSL Job as­sumes the fol­low­ing tools (with names) have been con­fig­ured in Jenk­ins: Java 8 (\u003ccode\u003eJDK8\u003c/code\u003e), Maven (\u003ccode\u003eM3.3.9\u003c/code\u003e), An­si­ble (\u003ccode\u003eAnsible2.0\u003c/code\u003e)\u003c/p\u003e\u003c/div\u003e\u003cul\u003e\u003cli\u003eAfter build­ing the seed job, a new job (\u003ccode\u003evertx-microservices-workshop-job\u003c/code\u003e) will be cre­ated, which will be in charge of pulling re­cent changes of the project, build­ing it, and de­ploy­ing it.\u003c/li\u003e\u003c/ul\u003e\u003ch3 id=\"demo\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#demo\"\u003e\u003c/a\u003eDemo\u003c/h3\u003e\u003cp\u003eWatch the pre­vi­ous demo in ac­tion in the fol­low­ing screen­cast:\u003c/p\u003e\u003cdiv class=\"youtube-embed\"\u003e\u003ciframe src=\"https://www.youtube.com/embed/GQd_Rfeu6Yo\" frameBorder=\"0\" allowfullscreen=\"\"\u003e\u003c/iframe\u003e\u003c/div\u003e\u003ch2 id=\"conclusion\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#conclusion\"\u003e\u003c/a\u003eConclusion\u003c/h2\u003e\u003cp\u003eCon­tin­u­ous De­liv­ery ap­proach is a \u003cem\u003emust\u003c/em\u003e in mod­ern soft­ware de­vel­op­ment life­cy­cles (in­clud­ing Vert.x-​based ap­pli­ca­tions) and a step fur­ther to­wards adopt­ing a De­vOps cul­ture. There are a num­ber of tools that en­able it and one ex­am­ple is the com­bi­na­tion of Jenk­ins + An­si­ble de­scribed in this post.\u003cbr/\u003e\n\u003c!-- --\u003eWhile Jenk­ins of­fers the pos­si­bil­ity to in­te­grate re­cent changes per­ceived in a code­base and build runnable ar­ti­facts, An­si­ble can help to de­ploy them to host­ing en­vi­ron­ments. The usage of both tools can be cou­pled eas­ily with the help of the Job DSL plug­in, a fea­ture of Jenk­ins that al­lows de­scrib­ing a build job using a \u003cem\u003edomain-​specific lan­guage\u003c/em\u003e, which can help to in­te­grate ad­di­tional steps and tools to a \u003cem\u003eCD\u003c/em\u003e pipeline.\u003c/p\u003e\u003cp\u003eFur­ther en­hance­ments can be done to this basic pipeline, such as, in­te­grat­ing the re­cent \u003ca href=\"https://wiki.jenkins-ci.org/display/JENKINS/Pipeline+Plugin\"\u003ePipeline plugin\u003c/a\u003e, a fea­ture that al­lows a bet­ter or­ches­tra­tion of CD stages; in­clu­sion of no­ti­fi­ca­tion and alert­ing ser­vices; and, ul­ti­mately a zero-​downtime de­ploy­ment ap­proach, which could be achieved with the help of a proxy; plus, tons of op­tions avail­able trough Jenk­ins plu­g­ins.\u003c/p\u003e\u003cp\u003eThanks for read­ing!\u003c/p\u003e","scope":{}}},"prevPost":{"meta":{"title":"OAuth2 got easy","category":"guides","authors":[{"name":"Paulo Lopes","github_id":"pmlopes"}],"summary":"Oauth2 support exists in Eclipse Vert.x since version 3.2.0. The implementation follows the principles that rule the whole vert.x ecosystem."},"date":"2016-12-02","slug":"oauth2-got-easy"},"nextPost":{"meta":{"title":"Vert.x 3.3.3 is released!","category":"releases","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"We have just released Vert.x 3.3.3, a bug fix release of Vert.x 3.3.x."},"date":"2016-09-12","slug":"vert-x-3-3-3-is-released"},"relatedPosts":[{"meta":{"title":"Centralized logging for Vert.x applications using the ELK stack","category":"guides","authors":[{"name":"Ricardo Hernandez","github_id":"ricardohmon"}],"summary":"This post entry describes a solution to achieve centralized logging of Vert.x applications using the ELK stack (Logstash, Elasticsearch, and Kibana)."},"date":"2016-09-08","slug":"centralized-logging-for-vert-x-applications-using-the-elk-stack"},{"meta":{"title":"Getting started with new fabric8 Vert.x Maven Plugin","category":"guides","authors":[{"name":"Kamesh Sampath","github_id":"kameshsampath"}],"summary":"The all new fabric8 Vert.x Maven Plugin allows you to setup, package, run, start, stop and redeploy easily with a very little configuration resulting in a less verbose pom.xml."},"date":"2016-12-07","slug":"getting-started-with-new-fabric8-vert-x-maven-plugin"},{"meta":{"title":"Unit and Integration Tests","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API."},"date":"2015-08-03","slug":"unit-and-integration-tests"}]},"__N_SSG":true},"page":"/blog/[[...slug]]","query":{"slug":["vert-x-featuring-continuous-delivery-with-jenkins-and-ansible"]},"buildId":"X7HrzfONgQ3zrJoHxk_7_","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-7cde6f5ea12aaa40097b.js"></script><script src="/_next/static/chunks/main-b6e20584df76f29b6f35.js" async=""></script><script src="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" async=""></script><script src="/_next/static/chunks/framework.fcef98db13e2318579fb.js" async=""></script><script src="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" async=""></script><script src="/_next/static/chunks/styles.6a5cc0a07ce13c54adf1.js" async=""></script><script src="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" async=""></script><script src="/_next/static/chunks/5e2acbba0c73eb7c5c0e969bcd552d3808de9969.4d0eb9c3d4239c66cc89.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-34b27bd96ede68f3ef0e.js" async=""></script><script src="/_next/static/X7HrzfONgQ3zrJoHxk_7_/_buildManifest.js" async=""></script><script src="/_next/static/X7HrzfONgQ3zrJoHxk_7_/_ssgManifest.js" async=""></script></body></html>