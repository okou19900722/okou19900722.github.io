<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><title>Vert.x Core Manual | Eclipse Vert.x</title><link rel="preload" href="/_next/static/css/styles.176b8cb6.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.176b8cb6.chunk.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-a5439aed580585c60faa.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.4df82c4704a0136f6a4b.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.535b6603caf47859052a.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.8577696c4e17514af975.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-8beb549608891d89d2f4.js" as="script"/><link rel="preload" href="/_next/static/chunks/4f16b6dee4e09daf8bf4ac98169064eb9dcaeaf1.0f6a83d1c5caa3878fd9.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-f40e234f2aec2fb6c8b1.js" as="script"/></head><body><div id="__next"><main class="page docs"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><a class="navbar-menu-item" href="/introduction-to-vertx-and-reactive/">Intro</a><a class="navbar-menu-item" href="/docs/">Docs</a><a class="navbar-menu-item" href="/faq/">FAQ</a><a class="navbar-menu-item" href="/blog/">Blog</a><a class="navbar-menu-item" href="/community/">Community</a></div><div class="navbar-social"><div class="dropdown"><a class="dropdown-title">v4.0.0<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/docs/"><li class="dropdown-item active"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dropdown-check-icon"><polyline points="20 6 9 17 4 12"></polyline></svg>Latest (v<!-- -->4.0.0<!-- -->)</li></a><a href="/docs/3.9.2"><li class="dropdown-item">v<!-- -->3.9.2</li></a><a href="/docs/3.9.1"><li class="dropdown-item">v<!-- -->3.9.1</li></a><a href="/docs/3.9.0"><li class="dropdown-item">v<!-- -->3.9.0</li></a></ul></div><a href="https://github.com/vert-x3/vertx-awesome" class="navbar-social-link" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M23.996 10.648l-6.153-5.644-.865.944 5.127 4.7H1.895l5.127-4.705L6.157 5 .004 10.648H0v3.72c0 1.682 1.62 3.052 3.61 3.052h3.794c1.99 0 3.61-1.37 3.61-3.051v-2.445h1.968v2.445c0 1.681 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.72z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link" title="Stack Overflow" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>Stack Overflow</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" class="navbar-social-link" title="YouTube" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>YouTube</title><path d="M23.495 6.205a3.007 3.007 0 0 0-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 0 0 .527 6.205a31.247 31.247 0 0 0-.522 5.805 31.247 31.247 0 0 0 .522 5.783 3.007 3.007 0 0 0 2.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 0 0 2.088-2.088 31.247 31.247 0 0 0 .5-5.783 31.247 31.247 0 0 0-.5-5.805zM9.609 15.601V8.408l6.264 3.602z"></path></svg></a><a href="https://gitter.im/eclipse-vertx/vertx-users" class="navbar-social-link" title="Gitter" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Gitter"><title>Gitter</title><path d="M8.501 4.001H10.5V24H8.501V4.001zm6.999 0V24h-2V4.001h2zM3.5 0h2.001v15H3.5V0zm15 4.001h2V15h-2V4.001z"></path></svg></a></div></div></div></div></header><div class="page-content docs-content"><div class="container"><div class="docs-content-wrapper"><aside class=""><div class="docs-content-wrapper-sidebar"><div class="search-panel"><div class="search"><input type="text" placeholder="Search..." value=""/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon-delete"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div><ul class="search-results"></ul><div class="search-results-none">No results.</div></div><div class="docs-content-toc"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_are_you_fluent">Are you fluent?</a></li>
<li><a href="#_dont_call_us_well_call_you">Don&#8217;t call us, we&#8217;ll call you.</a></li>
<li><a href="#_dont_block_me">Don&#8217;t block me!</a></li>
<li><a href="#_reactor_and_multi_reactor">Reactor and Multi-Reactor</a></li>
<li><a href="#golden_rule">The Golden Rule - Don&#8217;t Block the Event Loop</a></li>
<li><a href="#blocking_code">Running blocking code</a></li>
<li><a href="#_async_coordination">Async coordination</a>
<ul class="sectlevel2">
<li><a href="#_concurrent_composition">Concurrent composition</a></li>
<li><a href="#_sequential_composition">Sequential composition</a></li>
</ul>
</li>
<li><a href="#_verticles">Verticles</a>
<ul class="sectlevel2">
<li><a href="#_verticle_types">Verticle Types</a></li>
<li><a href="#_standard_verticles">Standard verticles</a></li>
<li><a href="#worker_verticles">Worker verticles</a></li>
<li><a href="#_deploying_verticles_programmatically">Deploying verticles programmatically</a></li>
<li><a href="#_rules_for_mapping_a_verticle_name_to_a_verticle_factory">Rules for mapping a verticle name to a verticle factory</a></li>
<li><a href="#_how_are_verticle_factories_located">How are Verticle Factories located?</a></li>
<li><a href="#_waiting_for_deployment_to_complete">Waiting for deployment to complete</a></li>
<li><a href="#_undeploying_verticle_deployments">Undeploying verticle deployments</a></li>
<li><a href="#_specifying_number_of_verticle_instances">Specifying number of verticle instances</a></li>
<li><a href="#_verticle_isolation_groups">Verticle Isolation Groups</a></li>
<li><a href="#_high_availability">High Availability</a></li>
<li><a href="#_running_verticles_from_the_command_line">Running Verticles from the command line</a></li>
<li><a href="#_causing_vert_x_to_exit">Causing Vert.x to exit</a></li>
<li><a href="#_the_context_object">The Context object</a></li>
<li><a href="#_executing_periodic_and_delayed_actions">Executing periodic and delayed actions</a></li>
<li><a href="#_verticle_worker_pool">Verticle worker pool</a></li>
</ul>
</li>
<li><a href="#_thread_safety">Thread safety</a></li>
<li><a href="#_metrics_spi">Metrics SPI</a></li>
<li><a href="#_osgi">OSGi</a></li>
<li><a href="#_the_vertx_command_line">The 'vertx' command line</a>
<ul class="sectlevel2">
<li><a href="#_run_verticles">Run verticles</a></li>
<li><a href="#_executing_a_vert_x_application_packaged_as_a_fat_jar">Executing a Vert.x application packaged as a fat jar</a></li>
<li><a href="#_displaying_version_of_vert_x">Displaying version of Vert.x</a></li>
<li><a href="#_other_commands">Other commands</a></li>
<li><a href="#_live_redeploy">Live Redeploy</a></li>
</ul>
</li>
<li><a href="#_cluster_managers">Cluster Managers</a></li>
<li><a href="#_logging">Logging</a>
<ul class="sectlevel2">
<li><a href="#_configuring_jul_logging">Configuring JUL logging</a></li>
<li><a href="#_using_another_logging_framework">Using another logging framework</a></li>
<li><a href="#netty-logging">Netty logging</a></li>
<li><a href="#_troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li><a href="#_high_availability_and_fail_over">High Availability and Fail-Over</a>
<ul class="sectlevel2">
<li><a href="#_automatic_failover">Automatic failover</a></li>
<li><a href="#_ha_groups">HA groups</a></li>
<li><a href="#_dealing_with_network_partitions_quora">Dealing with network partitions - Quora</a></li>
</ul>
</li>
<li><a href="#_native_transports">Native transports</a>
<ul class="sectlevel2">
<li><a href="#_native_linux_transport">Native Linux Transport</a></li>
<li><a href="#_native_bsd_transport">Native BSD Transport</a></li>
<li><a href="#_domain_sockets">Domain sockets</a></li>
</ul>
</li>
<li><a href="#_security_notes">Security notes</a>
<ul class="sectlevel2">
<li><a href="#_web_applications">Web applications</a></li>
<li><a href="#_clustered_event_bus_traffic">Clustered event bus traffic</a></li>
<li><a href="#_standard_security_best_practices">Standard security best practices</a></li>
</ul>
</li>
<li><a href="#_vert_x_command_line_interface_api">Vert.x Command Line Interface API</a></li>
<li><a href="#_the_vert_x_launcher">The vert.x Launcher</a>
<ul class="sectlevel2">
<li><a href="#_extending_the_vert_x_launcher">Extending the vert.x Launcher</a></li>
<li><a href="#_using_the_launcher_in_fat_jars">Using the Launcher in fat jars</a></li>
<li><a href="#_sub_classing_the_launcher">Sub-classing the Launcher</a></li>
<li><a href="#_launcher_and_exit_code">Launcher and exit code</a></li>
</ul>
</li>
<li><a href="#_configuring_vert_x_cache">Configuring Vert.x cache</a></li>
</ul>
</div></div></div></aside><div class="docs-content-sidebar-toggle"><div style="position:relative"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div></div><div class="docs-content-inner"><div class="docs-content-metadata"><div class="docs-content-metadata-left"><div><a href="/docs/apidocs/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg> API</a></div></div></div><div><h1>Vert.x Core Manual</h1>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>At the heart of Vert.x is a set of Java APIs that we call <strong>Vert.x Core</strong></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/eclipse/vert.x">Repository</a>.</p>
</div>
<div class="paragraph">
<p>Vert.x core provides functionality for things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Writing TCP clients and servers</p>
</li>
<li>
<p>Writing HTTP clients and servers including support for WebSockets</p>
</li>
<li>
<p>The Event bus</p>
</li>
<li>
<p>Shared data - local maps and clustered distributed maps</p>
</li>
<li>
<p>Periodic and delayed actions</p>
</li>
<li>
<p>Deploying and undeploying Verticles</p>
</li>
<li>
<p>Datagram Sockets</p>
</li>
<li>
<p>DNS client</p>
</li>
<li>
<p>File system access</p>
</li>
<li>
<p>High availability</p>
</li>
<li>
<p>Native transports</p>
</li>
<li>
<p>Clustering</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The functionality in core is fairly low level - you won&#8217;t find stuff like database access, authorisation or high level
web functionality here - that kind of stuff you&#8217;ll find in <strong>Vert.x ext</strong> (extensions).</p>
</div>
<div class="paragraph">
<p>Vert.x core is small and lightweight. You just use the parts you want. It&#8217;s also entirely embeddable in your
existing applications - we don&#8217;t force you to structure your applications in a special way just so you can use
Vert.x.</p>
</div>
<div class="paragraph">
<p>You can use core from any of the other languages that Vert.x supports. But here&#8217;a a cool bit - we don&#8217;t force
you to use the Java API directly from, say, JavaScript or Ruby - after all, different languages have different conventions
and idioms, and it would be odd to force Java idioms on Ruby developers (for example).
Instead, we automatically generate an <strong>idiomatic</strong> equivalent of the core Java APIs for each language.</p>
</div>
<div class="paragraph">
<p>From now on we&#8217;ll just use the word <strong>core</strong> to refer to Vert.x core.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::override/dependencies.adoc[]</p>
</div>
<div class="paragraph">
<p>Let&#8217;s discuss the different concepts and features in core.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::override/in-the-beginning.adoc[]</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_are_you_fluent"><a class="anchor" href="#_are_you_fluent"></a>Are you fluent?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You may have noticed that in the previous examples a <strong>fluent</strong> API was used.</p>
</div>
<div class="paragraph">
<p>A fluent API is where multiple methods calls can be chained together. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">request.response().put_header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>).write(<span class="hljs-string">"some text"</span>).<span class="hljs-keyword">end</span>()</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a common pattern throughout Vert.x APIs, so get used to it.</p>
</div>
<div class="paragraph">
<p>Chaining calls like this allows you to write code that&#8217;s a little bit less verbose. Of course, if you don&#8217;t
like the fluent approach <strong>we don&#8217;t force you</strong> to do it that way, you can happily ignore it if you prefer and write
your code like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">response = request.response()
response.put_header(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain"</span>)
response.write(<span class="hljs-string">"some text"</span>)
response.<span class="hljs-keyword">end</span>()</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dont_call_us_well_call_you"><a class="anchor" href="#_dont_call_us_well_call_you"></a>Don&#8217;t call us, we&#8217;ll call you.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Vert.x APIs are largely <em>event driven</em>. This means that when things happen in Vert.x that you are interested in,
Vert.x will call you by sending you events.</p>
</div>
<div class="paragraph">
<p>Some example events are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a timer has fired</p>
</li>
<li>
<p>some data has arrived on a socket,</p>
</li>
<li>
<p>some data has been read from disk</p>
</li>
<li>
<p>an exception has occurred</p>
</li>
<li>
<p>an HTTP server has received a request</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You handle events by providing <em>handlers</em> to the Vert.x APIs. For example to receive a timer event every second you
would do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">vertx.set_periodic(<span class="hljs-number">1000</span>) { <span class="hljs-params">|id|</span>
  <span class="hljs-comment"># This handler will get called every second</span>
  puts <span class="hljs-string">"timer fired!"</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or to receive an HTTP request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-comment"># Respond to each http request with "Hello World"</span>
server.request_handler() { <span class="hljs-params">|request|</span>
  <span class="hljs-comment"># This handler will be called every time an HTTP request is received at the server</span>
  request.response().<span class="hljs-keyword">end</span>(<span class="hljs-string">"hello world!"</span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Some time later when Vert.x has an event to pass to your handler Vert.x will call it <strong>asynchronously</strong>.</p>
</div>
<div class="paragraph">
<p>This leads us to some important concepts in Vert.x:</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dont_block_me"><a class="anchor" href="#_dont_block_me"></a>Don&#8217;t block me!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With very few exceptions (i.e. some file system operations ending in 'Sync'), none of the APIs in Vert.x block the calling thread.</p>
</div>
<div class="paragraph">
<p>If a result can be provided immediately, it will be returned immediately, otherwise you will usually provide a handler
to receive events some time later.</p>
</div>
<div class="paragraph">
<p>Because none of the Vert.x APIs block threads that means you can use Vert.x to handle a lot of concurrency using
just a small number of threads.</p>
</div>
<div class="paragraph">
<p>With a conventional blocking API the calling thread might block when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reading data from a socket</p>
</li>
<li>
<p>Writing data to disk</p>
</li>
<li>
<p>Sending a message to a recipient and waiting for a reply.</p>
</li>
<li>
<p>&#8230;&#8203; Many other situations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In all the above cases, when your thread is waiting for a result it can&#8217;t do anything else - it&#8217;s effectively useless.</p>
</div>
<div class="paragraph">
<p>This means that if you want a lot of concurrency using blocking APIs then you need a lot of threads to prevent your
application grinding to a halt.</p>
</div>
<div class="paragraph">
<p>Threads have overhead in terms of the memory they require (e.g. for their stack) and in context switching.</p>
</div>
<div class="paragraph">
<p>For the levels of concurrency required in many modern applications, a blocking approach just doesn&#8217;t scale.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reactor_and_multi_reactor"><a class="anchor" href="#_reactor_and_multi_reactor"></a>Reactor and Multi-Reactor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We mentioned before that Vert.x APIs are event driven - Vert.x passes events to handlers when they are available.</p>
</div>
<div class="paragraph">
<p>In most cases Vert.x calls your handlers using a thread called an <strong>event loop</strong>.</p>
</div>
<div class="paragraph">
<p>As nothing in Vert.x or your application blocks, the event loop can merrily run around delivering events to different handlers in succession
as they arrive.</p>
</div>
<div class="paragraph">
<p>Because nothing blocks, an event loop can potentially deliver huge amounts of events in a short amount of time.
For example a single event loop can handle many thousands of HTTP requests very quickly.</p>
</div>
<div class="paragraph">
<p>We call this the <a href="http://en.wikipedia.org/wiki/Reactor_pattern">Reactor Pattern</a>.</p>
</div>
<div class="paragraph">
<p>You may have heard of this before - for example Node.js implements this pattern.</p>
</div>
<div class="paragraph">
<p>In a standard reactor implementation there is a <strong>single event loop</strong> thread which runs around in a loop delivering all
events to all handlers as they arrive.</p>
</div>
<div class="paragraph">
<p>The trouble with a single thread is it can only run on a single core at any one time, so if you want your single threaded
reactor application (e.g. your Node.js application) to scale over your multi-core server you have to start up and
manage many different processes.</p>
</div>
<div class="paragraph">
<p>Vert.x works differently here. Instead of a single event loop, each Vertx instance maintains <strong>several event loops</strong>.
By default we choose the number based on the number of available cores on the machine, but this can be overridden.</p>
</div>
<div class="paragraph">
<p>This means a single Vertx process can scale across your server, unlike Node.js.</p>
</div>
<div class="paragraph">
<p>We call this pattern the <strong>Multi-Reactor Pattern</strong> to distinguish it from the single threaded reactor pattern.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Even though a Vertx instance maintains multiple event loops, any particular handler will never be executed
concurrently, and in most cases (with the exception of <a href="#worker_verticles">worker verticles</a>) will always be called
using the <strong>exact same event loop</strong>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="golden_rule"><a class="anchor" href="#golden_rule"></a>The Golden Rule - Don&#8217;t Block the Event Loop</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We already know that the Vert.x APIs are non blocking and won&#8217;t block the event loop, but that&#8217;s not much help if
you block the event loop <strong>yourself</strong> in a handler.</p>
</div>
<div class="paragraph">
<p>If you do that, then that event loop will not be able to do anything else while it&#8217;s blocked. If you block all of the
event loops in Vertx instance then your application will grind to a complete halt!</p>
</div>
<div class="paragraph">
<p>So don&#8217;t do it! <strong>You have been warned</strong>.</p>
</div>
<div class="paragraph">
<p>Examples of blocking include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Thread.sleep()</p>
</li>
<li>
<p>Waiting on a lock</p>
</li>
<li>
<p>Waiting on a mutex or monitor (e.g. synchronized section)</p>
</li>
<li>
<p>Doing a long lived database operation and waiting for a result</p>
</li>
<li>
<p>Doing a complex calculation that takes some significant time.</p>
</li>
<li>
<p>Spinning in a loop</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of the above stop the event loop from doing anything else for a <strong>significant amount of time</strong> then you should
go immediately to the naughty step, and await further instructions.</p>
</div>
<div class="paragraph">
<p>So&#8230;&#8203; what is a <strong>significant amount of time</strong>?</p>
</div>
<div class="paragraph">
<p>How long is a piece of string? It really depends on your application and the amount of concurrency you require.</p>
</div>
<div class="paragraph">
<p>If you have a single event loop, and you want to handle 10000 http requests per second, then it&#8217;s clear that each request
can&#8217;t take more than 0.1 ms to process, so you can&#8217;t block for any more time than that.</p>
</div>
<div class="paragraph">
<p><strong>The maths is not hard and shall be left as an exercise for the reader.</strong></p>
</div>
<div class="paragraph">
<p>If your application is not responsive it might be a sign that you are blocking an event loop somewhere. To help
you diagnose such issues, Vert.x will automatically log warnings if it detects an event loop hasn&#8217;t returned for
some time. If you see warnings like these in your logs, then you should investigate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Thread vertx-eventloop-thread-3 has been blocked for 20458 ms</pre>
</div>
</div>
<div class="paragraph">
<p>Vert.x will also provide stack traces to pinpoint exactly where the blocking is occurring.</p>
</div>
<div class="paragraph">
<p>If you want to turn off these warnings or change the settings, you can do that in the
<code><a href="../dataobjects.html#VertxOptions">VertxOptions</a></code> object before creating the Vertx object.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="blocking_code"><a class="anchor" href="#blocking_code"></a>Running blocking code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a perfect world, there will be no war or hunger, all APIs will be written asynchronously and bunny rabbits will
skip hand-in-hand with baby lambs across sunny green meadows.</p>
</div>
<div class="paragraph">
<p><strong>But&#8230;&#8203; the real world is not like that. (Have you watched the news lately?)</strong></p>
</div>
<div class="paragraph">
<p>Fact is, many, if not most libraries, especially in the JVM ecosystem have synchronous APIs and many of the methods are
likely to block. A good example is the JDBC API - it&#8217;s inherently synchronous, and no matter how hard it tries, Vert.x
cannot sprinkle magic pixie dust on it to make it asynchronous.</p>
</div>
<div class="paragraph">
<p>We&#8217;re not going to rewrite everything to be asynchronous overnight so we need to provide you a way to use "traditional"
blocking APIs safely within a Vert.x application.</p>
</div>
<div class="paragraph">
<p>As discussed before, you can&#8217;t call blocking operations directly from an event loop, as that would prevent it
from doing any other useful work. So how can you do this?</p>
</div>
<div class="paragraph">
<p>It&#8217;s done by calling <code><a href="../../yardoc/Vertx/Vertx.html#execute_blocking-instance_method">executeBlocking</a></code> specifying both the blocking code to execute and a
result handler to be called back asynchronous when the blocking code has been executed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">vertx.execute_blocking(lambda { <span class="hljs-params">|promise|</span>
  <span class="hljs-comment"># Call some blocking API that takes a significant amount of time to return</span>
  result = @someAPI.blocking_method(<span class="hljs-string">"hello"</span>)
  promise.complete(result)
}) { <span class="hljs-params">|res_err,res|</span>
  puts <span class="hljs-string">"The result is: <span class="hljs-subst">#{res}</span>"</span>
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Blocking code should block for a reasonable amount of time (i.e no more than a few seconds). Long blocking operations
        or polling operations (i.e a thread that spin in a loop polling events in a blocking fashion) are precluded.
        When the blocking operation lasts more than the 10 seconds, a message will be printed on the console by the
        blocked thread checker. Long blocking operations should use a dedicated thread managed by the application,
        which can interact with verticles using the event-bus or <code><a href="../../yardoc/Vertx/Context.html#run_on_context-instance_method">runOnContext</a></code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, if executeBlocking is called several times from the same context (e.g. the same verticle instance) then
the different executeBlocking are executed <em>serially</em> (i.e. one after another).</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t care about ordering you can call <code><a href="../../yardoc/Vertx/Vertx.html#execute_blocking-instance_method">executeBlocking</a></code>
specifying <code>false</code> as the argument to <code>ordered</code>. In this case any executeBlocking may be executed in parallel
on the worker pool.</p>
</div>
<div class="paragraph">
<p>An alternative way to run blocking code is to use a <a href="#worker_verticles">worker verticle</a></p>
</div>
<div class="paragraph">
<p>A worker verticle is always executed with a thread from the worker pool.</p>
</div>
<div class="paragraph">
<p>By default blocking code is executed on the Vert.x worker pool, configured with <code><a href="../dataobjects.html#VertxOptions#set_worker_pool_size-instance_method">workerPoolSize</a></code>.</p>
</div>
<div class="paragraph">
<p>Additional pools can be created for different purposes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">executor = vertx.create_shared_worker_executor(<span class="hljs-string">"my-worker-pool"</span>)
executor.execute_blocking(lambda { <span class="hljs-params">|promise|</span>
  <span class="hljs-comment"># Call some blocking API that takes a significant amount of time to return</span>
  result = @someAPI.blocking_method(<span class="hljs-string">"hello"</span>)
  promise.complete(result)
}) { <span class="hljs-params">|res_err,res|</span>
  puts <span class="hljs-string">"The result is: <span class="hljs-subst">#{res}</span>"</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The worker executor must be closed when it&#8217;s not necessary anymore:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">executor.close()</code></pre>
</div>
</div>
<div class="paragraph">
<p>When several workers are created with the same name, they will share the same pool. The worker pool is destroyed
when all the worker executors using it are closed.</p>
</div>
<div class="paragraph">
<p>When an executor is created in a Verticle, Vert.x will close it automatically for you when the Verticle
is undeployed.</p>
</div>
<div class="paragraph">
<p>Worker executors can be configured when created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-comment">#</span>
<span class="hljs-comment"># 10 threads max</span>
poolSize = <span class="hljs-number">10</span>

<span class="hljs-comment"># 2 minutes</span>
maxExecuteTime = <span class="hljs-number">2</span>
maxExecuteTimeUnit = <span class="hljs-symbol">:MINUTES</span>

executor = vertx.create_shared_worker_executor(<span class="hljs-string">"my-worker-pool"</span>, poolSize, maxExecuteTime, maxExecuteTimeUnit)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the configuration is set when the worker pool is created
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_async_coordination"><a class="anchor" href="#_async_coordination"></a>Async coordination</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Coordination of multiple asynchronous results can be achieved with Vert.x <code><a href="../../yardoc/Vertx/Future.html">futures</a></code>. It
supports concurrent composition (run several async operations in parallel) and sequential composition
(chain async operations).</p>
</div>
<div class="sect2">
<h3 id="_concurrent_composition"><a class="anchor" href="#_concurrent_composition"></a>Concurrent composition</h3>
<div class="paragraph">
<p><code><a href="../../yardoc/Vertx/CompositeFuture.html#all-class_method">CompositeFuture.all</a></code> takes several futures arguments (up to 6) and returns a future that is
<em>succeeded</em> when all the futures are and <em>failed</em> when at least one of the futures is failed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/future'</span>
<span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/composite_future'</span>
httpServerFuture = Vertx::Future.future() { <span class="hljs-params">|promise|</span>
  httpServer.listen(&amp;promise)
}

netServerFuture = Vertx::Future.future() { <span class="hljs-params">|promise|</span>
  netServer.listen(&amp;promise)
}

Vertx::CompositeFuture.all(httpServerFuture, netServerFuture).set_handler() { <span class="hljs-params">|ar_err,ar|</span>
  <span class="hljs-keyword">if</span> (ar_err == <span class="hljs-literal">nil</span>)
    <span class="hljs-comment"># All servers started</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-comment"># At least one server failed</span>
  <span class="hljs-keyword">end</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The operations run concurrently, the <code><a href="unavailable">Handler</a></code> attached to the returned future is invoked upon
completion of the composition. When one of the operation fails (one of the passed future is marked as a failure),
the resulting future is marked as failed too. When all the operations succeed, the resulting future is completed
with a success.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can pass a list (potentially empty) of futures:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/composite_future'</span>
Vertx::CompositeFuture.all([future1, future2, future3])</code></pre>
</div>
</div>
<div class="paragraph">
<p>While the <code>all</code> composition <em>waits</em> until all futures are successful (or one fails), the <code>any</code> composition
<em>waits</em> for the first succeeded future. <code><a href="../../yardoc/Vertx/CompositeFuture.html#any-class_method">CompositeFuture.any</a></code> takes several futures
arguments (up to 6) and returns a future that is succeeded when one of the futures is, and failed when
all the futures are failed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/composite_future'</span>
Vertx::CompositeFuture.any(future1, future2).set_handler() { <span class="hljs-params">|ar_err,ar|</span>
  <span class="hljs-keyword">if</span> (ar_err == <span class="hljs-literal">nil</span>)
    <span class="hljs-comment"># At least one is succeeded</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-comment"># All failed</span>
  <span class="hljs-keyword">end</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A list of futures can be used also:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/composite_future'</span>
Vertx::CompositeFuture.any([f1, f2, f3])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>join</code> composition <em>waits</em> until all futures are completed, either with a success or a failure.
<code><a href="../../yardoc/Vertx/CompositeFuture.html#join-class_method">CompositeFuture.join</a></code> takes several futures arguments (up to 6) and returns a future that is
succeeded when all the futures are succeeded, and failed when all the futures are completed and at least one of
them is failed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/composite_future'</span>
Vertx::CompositeFuture.join(future1, future2, future3).set_handler() { <span class="hljs-params">|ar_err,ar|</span>
  <span class="hljs-keyword">if</span> (ar_err == <span class="hljs-literal">nil</span>)
    <span class="hljs-comment"># All succeeded</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-comment"># All completed and at least one failed</span>
  <span class="hljs-keyword">end</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A list of futures can be used also:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/composite_future'</span>
Vertx::CompositeFuture.join([future1, future2, future3])</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sequential_composition"><a class="anchor" href="#_sequential_composition"></a>Sequential composition</h3>
<div class="paragraph">
<p>While <code>all</code> and <code>any</code> are implementing concurrent composition, <code><a href="../../yardoc/Vertx/Future.html#compose-instance_method">compose</a></code> can be used
for chaining futures (so sequential composition).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/future'</span>
<span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/buffer'</span>

fs = vertx.file_system()

fut1 = Vertx::Future.future() { <span class="hljs-params">|promise|</span>
  fs.create_file(<span class="hljs-string">"/foo"</span>, &amp;promise)
}

startFuture = fut1.compose(lambda { <span class="hljs-params">|v|</span>
  <span class="hljs-comment"># When the file is created (fut1), execute this:</span>
  <span class="hljs-keyword">return</span> Vertx::Future.future() { <span class="hljs-params">|promise|</span>
    fs.write_file(<span class="hljs-string">"/foo"</span>, Vertx::Buffer.buffer(), &amp;promise)
  }
}).compose(lambda { <span class="hljs-params">|v|</span>
  <span class="hljs-comment"># When the file is written (fut2), execute this:</span>
  <span class="hljs-keyword">return</span> Vertx::Future.future() { <span class="hljs-params">|promise|</span>
    fs.move(<span class="hljs-string">"/foo"</span>, <span class="hljs-string">"/bar"</span>, &amp;promise)
  }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, 3 operations are chained:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a file is created (<code>fut1</code>)</p>
</li>
<li>
<p>something is written in the file (<code>fut2</code>)</p>
</li>
<li>
<p>the file is moved (<code>startFuture</code>)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When these 3 steps are successful, the final future (<code>startFuture</code>) is succeeded. However, if one
of the steps fails, the final future is failed.</p>
</div>
<div class="paragraph">
<p>This example uses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../../yardoc/Vertx/Future.html#compose-instance_method">compose</a></code>: when the current future completes,
run the given function, that returns a future. When this returned future completes, it completes the composition.</p>
</li>
<li>
<p><code><a href="../../yardoc/Vertx/Future.html#compose-instance_method">compose</a></code>: when the current future
completes, run the given handler that completes the given <code>future</code> (next).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this second case, the <code><a href="unavailable">Handler</a></code> should complete the <code>next</code> future to report its success or
failure.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_verticles"><a class="anchor" href="#_verticles"></a>Verticles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x comes with a simple, scalable, <em>actor-like</em> deployment and concurrency model out of the box that
you can use to save you writing your own.</p>
</div>
<div class="paragraph">
<p><strong>This model is entirely optional and Vert.x does not force you to create your applications in this way if you don&#8217;t
want to.</strong>.</p>
</div>
<div class="paragraph">
<p>The model does not claim to be a strict actor-model implementation, but it does share similarities especially
with respect to concurrency, scaling and deployment.</p>
</div>
<div class="paragraph">
<p>To use this model, you write your code as set of <strong>verticles</strong>.</p>
</div>
<div class="paragraph">
<p>Verticles are chunks of code that get deployed and run by Vert.x. A Vert.x instance maintains N event loop threads
(where N by default is core*2) by default. Verticles can be written in any of the languages that Vert.x supports
and a single application can include verticles written in multiple languages.</p>
</div>
<div class="paragraph">
<p>You can think of a verticle as a bit like an actor in the <a href="http://en.wikipedia.org/wiki/Actor_model">Actor Model</a>.</p>
</div>
<div class="paragraph">
<p>An application would typically be composed of many verticle instances running in the same Vert.x instance at the same
time. The different verticle instances communicate with each other by sending messages on the <a href="#event_bus">event bus</a>.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::override/verticles.adoc[]</p>
</div>
<div class="sect2">
<h3 id="_verticle_types"><a class="anchor" href="#_verticle_types"></a>Verticle Types</h3>
<div class="paragraph">
<p>There are three different types of verticles:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Standard Verticles</dt>
<dd>
<p>These are the most common and useful type - they are always executed using an event loop thread.
We&#8217;ll discuss this more in the next section.</p>
</dd>
<dt class="hdlist1">Worker Verticles</dt>
<dd>
<p>These run using a thread from the worker pool. An instance is never executed concurrently by more
than one thread.</p>
</dd>
<dt class="hdlist1">Multi-threaded worker verticles</dt>
<dd>
<p>These run using a thread from the worker pool. An instance can be executed concurrently by more
than one thread.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_standard_verticles"><a class="anchor" href="#_standard_verticles"></a>Standard verticles</h3>
<div class="paragraph">
<p>Standard verticles are assigned an event loop thread when they are created and the start method is called with that
event loop. When you call any other methods that takes a handler on a core API from an event loop then Vert.x
will guarantee that those handlers, when called, will be executed on the same event loop.</p>
</div>
<div class="paragraph">
<p>This means we can guarantee that all the code in your verticle instance is always executed on the same event loop (as
long as you don&#8217;t create your own threads and call it!).</p>
</div>
<div class="paragraph">
<p>This means you can write all the code in your application as single threaded and let Vert.x worry about the threading
and scaling. No more worrying about synchronized and volatile any more, and you also avoid many other cases of race conditions
and deadlock so prevalent when doing hand-rolled 'traditional' multi-threaded application development.</p>
</div>
</div>
<div class="sect2">
<h3 id="worker_verticles"><a class="anchor" href="#worker_verticles"></a>Worker verticles</h3>
<div class="paragraph">
<p>A worker verticle is just like a standard verticle but it&#8217;s executed using a thread from the Vert.x worker thread pool,
rather than using an event loop.</p>
</div>
<div class="paragraph">
<p>Worker verticles are designed for calling blocking code, as they won&#8217;t block any event loops.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t want to use a worker verticle to run blocking code, you can also run <a href="#blocking_code">inline blocking code</a>
directly while on an event loop.</p>
</div>
<div class="paragraph">
<p>If you want to deploy a verticle as a worker verticle you do that with <code><a href="../dataobjects.html#DeploymentOptions#set_worker-instance_method">worker</a></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">options = {
  <span class="hljs-string">'worker'</span> =&gt; <span class="hljs-literal">true</span>
}
vertx.deploy_verticle(<span class="hljs-string">"com.mycompany.MyOrderProcessorVerticle"</span>, options)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Worker verticle instances are never executed concurrently by Vert.x by more than one thread, but can executed by
different threads at different times.</p>
</div>
<div class="sect3">
<h4 id="_multi_threaded_worker_verticles"><a class="anchor" href="#_multi_threaded_worker_verticles"></a>Multi-threaded worker verticles</h4>
<div class="paragraph">
<p>A multi-threaded worker verticle is just like a normal worker verticle but it <strong>can</strong> be executed concurrently by
different threads.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Multi-threaded worker verticles are an advanced feature and most applications will have no need for them.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Because of the concurrency in these verticles you have to be very careful to keep the verticle in a consistent state
using standard Java techniques for multi-threaded programming.</p>
</div>
<div class="paragraph">
<p>Multi-threaded worker verticles were designed and are intended for the sole use of consuming simultaneously <code>EventBus</code> messages in a blocking fashion.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Vert.x clients and servers (TCP, HTTP, &#8230;&#8203;etc) cannot be created in a multi-threaded worker verticle.
Should you incidentally try, an exception will be thrown.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Essentially, multi-threaded worker verticles simply avoid the user from deploying as much instances of a worker verticle as the number of threads in a worker pool.
So you could for example provide a worker pool name/size in <code><a href="../dataobjects.html#DeploymentOptions">DeploymentOptions</a></code> and set the number of instances accordingly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">options = {
  <span class="hljs-string">'worker'</span> =&gt; <span class="hljs-literal">true</span>,
  <span class="hljs-string">'instances'</span> =&gt; <span class="hljs-number">5</span>,
  <span class="hljs-string">'workerPoolName'</span> =&gt; <span class="hljs-string">"the-specific-pool"</span>,
  <span class="hljs-string">'workerPoolSize'</span> =&gt; <span class="hljs-number">5</span>
}
vertx.deploy_verticle(<span class="hljs-string">"com.mycompany.MyOrderProcessorVerticle"</span>, options)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you could create a regular verticle and wrap you blocking code with multiple <code>executeBlocking</code> with the <code>ordered</code> flag set to <code>false</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">vertx.event_bus().consumer(<span class="hljs-string">"foo"</span>) { <span class="hljs-params">|msg|</span>
  vertx.execute_blocking(lambda { <span class="hljs-params">|promise|</span>
    <span class="hljs-comment"># Invoke blocking code with received message data</span>
    promise.complete(someresult)
  }, <span class="hljs-literal">false</span>) { <span class="hljs-params">|ar_err,ar|</span>
    <span class="hljs-comment"># Handle result, e.g. reply to the message</span>
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploying_verticles_programmatically"><a class="anchor" href="#_deploying_verticles_programmatically"></a>Deploying verticles programmatically</h3>
<div class="paragraph">
<p>You can deploy a verticle using one of the <code><a href="../../yardoc/Vertx/Vertx.html#deploy_verticle-instance_method">deployVerticle</a></code> method, specifying a verticle
name or you can pass in a verticle instance you have already created yourself.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Deploying Verticle <strong>instances</strong> is Java only.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">myVerticle = Java::ExamplesCoreExamples::MyVerticle.<span class="hljs-keyword">new</span>()
vertx.deploy_verticle(myVerticle)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also deploy verticles by specifying the verticle <strong>name</strong>.</p>
</div>
<div class="paragraph">
<p>The verticle name is used to look up the specific <code><a href="unavailable">VerticleFactory</a></code> that will be used to
instantiate the actual verticle instance(s).</p>
</div>
<div class="paragraph">
<p>Different verticle factories are available for instantiating verticles in different languages and for various other
reasons such as loading services and getting verticles from Maven at run-time.</p>
</div>
<div class="paragraph">
<p>This allows you to deploy verticles written in any language from any other language that Vert.x supports.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of deploying some different types of verticles:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-comment"># Deploy a Java verticle - the name is the fully qualified class name of the verticle class</span>
vertx.deploy_verticle(<span class="hljs-string">"com.mycompany.MyOrderProcessorVerticle"</span>)

<span class="hljs-comment"># Deploy a JavaScript verticle</span>
vertx.deploy_verticle(<span class="hljs-string">"verticles/myverticle.js"</span>)

<span class="hljs-comment"># Deploy a Ruby verticle verticle</span>
vertx.deploy_verticle(<span class="hljs-string">"verticles/my_verticle.rb"</span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rules_for_mapping_a_verticle_name_to_a_verticle_factory"><a class="anchor" href="#_rules_for_mapping_a_verticle_name_to_a_verticle_factory"></a>Rules for mapping a verticle name to a verticle factory</h3>
<div class="paragraph">
<p>When deploying verticle(s) using a name, the name is used to select the actual verticle factory that will instantiate
the verticle(s).</p>
</div>
<div class="paragraph">
<p>Verticle names can have a prefix - which is a string followed by a colon, which if present will be used to look-up the factory, e.g.</p>
</div>
<div class="paragraph">
<p>js:foo.js // Use the JavaScript verticle factory
groovy:com.mycompany.SomeGroovyCompiledVerticle // Use the Groovy verticle factory
service:com.mycompany:myorderservice // Uses the service verticle factory</p>
</div>
<div class="paragraph">
<p>If no prefix is present, Vert.x will look for a suffix and use that to lookup the factory, e.g.</p>
</div>
<div class="paragraph">
<p>foo.js // Will also use the JavaScript verticle factory
SomeScript.groovy // Will use the Groovy verticle factory</p>
</div>
<div class="paragraph">
<p>If no prefix or suffix is present, Vert.x will assume it&#8217;s a Java fully qualified class name (FQCN) and try
and instantiate that.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_are_verticle_factories_located"><a class="anchor" href="#_how_are_verticle_factories_located"></a>How are Verticle Factories located?</h3>
<div class="paragraph">
<p>Most Verticle factories are loaded from the classpath and registered at Vert.x startup.</p>
</div>
<div class="paragraph">
<p>You can also programmatically register and unregister verticle factories using <code><a href="../../yardoc/Vertx/Vertx.html#register_verticle_factory-instance_method">registerVerticleFactory</a></code>
and <code><a href="../../yardoc/Vertx/Vertx.html#unregister_verticle_factory-instance_method">unregisterVerticleFactory</a></code> if you wish.</p>
</div>
</div>
<div class="sect2">
<h3 id="_waiting_for_deployment_to_complete"><a class="anchor" href="#_waiting_for_deployment_to_complete"></a>Waiting for deployment to complete</h3>
<div class="paragraph">
<p>Verticle deployment is asynchronous and may complete some time after the call to deploy has returned.</p>
</div>
<div class="paragraph">
<p>If you want to be notified when deployment is complete you can deploy specifying a completion handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">vertx.deploy_verticle(<span class="hljs-string">"com.mycompany.MyOrderProcessorVerticle"</span>) { <span class="hljs-params">|res_err,res|</span>
  <span class="hljs-keyword">if</span> (res_err == <span class="hljs-literal">nil</span>)
    puts <span class="hljs-string">"Deployment id is: <span class="hljs-subst">#{res}</span>"</span>
  <span class="hljs-keyword">else</span>
    puts <span class="hljs-string">"Deployment failed!"</span>
  <span class="hljs-keyword">end</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The completion handler will be passed a result containing the deployment ID string, if deployment succeeded.</p>
</div>
<div class="paragraph">
<p>This deployment ID can be used later if you want to undeploy the deployment.</p>
</div>
</div>
<div class="sect2">
<h3 id="_undeploying_verticle_deployments"><a class="anchor" href="#_undeploying_verticle_deployments"></a>Undeploying verticle deployments</h3>
<div class="paragraph">
<p>Deployments can be undeployed with <code><a href="../../yardoc/Vertx/Vertx.html#undeploy-instance_method">undeploy</a></code>.</p>
</div>
<div class="paragraph">
<p>Un-deployment is itself asynchronous so if you want to be notified when un-deployment is complete you can deploy specifying a completion handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">vertx.undeploy(deploymentID) { <span class="hljs-params">|res_err,res|</span>
  <span class="hljs-keyword">if</span> (res_err == <span class="hljs-literal">nil</span>)
    puts <span class="hljs-string">"Undeployed ok"</span>
  <span class="hljs-keyword">else</span>
    puts <span class="hljs-string">"Undeploy failed!"</span>
  <span class="hljs-keyword">end</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_specifying_number_of_verticle_instances"><a class="anchor" href="#_specifying_number_of_verticle_instances"></a>Specifying number of verticle instances</h3>
<div class="paragraph">
<p>When deploying a verticle using a verticle name, you can specify the number of verticle instances that you
want to deploy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">options = {
  <span class="hljs-string">'instances'</span> =&gt; <span class="hljs-number">16</span>
}
vertx.deploy_verticle(<span class="hljs-string">"com.mycompany.MyOrderProcessorVerticle"</span>, options)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is useful for scaling easily across multiple cores. For example you might have a web-server verticle to deploy
and multiple cores on your machine, so you want to deploy multiple instances to utilise all the cores.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::override/verticle-configuration.adoc[]</p>
</div>
</div>
<div class="sect2">
<h3 id="_verticle_isolation_groups"><a class="anchor" href="#_verticle_isolation_groups"></a>Verticle Isolation Groups</h3>
<div class="paragraph">
<p>By default, Vert.x has a <em>flat classpath</em>. I.e, when Vert.x deploys verticles it does so with the current classloader -
it doesn&#8217;t create a new one. In the majority of cases this is the simplest, clearest, and sanest thing to do.</p>
</div>
<div class="paragraph">
<p>However, in some cases you may want to deploy a verticle so the classes of that verticle are isolated from others in
your application.</p>
</div>
<div class="paragraph">
<p>This might be the case, for example, if you want to deploy two different versions of a verticle with the same class name
in the same Vert.x instance, or if you have two different verticles which use different versions of the same jar library.</p>
</div>
<div class="paragraph">
<p>When using an isolation group you provide a list of the class names that you want isolated using
<code><a href="../dataobjects.html#DeploymentOptions#set_isolated_classes-instance_method">isolatedClasses</a></code>-  an entry can be a fully qualified
classname such as <code>com.mycompany.myproject.engine.MyClass</code> or it can be a wildcard which will match any classes in a package and any
sub-packages, e.g. <code>com.mycompany.myproject.*</code> would match any classes in the package <code>com.mycompany.myproject</code> or
any sub-packages.</p>
</div>
<div class="paragraph">
<p>Please note that <em>only</em> the classes that match will be isolated - any other classes will be loaded by the current
class loader.</p>
</div>
<div class="paragraph">
<p>Extra classpath entries can also be provided with <code><a href="../dataobjects.html#DeploymentOptions#set_extra_classpath-instance_method">extraClasspath</a></code> so if
you want to load classes or resources that aren&#8217;t already present on the main classpath you can add this.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Use this feature with caution. Class-loaders can be a can of worms, and can make debugging difficult, amongst
other things.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of using an isolation group to isolate a verticle deployment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">options = {
  <span class="hljs-string">'isolationGroup'</span> =&gt; <span class="hljs-string">"mygroup"</span>
}
options[<span class="hljs-string">'isolatedClasses'</span>] = [<span class="hljs-string">"com.mycompany.myverticle.*"</span>, <span class="hljs-string">"com.mycompany.somepkg.SomeClass"</span>, <span class="hljs-string">"org.somelibrary.*"</span>]
vertx.deploy_verticle(<span class="hljs-string">"com.mycompany.myverticle.VerticleClass"</span>, options)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_high_availability"><a class="anchor" href="#_high_availability"></a>High Availability</h3>
<div class="paragraph">
<p>Verticles can be deployed with High Availability (HA) enabled. In that context, when a verticle is deployed on
a vert.x instance that dies abruptly, the verticle is redeployed on another vert.x instance from the cluster.</p>
</div>
<div class="paragraph">
<p>To run an verticle with the high availability enabled, just append the <code>-ha</code> switch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-verticle.js -ha</code></pre>
</div>
</div>
<div class="paragraph">
<p>When enabling high availability, no need to add <code>-cluster</code>.</p>
</div>
<div class="paragraph">
<p>More details about the high availability feature and configuration in the <a href="#_high_availability_and_fail_over">High Availability and Fail-Over</a>
 section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_running_verticles_from_the_command_line"><a class="anchor" href="#_running_verticles_from_the_command_line"></a>Running Verticles from the command line</h3>
<div class="paragraph">
<p>You can use Vert.x directly in your Maven or Gradle projects in the normal way by adding a dependency to the Vert.x
core library and hacking from there.</p>
</div>
<div class="paragraph">
<p>However you can also run Vert.x verticles directly from the command line if you wish.</p>
</div>
<div class="paragraph">
<p>To do this you need to download and install a Vert.x distribution, and add the <code>bin</code> directory of the installation
to your <code>PATH</code> environment variable. Also make sure you have a Java 8 JDK on your <code>PATH</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The JDK is required to support on the fly compilation of Java code.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can now run verticles by using the <code>vertx run</code> command. Here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Run a JavaScript verticle
vertx run my_verticle.js

# Run a Ruby verticle
vertx run a_n_other_verticle.rb

# Run a Groovy script verticle, clustered
vertx run FooVerticle.groovy -cluster</pre>
</div>
</div>
<div class="paragraph">
<p>You can even run Java source verticles without compiling them first!</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vertx run SomeJavaSourceFile.java</pre>
</div>
</div>
<div class="paragraph">
<p>Vert.x will compile the Java source file on the fly before running it. This is really useful for quickly
prototyping verticles and great for demos. No need to set-up a Maven or Gradle build first to get going!</p>
</div>
<div class="paragraph">
<p>For full information on the various options available when executing <code>vertx</code> on the command line,
type <code>vertx</code> at the command line.</p>
</div>
</div>
<div class="sect2">
<h3 id="_causing_vert_x_to_exit"><a class="anchor" href="#_causing_vert_x_to_exit"></a>Causing Vert.x to exit</h3>
<div class="paragraph">
<p>Threads maintained by Vert.x instances are not daemon threads so they will prevent the JVM from exiting.</p>
</div>
<div class="paragraph">
<p>If you are embedding Vert.x and you have finished with it, you can call <code><a href="../../yardoc/Vertx/Vertx.html#close-instance_method">close</a></code> to close it
down.</p>
</div>
<div class="paragraph">
<p>This will shut-down all internal thread pools and close other resources, and will allow the JVM to exit.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_context_object"><a class="anchor" href="#_the_context_object"></a>The Context object</h3>
<div class="paragraph">
<p>When Vert.x provides an event to a handler or calls the start or stop methods of a
<code><a href="unavailable">Verticle</a></code>, the execution is associated with a <code>Context</code>. Usually a context is an
<strong>event-loop context</strong> and is tied to a specific event loop thread. So executions for that context always occur
on that exact same event loop thread. In the case of worker verticles and running inline blocking code a
worker context will be associated with the execution which will use a thread from the worker thread pool.</p>
</div>
<div class="paragraph">
<p>To retrieve the context, use the <code><a href="../../yardoc/Vertx/Vertx.html#get_or_create_context-instance_method">getOrCreateContext</a></code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">context = vertx.get_or_create_context()</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the current thread has a context associated with it, it reuses the context object. If not a new instance of
context is created. You can test the <em>type</em> of context you have retrieved:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/context'</span>
context = vertx.get_or_create_context()
<span class="hljs-keyword">if</span> (context.event_loop_context?())
  puts <span class="hljs-string">"Context attached to Event Loop"</span>
<span class="hljs-keyword">elsif</span> (context.worker_context?())
  puts <span class="hljs-string">"Context attached to Worker Thread"</span>
<span class="hljs-keyword">elsif</span> (context.multi_threaded_worker_context?())
  puts <span class="hljs-string">"Context attached to Worker Thread - multi threaded worker"</span>
<span class="hljs-keyword">elsif</span> (!Vertx::Context.on_vertx_thread?())
  puts <span class="hljs-string">"Context not attached to a thread managed by vert.x"</span>
<span class="hljs-keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When you have retrieved the context object, you can run code in this context asynchronously. In other words,
you submit a task that will be eventually run in the same context, but later:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">vertx.get_or_create_context().run_on_context() { <span class="hljs-params">|v|</span>
  puts <span class="hljs-string">"This will be executed asynchronously in the same context"</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When several handlers run in the same context, they may want to share data. The context object offers methods to
store and retrieve data shared in the context. For instance, it lets you pass data to some action run with
<code><a href="../../yardoc/Vertx/Context.html#run_on_context-instance_method">runOnContext</a></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">context = vertx.get_or_create_context()
context.put(<span class="hljs-string">"data"</span>, <span class="hljs-string">"hello"</span>)
context.run_on_context() { <span class="hljs-params">|v|</span>
  hello = context.get(<span class="hljs-string">"data"</span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The context object also let you access verticle configuration using the <code><a href="../../yardoc/Vertx/Context.html#config-instance_method">config</a></code>
method. Check the <a href="#Passing configuration to a verticle">[Passing configuration to a verticle]</a> section for more details about this configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_executing_periodic_and_delayed_actions"><a class="anchor" href="#_executing_periodic_and_delayed_actions"></a>Executing periodic and delayed actions</h3>
<div class="paragraph">
<p>It&#8217;s very common in Vert.x to want to perform an action after a delay, or periodically.</p>
</div>
<div class="paragraph">
<p>In standard verticles you can&#8217;t just make the thread sleep to introduce a delay, as that will block the event loop thread.</p>
</div>
<div class="paragraph">
<p>Instead you use Vert.x timers. Timers can be <strong>one-shot</strong> or <strong>periodic</strong>. We&#8217;ll discuss both</p>
</div>
<div class="sect3">
<h4 id="_one_shot_timers"><a class="anchor" href="#_one_shot_timers"></a>One-shot Timers</h4>
<div class="paragraph">
<p>A one shot timer calls an event handler after a certain delay, expressed in milliseconds.</p>
</div>
<div class="paragraph">
<p>To set a timer to fire once you use <code><a href="../../yardoc/Vertx/Vertx.html#set_timer-instance_method">setTimer</a></code> method passing in the delay and a handler</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">timerID = vertx.set_timer(<span class="hljs-number">1000</span>) { <span class="hljs-params">|id|</span>
  puts <span class="hljs-string">"And one second later this is printed"</span>
}

puts <span class="hljs-string">"First this is printed"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The return value is a unique timer id which can later be used to cancel the timer. The handler is also passed the timer id.</p>
</div>
</div>
<div class="sect3">
<h4 id="_periodic_timers"><a class="anchor" href="#_periodic_timers"></a>Periodic Timers</h4>
<div class="paragraph">
<p>You can also set a timer to fire periodically by using <code><a href="../../yardoc/Vertx/Vertx.html#set_periodic-instance_method">setPeriodic</a></code>.</p>
</div>
<div class="paragraph">
<p>There will be an initial delay equal to the period.</p>
</div>
<div class="paragraph">
<p>The return value of <code>setPeriodic</code> is a unique timer id (long). This can be later used if the timer needs to be cancelled.</p>
</div>
<div class="paragraph">
<p>The argument passed into the timer event handler is also the unique timer id:</p>
</div>
<div class="paragraph">
<p>Keep in mind that the timer will fire on a periodic basis. If your periodic treatment takes a long amount of time to proceed,
your timer events could run continuously or even worse : stack up.</p>
</div>
<div class="paragraph">
<p>In this case, you should consider using <code><a href="../../yardoc/Vertx/Vertx.html#set_timer-instance_method">setTimer</a></code> instead. Once your treatment has
finished, you can set the next timer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">timerID = vertx.set_periodic(<span class="hljs-number">1000</span>) { <span class="hljs-params">|id|</span>
  puts <span class="hljs-string">"And every second this is printed"</span>
}

puts <span class="hljs-string">"First this is printed"</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cancelling_timers"><a class="anchor" href="#_cancelling_timers"></a>Cancelling timers</h4>
<div class="paragraph">
<p>To cancel a periodic timer, call <code><a href="../../yardoc/Vertx/Vertx.html#cancel_timer-instance_method">cancelTimer</a></code> specifying the timer id. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">vertx.cancel_timer?(timerID)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_automatic_clean_up_in_verticles"><a class="anchor" href="#_automatic_clean_up_in_verticles"></a>Automatic clean-up in verticles</h4>
<div class="paragraph">
<p>If you&#8217;re creating timers from inside verticles, those timers will be automatically closed
when the verticle is undeployed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_verticle_worker_pool"><a class="anchor" href="#_verticle_worker_pool"></a>Verticle worker pool</h3>
<div class="paragraph">
<p>Verticles use the Vert.x worker pool for executing blocking actions, i.e <code><a href="../../yardoc/Vertx/Context.html#execute_blocking-instance_method">executeBlocking</a></code> or
worker verticle.</p>
</div>
<div class="paragraph">
<p>A different worker pool can be specified in deployment options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">vertx.deploy_verticle(<span class="hljs-string">"the-verticle"</span>, {
  <span class="hljs-string">'workerPoolName'</span> =&gt; <span class="hljs-string">"the-specific-pool"</span>
})</code></pre>
</div>
</div>
<div id="event_bus" class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::eventbus.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::override/json.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::json-pointers.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::buffers.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::net.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::http.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::shareddata.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::filesystem.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::datagrams.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::dns.adoc[]</p>
</div>
<div id="streams" class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::streams.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::parsetools.adoc[]</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_thread_safety"><a class="anchor" href="#_thread_safety"></a>Thread safety</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most Vert.x objects are safe to access from different threads. <em>However</em> performance is optimised when they are
accessed from the same context they were created from.</p>
</div>
<div class="paragraph">
<p>For example if you have deployed a verticle which creates a <code><a href="../../yardoc/Vertx/NetServer.html">NetServer</a></code> which provides
<code><a href="../../yardoc/Vertx/NetSocket.html">NetSocket</a></code> instances in it&#8217;s handler, then it&#8217;s best to always access that socket instance
from the event loop of the verticle.</p>
</div>
<div class="paragraph">
<p>If you stick to the standard Vert.x verticle deployment model and avoid sharing objects between verticles then this
should be the case without you having to think about it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_metrics_spi"><a class="anchor" href="#_metrics_spi"></a>Metrics SPI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default Vert.x does not record any metrics. Instead it provides an SPI for others to implement which can be added
to the classpath. The metrics SPI is an advanced feature which allows implementers to capture events from Vert.x in
order to gather metrics. For more information on this, please consult the
<code><a href="unavailable">API Documentation</a></code>.</p>
</div>
<div class="paragraph">
<p>You can also specify a metrics factory programmatically if embedding Vert.x using
<code><a href="../dataobjects.html#MetricsOptions#set_factory-instance_method">factory</a></code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_osgi"><a class="anchor" href="#_osgi"></a>OSGi</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Core is packaged as an OSGi bundle, so can be used in any OSGi R4.2+ environment such as Apache Felix
or Eclipse Equinox. The bundle exports <code>io.vertx.core*</code>.</p>
</div>
<div class="paragraph">
<p>However, the bundle has some dependencies on Jackson and Netty. To get the vert.x core bundle resolved deploy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jackson Annotation [2.6.0,3)</p>
</li>
<li>
<p>Jackson Core [2.6.2,3)</p>
</li>
<li>
<p>Jackson Databind [2.6.2,3)</p>
</li>
<li>
<p>Netty Buffer [4.0.31,5)</p>
</li>
<li>
<p>Netty Codec [4.0.31,5)</p>
</li>
<li>
<p>Netty Codec/Socks [4.0.31,5)</p>
</li>
<li>
<p>Netty Codec/Common [4.0.31,5)</p>
</li>
<li>
<p>Netty Codec/Handler [4.0.31,5)</p>
</li>
<li>
<p>Netty Codec/Transport [4.0.31,5)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is a working deployment on Apache Felix 5.2.0:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>14|Active     |    1|Jackson-annotations (2.6.0)
15|Active     |    1|Jackson-core (2.6.2)
16|Active     |    1|jackson-databind (2.6.2)
18|Active     |    1|Netty/Buffer (4.0.31.Final)
19|Active     |    1|Netty/Codec (4.0.31.Final)
20|Active     |    1|Netty/Codec/HTTP (4.0.31.Final)
21|Active     |    1|Netty/Codec/Socks (4.0.31.Final)
22|Active     |    1|Netty/Common (4.0.31.Final)
23|Active     |    1|Netty/Handler (4.0.31.Final)
24|Active     |    1|Netty/Transport (4.0.31.Final)
25|Active     |    1|Netty/Transport/SCTP (4.0.31.Final)
26|Active     |    1|Vert.x Core (3.1.0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Equinox, you may want to disable the <code>ContextFinder</code> with the following framework property:
<code>eclipse.bundle.setTCCL=false</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_vertx_command_line"><a class="anchor" href="#_the_vertx_command_line"></a>The 'vertx' command line</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>vertx</code> command is used to interact with Vert.x from the command line. It&#8217;s main use is to run Vert.x verticles.
To do this you need to download and install a Vert.x distribution, and add the <code>bin</code> directory of the installation
to your <code>PATH</code> environment variable. Also make sure you have a Java 8 JDK on your <code>PATH</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The JDK is required to support on the fly compilation of Java code.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_run_verticles"><a class="anchor" href="#_run_verticles"></a>Run verticles</h3>
<div class="paragraph">
<p>You can run raw Vert.x verticles directly from the command line using <code>vertx run</code>. Here is a couple of examples of
the <code>run</code> <em>command</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-verticle.js                                 (1)
vertx run my-verticle.groovy                             (2)
vertx run my-verticle.rb                                 (3)

vertx run io.vertx.example.MyVerticle                    (4)
vertx run io.vertx.example.MVerticle -cp my-verticle.jar (5)

vertx run MyVerticle.java                                (6)</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploys a JavaScript verticle</p>
</li>
<li>
<p>Deploys a Groovy verticle</p>
</li>
<li>
<p>Deploys a Ruby verticle</p>
</li>
<li>
<p>Deploys an already compiled Java verticle. Classpath root is the current directory</p>
</li>
<li>
<p>Deploys a verticle packaged in a Jar, the jar need to be in the classpath</p>
</li>
<li>
<p>Compiles the Java source and deploys it</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>As you can see in the case of Java, the name can either be the fully qualified class name of the verticle, or
you can specify the Java Source file directly and Vert.x compiles it for you.</p>
</div>
<div class="paragraph">
<p>You can also prefix the verticle with the name of the language implementation to use. For example if the verticle is
a compiled Groovy class, you prefix it with <code>groovy:</code> so that Vert.x knows it&#8217;s a Groovy class not a Java class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run groovy:io.vertx.example.MyGroovyVerticle</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vertx run</code> command can take a few optional parameters, they are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-options &lt;options&gt;</code> - Provides the Vert.x options.
<code>options</code> is the name of a JSON file that represents the Vert.x options, or a JSON string. This is optional.</p>
</li>
<li>
<p><code>-conf &lt;config&gt;</code> - Provides some configuration to the verticle.
<code>config</code> is the name of a JSON file that represents the configuration for the verticle, or a JSON string. This is optional.</p>
</li>
<li>
<p><code>-cp &lt;path&gt;</code> - The path on which to search for the verticle and any other resources used by the verticle. This
defaults to <code>.</code> (current directory). If your verticle references other scripts, classes or other resources
(e.g. jar files) then make sure these are on this path. The path can contain multiple path entries separated by
<code>:</code> (colon) or <code>;</code> (semi-colon) depending on the operating system. Each path entry can be an absolute or relative
path to a directory containing scripts, or absolute or relative filenames for jar or zip files. An example path
might be <code>-cp classes:lib/otherscripts:jars/myjar.jar:jars/otherjar.jar</code>. Always use the path to reference any
resources that your verticle requires. Do <strong>not</strong> put them on the system classpath as this can cause isolation
issues between deployed verticles.</p>
</li>
<li>
<p><code>-instances &lt;instances&gt;</code>  - The number of instances of the verticle to instantiate. Each verticle instance is
strictly single threaded so to scale your application across available cores you might want to deploy more than
one instance. If omitted a single instance will be deployed.</p>
</li>
<li>
<p><code>-worker</code> - This option determines whether the verticle is a worker verticle or not.</p>
</li>
<li>
<p><code>-cluster</code> -  This option determines whether the Vert.x instance will attempt to form a cluster with other Vert.x
instances on the network. Clustering Vert.x instances allows Vert.x to form a distributed event bus with
other nodes. Default is <code>false</code> (not clustered).</p>
</li>
<li>
<p><code>-cluster-port</code> - If the <code>cluster</code> option has also been specified then this determines which port will be bound for
cluster communication with other Vert.x instances. Default is <code>0</code> - which means '<em>choose a free random port</em>'. You
don&#8217;t usually need to specify this parameter unless you really need to bind to a specific port.</p>
</li>
<li>
<p><code>-cluster-host</code> - If the <code>cluster</code> option has also been specified then this determines which host address will be
bound for cluster communication with other Vert.x instances. By default it will try and pick one from the available
interfaces. If you have more than one interface and you want to use a specific one, specify it here.</p>
</li>
<li>
<p><code>-cluster-public-port</code> - If the <code>cluster</code> option has also been specified then this determines which port will be advertised for
cluster communication with other Vert.x instances. Default is <code>-1</code>, which means same as <code>cluster-port</code>.</p>
</li>
<li>
<p><code>-cluster-public-host</code> - If the <code>cluster</code> option has also been specified then this determines which host address will be advertised for
cluster communication with other Vert.x instances. If not specified, Vert.x uses the value of <code>cluster-host</code>.</p>
</li>
<li>
<p><code>-ha</code> - if specified the verticle will be deployed as  high availability (HA) deployment. See related section
for more details</p>
</li>
<li>
<p><code>-quorum</code> - used in conjunction with <code>-ha</code>. It specifies the minimum number of nodes in the cluster for any <em>HA
deploymentIDs</em> to be active. Defaults to 0.</p>
</li>
<li>
<p><code>-hagroup</code> - used in conjunction with <code>-ha</code>. It specifies the HA group this node will join. There can be
multiple HA groups in a cluster. Nodes will only failover to other nodes in the same group. The default value is `
__DEFAULT__`</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also set system properties using: <code>-Dkey=value</code>.</p>
</div>
<div class="paragraph">
<p>Here are some more examples:</p>
</div>
<div class="paragraph">
<p>Run a JavaScript verticle server.js with default settings</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run server.js</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run 10 instances of a pre-compiled Java verticle specifying classpath</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run com.acme.MyVerticle -cp "classes:lib/myjar.jar" -instances 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run 10 instances of a Java verticle by source <em>file</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run MyVerticle.java -instances 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run 20 instances of a ruby worker verticle</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run order_worker.rb -instances 20 -worker</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run two JavaScript verticles on the same machine and let them cluster together with each other and any other servers
on the network</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run handler.js -cluster
vertx run sender.js -cluster</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run a Ruby verticle passing it some config</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my_verticle.rb -conf my_verticle.conf</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>my_verticle.conf</code> might contain something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
<span class="hljs-attr">"name"</span>: <span class="hljs-string">"foo"</span>,
<span class="hljs-attr">"num_widgets"</span>: <span class="hljs-number">46</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The config will be available inside the verticle via the core API.</p>
</div>
<div class="paragraph">
<p>When using the high-availability feature of vert.x you may want to create a <em>bare</em> instance of vert.x. This
instance does not deploy any verticles when launched, but will receive a verticle if another node of the cluster
dies. To create a <em>bare</em> instance, launch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx bare</code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on your cluster configuration, you may have to append the <code>cluster-host</code> and <code>cluster-port</code> parameters.</p>
</div>
</div>
<div class="sect2">
<h3 id="_executing_a_vert_x_application_packaged_as_a_fat_jar"><a class="anchor" href="#_executing_a_vert_x_application_packaged_as_a_fat_jar"></a>Executing a Vert.x application packaged as a fat jar</h3>
<div class="paragraph">
<p>A <em>fat jar</em> is an executable jar embedding its dependencies. This means you don&#8217;t have to have Vert.x pre-installed
on the machine on which you execute the jar. Like any executable Java jar it can be executed with.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java -jar my-application-fat.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is nothing really Vert.x specific about this, you could do this with any Java application</p>
</div>
<div class="paragraph">
<p>You can either create your own main class and specify that in the manifest, but it&#8217;s recommended that you write your
code as verticles and use the Vert.x <code><a href="unavailable">Launcher</a></code> class (<code>io.vertx.core.Launcher</code>) as your main
class. This is the same main class used when running Vert.x at the command line and therefore allows you to
specify command line arguments, such as <code>-instances</code> in order to scale your application more easily.</p>
</div>
<div class="paragraph">
<p>To deploy your verticle in a <em>fatjar</em> like this you must have a <em>manifest</em> with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Main-Class</code> set to <code>io.vertx.core.Launcher</code></p>
</li>
<li>
<p><code>Main-Verticle</code> specifying the main verticle (fully qualified class name or script file name)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also provide the usual command line arguments that you would pass to <code>vertx run</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java -jar my-verticle-fat.jar -cluster -conf myconf.json
java -jar my-verticle-fat.jar -cluster -conf myconf.json -cp path/to/dir/conf/cluster_xml</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please consult the Maven/Gradle simplest and Maven/Gradle verticle examples in the examples repository for
examples of building applications as fatjars.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A fat jar executes the <code>run</code> command, by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="_displaying_version_of_vert_x"><a class="anchor" href="#_displaying_version_of_vert_x"></a>Displaying version of Vert.x</h3>
<div class="paragraph">
<p>To display the vert.x version, just launch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx version</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_other_commands"><a class="anchor" href="#_other_commands"></a>Other commands</h3>
<div class="paragraph">
<p>The <code>vertx</code> command line and the <code>Launcher</code> also provide other <em>commands</em> in addition to <code>run</code> and <code>version</code>:</p>
</div>
<div class="paragraph">
<p>You can create a <code>bare</code> instance using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx bare
# or
java -jar my-verticle-fat.jar bare</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also start an application in background using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java -jar my-verticle-fat.jar start --vertx-id=my-app-name</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>my-app-name</code> is not set, a random id will be generated, and printed on the command prompt. You can pass <code>run</code>
options to the <code>start</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java -jar my-verticle-fat.jar start —-vertx-id=my-app-name -cluster</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once launched in background, you can stop it with the <code>stop</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java -jar my-verticle-fat.jar stop my-app-name</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also list the vert.x application launched in background using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java -jar my-verticle-fat.jar list</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>start</code>, <code>stop</code> and <code>list</code> command are also available from the <code>vertx</code> tool. The start` command supports a couple of options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>vertx-id</code> : the application id, uses a random UUID if not set</p>
</li>
<li>
<p><code>java-opts</code> : the Java Virtual Machine options, uses the <code>JAVA_OPTS</code> environment variable if not set.</p>
</li>
<li>
<p><code>redirect-output</code> : redirect the spawned process output and error streams to the parent process streams.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If option values contain spaces, don&#8217;t forget to wrap the value between <code>""</code> (double-quotes).</p>
</div>
<div class="paragraph">
<p>As the <code>start</code> command spawns a new process, the java options passed to the JVM are not propagated, so you <strong>must</strong>
use <code>java-opts</code> to configure the JVM (<code>-X</code>, <code>-D</code>&#8230;&#8203;). If you use the <code>CLASSPATH</code> environment variable, be sure it
contains all the required jars (vertx-core, your jars and all the dependencies).</p>
</div>
<div class="paragraph">
<p>The set of commands is extensible, refer to the <a href="#_extending_the_vert_x_launcher">Extending the vert.x Launcher</a> section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_live_redeploy"><a class="anchor" href="#_live_redeploy"></a>Live Redeploy</h3>
<div class="paragraph">
<p>When developing it may be convenient to automatically redeploy your application upon file changes. The <code>vertx</code>
command line tool and more generally the <code><a href="unavailable">Launcher</a></code> class offers this feature. Here are some
examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run MyVerticle.groovy --redeploy="**&amp;#47;*.groovy" --launcher-class=io.vertx.core.Launcher
vertx run MyVerticle.groovy --redeploy="**&amp;#47;*.groovy,**&amp;#47;*.rb"  --launcher-class=io.vertx.core.Launcher
java io.vertx.core.Launcher run org.acme.MyVerticle --redeploy="**&amp;#47;*.class"  --launcher-class=io.vertx.core
.Launcher -cp ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The redeployment process is implemented as follows. First your application is launched as a background application
(with the <code>start</code> command). On matching file changes, the process is stopped and the application is restarted.
This avoids leaks, as the process is restarted.</p>
</div>
<div class="paragraph">
<p>To enable the live redeploy, pass the <code>--redeploy</code> option to the <code>run</code> command. The <code>--redeploy</code> indicates the
set of file to <em>watch</em>. This set can use Ant-style patterns (with <code>**</code>, <code>*</code> and <code>?</code>). You can specify
several sets by separating them using a comma (<code>,</code>). Patterns are relative to the current working directory.</p>
</div>
<div class="paragraph">
<p>Parameters passed to the <code>run</code> command are passed to the application. Java Virtual Machine options can be
configured using <code>--java-opts</code>. For instance, to pass the the <code>conf</code> parameter or a system property, you need to
use: <code>--java-opts="-conf=my-conf.json -Dkey=value"</code></p>
</div>
<div class="paragraph">
<p>The <code>--launcher-class</code> option determine with with <em>main</em> class the application is launcher. It&#8217;s generally
<code><a href="unavailable">Launcher</a></code>, but you have use you own <em>main</em>.</p>
</div>
<div class="paragraph">
<p>The redeploy feature can be used in your IDE:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Eclipse - create a <em>Run</em> configuration, using the <code>io.vertx.core.Launcher</code> class a <em>main class</em>. In the <em>Program
arguments</em> area (in the <em>Arguments</em> tab), write <code>run your-verticle-fully-qualified-name --redeploy=**&#47;*.java
--launcher-class=io.vertx.core.Launcher</code>. You can also add other parameters. The redeployment works smoothly as
Eclipse incrementally compiles your files on save.</p>
</li>
<li>
<p>IntelliJ - create a <em>Run</em> configuration (<em>Application</em>), set the <em>Main class</em> to <code>io.vertx.core.Launcher</code>. In
the Program arguments write: <code>run your-verticle-fully-qualified-name --redeploy=**&#47;*.class
--launcher-class=io.vertx.core.Launcher</code>. To trigger the redeployment, you need to <em>make</em> the project or
the module explicitly (<em>Build</em> menu &#8594; <em>Make project</em>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To debug your application, create your run configuration as a remote application and configure the debugger
using <code>--java-opts</code>. However, don&#8217;t forget to re-plug the debugger after every redeployment as a new process is
created every time.</p>
</div>
<div class="paragraph">
<p>You can also hook your build process in the redeploy cycle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java -jar target/my-fat-jar.jar --redeploy="**&amp;#47;*.java" --on-redeploy="mvn package"
java -jar build/libs/my-fat-jar.jar --redeploy="src&amp;#47;**&amp;#47;*.java" --on-redeploy='./gradlew shadowJar'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The "on-redeploy" option specifies a command invoked after the shutdown of the application and before the
restart. So you can hook your build tool if it updates some runtime artifacts. For instance, you can launch <code>gulp</code>
or <code>grunt</code> to update your resources. Don&#8217;t forget that passing parameters to your application requires the
<code>--java-opts</code> param:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>java -jar target/my-fat-jar.jar --redeploy="**&amp;#47;*.java" --on-redeploy="mvn package" --java-opts="-Dkey=val"
java -jar build/libs/my-fat-jar.jar --redeploy="src&amp;#47;**&amp;#47;*.java" --on-redeploy='./gradlew shadowJar' --java-opts="-Dkey=val"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The redeploy feature also supports the following settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>redeploy-scan-period</code> : the file system check period (in milliseconds), 250ms by default</p>
</li>
<li>
<p><code>redeploy-grace-period</code> : the amount of time (in milliseconds) to wait between 2 re-deployments, 1000ms by default</p>
</li>
<li>
<p><code>redeploy-termination-period</code> : the amount of time to wait after having stopped the application (before
launching user command). This is useful on Windows, where the process is not killed immediately. The time is given
in milliseconds. 0 ms by default.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cluster_managers"><a class="anchor" href="#_cluster_managers"></a>Cluster Managers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Vert.x a cluster manager is used for various functions including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Discovery and group membership of Vert.x nodes in a cluster</p>
</li>
<li>
<p>Maintaining cluster wide topic subscriber lists (so we know which nodes are interested in which event bus addresses)</p>
</li>
<li>
<p>Distributed Map support</p>
</li>
<li>
<p>Distributed Locks</p>
</li>
<li>
<p>Distributed Counters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Cluster managers <em>do not</em> handle the event bus inter-node transport, this is done directly by Vert.x with TCP connections.</p>
</div>
<div class="paragraph">
<p>The default cluster manager used in the Vert.x distributions is one that uses <a href="http://hazelcast.com">Hazelcast</a> but this
can be easily replaced by a different implementation as Vert.x cluster managers are pluggable.</p>
</div>
<div class="paragraph">
<p>A cluster manager must implement the interface <code><a href="unavailable">ClusterManager</a></code>. Vert.x locates
cluster managers at run-time by using the Java
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">Service Loader</a> functionality to locate
instances of <code><a href="unavailable">ClusterManager</a></code> on the classpath.</p>
</div>
<div class="paragraph">
<p>If you are using Vert.x at the command line and you want to use clustering you should make sure the <code>lib</code> directory
of the Vert.x installation contains your cluster manager jar.</p>
</div>
<div class="paragraph">
<p>If you are using Vert.x from a Maven or Gradle project just add the cluster manager jar as a dependency of your project.</p>
</div>
<div class="paragraph">
<p>You can also specify cluster managers programmatically if embedding Vert.x using
<code><a href="../dataobjects.html#VertxOptions#set_cluster_manager-instance_method">clusterManager</a></code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging"><a class="anchor" href="#_logging"></a>Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x logs using it&#8217;s in-built logging API. The default implementation uses the JDK (JUL) logging so no extra
logging dependencies are needed.</p>
</div>
<div class="sect2">
<h3 id="_configuring_jul_logging"><a class="anchor" href="#_configuring_jul_logging"></a>Configuring JUL logging</h3>
<div class="paragraph">
<p>A JUL logging configuration file can be specified in the normal JUL way by providing a system property called:
<code>java.util.logging.config.file</code> with the value being your configuration file. For more information on this and
the structure of a JUL config file please consult the JUL logging documentation.</p>
</div>
<div class="paragraph">
<p>Vert.x also provides a slightly more convenient way to specify a configuration file without having to set a system
property. Just provide a JUL config file with the name <code>vertx-default-jul-logging.properties</code> on your classpath (e.g.
inside your fatjar) and Vert.x will use that to configure JUL.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_another_logging_framework"><a class="anchor" href="#_using_another_logging_framework"></a>Using another logging framework</h3>
<div class="paragraph">
<p>If you don&#8217;t want Vert.x to use JUL for it&#8217;s own logging you can configure it to use another logging framework, e.g.
Log4J or SLF4J.</p>
</div>
<div class="paragraph">
<p>To do this you should set a system property called <code>vertx.logger-delegate-factory-class-name</code> with the name of a Java
class which implements the interface <code><a href="unavailable">LogDelegateFactory</a></code>. We provide pre-built
implementations for Log4J (version 1), Log4J 2 and SLF4J with the class names
<code>io.vertx.core.logging.Log4jLogDelegateFactory</code>, <code>io.vertx.core.logging.Log4j2LogDelegateFactory</code> and
<code>io.vertx.core.logging.SLF4JLogDelegateFactory</code> respectively. If you want to use these implementations you should
also make sure the relevant Log4J or SLF4J jars are on your classpath.</p>
</div>
<div class="paragraph">
<p>Notice that, the provided delegate for Log4J 1 does not support parameterized message. The delegate for Log4J 2
uses the <code>{}</code> syntax like the SLF4J delegate. JUL delegate uses the <code>{x}</code> syntax.</p>
</div>
</div>
<div class="sect2">
<h3 id="netty-logging"><a class="anchor" href="#netty-logging"></a>Netty logging</h3>
<div class="paragraph">
<p>When configuring logging, you should care about configuring Netty logging as well.</p>
</div>
<div class="paragraph">
<p>Netty does not rely on external logging configuration (e.g system properties) and instead implements a logging
configuration based on the logging libraries visible from the Netty classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>use <code>SLF4J</code> library if it is visible</p>
</li>
<li>
<p>otherwise use <code>Log4j</code> if it is visible</p>
</li>
<li>
<p>otherwise fallback <code>java.util.logging</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The logger implementation can be forced to a specific implementation by setting Netty&#8217;s internal logger implementation directly
on <code>io.netty.util.internal.logging.InternalLoggerFactory</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-comment">// Force logging to Log4j</span>
InternalLoggerFactory.setDefaultFactory(Log4JLoggerFactory.INSTANCE);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>Troubleshooting</h3>
<div class="sect3">
<h4 id="_slf4j_warning_at_startup"><a class="anchor" href="#_slf4j_warning_at_startup"></a>SLF4J warning at startup</h4>
<div class="paragraph">
<p>If, when you start your application, you see the following message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.</pre>
</div>
</div>
<div class="paragraph">
<p>It means that you have SLF4J-API in your classpath but no actual binding. Messages logged with SLF4J will be dropped.
You should add a binding to your classpath. Check <a href="https://www.slf4j.org/manual.html#swapping" class="bare">https://www.slf4j.org/manual.html#swapping</a> to pick a binding and configure it.</p>
</div>
<div class="paragraph">
<p>Be aware that Netty looks for the SLF4-API jar and uses it by default.</p>
</div>
</div>
<div class="sect3">
<h4 id="_connection_reset_by_peer"><a class="anchor" href="#_connection_reset_by_peer"></a>Connection reset by peer</h4>
<div class="paragraph">
<p>If your logs show a bunch of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>io.vertx.core.net.impl.ConnectionBase
SEVERE: java.io.IOException: Connection reset by peer</pre>
</div>
</div>
<div class="paragraph">
<p>It means that the client is resetting the HTTP connection instead of closing it. This message also indicates that you
may have not consumed the complete payload (the connection was cut before you were able to).</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::override/hostname-resolution.adoc[]</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_high_availability_and_fail_over"><a class="anchor" href="#_high_availability_and_fail_over"></a>High Availability and Fail-Over</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x allows you to run your verticles with high availability (HA) support. In that case, when a vert.x
instance running a verticle dies abruptly, the verticle is migrated to another vertx instance. The vert.x
instances must be in the same cluster.</p>
</div>
<div class="sect2">
<h3 id="_automatic_failover"><a class="anchor" href="#_automatic_failover"></a>Automatic failover</h3>
<div class="paragraph">
<p>When vert.x runs with <em>HA</em> enabled, if a vert.x instance where a verticle runs fails or dies, the verticle is
redeployed automatically on another vert.x instance of the cluster. We call this <em>verticle fail-over</em>.</p>
</div>
<div class="paragraph">
<p>To run vert.x with the <em>HA</em> enabled, just add the <code>-ha</code> flag to the command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-verticle.js -ha</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now for HA to work, you need more than one Vert.x instances in the cluster, so let&#8217;s say you have another
Vert.x instance that you have already started, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-other-verticle.js -ha</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the Vert.x instance that is running <code>my-verticle.js</code> now dies (you can test this by killing the process
with <code>kill -9</code>), the Vert.x instance that is running <code>my-other-verticle.js</code> will automatic deploy <code>my-verticle
.js</code> so now that Vert.x instance is running both verticles.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the migration is only possible if the second vert.x instance has access to the verticle file (here
<code>my-verticle.js</code>).
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Please note that cleanly closing a Vert.x instance will not cause failover to occur, e.g. <code>CTRL-C</code>
or <code>kill -SIGINT</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also start <em>bare</em> Vert.x instances - i.e. instances that are not initially running any verticles, they
will also failover for nodes in the cluster. To start a bare instance you simply do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run -ha</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using the <code>-ha</code> switch you do not need to provide the <code>-cluster</code> switch, as a cluster is assumed if you
want HA.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
depending on your cluster configuration, you may need to customize the cluster manager configuration
(Hazelcast by default), and/or add the <code>cluster-host</code> and <code>cluster-port</code> parameters.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_ha_groups"><a class="anchor" href="#_ha_groups"></a>HA groups</h3>
<div class="paragraph">
<p>When running a Vert.x instance with HA you can also optional specify a <em>HA group</em>. A HA group denotes a
logical group of nodes in the cluster. Only nodes with the same HA group will failover onto one another. If
you don&#8217;t specify a HA group the default group <code>__DEFAULT__</code> is used.</p>
</div>
<div class="paragraph">
<p>To specify an HA group you use the <code>-hagroup</code> switch when running the verticle, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-verticle.js -ha -hagroup my-group</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s look at an example:</p>
</div>
<div class="paragraph">
<p>In a first terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-verticle.js -ha -hagroup g1</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a second terminal, let&#8217;s run another verticle using the same group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-other-verticle.js -ha -hagroup g1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, in a third terminal, launch another verticle using a different group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run yet-another-verticle.js -ha -hagroup g2</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we kill the instance in terminal 1, it will fail over to the instance in terminal 2, not the instance in
terminal 3 as that has a different group.</p>
</div>
<div class="paragraph">
<p>If we kill the instance in terminal 3, it won&#8217;t get failed over as there is no other vert.x instance in that
group.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dealing_with_network_partitions_quora"><a class="anchor" href="#_dealing_with_network_partitions_quora"></a>Dealing with network partitions - Quora</h3>
<div class="paragraph">
<p>The HA implementation also supports quora. A quorum is the minimum number of votes that a distributed
transaction has to obtain in order to be allowed to perform an operation in a distributed system.</p>
</div>
<div class="paragraph">
<p>When starting a Vert.x instance you can instruct it that it requires a <code>quorum</code> before any HA deployments will
be deployed. In this context, a quorum is a minimum number of nodes for a particular group in the cluster.
Typically you chose your quorum size to <code>Q = 1 + N/2</code> where <code>N</code> is the number of nodes in the group. If there
are less than <code>Q</code> nodes in the cluster the HA deployments will undeploy. They will redeploy again if/when a
quorum is re-attained. By doing this you can prevent against network partitions, a.k.a. <em>split brain</em>.</p>
</div>
<div class="paragraph">
<p>There is more information on quora <a href="http://en.wikipedia.org/wiki/Quorum_(distributed_computing)">here</a>.</p>
</div>
<div class="paragraph">
<p>To run vert.x instances with a quorum you specify <code>-quorum</code> on the command line, e.g.</p>
</div>
<div class="paragraph">
<p>In a first terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-verticle.js -ha -quorum 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point the Vert.x instance will start but not deploy the module (yet) because there is only one node
in the cluster, not 3.</p>
</div>
<div class="paragraph">
<p>In a second terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my-other-verticle.js -ha -quorum 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point the Vert.x instance will start but not deploy the module (yet) because there are only two nodes
in the cluster, not 3.</p>
</div>
<div class="paragraph">
<p>In a third console, you can start another instance of vert.x:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run yet-another-verticle.js -ha -quorum 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Yay! - we have three nodes, that&#8217;s a quorum. At this point the modules will automatically deploy on all
instances.</p>
</div>
<div class="paragraph">
<p>If we now close or kill one of the nodes the modules will automatically undeploy on the other nodes, as there
is no longer a quorum.</p>
</div>
<div class="paragraph">
<p>Quora can also be used in conjunction with ha groups. In that case, quora are resolved for each particular
group.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_native_transports"><a class="anchor" href="#_native_transports"></a>Native transports</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x can run with <a href="http://netty.io/wiki/native-transports.html">native transports</a> (when available) on BSD (OSX) and Linux:</p>
</div>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::override/configuring-native.adoc[]</p>
</div>
<div class="sect2">
<h3 id="_native_linux_transport"><a class="anchor" href="#_native_linux_transport"></a>Native Linux Transport</h3>
<div class="paragraph">
<p>You need to add the following dependency in your classpath:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.netty<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>netty-transport-native-epoll<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.1.15.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>linux-x86_64<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Native on Linux gives you extra networking options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SO_REUSEPORT</code></p>
</li>
<li>
<p><code>TCP_QUICKACK</code></p>
</li>
<li>
<p><code>TCP_CORK</code></p>
</li>
<li>
<p><code>TCP_FASTOPEN</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-comment"># Available on Linux</span>
vertx.create_http_server({
  <span class="hljs-string">'tcpFastOpen'</span> =&gt; fastOpen,
  <span class="hljs-string">'tcpCork'</span> =&gt; cork,
  <span class="hljs-string">'tcpQuickAck'</span> =&gt; quickAck,
  <span class="hljs-string">'reusePort'</span> =&gt; reusePort
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_native_bsd_transport"><a class="anchor" href="#_native_bsd_transport"></a>Native BSD Transport</h3>
<div class="paragraph">
<p>You need to add the following dependency in your classpath:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.netty<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>netty-transport-native-kqueue<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.1.15.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>osx-x86_64<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>MacOS Sierra and above are supported.</p>
</div>
<div class="paragraph">
<p>Native on BSD gives you extra networking options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SO_REUSEPORT</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-comment"># Available on BSD</span>
vertx.create_http_server({
  <span class="hljs-string">'reusePort'</span> =&gt; reusePort
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_domain_sockets"><a class="anchor" href="#_domain_sockets"></a>Domain sockets</h3>
<div class="paragraph">
<p>Natives provide domain sockets support for servers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/socket_address'</span>
<span class="hljs-comment"># Only available on BSD and Linux</span>
vertx.create_net_server().connect_handler() { <span class="hljs-params">|so|</span>
  <span class="hljs-comment"># Handle application</span>
}.listen(Vertx::SocketAddress.domain_socket_address(<span class="hljs-string">"/var/tmp/myservice.sock"</span>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>or for http:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/socket_address'</span>
vertx.create_http_server().request_handler() { <span class="hljs-params">|req|</span>
  <span class="hljs-comment"># Handle application</span>
}.listen(Vertx::SocketAddress.domain_socket_address(<span class="hljs-string">"/var/tmp/myservice.sock"</span>)) { <span class="hljs-params">|ar_err,ar|</span>
  <span class="hljs-keyword">if</span> (ar_err == <span class="hljs-literal">nil</span>)
    <span class="hljs-comment"># Bound to socket</span>
  <span class="hljs-keyword">else</span>
    ar_err.print_stack_trace()
  <span class="hljs-keyword">end</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As well as clients:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/socket_address'</span>
netClient = vertx.create_net_client()

<span class="hljs-comment"># Only available on BSD and Linux</span>
addr = Vertx::SocketAddress.domain_socket_address(<span class="hljs-string">"/var/tmp/myservice.sock"</span>)

<span class="hljs-comment"># Connect to the server</span>
netClient.connect(addr) { <span class="hljs-params">|ar_err,ar|</span>
  <span class="hljs-keyword">if</span> (ar_err == <span class="hljs-literal">nil</span>)
    <span class="hljs-comment"># Connected</span>
  <span class="hljs-keyword">else</span>
    ar_err.print_stack_trace()
  <span class="hljs-keyword">end</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or for http:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'vertx/socket_address'</span>
httpClient = vertx.create_http_client()

<span class="hljs-comment"># Only available on BSD and Linux</span>
addr = Vertx::SocketAddress.domain_socket_address(<span class="hljs-string">"/var/tmp/myservice.sock"</span>)

<span class="hljs-comment"># Send request to the server</span>
httpClient.request(<span class="hljs-symbol">:GET</span>, addr, <span class="hljs-number">8080</span>, <span class="hljs-string">"localhost"</span>, <span class="hljs-string">"/"</span>) { <span class="hljs-params">|resp|</span>
  <span class="hljs-comment"># Process response</span>
}.<span class="hljs-keyword">end</span>()</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security_notes"><a class="anchor" href="#_security_notes"></a>Security notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x is a toolkit, not an opinionated framework where we force you to do things in a certain way. This gives you
great power as a developer but with that comes great responsibility.</p>
</div>
<div class="paragraph">
<p>As with any toolkit, it&#8217;s possible to write insecure applications, so you should always be careful when developing
your application especially if it&#8217;s exposed to the public (e.g. over the internet).</p>
</div>
<div class="sect2">
<h3 id="_web_applications"><a class="anchor" href="#_web_applications"></a>Web applications</h3>
<div class="paragraph">
<p>If writing a web application it&#8217;s highly recommended that you use Vert.x-Web instead of Vert.x core directly for
serving resources and handling file uploads.</p>
</div>
<div class="paragraph">
<p>Vert.x-Web normalises the path in requests to prevent malicious clients from crafting URLs to access resources
outside of the web root.</p>
</div>
<div class="paragraph">
<p>Similarly for file uploads Vert.x-Web provides functionality for uploading to a known place on disk and does not rely
on the filename provided by the client in the upload which could be crafted to upload to a different place on disk.</p>
</div>
<div class="paragraph">
<p>Vert.x core itself does not provide such checks so it would be up to you as a developer to implement them yourself.</p>
</div>
</div>
<div class="sect2">
<h3 id="_clustered_event_bus_traffic"><a class="anchor" href="#_clustered_event_bus_traffic"></a>Clustered event bus traffic</h3>
<div class="paragraph">
<p>When clustering the event bus between different Vert.x nodes on a network, the traffic is sent un-encrypted across the
wire, so do not use this if you have confidential data to send and your Vert.x nodes are not on a trusted network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_standard_security_best_practices"><a class="anchor" href="#_standard_security_best_practices"></a>Standard security best practices</h3>
<div class="paragraph">
<p>Any service can have potentially vulnerabilities whether it&#8217;s written using Vert.x or any other toolkit so always
follow security best practice, especially if your service is public facing.</p>
</div>
<div class="paragraph">
<p>For example you should always run them in a DMZ and with an user account that has limited rights in order to limit
the extent of damage in case the service was compromised.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vert_x_command_line_interface_api"><a class="anchor" href="#_vert_x_command_line_interface_api"></a>Vert.x Command Line Interface API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::cli.adoc[]</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_vert_x_launcher"><a class="anchor" href="#_the_vert_x_launcher"></a>The vert.x Launcher</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The vert.x <code><a href="unavailable">Launcher</a></code> is used in <em>fat jar</em> as main class, and by the <code>vertx</code> command line
utility. It executes a set of <em>commands</em> such as <em>run</em>, <em>bare</em>, <em>start</em>&#8230;&#8203;</p>
</div>
<div class="sect2">
<h3 id="_extending_the_vert_x_launcher"><a class="anchor" href="#_extending_the_vert_x_launcher"></a>Extending the vert.x Launcher</h3>
<div class="paragraph">
<p>You can extend the set of command by implementing your own <code><a href="unavailable">Command</a></code> (in Java only):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&amp;#<span class="hljs-number">64</span>;Name(<span class="hljs-string">"my-command"</span>)
&amp;#<span class="hljs-number">64</span>;Summary(<span class="hljs-string">"A simple hello command."</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCommand</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DefaultCommand</span> </span>{

 <span class="hljs-keyword">private</span> String name;

 &amp;#<span class="hljs-number">64</span>;Option(longName = <span class="hljs-string">"name"</span>, required = <span class="hljs-keyword">true</span>)
 <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String n)</span> </span>{
   <span class="hljs-keyword">this</span>.name = n;
 }

 &amp;#<span class="hljs-number">64</span>;<span class="hljs-function">Override
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> CLIException </span>{
   System.out.println(<span class="hljs-string">"Hello "</span> + name);
 }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You also need an implementation of <code><a href="unavailable">CommandFactory</a></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloCommandFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DefaultCommandFactory</span>&lt;<span class="hljs-title">HelloCommand</span>&gt; </span>{
 <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HelloCommandFactory</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">super</span>(HelloCommand<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;
 }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, create the <code>src/main/resources/META-INF/services/io.vertx.core.spi.launcher.CommandFactory</code> and add a line
indicating the fully qualified name of the factory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>io.vertx.core.launcher.example.HelloCommandFactory</pre>
</div>
</div>
<div class="paragraph">
<p>Builds the jar containing the command. Be sure to includes the SPI file
(<code>META-INF/services/io.vertx.core.spi.launcher.CommandFactory</code>).</p>
</div>
<div class="paragraph">
<p>Then, place the jar containing the command into the classpath of your fat-jar (or include it inside) or in the <code>lib</code>
directory of your vert.x distribution, and you would be able to execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx hello vert.x
java -jar my-fat-jar.jar hello vert.x</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_launcher_in_fat_jars"><a class="anchor" href="#_using_the_launcher_in_fat_jars"></a>Using the Launcher in fat jars</h3>
<div class="paragraph">
<p>To use the <code><a href="unavailable">Launcher</a></code> class in a <em>fat-jar</em> just set the <code>Main-Class</code> of the <em>MANIFEST</em> to
<code>io.vertx.core.Launcher</code>. In addition, set the <code>Main-Verticle</code> <em>MANIFEST</em> entry to the name of your main verticle.</p>
</div>
<div class="paragraph">
<p>By default, it executed the <code>run</code> command. However, you can configure the default command by setting the
<code>Main-Command</code> <em>MANIFEST</em> entry. The default command is used if the <em>fat jar</em> is launched without a command.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sub_classing_the_launcher"><a class="anchor" href="#_sub_classing_the_launcher"></a>Sub-classing the Launcher</h3>
<div class="paragraph">
<p>You can also create a sub-class of <code><a href="unavailable">Launcher</a></code> to start your application. The class has been
designed to be easily extensible.</p>
</div>
<div class="paragraph">
<p>A <code><a href="unavailable">Launcher</a></code> sub-class can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>customize the vert.x configuration in <code><a href="unavailable#before_starting_vertx-instance_method">beforeStartingVertx</a></code></p>
</li>
<li>
<p>retrieve the vert.x instance created by the "run" or "bare" command by
overriding <code><a href="unavailable#after_starting_vertx-instance_method">afterStartingVertx</a></code></p>
</li>
<li>
<p>configure the default verticle and command with
<code><a href="unavailable#get_main_verticle-instance_method">getMainVerticle</a></code> and
<code><a href="unavailable#get_default_command-instance_method">getDefaultCommand</a></code></p>
</li>
<li>
<p>add / remove commands using <code><a href="unavailable#register-instance_method">register</a></code>
and <code><a href="unavailable#unregister-instance_method">unregister</a></code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_launcher_and_exit_code"><a class="anchor" href="#_launcher_and_exit_code"></a>Launcher and exit code</h3>
<div class="paragraph">
<p>When you use the <code><a href="unavailable">Launcher</a></code> class as main class, it uses the following exit code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>0</code> if the process ends smoothly, or if an uncaught error is thrown</p>
</li>
<li>
<p><code>1</code> for general purpose error</p>
</li>
<li>
<p><code>11</code> if Vert.x cannot be initialized</p>
</li>
<li>
<p><code>12</code> if a spawn process cannot be started, found or stopped. This error code is used by the <code>start</code> and
<code>stop</code> command</p>
</li>
<li>
<p><code>14</code> if the system configuration is not meeting the system requirement (shc as java not found)</p>
</li>
<li>
<p><code>15</code> if the main verticle cannot be deployed</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_vert_x_cache"><a class="anchor" href="#_configuring_vert_x_cache"></a>Configuring Vert.x cache</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When Vert.x needs to read a file from the classpath (embedded in a fat jar, in a jar form the classpath or a file
that is on the classpath), it copies it to a cache directory. The reason behind this is simple: reading a file
from a jar or from an input stream is blocking. So to avoid to pay the price every time, Vert.x copies the file to
its cache directory and reads it from there every subsequent read. This behavior can be configured.</p>
</div>
<div class="paragraph">
<p>First, by default, Vert.x uses <code>$CWD/.vertx</code> as cache directory. It creates a unique directory inside this one to
avoid conflicts. This location can be configured by using the <code>vertx.cacheDirBase</code> system property. For instance
if the current working directory is not writable (such as in an immutable container context), launch your
application with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>vertx run my.Verticle -Dvertx.cacheDirBase=/tmp/vertx-cache
# or
java -jar my-fat.jar vertx.cacheDirBase=/tmp/vertx-cache</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
the directory must be <strong>writable</strong>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you are editing resources such as HTML, CSS or JavaScript, this cache mechanism can be annoying as it serves
only the first version of the file (and so you won&#8217;t see your edits if you reload your page). To avoid this
behavior, launch your application with <code>-Dvertx.disableFileCaching=true</code>. With this setting, Vert.x still uses
the cache, but always refresh the version stored in the cache with the original source. So if you edit a file
served from the classpath and refresh your browser, Vert.x reads it from the classpath, copies it to the cache
directory and serves it from there. Do not use this setting in production, it can kill your performances.</p>
</div>
<div class="paragraph">
<p>Finally, you can disable completely the cache by using <code>-Dvertx.disableFileCPResolving=true</code>. This setting is not
without consequences. Vert.x would be unable to read any files from the classpath (only from the file system). Be
very careful when using this settings.</p>
</div>
</div>
</div></div></div></div></div></div><footer><div class="container"><div class="footer-nav-section"><div class="footer-nav-list footer-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="footer-nav-list"><h5>Eclipse Vert.x</h5><ul class=""><li><a class="navbar-menu-item" href="/docs/">Docs</a></li><li><a href="/faq/">FAQ</a></li><li><a href="/blog/">Blog</a></li><li><a href="/community/">Community</a></li></ul></div><div class="footer-nav-list"><h5>Eclipse</h5><ul class=""><li><a href="https://www.eclipse.org/">Eclipse Foundation</a></li><li><a href="https://www.eclipse.org/legal/privacy.php">Privacy Policy</a></li><li><a href="https://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li><li><a href="https://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li><li><a href="https://www.eclipse.org/legal/">Legal Resources</a></li></ul></div></div><div class="footer-copyright"><div class="footer-copyright-remarks">© <!-- -->2020<!-- --> Eclipse Vert.x<br/>Eclipse Vert.x is open source and dual-licensed under the <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer">Eclipse Public License 2.0</a> and the <a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache License 2.0</a>. <br class="footer-copyright-break"/>Website design by <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer">Michel Krämer</a>.</div><div class="footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyODEuMyA5MS4xIiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGU+LnN0MHtmaWxsOiNmNzk0MjJ9LnN0MXtmaWxsOiMzZDNjM2J9PC9zdHlsZT48ZyBpZD0iTGF5ZXJfMV8xXyI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTI2NS43IDg0TDI1NyA3M2gtMi43djE3LjdoMy4zdi0xMmw5LjMgMTJoMi4xVjczaC0zLjN2MTF6bS0zMi40LTguM2M0LjIgMCA1LjggMy4zIDUuOCA2LjNzLTEuNiA2LTUuOCA2LTUuNy0zLjEtNS44LTYgMS43LTYuMyA1LjgtNi4zem0wLTNjLTYuMSAwLTkuMSA0LjctOS4xIDkuMyAwIDQuNyAyLjkgOS4xIDkuMSA5LjFzOS00LjYgOS4xLTkuMi0zLTkuMi05LjEtOS4yem0tMjEuMiAxOFY3M2gtMy4zdjE3LjdoMy4zem0tMjMuNiAwaDMuM1Y3Nmg1LjZ2LTNoLTE0LjZ2M2g1LjZsLjEgMTQuN3ptLTE4LjktNi41SDE2M2wzLjMtNy42IDMuMyA3LjZ6bTIuOCA2LjVoMy42TDE2OC4yIDczaC0zLjZsLTggMTcuN2gzLjZsMS41LTMuM2g5LjNsMS40IDMuM3ptLTM4LTE0LjZoMy42YzMuOSAwIDUuNSAyLjggNS41IDUuNS4xIDIuOC0xLjUgNS44LTUuNSA1LjhoLTMuNlY3Ni4xem0zLjctMy4xaC02Ljl2MTcuN2g2LjljNi4yIDAgOC45LTQuNSA4LjktOXMtMi44LTguNy04LjktOC43em0tMjIuNCAxMUwxMDcgNzNoLTIuN3YxNy43aDMuM3YtMTJsOS4zIDEyaDIuMVY3M2gtMy4zdjExek04OC4yIDczdjEwLjJjMCAzLTEuNiA0LjktNC4zIDQuOXMtNC42LTEuNy00LjYtNC45VjczSDc2djEwLjFjMCA1LjMgMy42IDcuOSA3LjkgNy45IDQuNCAwIDcuNy0yLjcgNy43LTcuOVY3M2gtMy40em0tMzMgMi43YzQuMiAwIDUuOCAzLjMgNS44IDYuM3MtMS42IDYtNS44IDYtNS43LTMuMS01LjgtNiAxLjctNi4zIDUuOC02LjN6bTAtM2MtNi4xIDAtOS4xIDQuNy05LjEgOS4zczIuOSA5LjEgOS4xIDkuMSA5LTQuNiA5LjEtOS4yLTMtOS4yLTkuMS05LjJ6bS0yOS43IDE4di02LjVoOC45di0zLjFoLTguOXYtNC44aDkuNFY3M0gyMi4ydjE3LjZoMy4zeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjkuNCA1NC40aC0yMi4ydi04LjloMjEuNHYtNi45aC0yMS40di05LjFoMjIuMnYtNy4yaC0yOS42djM5LjVoMjkuNnYtNy40em0tNDAtMjUuNmMtMy02LjEtOS40LTcuOC0xNS41LTcuOC03LjMgMC0xNS4zIDMuNC0xNS4zIDExLjUgMCA4LjkgNy40IDExIDE1LjUgMTIgNS4yLjYgOS4xIDIuMSA5LjEgNS44IDAgNC4zLTQuNCA1LjktOS4xIDUuOXMtOS40LTEuOS0xMS4xLTYuM2wtNi4yIDMuMmMyLjkgNy4yIDkuMSA5LjcgMTcuMiA5LjcgOC44IDAgMTYuNi0zLjggMTYuNi0xMi42IDAtOS40LTcuNy0xMS42LTE1LjktMTIuNi00LjctLjYtOC44LTEuNS04LjgtNSAwLTIuOSAyLjYtNS4yIDguMi01LjIgNC4zIDAgOCAyLjIgOS40IDQuNGw1LjktM3pNMTc2IDIyLjJjLTYuMi0uMS0xMi40IDAtMTguNiAwdjM5LjVoNy40VjUwLjFIMTc2YzE5LjQgMCAxOS40LTI3LjkgMC0yNy45em0tMTEuMSA3LjFIMTc2YzkuNSAwIDkuNSAxNCAwIDE0aC0xMS4ybC4xLTE0em0tMTggMzIuNVYyMi4yaC03LjR2MzkuNWw3LjQuMXptLTQ0LTM5LjZ2MzkuNWgyNy43di02LjloLTIwLjNWMjIuMmgtNy40ek05MC43IDUxLjdjLTIuNyAyLjUtNi4yIDQtOS45IDQtOS44IDAtMTMuNS02LjgtMTMuNi0xMy40czQuMS0xMy43IDEzLjYtMTMuN2MzLjUtLjEgNyAxLjMgOS41IDMuN2w1LTQuOGMtMy44LTMuOS05LjEtNi0xNC41LTYtMTQuMyAwLTIxIDEwLjUtMjAuOSAyMC44czYuMyAyMC4zIDIwLjkgMjAuM2M1LjYuMSAxMS0yIDE1LTUuOWwtNS4xLTV6bS0zOSAyLjdIMjkuNXYtOC45aDIxLjR2LTYuOUgyOS41di05LjFoMjIuMnYtNy4ySDIyLjJ2MzkuNWgyOS42bC0uMS03LjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuOCAxOC4yQzE4LjggNC4xIDM2LjktLjggNTIuMSA2bC0xLS43QzM1LjctNC42IDE1LjItLjEgNS4zIDE1LjNzLTUuNCAzNS45IDEwIDQ1LjhsMS4xLjZDMy44IDUwLjguOCAzMi4zIDkuOCAxOC4yeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzIuMiAyNi4xYzAtMi41IDIuMS00LjYgNC42LTQuNiAyLjUgMCA0LjYgMi4xIDQuNiA0LjYgMCAyLjUtMi4xIDQuNi00LjYgNC42LTIuNiAwLTQuNi0yLjEtNC42LTQuNnptOC42IDBjMC0yLjItMS44LTQuMS00LTQuMXMtNC4xIDEuOC00LjEgNC4xYzAgMi4yIDEuNyA0IDMuOSA0LjFoLjFjMi4zIDAgNC4xLTEuOCA0LjEtNC4xem0tNi0yLjVoMi4zYzEuMSAwIDEuOS41IDEuOSAxLjYgMCAuNy0uNCAxLjMtMS4xIDEuNWwxLjIgMS43aC0xLjRsLTEtMS41aC0uN3YxLjVoLTEuMWwtLjEtNC44em0yLjIgMi4zYy41IDAgLjgtLjMuOC0uN3MtLjMtLjctLjgtLjdoLTF2MS4zbDEgLjF6Ii8+PC9nPjwvc3ZnPg==" alt="Eclipse foundation Logo"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"3.8.4/vertx-core/ruby","title":"Vert.x Core Manual","toc":"\u003cdiv id=\"toc\" class=\"toc\"\u003e\n\u003cdiv id=\"toctitle\"\u003eTable of Contents\u003c/div\u003e\n\u003cul class=\"sectlevel1\"\u003e\n\u003cli\u003e\u003ca href=\"#_are_you_fluent\"\u003eAre you fluent?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_dont_call_us_well_call_you\"\u003eDon\u0026#8217;t call us, we\u0026#8217;ll call you.\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_dont_block_me\"\u003eDon\u0026#8217;t block me!\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_reactor_and_multi_reactor\"\u003eReactor and Multi-Reactor\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#golden_rule\"\u003eThe Golden Rule - Don\u0026#8217;t Block the Event Loop\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#blocking_code\"\u003eRunning blocking code\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_async_coordination\"\u003eAsync coordination\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_concurrent_composition\"\u003eConcurrent composition\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_sequential_composition\"\u003eSequential composition\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_verticles\"\u003eVerticles\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_verticle_types\"\u003eVerticle Types\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_standard_verticles\"\u003eStandard verticles\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#worker_verticles\"\u003eWorker verticles\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_deploying_verticles_programmatically\"\u003eDeploying verticles programmatically\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_rules_for_mapping_a_verticle_name_to_a_verticle_factory\"\u003eRules for mapping a verticle name to a verticle factory\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_how_are_verticle_factories_located\"\u003eHow are Verticle Factories located?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_waiting_for_deployment_to_complete\"\u003eWaiting for deployment to complete\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_undeploying_verticle_deployments\"\u003eUndeploying verticle deployments\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_specifying_number_of_verticle_instances\"\u003eSpecifying number of verticle instances\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_verticle_isolation_groups\"\u003eVerticle Isolation Groups\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_high_availability\"\u003eHigh Availability\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_running_verticles_from_the_command_line\"\u003eRunning Verticles from the command line\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_causing_vert_x_to_exit\"\u003eCausing Vert.x to exit\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_the_context_object\"\u003eThe Context object\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_executing_periodic_and_delayed_actions\"\u003eExecuting periodic and delayed actions\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_verticle_worker_pool\"\u003eVerticle worker pool\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_thread_safety\"\u003eThread safety\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_metrics_spi\"\u003eMetrics SPI\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_osgi\"\u003eOSGi\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_the_vertx_command_line\"\u003eThe 'vertx' command line\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_run_verticles\"\u003eRun verticles\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_executing_a_vert_x_application_packaged_as_a_fat_jar\"\u003eExecuting a Vert.x application packaged as a fat jar\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_displaying_version_of_vert_x\"\u003eDisplaying version of Vert.x\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_other_commands\"\u003eOther commands\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_live_redeploy\"\u003eLive Redeploy\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_cluster_managers\"\u003eCluster Managers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_logging\"\u003eLogging\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_configuring_jul_logging\"\u003eConfiguring JUL logging\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_another_logging_framework\"\u003eUsing another logging framework\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#netty-logging\"\u003eNetty logging\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_troubleshooting\"\u003eTroubleshooting\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_high_availability_and_fail_over\"\u003eHigh Availability and Fail-Over\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_automatic_failover\"\u003eAutomatic failover\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_ha_groups\"\u003eHA groups\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_dealing_with_network_partitions_quora\"\u003eDealing with network partitions - Quora\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_native_transports\"\u003eNative transports\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_native_linux_transport\"\u003eNative Linux Transport\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_native_bsd_transport\"\u003eNative BSD Transport\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_domain_sockets\"\u003eDomain sockets\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_security_notes\"\u003eSecurity notes\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_web_applications\"\u003eWeb applications\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_clustered_event_bus_traffic\"\u003eClustered event bus traffic\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_standard_security_best_practices\"\u003eStandard security best practices\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_vert_x_command_line_interface_api\"\u003eVert.x Command Line Interface API\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_the_vert_x_launcher\"\u003eThe vert.x Launcher\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_extending_the_vert_x_launcher\"\u003eExtending the vert.x Launcher\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_the_launcher_in_fat_jars\"\u003eUsing the Launcher in fat jars\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_sub_classing_the_launcher\"\u003eSub-classing the Launcher\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_launcher_and_exit_code\"\u003eLauncher and exit code\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_configuring_vert_x_cache\"\u003eConfiguring Vert.x cache\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e","contents":"\u003ch1\u003eVert.x Core Manual\u003c/h1\u003e\n\n\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAt the heart of Vert.x is a set of Java APIs that we call \u003cstrong\u003eVert.x Core\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/eclipse/vert.x\"\u003eRepository\u003c/a\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x core provides functionality for things like:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eWriting TCP clients and servers\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWriting HTTP clients and servers including support for WebSockets\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe Event bus\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eShared data - local maps and clustered distributed maps\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePeriodic and delayed actions\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDeploying and undeploying Verticles\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDatagram Sockets\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDNS client\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFile system access\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eHigh availability\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNative transports\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eClustering\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe functionality in core is fairly low level - you won\u0026#8217;t find stuff like database access, authorisation or high level\nweb functionality here - that kind of stuff you\u0026#8217;ll find in \u003cstrong\u003eVert.x ext\u003c/strong\u003e (extensions).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x core is small and lightweight. You just use the parts you want. It\u0026#8217;s also entirely embeddable in your\nexisting applications - we don\u0026#8217;t force you to structure your applications in a special way just so you can use\nVert.x.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use core from any of the other languages that Vert.x supports. But here\u0026#8217;a a cool bit - we don\u0026#8217;t force\nyou to use the Java API directly from, say, JavaScript or Ruby - after all, different languages have different conventions\nand idioms, and it would be odd to force Java idioms on Ruby developers (for example).\nInstead, we automatically generate an \u003cstrong\u003eidiomatic\u003c/strong\u003e equivalent of the core Java APIs for each language.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFrom now on we\u0026#8217;ll just use the word \u003cstrong\u003ecore\u003c/strong\u003e to refer to Vert.x core.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::override/dependencies.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eLet\u0026#8217;s discuss the different concepts and features in core.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::override/in-the-beginning.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_are_you_fluent\"\u003e\u003ca class=\"anchor\" href=\"#_are_you_fluent\"\u003e\u003c/a\u003eAre you fluent?\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou may have noticed that in the previous examples a \u003cstrong\u003efluent\u003c/strong\u003e API was used.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA fluent API is where multiple methods calls can be chained together. For example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003erequest.response().put_header(\u003cspan class=\"hljs-string\"\u003e\"Content-Type\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"text/plain\"\u003c/span\u003e).write(\u003cspan class=\"hljs-string\"\u003e\"some text\"\u003c/span\u003e).\u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e()\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is a common pattern throughout Vert.x APIs, so get used to it.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eChaining calls like this allows you to write code that\u0026#8217;s a little bit less verbose. Of course, if you don\u0026#8217;t\nlike the fluent approach \u003cstrong\u003ewe don\u0026#8217;t force you\u003c/strong\u003e to do it that way, you can happily ignore it if you prefer and write\nyour code like this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003eresponse = request.response()\nresponse.put_header(\u003cspan class=\"hljs-string\"\u003e\"Content-Type\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"text/plain\"\u003c/span\u003e)\nresponse.write(\u003cspan class=\"hljs-string\"\u003e\"some text\"\u003c/span\u003e)\nresponse.\u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e()\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_dont_call_us_well_call_you\"\u003e\u003ca class=\"anchor\" href=\"#_dont_call_us_well_call_you\"\u003e\u003c/a\u003eDon\u0026#8217;t call us, we\u0026#8217;ll call you.\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe Vert.x APIs are largely \u003cem\u003eevent driven\u003c/em\u003e. This means that when things happen in Vert.x that you are interested in,\nVert.x will call you by sending you events.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSome example events are:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ea timer has fired\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003esome data has arrived on a socket,\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003esome data has been read from disk\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ean exception has occurred\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ean HTTP server has received a request\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou handle events by providing \u003cem\u003ehandlers\u003c/em\u003e to the Vert.x APIs. For example to receive a timer event every second you\nwould do:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003evertx.set_periodic(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e) { \u003cspan class=\"hljs-params\"\u003e|id|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# This handler will get called every second\u003c/span\u003e\n  puts \u003cspan class=\"hljs-string\"\u003e\"timer fired!\"\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOr to receive an HTTP request:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Respond to each http request with \"Hello World\"\u003c/span\u003e\nserver.request_handler() { \u003cspan class=\"hljs-params\"\u003e|request|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# This handler will be called every time an HTTP request is received at the server\u003c/span\u003e\n  request.response().\u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"hello world!\"\u003c/span\u003e)\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSome time later when Vert.x has an event to pass to your handler Vert.x will call it \u003cstrong\u003easynchronously\u003c/strong\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis leads us to some important concepts in Vert.x:\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_dont_block_me\"\u003e\u003ca class=\"anchor\" href=\"#_dont_block_me\"\u003e\u003c/a\u003eDon\u0026#8217;t block me!\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith very few exceptions (i.e. some file system operations ending in 'Sync'), none of the APIs in Vert.x block the calling thread.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf a result can be provided immediately, it will be returned immediately, otherwise you will usually provide a handler\nto receive events some time later.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBecause none of the Vert.x APIs block threads that means you can use Vert.x to handle a lot of concurrency using\njust a small number of threads.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith a conventional blocking API the calling thread might block when:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eReading data from a socket\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWriting data to disk\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSending a message to a recipient and waiting for a reply.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u0026#8230;\u0026#8203; Many other situations\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn all the above cases, when your thread is waiting for a result it can\u0026#8217;t do anything else - it\u0026#8217;s effectively useless.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis means that if you want a lot of concurrency using blocking APIs then you need a lot of threads to prevent your\napplication grinding to a halt.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThreads have overhead in terms of the memory they require (e.g. for their stack) and in context switching.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor the levels of concurrency required in many modern applications, a blocking approach just doesn\u0026#8217;t scale.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_reactor_and_multi_reactor\"\u003e\u003ca class=\"anchor\" href=\"#_reactor_and_multi_reactor\"\u003e\u003c/a\u003eReactor and Multi-Reactor\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe mentioned before that Vert.x APIs are event driven - Vert.x passes events to handlers when they are available.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn most cases Vert.x calls your handlers using a thread called an \u003cstrong\u003eevent loop\u003c/strong\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs nothing in Vert.x or your application blocks, the event loop can merrily run around delivering events to different handlers in succession\nas they arrive.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBecause nothing blocks, an event loop can potentially deliver huge amounts of events in a short amount of time.\nFor example a single event loop can handle many thousands of HTTP requests very quickly.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe call this the \u003ca href=\"http://en.wikipedia.org/wiki/Reactor_pattern\"\u003eReactor Pattern\u003c/a\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou may have heard of this before - for example Node.js implements this pattern.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn a standard reactor implementation there is a \u003cstrong\u003esingle event loop\u003c/strong\u003e thread which runs around in a loop delivering all\nevents to all handlers as they arrive.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe trouble with a single thread is it can only run on a single core at any one time, so if you want your single threaded\nreactor application (e.g. your Node.js application) to scale over your multi-core server you have to start up and\nmanage many different processes.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x works differently here. Instead of a single event loop, each Vertx instance maintains \u003cstrong\u003eseveral event loops\u003c/strong\u003e.\nBy default we choose the number based on the number of available cores on the machine, but this can be overridden.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis means a single Vertx process can scale across your server, unlike Node.js.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe call this pattern the \u003cstrong\u003eMulti-Reactor Pattern\u003c/strong\u003e to distinguish it from the single threaded reactor pattern.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nEven though a Vertx instance maintains multiple event loops, any particular handler will never be executed\nconcurrently, and in most cases (with the exception of \u003ca href=\"#worker_verticles\"\u003eworker verticles\u003c/a\u003e) will always be called\nusing the \u003cstrong\u003eexact same event loop\u003c/strong\u003e.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"golden_rule\"\u003e\u003ca class=\"anchor\" href=\"#golden_rule\"\u003e\u003c/a\u003eThe Golden Rule - Don\u0026#8217;t Block the Event Loop\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe already know that the Vert.x APIs are non blocking and won\u0026#8217;t block the event loop, but that\u0026#8217;s not much help if\nyou block the event loop \u003cstrong\u003eyourself\u003c/strong\u003e in a handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you do that, then that event loop will not be able to do anything else while it\u0026#8217;s blocked. If you block all of the\nevent loops in Vertx instance then your application will grind to a complete halt!\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSo don\u0026#8217;t do it! \u003cstrong\u003eYou have been warned\u003c/strong\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eExamples of blocking include:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eThread.sleep()\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWaiting on a lock\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWaiting on a mutex or monitor (e.g. synchronized section)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDoing a long lived database operation and waiting for a result\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDoing a complex calculation that takes some significant time.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSpinning in a loop\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf any of the above stop the event loop from doing anything else for a \u003cstrong\u003esignificant amount of time\u003c/strong\u003e then you should\ngo immediately to the naughty step, and await further instructions.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSo\u0026#8230;\u0026#8203; what is a \u003cstrong\u003esignificant amount of time\u003c/strong\u003e?\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHow long is a piece of string? It really depends on your application and the amount of concurrency you require.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you have a single event loop, and you want to handle 10000 http requests per second, then it\u0026#8217;s clear that each request\ncan\u0026#8217;t take more than 0.1 ms to process, so you can\u0026#8217;t block for any more time than that.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cstrong\u003eThe maths is not hard and shall be left as an exercise for the reader.\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf your application is not responsive it might be a sign that you are blocking an event loop somewhere. To help\nyou diagnose such issues, Vert.x will automatically log warnings if it detects an event loop hasn\u0026#8217;t returned for\nsome time. If you see warnings like these in your logs, then you should investigate.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003eThread vertx-eventloop-thread-3 has been blocked for 20458 ms\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x will also provide stack traces to pinpoint exactly where the blocking is occurring.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to turn off these warnings or change the settings, you can do that in the\n\u003ccode\u003e\u003ca href=\"../dataobjects.html#VertxOptions\"\u003eVertxOptions\u003c/a\u003e\u003c/code\u003e object before creating the Vertx object.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"blocking_code\"\u003e\u003ca class=\"anchor\" href=\"#blocking_code\"\u003e\u003c/a\u003eRunning blocking code\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn a perfect world, there will be no war or hunger, all APIs will be written asynchronously and bunny rabbits will\nskip hand-in-hand with baby lambs across sunny green meadows.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cstrong\u003eBut\u0026#8230;\u0026#8203; the real world is not like that. (Have you watched the news lately?)\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFact is, many, if not most libraries, especially in the JVM ecosystem have synchronous APIs and many of the methods are\nlikely to block. A good example is the JDBC API - it\u0026#8217;s inherently synchronous, and no matter how hard it tries, Vert.x\ncannot sprinkle magic pixie dust on it to make it asynchronous.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe\u0026#8217;re not going to rewrite everything to be asynchronous overnight so we need to provide you a way to use \"traditional\"\nblocking APIs safely within a Vert.x application.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs discussed before, you can\u0026#8217;t call blocking operations directly from an event loop, as that would prevent it\nfrom doing any other useful work. So how can you do this?\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt\u0026#8217;s done by calling \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#execute_blocking-instance_method\"\u003eexecuteBlocking\u003c/a\u003e\u003c/code\u003e specifying both the blocking code to execute and a\nresult handler to be called back asynchronous when the blocking code has been executed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003evertx.execute_blocking(lambda { \u003cspan class=\"hljs-params\"\u003e|promise|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Call some blocking API that takes a significant amount of time to return\u003c/span\u003e\n  result = @someAPI.blocking_method(\u003cspan class=\"hljs-string\"\u003e\"hello\"\u003c/span\u003e)\n  promise.complete(result)\n}) { \u003cspan class=\"hljs-params\"\u003e|res_err,res|\u003c/span\u003e\n  puts \u003cspan class=\"hljs-string\"\u003e\"The result is: \u003cspan class=\"hljs-subst\"\u003e#{res}\u003c/span\u003e\"\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock warning\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eWarning\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nBlocking code should block for a reasonable amount of time (i.e no more than a few seconds). Long blocking operations\n        or polling operations (i.e a thread that spin in a loop polling events in a blocking fashion) are precluded.\n        When the blocking operation lasts more than the 10 seconds, a message will be printed on the console by the\n        blocked thread checker. Long blocking operations should use a dedicated thread managed by the application,\n        which can interact with verticles using the event-bus or \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Context.html#run_on_context-instance_method\"\u003erunOnContext\u003c/a\u003e\u003c/code\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default, if executeBlocking is called several times from the same context (e.g. the same verticle instance) then\nthe different executeBlocking are executed \u003cem\u003eserially\u003c/em\u003e (i.e. one after another).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you don\u0026#8217;t care about ordering you can call \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#execute_blocking-instance_method\"\u003eexecuteBlocking\u003c/a\u003e\u003c/code\u003e\nspecifying \u003ccode\u003efalse\u003c/code\u003e as the argument to \u003ccode\u003eordered\u003c/code\u003e. In this case any executeBlocking may be executed in parallel\non the worker pool.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAn alternative way to run blocking code is to use a \u003ca href=\"#worker_verticles\"\u003eworker verticle\u003c/a\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA worker verticle is always executed with a thread from the worker pool.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default blocking code is executed on the Vert.x worker pool, configured with \u003ccode\u003e\u003ca href=\"../dataobjects.html#VertxOptions#set_worker_pool_size-instance_method\"\u003eworkerPoolSize\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAdditional pools can be created for different purposes:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003eexecutor = vertx.create_shared_worker_executor(\u003cspan class=\"hljs-string\"\u003e\"my-worker-pool\"\u003c/span\u003e)\nexecutor.execute_blocking(lambda { \u003cspan class=\"hljs-params\"\u003e|promise|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Call some blocking API that takes a significant amount of time to return\u003c/span\u003e\n  result = @someAPI.blocking_method(\u003cspan class=\"hljs-string\"\u003e\"hello\"\u003c/span\u003e)\n  promise.complete(result)\n}) { \u003cspan class=\"hljs-params\"\u003e|res_err,res|\u003c/span\u003e\n  puts \u003cspan class=\"hljs-string\"\u003e\"The result is: \u003cspan class=\"hljs-subst\"\u003e#{res}\u003c/span\u003e\"\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe worker executor must be closed when it\u0026#8217;s not necessary anymore:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003eexecutor.close()\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen several workers are created with the same name, they will share the same pool. The worker pool is destroyed\nwhen all the worker executors using it are closed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen an executor is created in a Verticle, Vert.x will close it automatically for you when the Verticle\nis undeployed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWorker executors can be configured when created:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-comment\"\u003e#\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# 10 threads max\u003c/span\u003e\npoolSize = \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 2 minutes\u003c/span\u003e\nmaxExecuteTime = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\nmaxExecuteTimeUnit = \u003cspan class=\"hljs-symbol\"\u003e:MINUTES\u003c/span\u003e\n\nexecutor = vertx.create_shared_worker_executor(\u003cspan class=\"hljs-string\"\u003e\"my-worker-pool\"\u003c/span\u003e, poolSize, maxExecuteTime, maxExecuteTimeUnit)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nthe configuration is set when the worker pool is created\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_async_coordination\"\u003e\u003ca class=\"anchor\" href=\"#_async_coordination\"\u003e\u003c/a\u003eAsync coordination\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCoordination of multiple asynchronous results can be achieved with Vert.x \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Future.html\"\u003efutures\u003c/a\u003e\u003c/code\u003e. It\nsupports concurrent composition (run several async operations in parallel) and sequential composition\n(chain async operations).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_concurrent_composition\"\u003e\u003ca class=\"anchor\" href=\"#_concurrent_composition\"\u003e\u003c/a\u003eConcurrent composition\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/CompositeFuture.html#all-class_method\"\u003eCompositeFuture.all\u003c/a\u003e\u003c/code\u003e takes several futures arguments (up to 6) and returns a future that is\n\u003cem\u003esucceeded\u003c/em\u003e when all the futures are and \u003cem\u003efailed\u003c/em\u003e when at least one of the futures is failed:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/future'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/composite_future'\u003c/span\u003e\nhttpServerFuture = Vertx::Future.future() { \u003cspan class=\"hljs-params\"\u003e|promise|\u003c/span\u003e\n  httpServer.listen(\u0026amp;promise)\n}\n\nnetServerFuture = Vertx::Future.future() { \u003cspan class=\"hljs-params\"\u003e|promise|\u003c/span\u003e\n  netServer.listen(\u0026amp;promise)\n}\n\nVertx::CompositeFuture.all(httpServerFuture, netServerFuture).set_handler() { \u003cspan class=\"hljs-params\"\u003e|ar_err,ar|\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar_err == \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e)\n    \u003cspan class=\"hljs-comment\"\u003e# All servers started\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# At least one server failed\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe operations run concurrently, the \u003ccode\u003e\u003ca href=\"unavailable\"\u003eHandler\u003c/a\u003e\u003c/code\u003e attached to the returned future is invoked upon\ncompletion of the composition. When one of the operation fails (one of the passed future is marked as a failure),\nthe resulting future is marked as failed too. When all the operations succeed, the resulting future is completed\nwith a success.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAlternatively, you can pass a list (potentially empty) of futures:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/composite_future'\u003c/span\u003e\nVertx::CompositeFuture.all([future1, future2, future3])\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhile the \u003ccode\u003eall\u003c/code\u003e composition \u003cem\u003ewaits\u003c/em\u003e until all futures are successful (or one fails), the \u003ccode\u003eany\u003c/code\u003e composition\n\u003cem\u003ewaits\u003c/em\u003e for the first succeeded future. \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/CompositeFuture.html#any-class_method\"\u003eCompositeFuture.any\u003c/a\u003e\u003c/code\u003e takes several futures\narguments (up to 6) and returns a future that is succeeded when one of the futures is, and failed when\nall the futures are failed:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/composite_future'\u003c/span\u003e\nVertx::CompositeFuture.any(future1, future2).set_handler() { \u003cspan class=\"hljs-params\"\u003e|ar_err,ar|\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar_err == \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e)\n    \u003cspan class=\"hljs-comment\"\u003e# At least one is succeeded\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# All failed\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA list of futures can be used also:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/composite_future'\u003c/span\u003e\nVertx::CompositeFuture.any([f1, f2, f3])\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003ejoin\u003c/code\u003e composition \u003cem\u003ewaits\u003c/em\u003e until all futures are completed, either with a success or a failure.\n\u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/CompositeFuture.html#join-class_method\"\u003eCompositeFuture.join\u003c/a\u003e\u003c/code\u003e takes several futures arguments (up to 6) and returns a future that is\nsucceeded when all the futures are succeeded, and failed when all the futures are completed and at least one of\nthem is failed:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/composite_future'\u003c/span\u003e\nVertx::CompositeFuture.join(future1, future2, future3).set_handler() { \u003cspan class=\"hljs-params\"\u003e|ar_err,ar|\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar_err == \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e)\n    \u003cspan class=\"hljs-comment\"\u003e# All succeeded\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# All completed and at least one failed\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA list of futures can be used also:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/composite_future'\u003c/span\u003e\nVertx::CompositeFuture.join([future1, future2, future3])\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_sequential_composition\"\u003e\u003ca class=\"anchor\" href=\"#_sequential_composition\"\u003e\u003c/a\u003eSequential composition\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhile \u003ccode\u003eall\u003c/code\u003e and \u003ccode\u003eany\u003c/code\u003e are implementing concurrent composition, \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Future.html#compose-instance_method\"\u003ecompose\u003c/a\u003e\u003c/code\u003e can be used\nfor chaining futures (so sequential composition).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/future'\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/buffer'\u003c/span\u003e\n\nfs = vertx.file_system()\n\nfut1 = Vertx::Future.future() { \u003cspan class=\"hljs-params\"\u003e|promise|\u003c/span\u003e\n  fs.create_file(\u003cspan class=\"hljs-string\"\u003e\"/foo\"\u003c/span\u003e, \u0026amp;promise)\n}\n\nstartFuture = fut1.compose(lambda { \u003cspan class=\"hljs-params\"\u003e|v|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# When the file is created (fut1), execute this:\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Vertx::Future.future() { \u003cspan class=\"hljs-params\"\u003e|promise|\u003c/span\u003e\n    fs.write_file(\u003cspan class=\"hljs-string\"\u003e\"/foo\"\u003c/span\u003e, Vertx::Buffer.buffer(), \u0026amp;promise)\n  }\n}).compose(lambda { \u003cspan class=\"hljs-params\"\u003e|v|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# When the file is written (fut2), execute this:\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Vertx::Future.future() { \u003cspan class=\"hljs-params\"\u003e|promise|\u003c/span\u003e\n    fs.move(\u003cspan class=\"hljs-string\"\u003e\"/foo\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"/bar\"\u003c/span\u003e, \u0026amp;promise)\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn this example, 3 operations are chained:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"olist arabic\"\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\n\u003cp\u003ea file is created (\u003ccode\u003efut1\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003esomething is written in the file (\u003ccode\u003efut2\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethe file is moved (\u003ccode\u003estartFuture\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen these 3 steps are successful, the final future (\u003ccode\u003estartFuture\u003c/code\u003e) is succeeded. However, if one\nof the steps fails, the final future is failed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis example uses:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Future.html#compose-instance_method\"\u003ecompose\u003c/a\u003e\u003c/code\u003e: when the current future completes,\nrun the given function, that returns a future. When this returned future completes, it completes the composition.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Future.html#compose-instance_method\"\u003ecompose\u003c/a\u003e\u003c/code\u003e: when the current future\ncompletes, run the given handler that completes the given \u003ccode\u003efuture\u003c/code\u003e (next).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn this second case, the \u003ccode\u003e\u003ca href=\"unavailable\"\u003eHandler\u003c/a\u003e\u003c/code\u003e should complete the \u003ccode\u003enext\u003c/code\u003e future to report its success or\nfailure.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_verticles\"\u003e\u003ca class=\"anchor\" href=\"#_verticles\"\u003e\u003c/a\u003eVerticles\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x comes with a simple, scalable, \u003cem\u003eactor-like\u003c/em\u003e deployment and concurrency model out of the box that\nyou can use to save you writing your own.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cstrong\u003eThis model is entirely optional and Vert.x does not force you to create your applications in this way if you don\u0026#8217;t\nwant to.\u003c/strong\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe model does not claim to be a strict actor-model implementation, but it does share similarities especially\nwith respect to concurrency, scaling and deployment.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use this model, you write your code as set of \u003cstrong\u003everticles\u003c/strong\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVerticles are chunks of code that get deployed and run by Vert.x. A Vert.x instance maintains N event loop threads\n(where N by default is core*2) by default. Verticles can be written in any of the languages that Vert.x supports\nand a single application can include verticles written in multiple languages.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can think of a verticle as a bit like an actor in the \u003ca href=\"http://en.wikipedia.org/wiki/Actor_model\"\u003eActor Model\u003c/a\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAn application would typically be composed of many verticle instances running in the same Vert.x instance at the same\ntime. The different verticle instances communicate with each other by sending messages on the \u003ca href=\"#event_bus\"\u003eevent bus\u003c/a\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::override/verticles.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_verticle_types\"\u003e\u003ca class=\"anchor\" href=\"#_verticle_types\"\u003e\u003c/a\u003eVerticle Types\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere are three different types of verticles:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003eStandard Verticles\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThese are the most common and useful type - they are always executed using an event loop thread.\nWe\u0026#8217;ll discuss this more in the next section.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eWorker Verticles\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThese run using a thread from the worker pool. An instance is never executed concurrently by more\nthan one thread.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eMulti-threaded worker verticles\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThese run using a thread from the worker pool. An instance can be executed concurrently by more\nthan one thread.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_standard_verticles\"\u003e\u003ca class=\"anchor\" href=\"#_standard_verticles\"\u003e\u003c/a\u003eStandard verticles\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eStandard verticles are assigned an event loop thread when they are created and the start method is called with that\nevent loop. When you call any other methods that takes a handler on a core API from an event loop then Vert.x\nwill guarantee that those handlers, when called, will be executed on the same event loop.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis means we can guarantee that all the code in your verticle instance is always executed on the same event loop (as\nlong as you don\u0026#8217;t create your own threads and call it!).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis means you can write all the code in your application as single threaded and let Vert.x worry about the threading\nand scaling. No more worrying about synchronized and volatile any more, and you also avoid many other cases of race conditions\nand deadlock so prevalent when doing hand-rolled 'traditional' multi-threaded application development.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"worker_verticles\"\u003e\u003ca class=\"anchor\" href=\"#worker_verticles\"\u003e\u003c/a\u003eWorker verticles\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA worker verticle is just like a standard verticle but it\u0026#8217;s executed using a thread from the Vert.x worker thread pool,\nrather than using an event loop.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWorker verticles are designed for calling blocking code, as they won\u0026#8217;t block any event loops.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you don\u0026#8217;t want to use a worker verticle to run blocking code, you can also run \u003ca href=\"#blocking_code\"\u003einline blocking code\u003c/a\u003e\ndirectly while on an event loop.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to deploy a verticle as a worker verticle you do that with \u003ccode\u003e\u003ca href=\"../dataobjects.html#DeploymentOptions#set_worker-instance_method\"\u003eworker\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003eoptions = {\n  \u003cspan class=\"hljs-string\"\u003e'worker'\u003c/span\u003e =\u0026gt; \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n}\nvertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"com.mycompany.MyOrderProcessorVerticle\"\u003c/span\u003e, options)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWorker verticle instances are never executed concurrently by Vert.x by more than one thread, but can executed by\ndifferent threads at different times.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_multi_threaded_worker_verticles\"\u003e\u003ca class=\"anchor\" href=\"#_multi_threaded_worker_verticles\"\u003e\u003c/a\u003eMulti-threaded worker verticles\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA multi-threaded worker verticle is just like a normal worker verticle but it \u003cstrong\u003ecan\u003c/strong\u003e be executed concurrently by\ndifferent threads.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock caution\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eCaution\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nMulti-threaded worker verticles are an advanced feature and most applications will have no need for them.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBecause of the concurrency in these verticles you have to be very careful to keep the verticle in a consistent state\nusing standard Java techniques for multi-threaded programming.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMulti-threaded worker verticles were designed and are intended for the sole use of consuming simultaneously \u003ccode\u003eEventBus\u003c/code\u003e messages in a blocking fashion.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock warning\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eWarning\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nVert.x clients and servers (TCP, HTTP, \u0026#8230;\u0026#8203;etc) cannot be created in a multi-threaded worker verticle.\nShould you incidentally try, an exception will be thrown.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eEssentially, multi-threaded worker verticles simply avoid the user from deploying as much instances of a worker verticle as the number of threads in a worker pool.\nSo you could for example provide a worker pool name/size in \u003ccode\u003e\u003ca href=\"../dataobjects.html#DeploymentOptions\"\u003eDeploymentOptions\u003c/a\u003e\u003c/code\u003e and set the number of instances accordingly:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003eoptions = {\n  \u003cspan class=\"hljs-string\"\u003e'worker'\u003c/span\u003e =\u0026gt; \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'instances'\u003c/span\u003e =\u0026gt; \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'workerPoolName'\u003c/span\u003e =\u0026gt; \u003cspan class=\"hljs-string\"\u003e\"the-specific-pool\"\u003c/span\u003e,\n  \u003cspan class=\"hljs-string\"\u003e'workerPoolSize'\u003c/span\u003e =\u0026gt; \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\n}\nvertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"com.mycompany.MyOrderProcessorVerticle\"\u003c/span\u003e, options)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAlternatively, you could create a regular verticle and wrap you blocking code with multiple \u003ccode\u003eexecuteBlocking\u003c/code\u003e with the \u003ccode\u003eordered\u003c/code\u003e flag set to \u003ccode\u003efalse\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003evertx.event_bus().consumer(\u003cspan class=\"hljs-string\"\u003e\"foo\"\u003c/span\u003e) { \u003cspan class=\"hljs-params\"\u003e|msg|\u003c/span\u003e\n  vertx.execute_blocking(lambda { \u003cspan class=\"hljs-params\"\u003e|promise|\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# Invoke blocking code with received message data\u003c/span\u003e\n    promise.complete(someresult)\n  }, \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e) { \u003cspan class=\"hljs-params\"\u003e|ar_err,ar|\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# Handle result, e.g. reply to the message\u003c/span\u003e\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_deploying_verticles_programmatically\"\u003e\u003ca class=\"anchor\" href=\"#_deploying_verticles_programmatically\"\u003e\u003c/a\u003eDeploying verticles programmatically\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can deploy a verticle using one of the \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#deploy_verticle-instance_method\"\u003edeployVerticle\u003c/a\u003e\u003c/code\u003e method, specifying a verticle\nname or you can pass in a verticle instance you have already created yourself.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nDeploying Verticle \u003cstrong\u003einstances\u003c/strong\u003e is Java only.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003emyVerticle = Java::ExamplesCoreExamples::MyVerticle.\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e()\nvertx.deploy_verticle(myVerticle)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also deploy verticles by specifying the verticle \u003cstrong\u003ename\u003c/strong\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe verticle name is used to look up the specific \u003ccode\u003e\u003ca href=\"unavailable\"\u003eVerticleFactory\u003c/a\u003e\u003c/code\u003e that will be used to\ninstantiate the actual verticle instance(s).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eDifferent verticle factories are available for instantiating verticles in different languages and for various other\nreasons such as loading services and getting verticles from Maven at run-time.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis allows you to deploy verticles written in any language from any other language that Vert.x supports.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of deploying some different types of verticles:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Deploy a Java verticle - the name is the fully qualified class name of the verticle class\u003c/span\u003e\nvertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"com.mycompany.MyOrderProcessorVerticle\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# Deploy a JavaScript verticle\u003c/span\u003e\nvertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"verticles/myverticle.js\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# Deploy a Ruby verticle verticle\u003c/span\u003e\nvertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"verticles/my_verticle.rb\"\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_rules_for_mapping_a_verticle_name_to_a_verticle_factory\"\u003e\u003ca class=\"anchor\" href=\"#_rules_for_mapping_a_verticle_name_to_a_verticle_factory\"\u003e\u003c/a\u003eRules for mapping a verticle name to a verticle factory\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen deploying verticle(s) using a name, the name is used to select the actual verticle factory that will instantiate\nthe verticle(s).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVerticle names can have a prefix - which is a string followed by a colon, which if present will be used to look-up the factory, e.g.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ejs:foo.js // Use the JavaScript verticle factory\ngroovy:com.mycompany.SomeGroovyCompiledVerticle // Use the Groovy verticle factory\nservice:com.mycompany:myorderservice // Uses the service verticle factory\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf no prefix is present, Vert.x will look for a suffix and use that to lookup the factory, e.g.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003efoo.js // Will also use the JavaScript verticle factory\nSomeScript.groovy // Will use the Groovy verticle factory\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf no prefix or suffix is present, Vert.x will assume it\u0026#8217;s a Java fully qualified class name (FQCN) and try\nand instantiate that.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_how_are_verticle_factories_located\"\u003e\u003ca class=\"anchor\" href=\"#_how_are_verticle_factories_located\"\u003e\u003c/a\u003eHow are Verticle Factories located?\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMost Verticle factories are loaded from the classpath and registered at Vert.x startup.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also programmatically register and unregister verticle factories using \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#register_verticle_factory-instance_method\"\u003eregisterVerticleFactory\u003c/a\u003e\u003c/code\u003e\nand \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#unregister_verticle_factory-instance_method\"\u003eunregisterVerticleFactory\u003c/a\u003e\u003c/code\u003e if you wish.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_waiting_for_deployment_to_complete\"\u003e\u003ca class=\"anchor\" href=\"#_waiting_for_deployment_to_complete\"\u003e\u003c/a\u003eWaiting for deployment to complete\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVerticle deployment is asynchronous and may complete some time after the call to deploy has returned.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to be notified when deployment is complete you can deploy specifying a completion handler:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003evertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"com.mycompany.MyOrderProcessorVerticle\"\u003c/span\u003e) { \u003cspan class=\"hljs-params\"\u003e|res_err,res|\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res_err == \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e)\n    puts \u003cspan class=\"hljs-string\"\u003e\"Deployment id is: \u003cspan class=\"hljs-subst\"\u003e#{res}\u003c/span\u003e\"\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    puts \u003cspan class=\"hljs-string\"\u003e\"Deployment failed!\"\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe completion handler will be passed a result containing the deployment ID string, if deployment succeeded.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis deployment ID can be used later if you want to undeploy the deployment.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_undeploying_verticle_deployments\"\u003e\u003ca class=\"anchor\" href=\"#_undeploying_verticle_deployments\"\u003e\u003c/a\u003eUndeploying verticle deployments\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eDeployments can be undeployed with \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#undeploy-instance_method\"\u003eundeploy\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUn-deployment is itself asynchronous so if you want to be notified when un-deployment is complete you can deploy specifying a completion handler:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003evertx.undeploy(deploymentID) { \u003cspan class=\"hljs-params\"\u003e|res_err,res|\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res_err == \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e)\n    puts \u003cspan class=\"hljs-string\"\u003e\"Undeployed ok\"\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    puts \u003cspan class=\"hljs-string\"\u003e\"Undeploy failed!\"\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_specifying_number_of_verticle_instances\"\u003e\u003ca class=\"anchor\" href=\"#_specifying_number_of_verticle_instances\"\u003e\u003c/a\u003eSpecifying number of verticle instances\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen deploying a verticle using a verticle name, you can specify the number of verticle instances that you\nwant to deploy:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003eoptions = {\n  \u003cspan class=\"hljs-string\"\u003e'instances'\u003c/span\u003e =\u0026gt; \u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e\n}\nvertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"com.mycompany.MyOrderProcessorVerticle\"\u003c/span\u003e, options)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is useful for scaling easily across multiple cores. For example you might have a web-server verticle to deploy\nand multiple cores on your machine, so you want to deploy multiple instances to utilise all the cores.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::override/verticle-configuration.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_verticle_isolation_groups\"\u003e\u003ca class=\"anchor\" href=\"#_verticle_isolation_groups\"\u003e\u003c/a\u003eVerticle Isolation Groups\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default, Vert.x has a \u003cem\u003eflat classpath\u003c/em\u003e. I.e, when Vert.x deploys verticles it does so with the current classloader -\nit doesn\u0026#8217;t create a new one. In the majority of cases this is the simplest, clearest, and sanest thing to do.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHowever, in some cases you may want to deploy a verticle so the classes of that verticle are isolated from others in\nyour application.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis might be the case, for example, if you want to deploy two different versions of a verticle with the same class name\nin the same Vert.x instance, or if you have two different verticles which use different versions of the same jar library.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using an isolation group you provide a list of the class names that you want isolated using\n\u003ccode\u003e\u003ca href=\"../dataobjects.html#DeploymentOptions#set_isolated_classes-instance_method\"\u003eisolatedClasses\u003c/a\u003e\u003c/code\u003e-  an entry can be a fully qualified\nclassname such as \u003ccode\u003ecom.mycompany.myproject.engine.MyClass\u003c/code\u003e or it can be a wildcard which will match any classes in a package and any\nsub-packages, e.g. \u003ccode\u003ecom.mycompany.myproject.*\u003c/code\u003e would match any classes in the package \u003ccode\u003ecom.mycompany.myproject\u003c/code\u003e or\nany sub-packages.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease note that \u003cem\u003eonly\u003c/em\u003e the classes that match will be isolated - any other classes will be loaded by the current\nclass loader.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eExtra classpath entries can also be provided with \u003ccode\u003e\u003ca href=\"../dataobjects.html#DeploymentOptions#set_extra_classpath-instance_method\"\u003eextraClasspath\u003c/a\u003e\u003c/code\u003e so if\nyou want to load classes or resources that aren\u0026#8217;t already present on the main classpath you can add this.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock warning\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eWarning\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nUse this feature with caution. Class-loaders can be a can of worms, and can make debugging difficult, amongst\nother things.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of using an isolation group to isolate a verticle deployment.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003eoptions = {\n  \u003cspan class=\"hljs-string\"\u003e'isolationGroup'\u003c/span\u003e =\u0026gt; \u003cspan class=\"hljs-string\"\u003e\"mygroup\"\u003c/span\u003e\n}\noptions[\u003cspan class=\"hljs-string\"\u003e'isolatedClasses'\u003c/span\u003e] = [\u003cspan class=\"hljs-string\"\u003e\"com.mycompany.myverticle.*\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"com.mycompany.somepkg.SomeClass\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"org.somelibrary.*\"\u003c/span\u003e]\nvertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"com.mycompany.myverticle.VerticleClass\"\u003c/span\u003e, options)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_high_availability\"\u003e\u003ca class=\"anchor\" href=\"#_high_availability\"\u003e\u003c/a\u003eHigh Availability\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVerticles can be deployed with High Availability (HA) enabled. In that context, when a verticle is deployed on\na vert.x instance that dies abruptly, the verticle is redeployed on another vert.x instance from the cluster.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo run an verticle with the high availability enabled, just append the \u003ccode\u003e-ha\u003c/code\u003e switch:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-verticle.js -ha\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen enabling high availability, no need to add \u003ccode\u003e-cluster\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMore details about the high availability feature and configuration in the \u003ca href=\"#_high_availability_and_fail_over\"\u003eHigh Availability and Fail-Over\u003c/a\u003e\n section.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_running_verticles_from_the_command_line\"\u003e\u003ca class=\"anchor\" href=\"#_running_verticles_from_the_command_line\"\u003e\u003c/a\u003eRunning Verticles from the command line\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use Vert.x directly in your Maven or Gradle projects in the normal way by adding a dependency to the Vert.x\ncore library and hacking from there.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHowever you can also run Vert.x verticles directly from the command line if you wish.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo do this you need to download and install a Vert.x distribution, and add the \u003ccode\u003ebin\u003c/code\u003e directory of the installation\nto your \u003ccode\u003ePATH\u003c/code\u003e environment variable. Also make sure you have a Java 8 JDK on your \u003ccode\u003ePATH\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nThe JDK is required to support on the fly compilation of Java code.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can now run verticles by using the \u003ccode\u003evertx run\u003c/code\u003e command. Here are some examples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e# Run a JavaScript verticle\nvertx run my_verticle.js\n\n# Run a Ruby verticle\nvertx run a_n_other_verticle.rb\n\n# Run a Groovy script verticle, clustered\nvertx run FooVerticle.groovy -cluster\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can even run Java source verticles without compiling them first!\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003evertx run SomeJavaSourceFile.java\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x will compile the Java source file on the fly before running it. This is really useful for quickly\nprototyping verticles and great for demos. No need to set-up a Maven or Gradle build first to get going!\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor full information on the various options available when executing \u003ccode\u003evertx\u003c/code\u003e on the command line,\ntype \u003ccode\u003evertx\u003c/code\u003e at the command line.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_causing_vert_x_to_exit\"\u003e\u003ca class=\"anchor\" href=\"#_causing_vert_x_to_exit\"\u003e\u003c/a\u003eCausing Vert.x to exit\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThreads maintained by Vert.x instances are not daemon threads so they will prevent the JVM from exiting.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you are embedding Vert.x and you have finished with it, you can call \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#close-instance_method\"\u003eclose\u003c/a\u003e\u003c/code\u003e to close it\ndown.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis will shut-down all internal thread pools and close other resources, and will allow the JVM to exit.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_the_context_object\"\u003e\u003ca class=\"anchor\" href=\"#_the_context_object\"\u003e\u003c/a\u003eThe Context object\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen Vert.x provides an event to a handler or calls the start or stop methods of a\n\u003ccode\u003e\u003ca href=\"unavailable\"\u003eVerticle\u003c/a\u003e\u003c/code\u003e, the execution is associated with a \u003ccode\u003eContext\u003c/code\u003e. Usually a context is an\n\u003cstrong\u003eevent-loop context\u003c/strong\u003e and is tied to a specific event loop thread. So executions for that context always occur\non that exact same event loop thread. In the case of worker verticles and running inline blocking code a\nworker context will be associated with the execution which will use a thread from the worker thread pool.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo retrieve the context, use the \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#get_or_create_context-instance_method\"\u003egetOrCreateContext\u003c/a\u003e\u003c/code\u003e method:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003econtext = vertx.get_or_create_context()\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf the current thread has a context associated with it, it reuses the context object. If not a new instance of\ncontext is created. You can test the \u003cem\u003etype\u003c/em\u003e of context you have retrieved:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/context'\u003c/span\u003e\ncontext = vertx.get_or_create_context()\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (context.event_loop_context?())\n  puts \u003cspan class=\"hljs-string\"\u003e\"Context attached to Event Loop\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eelsif\u003c/span\u003e (context.worker_context?())\n  puts \u003cspan class=\"hljs-string\"\u003e\"Context attached to Worker Thread\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eelsif\u003c/span\u003e (context.multi_threaded_worker_context?())\n  puts \u003cspan class=\"hljs-string\"\u003e\"Context attached to Worker Thread - multi threaded worker\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eelsif\u003c/span\u003e (!Vertx::Context.on_vertx_thread?())\n  puts \u003cspan class=\"hljs-string\"\u003e\"Context not attached to a thread managed by vert.x\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you have retrieved the context object, you can run code in this context asynchronously. In other words,\nyou submit a task that will be eventually run in the same context, but later:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003evertx.get_or_create_context().run_on_context() { \u003cspan class=\"hljs-params\"\u003e|v|\u003c/span\u003e\n  puts \u003cspan class=\"hljs-string\"\u003e\"This will be executed asynchronously in the same context\"\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen several handlers run in the same context, they may want to share data. The context object offers methods to\nstore and retrieve data shared in the context. For instance, it lets you pass data to some action run with\n\u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Context.html#run_on_context-instance_method\"\u003erunOnContext\u003c/a\u003e\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003econtext = vertx.get_or_create_context()\ncontext.put(\u003cspan class=\"hljs-string\"\u003e\"data\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"hello\"\u003c/span\u003e)\ncontext.run_on_context() { \u003cspan class=\"hljs-params\"\u003e|v|\u003c/span\u003e\n  hello = context.get(\u003cspan class=\"hljs-string\"\u003e\"data\"\u003c/span\u003e)\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe context object also let you access verticle configuration using the \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Context.html#config-instance_method\"\u003econfig\u003c/a\u003e\u003c/code\u003e\nmethod. Check the \u003ca href=\"#Passing configuration to a verticle\"\u003e[Passing configuration to a verticle]\u003c/a\u003e section for more details about this configuration.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_executing_periodic_and_delayed_actions\"\u003e\u003ca class=\"anchor\" href=\"#_executing_periodic_and_delayed_actions\"\u003e\u003c/a\u003eExecuting periodic and delayed actions\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt\u0026#8217;s very common in Vert.x to want to perform an action after a delay, or periodically.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn standard verticles you can\u0026#8217;t just make the thread sleep to introduce a delay, as that will block the event loop thread.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eInstead you use Vert.x timers. Timers can be \u003cstrong\u003eone-shot\u003c/strong\u003e or \u003cstrong\u003eperiodic\u003c/strong\u003e. We\u0026#8217;ll discuss both\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_one_shot_timers\"\u003e\u003ca class=\"anchor\" href=\"#_one_shot_timers\"\u003e\u003c/a\u003eOne-shot Timers\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA one shot timer calls an event handler after a certain delay, expressed in milliseconds.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo set a timer to fire once you use \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#set_timer-instance_method\"\u003esetTimer\u003c/a\u003e\u003c/code\u003e method passing in the delay and a handler\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003etimerID = vertx.set_timer(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e) { \u003cspan class=\"hljs-params\"\u003e|id|\u003c/span\u003e\n  puts \u003cspan class=\"hljs-string\"\u003e\"And one second later this is printed\"\u003c/span\u003e\n}\n\nputs \u003cspan class=\"hljs-string\"\u003e\"First this is printed\"\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe return value is a unique timer id which can later be used to cancel the timer. The handler is also passed the timer id.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_periodic_timers\"\u003e\u003ca class=\"anchor\" href=\"#_periodic_timers\"\u003e\u003c/a\u003ePeriodic Timers\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also set a timer to fire periodically by using \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#set_periodic-instance_method\"\u003esetPeriodic\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere will be an initial delay equal to the period.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe return value of \u003ccode\u003esetPeriodic\u003c/code\u003e is a unique timer id (long). This can be later used if the timer needs to be cancelled.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe argument passed into the timer event handler is also the unique timer id:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eKeep in mind that the timer will fire on a periodic basis. If your periodic treatment takes a long amount of time to proceed,\nyour timer events could run continuously or even worse : stack up.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn this case, you should consider using \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#set_timer-instance_method\"\u003esetTimer\u003c/a\u003e\u003c/code\u003e instead. Once your treatment has\nfinished, you can set the next timer.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003etimerID = vertx.set_periodic(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e) { \u003cspan class=\"hljs-params\"\u003e|id|\u003c/span\u003e\n  puts \u003cspan class=\"hljs-string\"\u003e\"And every second this is printed\"\u003c/span\u003e\n}\n\nputs \u003cspan class=\"hljs-string\"\u003e\"First this is printed\"\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_cancelling_timers\"\u003e\u003ca class=\"anchor\" href=\"#_cancelling_timers\"\u003e\u003c/a\u003eCancelling timers\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo cancel a periodic timer, call \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Vertx.html#cancel_timer-instance_method\"\u003ecancelTimer\u003c/a\u003e\u003c/code\u003e specifying the timer id. For example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003evertx.cancel_timer?(timerID)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_automatic_clean_up_in_verticles\"\u003e\u003ca class=\"anchor\" href=\"#_automatic_clean_up_in_verticles\"\u003e\u003c/a\u003eAutomatic clean-up in verticles\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you\u0026#8217;re creating timers from inside verticles, those timers will be automatically closed\nwhen the verticle is undeployed.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_verticle_worker_pool\"\u003e\u003ca class=\"anchor\" href=\"#_verticle_worker_pool\"\u003e\u003c/a\u003eVerticle worker pool\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVerticles use the Vert.x worker pool for executing blocking actions, i.e \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/Context.html#execute_blocking-instance_method\"\u003eexecuteBlocking\u003c/a\u003e\u003c/code\u003e or\nworker verticle.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA different worker pool can be specified in deployment options:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003evertx.deploy_verticle(\u003cspan class=\"hljs-string\"\u003e\"the-verticle\"\u003c/span\u003e, {\n  \u003cspan class=\"hljs-string\"\u003e'workerPoolName'\u003c/span\u003e =\u0026gt; \u003cspan class=\"hljs-string\"\u003e\"the-specific-pool\"\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv id=\"event_bus\" class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::eventbus.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::override/json.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::json-pointers.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::buffers.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::net.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::http.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::shareddata.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::filesystem.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::datagrams.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::dns.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv id=\"streams\" class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::streams.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::parsetools.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_thread_safety\"\u003e\u003ca class=\"anchor\" href=\"#_thread_safety\"\u003e\u003c/a\u003eThread safety\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMost Vert.x objects are safe to access from different threads. \u003cem\u003eHowever\u003c/em\u003e performance is optimised when they are\naccessed from the same context they were created from.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor example if you have deployed a verticle which creates a \u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/NetServer.html\"\u003eNetServer\u003c/a\u003e\u003c/code\u003e which provides\n\u003ccode\u003e\u003ca href=\"../../yardoc/Vertx/NetSocket.html\"\u003eNetSocket\u003c/a\u003e\u003c/code\u003e instances in it\u0026#8217;s handler, then it\u0026#8217;s best to always access that socket instance\nfrom the event loop of the verticle.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you stick to the standard Vert.x verticle deployment model and avoid sharing objects between verticles then this\nshould be the case without you having to think about it.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_metrics_spi\"\u003e\u003ca class=\"anchor\" href=\"#_metrics_spi\"\u003e\u003c/a\u003eMetrics SPI\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default Vert.x does not record any metrics. Instead it provides an SPI for others to implement which can be added\nto the classpath. The metrics SPI is an advanced feature which allows implementers to capture events from Vert.x in\norder to gather metrics. For more information on this, please consult the\n\u003ccode\u003e\u003ca href=\"unavailable\"\u003eAPI Documentation\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also specify a metrics factory programmatically if embedding Vert.x using\n\u003ccode\u003e\u003ca href=\"../dataobjects.html#MetricsOptions#set_factory-instance_method\"\u003efactory\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_osgi\"\u003e\u003ca class=\"anchor\" href=\"#_osgi\"\u003e\u003c/a\u003eOSGi\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Core is packaged as an OSGi bundle, so can be used in any OSGi R4.2+ environment such as Apache Felix\nor Eclipse Equinox. The bundle exports \u003ccode\u003eio.vertx.core*\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHowever, the bundle has some dependencies on Jackson and Netty. To get the vert.x core bundle resolved deploy:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eJackson Annotation [2.6.0,3)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eJackson Core [2.6.2,3)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eJackson Databind [2.6.2,3)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNetty Buffer [4.0.31,5)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNetty Codec [4.0.31,5)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNetty Codec/Socks [4.0.31,5)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNetty Codec/Common [4.0.31,5)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNetty Codec/Handler [4.0.31,5)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNetty Codec/Transport [4.0.31,5)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere is a working deployment on Apache Felix 5.2.0:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003e14|Active     |    1|Jackson-annotations (2.6.0)\n15|Active     |    1|Jackson-core (2.6.2)\n16|Active     |    1|jackson-databind (2.6.2)\n18|Active     |    1|Netty/Buffer (4.0.31.Final)\n19|Active     |    1|Netty/Codec (4.0.31.Final)\n20|Active     |    1|Netty/Codec/HTTP (4.0.31.Final)\n21|Active     |    1|Netty/Codec/Socks (4.0.31.Final)\n22|Active     |    1|Netty/Common (4.0.31.Final)\n23|Active     |    1|Netty/Handler (4.0.31.Final)\n24|Active     |    1|Netty/Transport (4.0.31.Final)\n25|Active     |    1|Netty/Transport/SCTP (4.0.31.Final)\n26|Active     |    1|Vert.x Core (3.1.0)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOn Equinox, you may want to disable the \u003ccode\u003eContextFinder\u003c/code\u003e with the following framework property:\n\u003ccode\u003eeclipse.bundle.setTCCL=false\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_the_vertx_command_line\"\u003e\u003ca class=\"anchor\" href=\"#_the_vertx_command_line\"\u003e\u003c/a\u003eThe 'vertx' command line\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003evertx\u003c/code\u003e command is used to interact with Vert.x from the command line. It\u0026#8217;s main use is to run Vert.x verticles.\nTo do this you need to download and install a Vert.x distribution, and add the \u003ccode\u003ebin\u003c/code\u003e directory of the installation\nto your \u003ccode\u003ePATH\u003c/code\u003e environment variable. Also make sure you have a Java 8 JDK on your \u003ccode\u003ePATH\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nThe JDK is required to support on the fly compilation of Java code.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_run_verticles\"\u003e\u003ca class=\"anchor\" href=\"#_run_verticles\"\u003e\u003c/a\u003eRun verticles\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can run raw Vert.x verticles directly from the command line using \u003ccode\u003evertx run\u003c/code\u003e. Here is a couple of examples of\nthe \u003ccode\u003erun\u003c/code\u003e \u003cem\u003ecommand\u003c/em\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-verticle.js                                 (1)\nvertx run my-verticle.groovy                             (2)\nvertx run my-verticle.rb                                 (3)\n\nvertx run io.vertx.example.MyVerticle                    (4)\nvertx run io.vertx.example.MVerticle -cp my-verticle.jar (5)\n\nvertx run MyVerticle.java                                (6)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"olist arabic\"\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\n\u003cp\u003eDeploys a JavaScript verticle\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDeploys a Groovy verticle\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDeploys a Ruby verticle\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDeploys an already compiled Java verticle. Classpath root is the current directory\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDeploys a verticle packaged in a Jar, the jar need to be in the classpath\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCompiles the Java source and deploys it\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs you can see in the case of Java, the name can either be the fully qualified class name of the verticle, or\nyou can specify the Java Source file directly and Vert.x compiles it for you.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also prefix the verticle with the name of the language implementation to use. For example if the verticle is\na compiled Groovy class, you prefix it with \u003ccode\u003egroovy:\u003c/code\u003e so that Vert.x knows it\u0026#8217;s a Groovy class not a Java class.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run groovy:io.vertx.example.MyGroovyVerticle\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003evertx run\u003c/code\u003e command can take a few optional parameters, they are:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-options \u0026lt;options\u0026gt;\u003c/code\u003e - Provides the Vert.x options.\n\u003ccode\u003eoptions\u003c/code\u003e is the name of a JSON file that represents the Vert.x options, or a JSON string. This is optional.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-conf \u0026lt;config\u0026gt;\u003c/code\u003e - Provides some configuration to the verticle.\n\u003ccode\u003econfig\u003c/code\u003e is the name of a JSON file that represents the configuration for the verticle, or a JSON string. This is optional.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-cp \u0026lt;path\u0026gt;\u003c/code\u003e - The path on which to search for the verticle and any other resources used by the verticle. This\ndefaults to \u003ccode\u003e.\u003c/code\u003e (current directory). If your verticle references other scripts, classes or other resources\n(e.g. jar files) then make sure these are on this path. The path can contain multiple path entries separated by\n\u003ccode\u003e:\u003c/code\u003e (colon) or \u003ccode\u003e;\u003c/code\u003e (semi-colon) depending on the operating system. Each path entry can be an absolute or relative\npath to a directory containing scripts, or absolute or relative filenames for jar or zip files. An example path\nmight be \u003ccode\u003e-cp classes:lib/otherscripts:jars/myjar.jar:jars/otherjar.jar\u003c/code\u003e. Always use the path to reference any\nresources that your verticle requires. Do \u003cstrong\u003enot\u003c/strong\u003e put them on the system classpath as this can cause isolation\nissues between deployed verticles.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-instances \u0026lt;instances\u0026gt;\u003c/code\u003e  - The number of instances of the verticle to instantiate. Each verticle instance is\nstrictly single threaded so to scale your application across available cores you might want to deploy more than\none instance. If omitted a single instance will be deployed.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-worker\u003c/code\u003e - This option determines whether the verticle is a worker verticle or not.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-cluster\u003c/code\u003e -  This option determines whether the Vert.x instance will attempt to form a cluster with other Vert.x\ninstances on the network. Clustering Vert.x instances allows Vert.x to form a distributed event bus with\nother nodes. Default is \u003ccode\u003efalse\u003c/code\u003e (not clustered).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-cluster-port\u003c/code\u003e - If the \u003ccode\u003ecluster\u003c/code\u003e option has also been specified then this determines which port will be bound for\ncluster communication with other Vert.x instances. Default is \u003ccode\u003e0\u003c/code\u003e - which means '\u003cem\u003echoose a free random port\u003c/em\u003e'. You\ndon\u0026#8217;t usually need to specify this parameter unless you really need to bind to a specific port.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-cluster-host\u003c/code\u003e - If the \u003ccode\u003ecluster\u003c/code\u003e option has also been specified then this determines which host address will be\nbound for cluster communication with other Vert.x instances. By default it will try and pick one from the available\ninterfaces. If you have more than one interface and you want to use a specific one, specify it here.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-cluster-public-port\u003c/code\u003e - If the \u003ccode\u003ecluster\u003c/code\u003e option has also been specified then this determines which port will be advertised for\ncluster communication with other Vert.x instances. Default is \u003ccode\u003e-1\u003c/code\u003e, which means same as \u003ccode\u003ecluster-port\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-cluster-public-host\u003c/code\u003e - If the \u003ccode\u003ecluster\u003c/code\u003e option has also been specified then this determines which host address will be advertised for\ncluster communication with other Vert.x instances. If not specified, Vert.x uses the value of \u003ccode\u003ecluster-host\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-ha\u003c/code\u003e - if specified the verticle will be deployed as  high availability (HA) deployment. See related section\nfor more details\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-quorum\u003c/code\u003e - used in conjunction with \u003ccode\u003e-ha\u003c/code\u003e. It specifies the minimum number of nodes in the cluster for any \u003cem\u003eHA\ndeploymentIDs\u003c/em\u003e to be active. Defaults to 0.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e-hagroup\u003c/code\u003e - used in conjunction with \u003ccode\u003e-ha\u003c/code\u003e. It specifies the HA group this node will join. There can be\nmultiple HA groups in a cluster. Nodes will only failover to other nodes in the same group. The default value is `\n__DEFAULT__`\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also set system properties using: \u003ccode\u003e-Dkey=value\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some more examples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRun a JavaScript verticle server.js with default settings\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run server.js\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRun 10 instances of a pre-compiled Java verticle specifying classpath\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run com.acme.MyVerticle -cp \"classes:lib/myjar.jar\" -instances 10\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRun 10 instances of a Java verticle by source \u003cem\u003efile\u003c/em\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run MyVerticle.java -instances 10\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRun 20 instances of a ruby worker verticle\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run order_worker.rb -instances 20 -worker\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRun two JavaScript verticles on the same machine and let them cluster together with each other and any other servers\non the network\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run handler.js -cluster\nvertx run sender.js -cluster\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRun a Ruby verticle passing it some config\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my_verticle.rb -conf my_verticle.conf\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhere \u003ccode\u003emy_verticle.conf\u003c/code\u003e might contain something like:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e{\n\u003cspan class=\"hljs-attr\"\u003e\"name\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"foo\"\u003c/span\u003e,\n\u003cspan class=\"hljs-attr\"\u003e\"num_widgets\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe config will be available inside the verticle via the core API.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using the high-availability feature of vert.x you may want to create a \u003cem\u003ebare\u003c/em\u003e instance of vert.x. This\ninstance does not deploy any verticles when launched, but will receive a verticle if another node of the cluster\ndies. To create a \u003cem\u003ebare\u003c/em\u003e instance, launch:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx bare\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eDepending on your cluster configuration, you may have to append the \u003ccode\u003ecluster-host\u003c/code\u003e and \u003ccode\u003ecluster-port\u003c/code\u003e parameters.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_executing_a_vert_x_application_packaged_as_a_fat_jar\"\u003e\u003ca class=\"anchor\" href=\"#_executing_a_vert_x_application_packaged_as_a_fat_jar\"\u003e\u003c/a\u003eExecuting a Vert.x application packaged as a fat jar\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA \u003cem\u003efat jar\u003c/em\u003e is an executable jar embedding its dependencies. This means you don\u0026#8217;t have to have Vert.x pre-installed\non the machine on which you execute the jar. Like any executable Java jar it can be executed with.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003ejava -jar my-application-fat.jar\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere is nothing really Vert.x specific about this, you could do this with any Java application\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can either create your own main class and specify that in the manifest, but it\u0026#8217;s recommended that you write your\ncode as verticles and use the Vert.x \u003ccode\u003e\u003ca href=\"unavailable\"\u003eLauncher\u003c/a\u003e\u003c/code\u003e class (\u003ccode\u003eio.vertx.core.Launcher\u003c/code\u003e) as your main\nclass. This is the same main class used when running Vert.x at the command line and therefore allows you to\nspecify command line arguments, such as \u003ccode\u003e-instances\u003c/code\u003e in order to scale your application more easily.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo deploy your verticle in a \u003cem\u003efatjar\u003c/em\u003e like this you must have a \u003cem\u003emanifest\u003c/em\u003e with:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eMain-Class\u003c/code\u003e set to \u003ccode\u003eio.vertx.core.Launcher\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eMain-Verticle\u003c/code\u003e specifying the main verticle (fully qualified class name or script file name)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also provide the usual command line arguments that you would pass to \u003ccode\u003evertx run\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003ejava -jar my-verticle-fat.jar -cluster -conf myconf.json\njava -jar my-verticle-fat.jar -cluster -conf myconf.json -cp path/to/dir/conf/cluster_xml\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nPlease consult the Maven/Gradle simplest and Maven/Gradle verticle examples in the examples repository for\nexamples of building applications as fatjars.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA fat jar executes the \u003ccode\u003erun\u003c/code\u003e command, by default.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_displaying_version_of_vert_x\"\u003e\u003ca class=\"anchor\" href=\"#_displaying_version_of_vert_x\"\u003e\u003c/a\u003eDisplaying version of Vert.x\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo display the vert.x version, just launch:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx version\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_other_commands\"\u003e\u003ca class=\"anchor\" href=\"#_other_commands\"\u003e\u003c/a\u003eOther commands\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003evertx\u003c/code\u003e command line and the \u003ccode\u003eLauncher\u003c/code\u003e also provide other \u003cem\u003ecommands\u003c/em\u003e in addition to \u003ccode\u003erun\u003c/code\u003e and \u003ccode\u003eversion\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can create a \u003ccode\u003ebare\u003c/code\u003e instance using:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx bare\n# or\njava -jar my-verticle-fat.jar bare\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also start an application in background using:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003ejava -jar my-verticle-fat.jar start --vertx-id=my-app-name\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf \u003ccode\u003emy-app-name\u003c/code\u003e is not set, a random id will be generated, and printed on the command prompt. You can pass \u003ccode\u003erun\u003c/code\u003e\noptions to the \u003ccode\u003estart\u003c/code\u003e command:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003ejava -jar my-verticle-fat.jar start —-vertx-id=my-app-name -cluster\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOnce launched in background, you can stop it with the \u003ccode\u003estop\u003c/code\u003e command:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003ejava -jar my-verticle-fat.jar stop my-app-name\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also list the vert.x application launched in background using:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003ejava -jar my-verticle-fat.jar list\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003estart\u003c/code\u003e, \u003ccode\u003estop\u003c/code\u003e and \u003ccode\u003elist\u003c/code\u003e command are also available from the \u003ccode\u003evertx\u003c/code\u003e tool. The start` command supports a couple of options:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003evertx-id\u003c/code\u003e : the application id, uses a random UUID if not set\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ejava-opts\u003c/code\u003e : the Java Virtual Machine options, uses the \u003ccode\u003eJAVA_OPTS\u003c/code\u003e environment variable if not set.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eredirect-output\u003c/code\u003e : redirect the spawned process output and error streams to the parent process streams.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf option values contain spaces, don\u0026#8217;t forget to wrap the value between \u003ccode\u003e\"\"\u003c/code\u003e (double-quotes).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs the \u003ccode\u003estart\u003c/code\u003e command spawns a new process, the java options passed to the JVM are not propagated, so you \u003cstrong\u003emust\u003c/strong\u003e\nuse \u003ccode\u003ejava-opts\u003c/code\u003e to configure the JVM (\u003ccode\u003e-X\u003c/code\u003e, \u003ccode\u003e-D\u003c/code\u003e\u0026#8230;\u0026#8203;). If you use the \u003ccode\u003eCLASSPATH\u003c/code\u003e environment variable, be sure it\ncontains all the required jars (vertx-core, your jars and all the dependencies).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe set of commands is extensible, refer to the \u003ca href=\"#_extending_the_vert_x_launcher\"\u003eExtending the vert.x Launcher\u003c/a\u003e section.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_live_redeploy\"\u003e\u003ca class=\"anchor\" href=\"#_live_redeploy\"\u003e\u003c/a\u003eLive Redeploy\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen developing it may be convenient to automatically redeploy your application upon file changes. The \u003ccode\u003evertx\u003c/code\u003e\ncommand line tool and more generally the \u003ccode\u003e\u003ca href=\"unavailable\"\u003eLauncher\u003c/a\u003e\u003c/code\u003e class offers this feature. Here are some\nexamples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run MyVerticle.groovy --redeploy=\"**\u0026amp;#47;*.groovy\" --launcher-class=io.vertx.core.Launcher\nvertx run MyVerticle.groovy --redeploy=\"**\u0026amp;#47;*.groovy,**\u0026amp;#47;*.rb\"  --launcher-class=io.vertx.core.Launcher\njava io.vertx.core.Launcher run org.acme.MyVerticle --redeploy=\"**\u0026amp;#47;*.class\"  --launcher-class=io.vertx.core\n.Launcher -cp ...\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe redeployment process is implemented as follows. First your application is launched as a background application\n(with the \u003ccode\u003estart\u003c/code\u003e command). On matching file changes, the process is stopped and the application is restarted.\nThis avoids leaks, as the process is restarted.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo enable the live redeploy, pass the \u003ccode\u003e--redeploy\u003c/code\u003e option to the \u003ccode\u003erun\u003c/code\u003e command. The \u003ccode\u003e--redeploy\u003c/code\u003e indicates the\nset of file to \u003cem\u003ewatch\u003c/em\u003e. This set can use Ant-style patterns (with \u003ccode\u003e**\u003c/code\u003e, \u003ccode\u003e*\u003c/code\u003e and \u003ccode\u003e?\u003c/code\u003e). You can specify\nseveral sets by separating them using a comma (\u003ccode\u003e,\u003c/code\u003e). Patterns are relative to the current working directory.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eParameters passed to the \u003ccode\u003erun\u003c/code\u003e command are passed to the application. Java Virtual Machine options can be\nconfigured using \u003ccode\u003e--java-opts\u003c/code\u003e. For instance, to pass the the \u003ccode\u003econf\u003c/code\u003e parameter or a system property, you need to\nuse: \u003ccode\u003e--java-opts=\"-conf=my-conf.json -Dkey=value\"\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003e--launcher-class\u003c/code\u003e option determine with with \u003cem\u003emain\u003c/em\u003e class the application is launcher. It\u0026#8217;s generally\n\u003ccode\u003e\u003ca href=\"unavailable\"\u003eLauncher\u003c/a\u003e\u003c/code\u003e, but you have use you own \u003cem\u003emain\u003c/em\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe redeploy feature can be used in your IDE:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eEclipse - create a \u003cem\u003eRun\u003c/em\u003e configuration, using the \u003ccode\u003eio.vertx.core.Launcher\u003c/code\u003e class a \u003cem\u003emain class\u003c/em\u003e. In the \u003cem\u003eProgram\narguments\u003c/em\u003e area (in the \u003cem\u003eArguments\u003c/em\u003e tab), write \u003ccode\u003erun your-verticle-fully-qualified-name --redeploy=**\u0026#47;*.java\n--launcher-class=io.vertx.core.Launcher\u003c/code\u003e. You can also add other parameters. The redeployment works smoothly as\nEclipse incrementally compiles your files on save.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIntelliJ - create a \u003cem\u003eRun\u003c/em\u003e configuration (\u003cem\u003eApplication\u003c/em\u003e), set the \u003cem\u003eMain class\u003c/em\u003e to \u003ccode\u003eio.vertx.core.Launcher\u003c/code\u003e. In\nthe Program arguments write: \u003ccode\u003erun your-verticle-fully-qualified-name --redeploy=**\u0026#47;*.class\n--launcher-class=io.vertx.core.Launcher\u003c/code\u003e. To trigger the redeployment, you need to \u003cem\u003emake\u003c/em\u003e the project or\nthe module explicitly (\u003cem\u003eBuild\u003c/em\u003e menu \u0026#8594; \u003cem\u003eMake project\u003c/em\u003e).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo debug your application, create your run configuration as a remote application and configure the debugger\nusing \u003ccode\u003e--java-opts\u003c/code\u003e. However, don\u0026#8217;t forget to re-plug the debugger after every redeployment as a new process is\ncreated every time.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also hook your build process in the redeploy cycle:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003ejava -jar target/my-fat-jar.jar --redeploy=\"**\u0026amp;#47;*.java\" --on-redeploy=\"mvn package\"\njava -jar build/libs/my-fat-jar.jar --redeploy=\"src\u0026amp;#47;**\u0026amp;#47;*.java\" --on-redeploy='./gradlew shadowJar'\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \"on-redeploy\" option specifies a command invoked after the shutdown of the application and before the\nrestart. So you can hook your build tool if it updates some runtime artifacts. For instance, you can launch \u003ccode\u003egulp\u003c/code\u003e\nor \u003ccode\u003egrunt\u003c/code\u003e to update your resources. Don\u0026#8217;t forget that passing parameters to your application requires the\n\u003ccode\u003e--java-opts\u003c/code\u003e param:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003ejava -jar target/my-fat-jar.jar --redeploy=\"**\u0026amp;#47;*.java\" --on-redeploy=\"mvn package\" --java-opts=\"-Dkey=val\"\njava -jar build/libs/my-fat-jar.jar --redeploy=\"src\u0026amp;#47;**\u0026amp;#47;*.java\" --on-redeploy='./gradlew shadowJar' --java-opts=\"-Dkey=val\"\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe redeploy feature also supports the following settings:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eredeploy-scan-period\u003c/code\u003e : the file system check period (in milliseconds), 250ms by default\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eredeploy-grace-period\u003c/code\u003e : the amount of time (in milliseconds) to wait between 2 re-deployments, 1000ms by default\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eredeploy-termination-period\u003c/code\u003e : the amount of time to wait after having stopped the application (before\nlaunching user command). This is useful on Windows, where the process is not killed immediately. The time is given\nin milliseconds. 0 ms by default.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_cluster_managers\"\u003e\u003ca class=\"anchor\" href=\"#_cluster_managers\"\u003e\u003c/a\u003eCluster Managers\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn Vert.x a cluster manager is used for various functions including:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eDiscovery and group membership of Vert.x nodes in a cluster\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMaintaining cluster wide topic subscriber lists (so we know which nodes are interested in which event bus addresses)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDistributed Map support\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDistributed Locks\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDistributed Counters\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCluster managers \u003cem\u003edo not\u003c/em\u003e handle the event bus inter-node transport, this is done directly by Vert.x with TCP connections.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe default cluster manager used in the Vert.x distributions is one that uses \u003ca href=\"http://hazelcast.com\"\u003eHazelcast\u003c/a\u003e but this\ncan be easily replaced by a different implementation as Vert.x cluster managers are pluggable.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA cluster manager must implement the interface \u003ccode\u003e\u003ca href=\"unavailable\"\u003eClusterManager\u003c/a\u003e\u003c/code\u003e. Vert.x locates\ncluster managers at run-time by using the Java\n\u003ca href=\"https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html\"\u003eService Loader\u003c/a\u003e functionality to locate\ninstances of \u003ccode\u003e\u003ca href=\"unavailable\"\u003eClusterManager\u003c/a\u003e\u003c/code\u003e on the classpath.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you are using Vert.x at the command line and you want to use clustering you should make sure the \u003ccode\u003elib\u003c/code\u003e directory\nof the Vert.x installation contains your cluster manager jar.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you are using Vert.x from a Maven or Gradle project just add the cluster manager jar as a dependency of your project.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also specify cluster managers programmatically if embedding Vert.x using\n\u003ccode\u003e\u003ca href=\"../dataobjects.html#VertxOptions#set_cluster_manager-instance_method\"\u003eclusterManager\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_logging\"\u003e\u003ca class=\"anchor\" href=\"#_logging\"\u003e\u003c/a\u003eLogging\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x logs using it\u0026#8217;s in-built logging API. The default implementation uses the JDK (JUL) logging so no extra\nlogging dependencies are needed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_configuring_jul_logging\"\u003e\u003ca class=\"anchor\" href=\"#_configuring_jul_logging\"\u003e\u003c/a\u003eConfiguring JUL logging\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA JUL logging configuration file can be specified in the normal JUL way by providing a system property called:\n\u003ccode\u003ejava.util.logging.config.file\u003c/code\u003e with the value being your configuration file. For more information on this and\nthe structure of a JUL config file please consult the JUL logging documentation.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x also provides a slightly more convenient way to specify a configuration file without having to set a system\nproperty. Just provide a JUL config file with the name \u003ccode\u003evertx-default-jul-logging.properties\u003c/code\u003e on your classpath (e.g.\ninside your fatjar) and Vert.x will use that to configure JUL.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_using_another_logging_framework\"\u003e\u003ca class=\"anchor\" href=\"#_using_another_logging_framework\"\u003e\u003c/a\u003eUsing another logging framework\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you don\u0026#8217;t want Vert.x to use JUL for it\u0026#8217;s own logging you can configure it to use another logging framework, e.g.\nLog4J or SLF4J.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo do this you should set a system property called \u003ccode\u003evertx.logger-delegate-factory-class-name\u003c/code\u003e with the name of a Java\nclass which implements the interface \u003ccode\u003e\u003ca href=\"unavailable\"\u003eLogDelegateFactory\u003c/a\u003e\u003c/code\u003e. We provide pre-built\nimplementations for Log4J (version 1), Log4J 2 and SLF4J with the class names\n\u003ccode\u003eio.vertx.core.logging.Log4jLogDelegateFactory\u003c/code\u003e, \u003ccode\u003eio.vertx.core.logging.Log4j2LogDelegateFactory\u003c/code\u003e and\n\u003ccode\u003eio.vertx.core.logging.SLF4JLogDelegateFactory\u003c/code\u003e respectively. If you want to use these implementations you should\nalso make sure the relevant Log4J or SLF4J jars are on your classpath.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNotice that, the provided delegate for Log4J 1 does not support parameterized message. The delegate for Log4J 2\nuses the \u003ccode\u003e{}\u003c/code\u003e syntax like the SLF4J delegate. JUL delegate uses the \u003ccode\u003e{x}\u003c/code\u003e syntax.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"netty-logging\"\u003e\u003ca class=\"anchor\" href=\"#netty-logging\"\u003e\u003c/a\u003eNetty logging\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen configuring logging, you should care about configuring Netty logging as well.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNetty does not rely on external logging configuration (e.g system properties) and instead implements a logging\nconfiguration based on the logging libraries visible from the Netty classes:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003euse \u003ccode\u003eSLF4J\u003c/code\u003e library if it is visible\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eotherwise use \u003ccode\u003eLog4j\u003c/code\u003e if it is visible\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eotherwise fallback \u003ccode\u003ejava.util.logging\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe logger implementation can be forced to a specific implementation by setting Netty\u0026#8217;s internal logger implementation directly\non \u003ccode\u003eio.netty.util.internal.logging.InternalLoggerFactory\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Force logging to Log4j\u003c/span\u003e\nInternalLoggerFactory.setDefaultFactory(Log4JLoggerFactory.INSTANCE);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_troubleshooting\"\u003e\u003ca class=\"anchor\" href=\"#_troubleshooting\"\u003e\u003c/a\u003eTroubleshooting\u003c/h3\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_slf4j_warning_at_startup\"\u003e\u003ca class=\"anchor\" href=\"#_slf4j_warning_at_startup\"\u003e\u003c/a\u003eSLF4J warning at startup\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf, when you start your application, you see the following message:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003eSLF4J: Failed to load class \"org.slf4j.impl.StaticLoggerBinder\".\nSLF4J: Defaulting to no-operation (NOP) logger implementation\nSLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt means that you have SLF4J-API in your classpath but no actual binding. Messages logged with SLF4J will be dropped.\nYou should add a binding to your classpath. Check \u003ca href=\"https://www.slf4j.org/manual.html#swapping\" class=\"bare\"\u003ehttps://www.slf4j.org/manual.html#swapping\u003c/a\u003e to pick a binding and configure it.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBe aware that Netty looks for the SLF4-API jar and uses it by default.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_connection_reset_by_peer\"\u003e\u003ca class=\"anchor\" href=\"#_connection_reset_by_peer\"\u003e\u003c/a\u003eConnection reset by peer\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf your logs show a bunch of:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003eio.vertx.core.net.impl.ConnectionBase\nSEVERE: java.io.IOException: Connection reset by peer\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt means that the client is resetting the HTTP connection instead of closing it. This message also indicates that you\nmay have not consumed the complete payload (the connection was cut before you were able to).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::override/hostname-resolution.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_high_availability_and_fail_over\"\u003e\u003ca class=\"anchor\" href=\"#_high_availability_and_fail_over\"\u003e\u003c/a\u003eHigh Availability and Fail-Over\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x allows you to run your verticles with high availability (HA) support. In that case, when a vert.x\ninstance running a verticle dies abruptly, the verticle is migrated to another vertx instance. The vert.x\ninstances must be in the same cluster.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_automatic_failover\"\u003e\u003ca class=\"anchor\" href=\"#_automatic_failover\"\u003e\u003c/a\u003eAutomatic failover\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen vert.x runs with \u003cem\u003eHA\u003c/em\u003e enabled, if a vert.x instance where a verticle runs fails or dies, the verticle is\nredeployed automatically on another vert.x instance of the cluster. We call this \u003cem\u003everticle fail-over\u003c/em\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo run vert.x with the \u003cem\u003eHA\u003c/em\u003e enabled, just add the \u003ccode\u003e-ha\u003c/code\u003e flag to the command line:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-verticle.js -ha\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNow for HA to work, you need more than one Vert.x instances in the cluster, so let\u0026#8217;s say you have another\nVert.x instance that you have already started, for example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-other-verticle.js -ha\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf the Vert.x instance that is running \u003ccode\u003emy-verticle.js\u003c/code\u003e now dies (you can test this by killing the process\nwith \u003ccode\u003ekill -9\u003c/code\u003e), the Vert.x instance that is running \u003ccode\u003emy-other-verticle.js\u003c/code\u003e will automatic deploy \u003ccode\u003emy-verticle\n.js\u003c/code\u003e so now that Vert.x instance is running both verticles.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nthe migration is only possible if the second vert.x instance has access to the verticle file (here\n\u003ccode\u003emy-verticle.js\u003c/code\u003e).\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock important\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eImportant\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nPlease note that cleanly closing a Vert.x instance will not cause failover to occur, e.g. \u003ccode\u003eCTRL-C\u003c/code\u003e\nor \u003ccode\u003ekill -SIGINT\u003c/code\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also start \u003cem\u003ebare\u003c/em\u003e Vert.x instances - i.e. instances that are not initially running any verticles, they\nwill also failover for nodes in the cluster. To start a bare instance you simply do:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run -ha\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using the \u003ccode\u003e-ha\u003c/code\u003e switch you do not need to provide the \u003ccode\u003e-cluster\u003c/code\u003e switch, as a cluster is assumed if you\nwant HA.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\ndepending on your cluster configuration, you may need to customize the cluster manager configuration\n(Hazelcast by default), and/or add the \u003ccode\u003ecluster-host\u003c/code\u003e and \u003ccode\u003ecluster-port\u003c/code\u003e parameters.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_ha_groups\"\u003e\u003ca class=\"anchor\" href=\"#_ha_groups\"\u003e\u003c/a\u003eHA groups\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen running a Vert.x instance with HA you can also optional specify a \u003cem\u003eHA group\u003c/em\u003e. A HA group denotes a\nlogical group of nodes in the cluster. Only nodes with the same HA group will failover onto one another. If\nyou don\u0026#8217;t specify a HA group the default group \u003ccode\u003e__DEFAULT__\u003c/code\u003e is used.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo specify an HA group you use the \u003ccode\u003e-hagroup\u003c/code\u003e switch when running the verticle, e.g.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-verticle.js -ha -hagroup my-group\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eLet\u0026#8217;s look at an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn a first terminal:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-verticle.js -ha -hagroup g1\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn a second terminal, let\u0026#8217;s run another verticle using the same group:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-other-verticle.js -ha -hagroup g1\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFinally, in a third terminal, launch another verticle using a different group:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run yet-another-verticle.js -ha -hagroup g2\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf we kill the instance in terminal 1, it will fail over to the instance in terminal 2, not the instance in\nterminal 3 as that has a different group.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf we kill the instance in terminal 3, it won\u0026#8217;t get failed over as there is no other vert.x instance in that\ngroup.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_dealing_with_network_partitions_quora\"\u003e\u003ca class=\"anchor\" href=\"#_dealing_with_network_partitions_quora\"\u003e\u003c/a\u003eDealing with network partitions - Quora\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe HA implementation also supports quora. A quorum is the minimum number of votes that a distributed\ntransaction has to obtain in order to be allowed to perform an operation in a distributed system.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen starting a Vert.x instance you can instruct it that it requires a \u003ccode\u003equorum\u003c/code\u003e before any HA deployments will\nbe deployed. In this context, a quorum is a minimum number of nodes for a particular group in the cluster.\nTypically you chose your quorum size to \u003ccode\u003eQ = 1 + N/2\u003c/code\u003e where \u003ccode\u003eN\u003c/code\u003e is the number of nodes in the group. If there\nare less than \u003ccode\u003eQ\u003c/code\u003e nodes in the cluster the HA deployments will undeploy. They will redeploy again if/when a\nquorum is re-attained. By doing this you can prevent against network partitions, a.k.a. \u003cem\u003esplit brain\u003c/em\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere is more information on quora \u003ca href=\"http://en.wikipedia.org/wiki/Quorum_(distributed_computing)\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo run vert.x instances with a quorum you specify \u003ccode\u003e-quorum\u003c/code\u003e on the command line, e.g.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn a first terminal:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-verticle.js -ha -quorum 3\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAt this point the Vert.x instance will start but not deploy the module (yet) because there is only one node\nin the cluster, not 3.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn a second terminal:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my-other-verticle.js -ha -quorum 3\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAt this point the Vert.x instance will start but not deploy the module (yet) because there are only two nodes\nin the cluster, not 3.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn a third console, you can start another instance of vert.x:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run yet-another-verticle.js -ha -quorum 3\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYay! - we have three nodes, that\u0026#8217;s a quorum. At this point the modules will automatically deploy on all\ninstances.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf we now close or kill one of the nodes the modules will automatically undeploy on the other nodes, as there\nis no longer a quorum.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eQuora can also be used in conjunction with ha groups. In that case, quora are resolved for each particular\ngroup.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_native_transports\"\u003e\u003ca class=\"anchor\" href=\"#_native_transports\"\u003e\u003c/a\u003eNative transports\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x can run with \u003ca href=\"http://netty.io/wiki/native-transports.html\"\u003enative transports\u003c/a\u003e (when available) on BSD (OSX) and Linux:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::override/configuring-native.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_native_linux_transport\"\u003e\u003ca class=\"anchor\" href=\"#_native_linux_transport\"\u003e\u003c/a\u003eNative Linux Transport\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou need to add the following dependency in your classpath:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.netty\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003enetty-transport-native-epoll\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e4.1.15.Final\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eclassifier\u003c/span\u003e\u0026gt;\u003c/span\u003elinux-x86_64\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eclassifier\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNative on Linux gives you extra networking options:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eSO_REUSEPORT\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eTCP_QUICKACK\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eTCP_CORK\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eTCP_FASTOPEN\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Available on Linux\u003c/span\u003e\nvertx.create_http_server({\n  \u003cspan class=\"hljs-string\"\u003e'tcpFastOpen'\u003c/span\u003e =\u0026gt; fastOpen,\n  \u003cspan class=\"hljs-string\"\u003e'tcpCork'\u003c/span\u003e =\u0026gt; cork,\n  \u003cspan class=\"hljs-string\"\u003e'tcpQuickAck'\u003c/span\u003e =\u0026gt; quickAck,\n  \u003cspan class=\"hljs-string\"\u003e'reusePort'\u003c/span\u003e =\u0026gt; reusePort\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_native_bsd_transport\"\u003e\u003ca class=\"anchor\" href=\"#_native_bsd_transport\"\u003e\u003c/a\u003eNative BSD Transport\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou need to add the following dependency in your classpath:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.netty\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003enetty-transport-native-kqueue\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e4.1.15.Final\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eclassifier\u003c/span\u003e\u0026gt;\u003c/span\u003eosx-x86_64\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eclassifier\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMacOS Sierra and above are supported.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNative on BSD gives you extra networking options:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eSO_REUSEPORT\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Available on BSD\u003c/span\u003e\nvertx.create_http_server({\n  \u003cspan class=\"hljs-string\"\u003e'reusePort'\u003c/span\u003e =\u0026gt; reusePort\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_domain_sockets\"\u003e\u003ca class=\"anchor\" href=\"#_domain_sockets\"\u003e\u003c/a\u003eDomain sockets\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNatives provide domain sockets support for servers:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/socket_address'\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# Only available on BSD and Linux\u003c/span\u003e\nvertx.create_net_server().connect_handler() { \u003cspan class=\"hljs-params\"\u003e|so|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Handle application\u003c/span\u003e\n}.listen(Vertx::SocketAddress.domain_socket_address(\u003cspan class=\"hljs-string\"\u003e\"/var/tmp/myservice.sock\"\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eor for http:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/socket_address'\u003c/span\u003e\nvertx.create_http_server().request_handler() { \u003cspan class=\"hljs-params\"\u003e|req|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Handle application\u003c/span\u003e\n}.listen(Vertx::SocketAddress.domain_socket_address(\u003cspan class=\"hljs-string\"\u003e\"/var/tmp/myservice.sock\"\u003c/span\u003e)) { \u003cspan class=\"hljs-params\"\u003e|ar_err,ar|\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar_err == \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e)\n    \u003cspan class=\"hljs-comment\"\u003e# Bound to socket\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    ar_err.print_stack_trace()\n  \u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs well as clients:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/socket_address'\u003c/span\u003e\nnetClient = vertx.create_net_client()\n\n\u003cspan class=\"hljs-comment\"\u003e# Only available on BSD and Linux\u003c/span\u003e\naddr = Vertx::SocketAddress.domain_socket_address(\u003cspan class=\"hljs-string\"\u003e\"/var/tmp/myservice.sock\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# Connect to the server\u003c/span\u003e\nnetClient.connect(addr) { \u003cspan class=\"hljs-params\"\u003e|ar_err,ar|\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar_err == \u003cspan class=\"hljs-literal\"\u003enil\u003c/span\u003e)\n    \u003cspan class=\"hljs-comment\"\u003e# Connected\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n    ar_err.print_stack_trace()\n  \u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eor for http:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"hljs-keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'vertx/socket_address'\u003c/span\u003e\nhttpClient = vertx.create_http_client()\n\n\u003cspan class=\"hljs-comment\"\u003e# Only available on BSD and Linux\u003c/span\u003e\naddr = Vertx::SocketAddress.domain_socket_address(\u003cspan class=\"hljs-string\"\u003e\"/var/tmp/myservice.sock\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e# Send request to the server\u003c/span\u003e\nhttpClient.request(\u003cspan class=\"hljs-symbol\"\u003e:GET\u003c/span\u003e, addr, \u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"localhost\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e) { \u003cspan class=\"hljs-params\"\u003e|resp|\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Process response\u003c/span\u003e\n}.\u003cspan class=\"hljs-keyword\"\u003eend\u003c/span\u003e()\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_security_notes\"\u003e\u003ca class=\"anchor\" href=\"#_security_notes\"\u003e\u003c/a\u003eSecurity notes\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x is a toolkit, not an opinionated framework where we force you to do things in a certain way. This gives you\ngreat power as a developer but with that comes great responsibility.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs with any toolkit, it\u0026#8217;s possible to write insecure applications, so you should always be careful when developing\nyour application especially if it\u0026#8217;s exposed to the public (e.g. over the internet).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_web_applications\"\u003e\u003ca class=\"anchor\" href=\"#_web_applications\"\u003e\u003c/a\u003eWeb applications\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf writing a web application it\u0026#8217;s highly recommended that you use Vert.x-Web instead of Vert.x core directly for\nserving resources and handling file uploads.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web normalises the path in requests to prevent malicious clients from crafting URLs to access resources\noutside of the web root.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSimilarly for file uploads Vert.x-Web provides functionality for uploading to a known place on disk and does not rely\non the filename provided by the client in the upload which could be crafted to upload to a different place on disk.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x core itself does not provide such checks so it would be up to you as a developer to implement them yourself.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_clustered_event_bus_traffic\"\u003e\u003ca class=\"anchor\" href=\"#_clustered_event_bus_traffic\"\u003e\u003c/a\u003eClustered event bus traffic\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen clustering the event bus between different Vert.x nodes on a network, the traffic is sent un-encrypted across the\nwire, so do not use this if you have confidential data to send and your Vert.x nodes are not on a trusted network.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_standard_security_best_practices\"\u003e\u003ca class=\"anchor\" href=\"#_standard_security_best_practices\"\u003e\u003c/a\u003eStandard security best practices\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAny service can have potentially vulnerabilities whether it\u0026#8217;s written using Vert.x or any other toolkit so always\nfollow security best practice, especially if your service is public facing.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor example you should always run them in a DMZ and with an user account that has limited rights in order to limit\nthe extent of damage in case the service was compromised.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_vert_x_command_line_interface_api\"\u003e\u003ca class=\"anchor\" href=\"#_vert_x_command_line_interface_api\"\u003e\u003c/a\u003eVert.x Command Line Interface API\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in \u0026lt;stdin\u0026gt; - include::cli.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_the_vert_x_launcher\"\u003e\u003ca class=\"anchor\" href=\"#_the_vert_x_launcher\"\u003e\u003c/a\u003eThe vert.x Launcher\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe vert.x \u003ccode\u003e\u003ca href=\"unavailable\"\u003eLauncher\u003c/a\u003e\u003c/code\u003e is used in \u003cem\u003efat jar\u003c/em\u003e as main class, and by the \u003ccode\u003evertx\u003c/code\u003e command line\nutility. It executes a set of \u003cem\u003ecommands\u003c/em\u003e such as \u003cem\u003erun\u003c/em\u003e, \u003cem\u003ebare\u003c/em\u003e, \u003cem\u003estart\u003c/em\u003e\u0026#8230;\u0026#8203;\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_extending_the_vert_x_launcher\"\u003e\u003ca class=\"anchor\" href=\"#_extending_the_vert_x_launcher\"\u003e\u003c/a\u003eExtending the vert.x Launcher\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can extend the set of command by implementing your own \u003ccode\u003e\u003ca href=\"unavailable\"\u003eCommand\u003c/a\u003e\u003c/code\u003e (in Java only):\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u0026amp;#\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e;Name(\u003cspan class=\"hljs-string\"\u003e\"my-command\"\u003c/span\u003e)\n\u0026amp;#\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e;Summary(\u003cspan class=\"hljs-string\"\u003e\"A simple hello command.\"\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eMyCommand\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eDefaultCommand\u003c/span\u003e \u003c/span\u003e{\n\n \u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e String name;\n\n \u0026amp;#\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e;Option(longName = \u003cspan class=\"hljs-string\"\u003e\"name\"\u003c/span\u003e, required = \u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e)\n \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003esetName\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(String n)\u003c/span\u003e \u003c/span\u003e{\n   \u003cspan class=\"hljs-keyword\"\u003ethis\u003c/span\u003e.name = n;\n }\n\n \u0026amp;#\u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e;\u003cspan class=\"hljs-function\"\u003eOverride\n \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003erun\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e()\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ethrows\u003c/span\u003e CLIException \u003c/span\u003e{\n   System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Hello \"\u003c/span\u003e + name);\n }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou also need an implementation of \u003ccode\u003e\u003ca href=\"unavailable\"\u003eCommandFactory\u003c/a\u003e\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eHelloCommandFactory\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eDefaultCommandFactory\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title\"\u003eHelloCommand\u003c/span\u003e\u0026gt; \u003c/span\u003e{\n \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eHelloCommandFactory\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e()\u003c/span\u003e \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003esuper\u003c/span\u003e(HelloCommand\u003cspan class=\"hljs-class\"\u003e.\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e)\u003c/span\u003e;\n }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThen, create the \u003ccode\u003esrc/main/resources/META-INF/services/io.vertx.core.spi.launcher.CommandFactory\u003c/code\u003e and add a line\nindicating the fully qualified name of the factory:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003eio.vertx.core.launcher.example.HelloCommandFactory\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBuilds the jar containing the command. Be sure to includes the SPI file\n(\u003ccode\u003eMETA-INF/services/io.vertx.core.spi.launcher.CommandFactory\u003c/code\u003e).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThen, place the jar containing the command into the classpath of your fat-jar (or include it inside) or in the \u003ccode\u003elib\u003c/code\u003e\ndirectory of your vert.x distribution, and you would be able to execute:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx hello vert.x\njava -jar my-fat-jar.jar hello vert.x\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_using_the_launcher_in_fat_jars\"\u003e\u003ca class=\"anchor\" href=\"#_using_the_launcher_in_fat_jars\"\u003e\u003c/a\u003eUsing the Launcher in fat jars\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use the \u003ccode\u003e\u003ca href=\"unavailable\"\u003eLauncher\u003c/a\u003e\u003c/code\u003e class in a \u003cem\u003efat-jar\u003c/em\u003e just set the \u003ccode\u003eMain-Class\u003c/code\u003e of the \u003cem\u003eMANIFEST\u003c/em\u003e to\n\u003ccode\u003eio.vertx.core.Launcher\u003c/code\u003e. In addition, set the \u003ccode\u003eMain-Verticle\u003c/code\u003e \u003cem\u003eMANIFEST\u003c/em\u003e entry to the name of your main verticle.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default, it executed the \u003ccode\u003erun\u003c/code\u003e command. However, you can configure the default command by setting the\n\u003ccode\u003eMain-Command\u003c/code\u003e \u003cem\u003eMANIFEST\u003c/em\u003e entry. The default command is used if the \u003cem\u003efat jar\u003c/em\u003e is launched without a command.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_sub_classing_the_launcher\"\u003e\u003ca class=\"anchor\" href=\"#_sub_classing_the_launcher\"\u003e\u003c/a\u003eSub-classing the Launcher\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also create a sub-class of \u003ccode\u003e\u003ca href=\"unavailable\"\u003eLauncher\u003c/a\u003e\u003c/code\u003e to start your application. The class has been\ndesigned to be easily extensible.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA \u003ccode\u003e\u003ca href=\"unavailable\"\u003eLauncher\u003c/a\u003e\u003c/code\u003e sub-class can:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ecustomize the vert.x configuration in \u003ccode\u003e\u003ca href=\"unavailable#before_starting_vertx-instance_method\"\u003ebeforeStartingVertx\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eretrieve the vert.x instance created by the \"run\" or \"bare\" command by\noverriding \u003ccode\u003e\u003ca href=\"unavailable#after_starting_vertx-instance_method\"\u003eafterStartingVertx\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003econfigure the default verticle and command with\n\u003ccode\u003e\u003ca href=\"unavailable#get_main_verticle-instance_method\"\u003egetMainVerticle\u003c/a\u003e\u003c/code\u003e and\n\u003ccode\u003e\u003ca href=\"unavailable#get_default_command-instance_method\"\u003egetDefaultCommand\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eadd / remove commands using \u003ccode\u003e\u003ca href=\"unavailable#register-instance_method\"\u003eregister\u003c/a\u003e\u003c/code\u003e\nand \u003ccode\u003e\u003ca href=\"unavailable#unregister-instance_method\"\u003eunregister\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_launcher_and_exit_code\"\u003e\u003ca class=\"anchor\" href=\"#_launcher_and_exit_code\"\u003e\u003c/a\u003eLauncher and exit code\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you use the \u003ccode\u003e\u003ca href=\"unavailable\"\u003eLauncher\u003c/a\u003e\u003c/code\u003e class as main class, it uses the following exit code:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e0\u003c/code\u003e if the process ends smoothly, or if an uncaught error is thrown\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e1\u003c/code\u003e for general purpose error\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e11\u003c/code\u003e if Vert.x cannot be initialized\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e12\u003c/code\u003e if a spawn process cannot be started, found or stopped. This error code is used by the \u003ccode\u003estart\u003c/code\u003e and\n\u003ccode\u003estop\u003c/code\u003e command\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e14\u003c/code\u003e if the system configuration is not meeting the system requirement (shc as java not found)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e15\u003c/code\u003e if the main verticle cannot be deployed\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_configuring_vert_x_cache\"\u003e\u003ca class=\"anchor\" href=\"#_configuring_vert_x_cache\"\u003e\u003c/a\u003eConfiguring Vert.x cache\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen Vert.x needs to read a file from the classpath (embedded in a fat jar, in a jar form the classpath or a file\nthat is on the classpath), it copies it to a cache directory. The reason behind this is simple: reading a file\nfrom a jar or from an input stream is blocking. So to avoid to pay the price every time, Vert.x copies the file to\nits cache directory and reads it from there every subsequent read. This behavior can be configured.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFirst, by default, Vert.x uses \u003ccode\u003e$CWD/.vertx\u003c/code\u003e as cache directory. It creates a unique directory inside this one to\navoid conflicts. This location can be configured by using the \u003ccode\u003evertx.cacheDirBase\u003c/code\u003e system property. For instance\nif the current working directory is not writable (such as in an immutable container context), launch your\napplication with:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003evertx run my.Verticle -Dvertx.cacheDirBase=/tmp/vertx-cache\n# or\njava -jar my-fat.jar vertx.cacheDirBase=/tmp/vertx-cache\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock important\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eImportant\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nthe directory must be \u003cstrong\u003ewritable\u003c/strong\u003e.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you are editing resources such as HTML, CSS or JavaScript, this cache mechanism can be annoying as it serves\nonly the first version of the file (and so you won\u0026#8217;t see your edits if you reload your page). To avoid this\nbehavior, launch your application with \u003ccode\u003e-Dvertx.disableFileCaching=true\u003c/code\u003e. With this setting, Vert.x still uses\nthe cache, but always refresh the version stored in the cache with the original source. So if you edit a file\nserved from the classpath and refresh your browser, Vert.x reads it from the classpath, copies it to the cache\ndirectory and serves it from there. Do not use this setting in production, it can kill your performances.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFinally, you can disable completely the cache by using \u003ccode\u003e-Dvertx.disableFileCPResolving=true\u003c/code\u003e. This setting is not\nwithout consequences. Vert.x would be unable to read any files from the classpath (only from the file system). Be\nvery careful when using this settings.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e"},"__N_SSG":true},"page":"/docs/[[...slug]]","query":{"slug":["3.8.4","vertx-core","ruby"]},"buildId":"Z-p86lnm_k5TmKwV4hI3t","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"charSet":"utf-8"}],["meta",{"httpEquiv":"X-UA-Compatible","content":"IE=edge"}],["meta",{"name":"viewport","content":"width=device-width, initial-scale=1, shrink-to-fit=no"}],["meta",{"name":"description","content":"Vert.x | Reactive applications on the JVM"}],["meta",{"name":"robots","content":"index,follow"}],["link",{"href":"https://fonts.googleapis.com/css?family=Roboto:300,400,500","rel":"stylesheet"}],["link",{"href":"https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400","rel":"stylesheet"}],["link",{"href":"https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400\u0026display=swap","rel":"stylesheet"}],["link",{"rel":"shortcut icon","href":"/favicons/favicon.ico"}],["link",{"rel":"icon","type":"image/png","sizes":"16x16","href":"/favicons/favicon-16x16.png"}],["link",{"rel":"icon","type":"image/png","sizes":"32x32","href":"/favicons/favicon-32x32.png"}],["link",{"rel":"icon","type":"image/png","sizes":"48x48","href":"/favicons/favicon-48x48.png"}],["title",{"children":"Vert.x Core Manual | Eclipse Vert.x"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-5a9a91c546a2d4fb4cc4.js"></script><script src="/_next/static/chunks/main-a5439aed580585c60faa.js" async=""></script><script src="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" async=""></script><script src="/_next/static/chunks/framework.4df82c4704a0136f6a4b.js" async=""></script><script src="/_next/static/chunks/commons.535b6603caf47859052a.js" async=""></script><script src="/_next/static/chunks/styles.8577696c4e17514af975.js" async=""></script><script src="/_next/static/chunks/pages/_app-8beb549608891d89d2f4.js" async=""></script><script src="/_next/static/chunks/4f16b6dee4e09daf8bf4ac98169064eb9dcaeaf1.0f6a83d1c5caa3878fd9.js" async=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-f40e234f2aec2fb6c8b1.js" async=""></script><script src="/_next/static/Z-p86lnm_k5TmKwV4hI3t/_buildManifest.js" async=""></script><script src="/_next/static/Z-p86lnm_k5TmKwV4hI3t/_ssgManifest.js" async=""></script></body></html>