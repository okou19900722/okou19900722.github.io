<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><title>Cassandra Client for Vert.x</title><meta name="next-head-count" content="9"/><link rel="preload" href="/_next/static/css/styles.9a6ebcf2.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.9a6ebcf2.chunk.css"/><link rel="preload" href="/_next/static/KJl23CUTg6SxIXzsvS5RS/pages/docs/%5B...slug%5D.js" as="script"/><link rel="preload" href="/_next/static/KJl23CUTg6SxIXzsvS5RS/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.2452a08f25aa09397355.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5e3e47f192c8968126d4.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.a536770b8a7efd3f31c6.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-82853df24da4e8dbe047.js" as="script"/><link rel="preload" href="/_next/static/chunks/5e791559a9a12799b7c8380cc031d13dc3b616ba.c1ef14f95bc9470df0df.js" as="script"/></head><body><div id="__next"><main><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4="/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><a class="navbar-menu-item" href="/">Ecosystem</a><a class="navbar-menu-item" href="/docs/">Docs</a><a class="navbar-menu-item" href="/">FAQ</a><a class="navbar-menu-item" href="/">Blog</a><a class="navbar-menu-item" href="/">Community</a></div><div class="navbar-social"><a href="/" class="navbar-social-link navbar-social-version">v4.0.0</a><a href="/" class="navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M23.495 6.205a3.007 3.007 0 0 0-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 0 0 .527 6.205a31.247 31.247 0 0 0-.522 5.805 31.247 31.247 0 0 0 .522 5.783 3.007 3.007 0 0 0 2.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 0 0 2.088-2.088 31.247 31.247 0 0 0 .5-5.783 31.247 31.247 0 0 0-.5-5.805zM9.609 15.601V8.408l6.264 3.602z"></path></svg></a><a href="/" class="navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="/" class="navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M8.501 4.001H10.5V24H8.501V4.001zm6.999 0V24h-2V4.001h2zM3.5 0h2.001v15H3.5V0zm15 4.001h2V15h-2V4.001z"></path></svg></a></div></div></div></div></header><div class="page"><div class="container"><div><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A Vert.x client allowing applications to interact with an <a href="http://cassandra.apache.org/">Apache Cassandra</a> service.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This module has <em>Tech Preview</em> status, this means the API can change between versions.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use this module, add the following to the <em>dependencies</em> section of your Maven POM file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-cassandra-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.0-milestone4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, if you use Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">compile <span class="hljs-string">'io.vertx:vertx-cassandra-client:4.0.0-milestone4'</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The Cassandra client is not compatible with the Vert.x Dropwizard Metrics library.
Both are using a different major version of the Dropwizard Metrics library and the Datastax Java driver <a href="https://github.com/datastax/java-driver/pull/943">won&#8217;t upgrade</a> to the most recent version due to the drop of Java 7.
The next major version (4.x) of the driver will use a more recent Dropwizard Metrics library  version.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_client">Creating a client</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_client_options">Client options</h3>
<div class="paragraph">
<p>Cassandra is a distributed system, and it can have many nodes.
To connect to Cassandra you need to specify the addresses of some cluster nodes when creating a <code><a href="../../apidocs/io/vertx/cassandra/CassandraClientOptions.html">CassandraClientOptions</a></code> object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> options = CassandraClientOptions(
  contactPoints = listOf(<span class="hljs-string">"node1.address"</span>, <span class="hljs-string">"node2.address"</span>, <span class="hljs-string">"node3.address"</span>))
<span class="hljs-keyword">var</span> client = CassandraClient.createNonShared(vertx, options)</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the Cassandra client for Vert.x connects to the local machine&#8217;s port <code>9042</code> and is not tied to any specific keyspace.
But you can set either or both of these options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> options = CassandraClientOptions(
  port = <span class="hljs-number">9142</span>,
  keyspace = <span class="hljs-string">"my_keyspace"</span>)
<span class="hljs-keyword">var</span> client = CassandraClient.createNonShared(vertx, options)</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
For fine tuning purposes, <code><a href="../../apidocs/io/vertx/cassandra/CassandraClientOptions.html">CassandraClientOptions</a></code> exposes a <code>com.datastax.driver.core.Cluster.Builder</code> instance.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_shared_clients">Shared clients</h3>
<div class="paragraph">
<p>If you deploy multiple instances of your verticle or have different verticles interacting with the same database, it is recommended to create a shared client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> options = CassandraClientOptions(
  contactPoints = listOf(<span class="hljs-string">"node1.address"</span>, <span class="hljs-string">"node2.address"</span>, <span class="hljs-string">"node3.address"</span>),
  keyspace = <span class="hljs-string">"my_keyspace"</span>)
<span class="hljs-keyword">var</span> client = CassandraClient.createShared(vertx, <span class="hljs-string">"sharedClientName"</span>, options)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Shared clients with the same name will use a single underlying <code>com.datastax.driver.core.Session</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_client_lifecycle">Client lifecycle</h3>
<div class="paragraph">
<p>After the client is created, it is not connected until the first query is executed.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
A shared client can be connected after creation if another client with the same name has already executed a query.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Clients created inside a verticle are automatically stopped when the verticle is undeployed.
In other words, you do not need to invoke <code><a href="../../apidocs/io/vertx/cassandra/CassandraClient.html#close--">close</a></code> in the verticle <code>stop</code> method.</p>
</div>
<div class="paragraph">
<p>In all other cases, you must manually close the client.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When a shared client is closed, the driver dession is not closed if other clients with the same name are still running.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_api">Using the API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The client API is represented by <code><a href="../../apidocs/io/vertx/cassandra/CassandraClient.html">CassandraClient</a></code>.</p>
</div>
<div class="sect2">
<h3 id="_querying">Querying</h3>
<div class="paragraph">
<p>You can get query results using three different ways.</p>
</div>
<div class="sect3">
<h4 id="_streaming">Streaming</h4>
<div class="paragraph">
<p>The streaming API is most appropriate when you need to consume results iteratively, e.g you want to process each item.
This is very efficient specially for large amount of rows.</p>
</div>
<div class="paragraph">
<p>In order to give you some inspiration and ideas on how you can use the API, we&#8217;d like to you to consider this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">cassandraClient.queryStream(<span class="hljs-string">"SELECT my_string_col FROM my_keyspace.my_table where my_key = 'my_value'"</span>, { queryStream -&gt;
  <span class="hljs-keyword">if</span> (queryStream.succeeded()) {
    <span class="hljs-keyword">var</span> stream = queryStream.result()

    <span class="hljs-comment">// resume stream when queue is ready to accept buffers again</span>
    response.drainHandler({ v -&gt;
      stream.resume()
    })

    stream.handler({ row -&gt;
      <span class="hljs-keyword">var</span> value = row.getString(<span class="hljs-string">"my_string_col"</span>)
      response.write(value)

      <span class="hljs-comment">// pause row stream when we buffer queue is full</span>
      <span class="hljs-keyword">if</span> (response.writeQueueFull()) {
        stream.pause()
      }
    })

    <span class="hljs-comment">// end request when we reached end of the stream</span>
    stream.endHandler({ end -&gt;
      response.end()
    })

  } <span class="hljs-keyword">else</span> {
    queryStream.cause().printStackTrace()
    <span class="hljs-comment">// response with internal server error if we are not able to execute given query</span>
    response.setStatusCode(<span class="hljs-number">500</span>).end(<span class="hljs-string">"Unable to execute the query"</span>)
  }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example, we are executing a query, and stream results via HTTP.</p>
</div>
</div>
<div class="sect3">
<h4 id="_bulk_fetching">Bulk fetching</h4>
<div class="paragraph">
<p>This API should be used when you need to process all the rows at the same time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">cassandraClient.executeWithFullFetch(<span class="hljs-string">"SELECT * FROM my_keyspace.my_table where my_key = 'my_value'"</span>, { executeWithFullFetch -&gt;
  <span class="hljs-keyword">if</span> (executeWithFullFetch.succeeded()) {
    <span class="hljs-keyword">var</span> rows = executeWithFullFetch.result()
    <span class="hljs-keyword">for</span> (row <span class="hljs-keyword">in</span> rows) {
      <span class="hljs-comment">// handle each row here</span>
    }
  } <span class="hljs-keyword">else</span> {
    println(<span class="hljs-string">"Unable to execute the query"</span>)
    executeWithFullFetch.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Use bulk fetching only if you can afford to load the full result set in memory.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_collector_queries">Collector queries</h3>
<div class="paragraph">
<p>You can use Java collectors with the query API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">Code not translatable</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_low_level_fetch">Low level fetch</h4>
<div class="paragraph">
<p>This API provides greater control over loading at the expense of being a bit lower-level than the streaming and bulk fetching APIs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">cassandraClient.execute(<span class="hljs-string">"SELECT * FROM my_keyspace.my_table where my_key = 'my_value'"</span>, { execute -&gt;
  <span class="hljs-keyword">if</span> (execute.succeeded()) {
    <span class="hljs-keyword">var</span> resultSet = execute.result()

    resultSet.one({ one -&gt;
      <span class="hljs-keyword">if</span> (one.succeeded()) {
        <span class="hljs-keyword">var</span> row = one.result()
        println(<span class="hljs-string">"One row successfully fetched"</span>)
      } <span class="hljs-keyword">else</span> {
        println(<span class="hljs-string">"Unable to fetch a row"</span>)
        one.cause().printStackTrace()
      }
    })

    resultSet.fetchMoreResults({ fetchMoreResults -&gt;
      <span class="hljs-keyword">if</span> (fetchMoreResults.succeeded()) {
        <span class="hljs-keyword">var</span> availableWithoutFetching = resultSet.getAvailableWithoutFetching()
        println(<span class="hljs-string">"Now we have <span class="hljs-subst">${availableWithoutFetching}</span> rows fetched, but not consumed!"</span>)
        <span class="hljs-keyword">if</span> (resultSet.isFullyFetched()) {
          println(<span class="hljs-string">"The result is fully fetched, we don't need to call this method for one more time!"</span>)
        } <span class="hljs-keyword">else</span> {
          println(<span class="hljs-string">"The result still does not fully fetched"</span>)
        }
      } <span class="hljs-keyword">else</span> {
        println(<span class="hljs-string">"Unable to fetch more results"</span>)
        fetchMoreResults.cause().printStackTrace()
      }
    })

  } <span class="hljs-keyword">else</span> {
    println(<span class="hljs-string">"Unable to execute the query"</span>)
    execute.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_prepared_queries">Prepared queries</h3>
<div class="paragraph">
<p>For security and efficiency reasons, it is a good idea to use prepared statements for all the queries you are using more than once.</p>
</div>
<div class="paragraph">
<p>You can prepare a query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">cassandraClient.prepare(<span class="hljs-string">"SELECT * FROM my_keyspace.my_table where my_key = ? "</span>, { preparedStatementResult -&gt;
  <span class="hljs-keyword">if</span> (preparedStatementResult.succeeded()) {
    println(<span class="hljs-string">"The query has successfully been prepared"</span>)
    <span class="hljs-keyword">var</span> preparedStatement = preparedStatementResult.result()
    <span class="hljs-comment">// now you can use this PreparedStatement object for the next queries</span>
  } <span class="hljs-keyword">else</span> {
    println(<span class="hljs-string">"Unable to prepare the query"</span>)
    preparedStatementResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then use the <a href="https://docs.datastax.com/en/drivers/java/3.5/com/datastax/driver/core/PreparedStatement.html"><code>PreparedStatement</code></a> for all the next queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-comment">// You can execute you prepared statement using any way to execute queries.</span>

<span class="hljs-comment">// Low level fetch API</span>
cassandraClient.execute(preparedStatement.bind(<span class="hljs-string">"my_value"</span>), { done -&gt;
  <span class="hljs-keyword">var</span> results = done.result()
  <span class="hljs-comment">// handle results here</span>
})

<span class="hljs-comment">// Bulk fetching API</span>
cassandraClient.executeWithFullFetch(preparedStatement.bind(<span class="hljs-string">"my_value"</span>), { done -&gt;
  <span class="hljs-keyword">var</span> results = done.result()
  <span class="hljs-comment">// handle results here</span>
})

<span class="hljs-comment">// Streaming API</span>
cassandraClient.queryStream(preparedStatement.bind(<span class="hljs-string">"my_value"</span>), { done -&gt;
  <span class="hljs-keyword">var</span> results = done.result()
  <span class="hljs-comment">// handle results here</span>
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batching">Batching</h3>
<div class="paragraph">
<p>In case you&#8217;d like to execute several queries at once, you can use <a href="https://docs.datastax.com/en/drivers/java/3.5/com/datastax/driver/core/BatchStatement.html"><code>BatchStatement</code></a> for that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> batchStatement = com.datastax.driver.core.BatchStatement().add(com.datastax.driver.core.SimpleStatement(<span class="hljs-string">"INSERT INTO NAMES (name) VALUES ('Pavel')"</span>)).add(com.datastax.driver.core.SimpleStatement(<span class="hljs-string">"INSERT INTO NAMES (name) VALUES ('Thomas')"</span>)).add(com.datastax.driver.core.SimpleStatement(<span class="hljs-string">"INSERT INTO NAMES (name) VALUES ('Julien')"</span>))

cassandraClient.execute(batchStatement, { result -&gt;
  <span class="hljs-keyword">if</span> (result.succeeded()) {
    println(<span class="hljs-string">"The given batch executed successfully"</span>)
  } <span class="hljs-keyword">else</span> {
    println(<span class="hljs-string">"Unable to execute the batch"</span>)
    result.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_object_mapper">Object Mapper</h3>
<div class="paragraph">
<p>You can use the object <code><a href="../../apidocs/io/vertx/cassandra/Mapper.html">Mapper</a></code> to map between domain classes and queries.</p>
</div>
<div class="paragraph">
<p>First, add the following to the <em>dependencies</em> section of your Maven POM file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.datastax.cassandra<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>cassandra-driver-mapping<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, if you use Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">compile <span class="hljs-string">'com.datastax.cassandra:cassandra-driver-mapping:3.5.0'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Consider the following entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@Table</span>(keyspace = <span class="hljs-string">"test"</span>, name = <span class="hljs-string">"names"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MappedClass</span> </span>{
 <span class="hljs-meta">@PartitionKey</span>
 <span class="hljs-keyword">private</span> String name;

 <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MappedClass</span><span class="hljs-params">(String name)</span> </span>{
   <span class="hljs-keyword">this</span>.name = name;
 }

 MappedClass() {
   <span class="hljs-comment">// Required for mapping</span>
 }

 <span class="hljs-comment">// getters / setters</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a mapper for it and you may save, retrieve or delete data from the corresponding table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> mappingManager = MappingManager.create(cassandraClient)
<span class="hljs-keyword">var</span> mapper = mappingManager.mapper(examples.CassandraClientExamples.MappedClass.`<span class="hljs-class"><span class="hljs-keyword">class</span>`)</span>

<span class="hljs-keyword">var</span> value = examples.CassandraClientExamples.MappedClass(<span class="hljs-string">"foo"</span>)

mapper.save(value, { handler -&gt;
  <span class="hljs-comment">// Entity saved</span>
})

mapper.<span class="hljs-keyword">get</span>(java.util.Collections.singletonList(<span class="hljs-string">"foo"</span>), { handler -&gt;
  <span class="hljs-comment">// Entity loaded</span>
})

mapper.delete(java.util.Collections.singletonList(<span class="hljs-string">"foo"</span>), { handler -&gt;
  <span class="hljs-comment">// Entity deleted</span>
})</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
It is safe to reuse mapping manager and mapper instances for a given Cassandra client.
</td>
</tr>
</table>
</div>
</div>
</div>
</div></div></div></div><footer></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"Cassandra Client for Vert.x","contents":"\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA Vert.x client allowing applications to interact with an \u003ca href=\"http://cassandra.apache.org/\"\u003eApache Cassandra\u003c/a\u003e service.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock warning\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eWarning\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nThis module has \u003cem\u003eTech Preview\u003c/em\u003e status, this means the API can change between versions.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_getting_started\"\u003eGetting started\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use this module, add the following to the \u003cem\u003edependencies\u003c/em\u003e section of your Maven POM file:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-cassandra-client\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e4.0.0-milestone4\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOr, if you use Gradle:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003ecompile \u003cspan class=\"hljs-string\"\u003e'io.vertx:vertx-cassandra-client:4.0.0-milestone4'\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock warning\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eWarning\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nThe Cassandra client is not compatible with the Vert.x Dropwizard Metrics library.\nBoth are using a different major version of the Dropwizard Metrics library and the Datastax Java driver \u003ca href=\"https://github.com/datastax/java-driver/pull/943\"\u003ewon\u0026#8217;t upgrade\u003c/a\u003e to the most recent version due to the drop of Java 7.\nThe next major version (4.x) of the driver will use a more recent Dropwizard Metrics library  version.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_creating_a_client\"\u003eCreating a client\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_client_options\"\u003eClient options\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCassandra is a distributed system, and it can have many nodes.\nTo connect to Cassandra you need to specify the addresses of some cluster nodes when creating a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/cassandra/CassandraClientOptions.html\"\u003eCassandraClientOptions\u003c/a\u003e\u003c/code\u003e object:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = CassandraClientOptions(\n  contactPoints = listOf(\u003cspan class=\"hljs-string\"\u003e\"node1.address\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"node2.address\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"node3.address\"\u003c/span\u003e))\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e client = CassandraClient.createNonShared(vertx, options)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default, the Cassandra client for Vert.x connects to the local machine\u0026#8217;s port \u003ccode\u003e9042\u003c/code\u003e and is not tied to any specific keyspace.\nBut you can set either or both of these options:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = CassandraClientOptions(\n  port = \u003cspan class=\"hljs-number\"\u003e9142\u003c/span\u003e,\n  keyspace = \u003cspan class=\"hljs-string\"\u003e\"my_keyspace\"\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e client = CassandraClient.createNonShared(vertx, options)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock tip\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eTip\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nFor fine tuning purposes, \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/cassandra/CassandraClientOptions.html\"\u003eCassandraClientOptions\u003c/a\u003e\u003c/code\u003e exposes a \u003ccode\u003ecom.datastax.driver.core.Cluster.Builder\u003c/code\u003e instance.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_shared_clients\"\u003eShared clients\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you deploy multiple instances of your verticle or have different verticles interacting with the same database, it is recommended to create a shared client:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = CassandraClientOptions(\n  contactPoints = listOf(\u003cspan class=\"hljs-string\"\u003e\"node1.address\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"node2.address\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"node3.address\"\u003c/span\u003e),\n  keyspace = \u003cspan class=\"hljs-string\"\u003e\"my_keyspace\"\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e client = CassandraClient.createShared(vertx, \u003cspan class=\"hljs-string\"\u003e\"sharedClientName\"\u003c/span\u003e, options)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eShared clients with the same name will use a single underlying \u003ccode\u003ecom.datastax.driver.core.Session\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_client_lifecycle\"\u003eClient lifecycle\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAfter the client is created, it is not connected until the first query is executed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock tip\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eTip\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nA shared client can be connected after creation if another client with the same name has already executed a query.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eClients created inside a verticle are automatically stopped when the verticle is undeployed.\nIn other words, you do not need to invoke \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/cassandra/CassandraClient.html#close--\"\u003eclose\u003c/a\u003e\u003c/code\u003e in the verticle \u003ccode\u003estop\u003c/code\u003e method.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn all other cases, you must manually close the client.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eNote\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nWhen a shared client is closed, the driver dession is not closed if other clients with the same name are still running.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_the_api\"\u003eUsing the API\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe client API is represented by \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/cassandra/CassandraClient.html\"\u003eCassandraClient\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_querying\"\u003eQuerying\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can get query results using three different ways.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_streaming\"\u003eStreaming\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe streaming API is most appropriate when you need to consume results iteratively, e.g you want to process each item.\nThis is very efficient specially for large amount of rows.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn order to give you some inspiration and ideas on how you can use the API, we\u0026#8217;d like to you to consider this example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003ecassandraClient.queryStream(\u003cspan class=\"hljs-string\"\u003e\"SELECT my_string_col FROM my_keyspace.my_table where my_key = 'my_value'\"\u003c/span\u003e, { queryStream -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (queryStream.succeeded()) {\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e stream = queryStream.result()\n\n    \u003cspan class=\"hljs-comment\"\u003e// resume stream when queue is ready to accept buffers again\u003c/span\u003e\n    response.drainHandler({ v -\u0026gt;\n      stream.resume()\n    })\n\n    stream.handler({ row -\u0026gt;\n      \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e value = row.getString(\u003cspan class=\"hljs-string\"\u003e\"my_string_col\"\u003c/span\u003e)\n      response.write(value)\n\n      \u003cspan class=\"hljs-comment\"\u003e// pause row stream when we buffer queue is full\u003c/span\u003e\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (response.writeQueueFull()) {\n        stream.pause()\n      }\n    })\n\n    \u003cspan class=\"hljs-comment\"\u003e// end request when we reached end of the stream\u003c/span\u003e\n    stream.endHandler({ end -\u0026gt;\n      response.end()\n    })\n\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    queryStream.cause().printStackTrace()\n    \u003cspan class=\"hljs-comment\"\u003e// response with internal server error if we are not able to execute given query\u003c/span\u003e\n    response.setStatusCode(\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e).end(\u003cspan class=\"hljs-string\"\u003e\"Unable to execute the query\"\u003c/span\u003e)\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the example, we are executing a query, and stream results via HTTP.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_bulk_fetching\"\u003eBulk fetching\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis API should be used when you need to process all the rows at the same time.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003ecassandraClient.executeWithFullFetch(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM my_keyspace.my_table where my_key = 'my_value'\"\u003c/span\u003e, { executeWithFullFetch -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (executeWithFullFetch.succeeded()) {\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e rows = executeWithFullFetch.result()\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (row \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e rows) {\n      \u003cspan class=\"hljs-comment\"\u003e// handle each row here\u003c/span\u003e\n    }\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Unable to execute the query\"\u003c/span\u003e)\n    executeWithFullFetch.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock caution\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eCaution\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nUse bulk fetching only if you can afford to load the full result set in memory.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_collector_queries\"\u003eCollector queries\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use Java collectors with the query API:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003eCode not translatable\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_low_level_fetch\"\u003eLow level fetch\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis API provides greater control over loading at the expense of being a bit lower-level than the streaming and bulk fetching APIs.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003ecassandraClient.execute(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM my_keyspace.my_table where my_key = 'my_value'\"\u003c/span\u003e, { execute -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (execute.succeeded()) {\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e resultSet = execute.result()\n\n    resultSet.one({ one -\u0026gt;\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (one.succeeded()) {\n        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e row = one.result()\n        println(\u003cspan class=\"hljs-string\"\u003e\"One row successfully fetched\"\u003c/span\u003e)\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        println(\u003cspan class=\"hljs-string\"\u003e\"Unable to fetch a row\"\u003c/span\u003e)\n        one.cause().printStackTrace()\n      }\n    })\n\n    resultSet.fetchMoreResults({ fetchMoreResults -\u0026gt;\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (fetchMoreResults.succeeded()) {\n        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e availableWithoutFetching = resultSet.getAvailableWithoutFetching()\n        println(\u003cspan class=\"hljs-string\"\u003e\"Now we have \u003cspan class=\"hljs-subst\"\u003e${availableWithoutFetching}\u003c/span\u003e rows fetched, but not consumed!\"\u003c/span\u003e)\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (resultSet.isFullyFetched()) {\n          println(\u003cspan class=\"hljs-string\"\u003e\"The result is fully fetched, we don't need to call this method for one more time!\"\u003c/span\u003e)\n        } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n          println(\u003cspan class=\"hljs-string\"\u003e\"The result still does not fully fetched\"\u003c/span\u003e)\n        }\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        println(\u003cspan class=\"hljs-string\"\u003e\"Unable to fetch more results\"\u003c/span\u003e)\n        fetchMoreResults.cause().printStackTrace()\n      }\n    })\n\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Unable to execute the query\"\u003c/span\u003e)\n    execute.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_prepared_queries\"\u003ePrepared queries\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor security and efficiency reasons, it is a good idea to use prepared statements for all the queries you are using more than once.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can prepare a query:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003ecassandraClient.prepare(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM my_keyspace.my_table where my_key = ? \"\u003c/span\u003e, { preparedStatementResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (preparedStatementResult.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"The query has successfully been prepared\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e preparedStatement = preparedStatementResult.result()\n    \u003cspan class=\"hljs-comment\"\u003e// now you can use this PreparedStatement object for the next queries\u003c/span\u003e\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Unable to prepare the query\"\u003c/span\u003e)\n    preparedStatementResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAnd then use the \u003ca href=\"https://docs.datastax.com/en/drivers/java/3.5/com/datastax/driver/core/PreparedStatement.html\"\u003e\u003ccode\u003ePreparedStatement\u003c/code\u003e\u003c/a\u003e for all the next queries:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-comment\"\u003e// You can execute you prepared statement using any way to execute queries.\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Low level fetch API\u003c/span\u003e\ncassandraClient.execute(preparedStatement.bind(\u003cspan class=\"hljs-string\"\u003e\"my_value\"\u003c/span\u003e), { done -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e results = done.result()\n  \u003cspan class=\"hljs-comment\"\u003e// handle results here\u003c/span\u003e\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// Bulk fetching API\u003c/span\u003e\ncassandraClient.executeWithFullFetch(preparedStatement.bind(\u003cspan class=\"hljs-string\"\u003e\"my_value\"\u003c/span\u003e), { done -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e results = done.result()\n  \u003cspan class=\"hljs-comment\"\u003e// handle results here\u003c/span\u003e\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// Streaming API\u003c/span\u003e\ncassandraClient.queryStream(preparedStatement.bind(\u003cspan class=\"hljs-string\"\u003e\"my_value\"\u003c/span\u003e), { done -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e results = done.result()\n  \u003cspan class=\"hljs-comment\"\u003e// handle results here\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_batching\"\u003eBatching\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn case you\u0026#8217;d like to execute several queries at once, you can use \u003ca href=\"https://docs.datastax.com/en/drivers/java/3.5/com/datastax/driver/core/BatchStatement.html\"\u003e\u003ccode\u003eBatchStatement\u003c/code\u003e\u003c/a\u003e for that:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e batchStatement = com.datastax.driver.core.BatchStatement().add(com.datastax.driver.core.SimpleStatement(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO NAMES (name) VALUES ('Pavel')\"\u003c/span\u003e)).add(com.datastax.driver.core.SimpleStatement(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO NAMES (name) VALUES ('Thomas')\"\u003c/span\u003e)).add(com.datastax.driver.core.SimpleStatement(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO NAMES (name) VALUES ('Julien')\"\u003c/span\u003e))\n\ncassandraClient.execute(batchStatement, { result -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (result.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"The given batch executed successfully\"\u003c/span\u003e)\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Unable to execute the batch\"\u003c/span\u003e)\n    result.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_object_mapper\"\u003eObject Mapper\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use the object \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/cassandra/Mapper.html\"\u003eMapper\u003c/a\u003e\u003c/code\u003e to map between domain classes and queries.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFirst, add the following to the \u003cem\u003edependencies\u003c/em\u003e section of your Maven POM file:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003ecom.datastax.cassandra\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003ecassandra-driver-mapping\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e3.5.0\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOr, if you use Gradle:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003ecompile \u003cspan class=\"hljs-string\"\u003e'com.datastax.cassandra:cassandra-driver-mapping:3.5.0'\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eConsider the following entity:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-meta\"\u003e@Table\u003c/span\u003e(keyspace = \u003cspan class=\"hljs-string\"\u003e\"test\"\u003c/span\u003e, name = \u003cspan class=\"hljs-string\"\u003e\"names\"\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eMappedClass\u003c/span\u003e \u003c/span\u003e{\n \u003cspan class=\"hljs-meta\"\u003e@PartitionKey\u003c/span\u003e\n \u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e String name;\n\n \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eMappedClass\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(String name)\u003c/span\u003e \u003c/span\u003e{\n   \u003cspan class=\"hljs-keyword\"\u003ethis\u003c/span\u003e.name = name;\n }\n\n MappedClass() {\n   \u003cspan class=\"hljs-comment\"\u003e// Required for mapping\u003c/span\u003e\n }\n\n \u003cspan class=\"hljs-comment\"\u003e// getters / setters\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCreate a mapper for it and you may save, retrieve or delete data from the corresponding table:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e mappingManager = MappingManager.create(cassandraClient)\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e mapper = mappingManager.mapper(examples.CassandraClientExamples.MappedClass.`\u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e`)\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e value = examples.CassandraClientExamples.MappedClass(\u003cspan class=\"hljs-string\"\u003e\"foo\"\u003c/span\u003e)\n\nmapper.save(value, { handler -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// Entity saved\u003c/span\u003e\n})\n\nmapper.\u003cspan class=\"hljs-keyword\"\u003eget\u003c/span\u003e(java.util.Collections.singletonList(\u003cspan class=\"hljs-string\"\u003e\"foo\"\u003c/span\u003e), { handler -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// Entity loaded\u003c/span\u003e\n})\n\nmapper.delete(java.util.Collections.singletonList(\u003cspan class=\"hljs-string\"\u003e\"foo\"\u003c/span\u003e), { handler -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// Entity deleted\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock tip\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003eTip\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\nIt is safe to reuse mapping manager and mapper instances for a given Cassandra client.\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e"},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["vertx-cassandra-client","kotlin"]},"buildId":"KJl23CUTg6SxIXzsvS5RS","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-636e3ece1ef7a5e3df65.js"></script><script async="" data-next-page="/docs/[...slug]" src="/_next/static/KJl23CUTg6SxIXzsvS5RS/pages/docs/%5B...slug%5D.js"></script><script async="" data-next-page="/_app" src="/_next/static/KJl23CUTg6SxIXzsvS5RS/pages/_app.js"></script><script src="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" async=""></script><script src="/_next/static/chunks/framework.2452a08f25aa09397355.js" async=""></script><script src="/_next/static/chunks/commons.5e3e47f192c8968126d4.js" async=""></script><script src="/_next/static/chunks/styles.a536770b8a7efd3f31c6.js" async=""></script><script src="/_next/static/runtime/main-82853df24da4e8dbe047.js" async=""></script><script src="/_next/static/chunks/5e791559a9a12799b7c8380cc031d13dc3b616ba.c1ef14f95bc9470df0df.js" async=""></script><script src="/_next/static/KJl23CUTg6SxIXzsvS5RS/_buildManifest.js" async=""></script><script src="/_next/static/KJl23CUTg6SxIXzsvS5RS/_ssgManifest.js" async=""></script></body></html>