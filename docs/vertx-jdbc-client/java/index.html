<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><title>JDBC client | Eclipse Vert.x</title><link rel="preload" href="https://api.github.com/repos/vert-x3/vertx-jdbc-client" as="fetch" crossorigin="anonymous"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/styles.065337ce.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.065337ce.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-b6e20584df76f29b6f35.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.fcef98db13e2318579fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.6a5cc0a07ce13c54adf1.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" as="script"/><link rel="preload" href="/_next/static/chunks/5e2acbba0c73eb7c5c0e969bcd552d3808de9969.4d0eb9c3d4239c66cc89.js" as="script"/><link rel="preload" href="/_next/static/chunks/31acfd8439b7c9eee4abe9f59c7500d6c943ee0d.46f4cf2c4741679ce3eb.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-a0e26e250e9304ae7812.js" as="script"/></head><body><div id="__next"><main class="page docs"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><a class="navbar-menu-item" href="/introduction-to-vertx-and-reactive/">Intro</a><a class="navbar-menu-item" href="/docs/">Docs</a><a class="navbar-menu-item" href="/faq/">FAQ</a><a class="navbar-menu-item" href="/blog/">Blog</a><a class="navbar-menu-item" href="/community/">Community</a></div><div class="navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" class="navbar-social-link" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link" title="Stack Overflow" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>Stack Overflow</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" class="navbar-social-link" title="YouTube" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>YouTube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a href="https://discord.gg/KzEMwP2" class="navbar-social-link" title="Discord" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>Discord</title><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" class="navbar-social-link" title="Vert.x User Group" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x User Group</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a></div></div></div></div></header><div class="page-content docs-content"><div class="container"><div class="docs-content-wrapper"><aside class=""><div class="docs-content-wrapper-sidebar"><div class="search-panel"><div class="search"><input type="text" placeholder="Search..." value=""/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon-delete"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div><ul class="search-results"></ul><div class="search-results-none">No results.</div></div><div class="docs-content-toc"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_using_the_sql_client_api">Using the Sql Client API</a>
<ul class="sectlevel2">
<li><a href="#_creating_a_db_pool">Creating a DB Pool</a></li>
</ul>
</li>
<li><a href="#_legacy_jdbc_client_api">Legacy JDBC Client API</a>
<ul class="sectlevel2">
<li><a href="#_getting_a_connection">Getting a connection</a></li>
<li><a href="#_simple_sql_operations">Simple SQL Operations</a></li>
<li><a href="#_creating_a_the_client">Creating a the client</a></li>
<li><a href="#_closing_the_client">Closing the client</a></li>
<li><a href="#_the_sql_connection">The SQL Connection</a></li>
<li><a href="#_configuration">Configuration</a></li>
<li><a href="#_jdbc_drivers">JDBC Drivers</a></li>
<li><a href="#_data_types">Data types</a></li>
</ul>
</li>
</ul>
</div></div></div></aside><div class="docs-content-sidebar-toggle"><div style="position:relative"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div></div><div class="docs-content-inner"><div class="docs-content-metadata"><div class="docs-content-metadata-left"><div class="docs-content-metadata-repo"><div class="github-stars"><a href="https://github.com/vert-x3/vertx-jdbc-client"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>91 stars</a></div></div><div><a href="/docs/apidocs/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> API</a></div><div class="docs-content-metadata-examples"><a href="https://github.com/vert-x3/vertx-examples/tree/4.x/jdbc-examples"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg> Examples</a></div><div class="docs-content-metadata-edit"><a href="https://github.com/vert-x3/vertx-jdbc-client/tree/master/src/main/asciidoc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> Edit</a></div><span class="docs-content-metadata-version"><div class="dropdown"><a class="dropdown-title">v4.0.0<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/docs/vertx-jdbc-client/java/"><li class="dropdown-item active"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dropdown-check-icon"><polyline points="20 6 9 17 4 12"></polyline></svg>Latest (v<!-- -->4.0.0<!-- -->)</li></a><a href="/docs/3.9.4/vertx-jdbc-client/java/"><li class="dropdown-item">v<!-- -->3.9.4</li></a><a href="/docs/3.9.3/vertx-jdbc-client/java/"><li class="dropdown-item">v<!-- -->3.9.3</li></a><a href="/docs/3.9.2/vertx-jdbc-client/java/"><li class="dropdown-item">v<!-- -->3.9.2</li></a><a href="/docs/3.9.1/vertx-jdbc-client/java/"><li class="dropdown-item">v<!-- -->3.9.1</li></a><a href="/docs/3.9.0/vertx-jdbc-client/java/"><li class="dropdown-item">v<!-- -->3.9.0</li></a></ul></div></span></div></div><div><h1>Vert.x JDBC client</h1>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This client allows you to interact with any JDBC compliant database using an asynchronous API from your Vert.x
application.</p>
</div>
<div class="paragraph">
<p>The client API is represented with the interface <code><a href="../../apidocs/io/vertx/ext/jdbc/JDBCClient.html">JDBCClient</a></code>.</p>
</div>
<div class="paragraph">
<p>To use this project, add the following dependency to the <em>dependencies</em> section of your build descriptor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven (in your <code>pom.xml</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-jdbc-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle (in your <code>build.gradle</code> file):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">compile <span class="hljs-string">'io.vertx:vertx-jdbc-client:4.0.0'</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_sql_client_api"><a class="anchor" href="#_using_the_sql_client_api"></a>Using the Sql Client API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sql Client is the vert.x reactive API to communicate with SQL databases. There are already several implementations of the
API for popular engines such as <code>MySQL</code>, <code>PostgreSQL</code>, <code>MSSQL</code> and <code>IBM DB2</code>. However as there are still many other
engines that have no asynchronous drivers, the JDBC Client also implements the same API to allow the usage of JDBC
drivers until such asynchronous support is implemented (eventually).</p>
</div>
<div class="sect2">
<h3 id="_creating_a_db_pool"><a class="anchor" href="#_creating_a_db_pool"></a>Creating a DB Pool</h3>
<div class="paragraph">
<p>It all starts with a pool. Creating a pool is simple. The shortest example would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">JDBCPool pool = JDBCPool.pool(vertx, config);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case we are reusing the JDBC client API to create the pool. The configuration is free form and users need to
look up the properties required for the underlying connection pool of choice.</p>
</div>
<div class="paragraph">
<p>For a type safe alternative, a second factory method is present. This second factory method ensures that the config is
correct (as it&#8217;s properties and type is validated by the compiler) but currently only works with the <code>Agroal</code> connection
pool.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">JDBCPool pool = JDBCPool.pool(
  vertx,
  <span class="hljs-comment">// configure the connection</span>
  <span class="hljs-keyword">new</span> JDBCConnectOptions()
    <span class="hljs-comment">// H2 connection string</span>
    .setJdbcUrl(<span class="hljs-string">"jdbc:h2:~/test"</span>)
    <span class="hljs-comment">// username</span>
    .setUser(<span class="hljs-string">"sa"</span>)
    <span class="hljs-comment">// password</span>
    .setPassword(<span class="hljs-string">""</span>),
  <span class="hljs-comment">// configure the pool</span>
  <span class="hljs-keyword">new</span> PoolOptions()
    .setMaxSize(<span class="hljs-number">16</span>)
);</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_pool"><a class="anchor" href="#_using_the_pool"></a>Using the Pool</h4>
<div class="paragraph">
<p>Once you have a pool, you can start using your database, the pool operates in 2 modes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Managed connection mode</p>
</li>
<li>
<p>Manual connection mode</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When working in managed connection mode, as a user, you don&#8217;t need to worry to fetch and return connections to the pool.
Queries can be run directly against the pool and the pool ensures that a connection is acquired and returned after the
query is terminated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool
  .query(<span class="hljs-string">"SELECT * FROM user"</span>)
  .execute()
  .onFailure(e -&gt; {
    <span class="hljs-comment">// handle the failure</span>
  })
  .onSuccess(rows -&gt; {
    <span class="hljs-keyword">for</span> (Row row : rows) {
      System.out.println(row.getString(<span class="hljs-string">"FIRST_NAME"</span>));
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is also applicable for prepared statements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool
  .preparedQuery(<span class="hljs-string">"SELECT * FROM user WHERE emp_id &gt; ?"</span>)
  <span class="hljs-comment">// the emp id to look up</span>
  .execute(Tuple.of(<span class="hljs-number">1000</span>))
  .onFailure(e -&gt; {
    <span class="hljs-comment">// handle the failure</span>
  })
  .onSuccess(rows -&gt; {
    <span class="hljs-keyword">for</span> (Row row : rows) {
      System.out.println(row.getString(<span class="hljs-string">"FIRST_NAME"</span>));
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this mode is quite convenient as it allows you to focus on the business logic, not on the connection management.
There are times when order and causality may need to be preserved. In this case we need to execute queries on a manual
connection mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool
  .getConnection()
  .onFailure(e -&gt; {
    <span class="hljs-comment">// failed to get a connection</span>
  })
  .onSuccess(conn -&gt; {
    conn
      .query(<span class="hljs-string">"SELECT * FROM user"</span>)
      .execute()
      .onFailure(e -&gt; {
        <span class="hljs-comment">// handle the failure</span>

        <span class="hljs-comment">// very important! don't forget to return the connection</span>
        conn.close();
      })
      .onSuccess(rows -&gt; {
        <span class="hljs-keyword">for</span> (Row row : rows) {
          System.out.println(row.getString(<span class="hljs-string">"FIRST_NAME"</span>));
        }

        <span class="hljs-comment">// very important! don't forget to return the connection</span>
        conn.close();
      });
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course same is to say that prepared statements are also applicable to this mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool
  .getConnection()
  .onFailure(e -&gt; {
    <span class="hljs-comment">// failed to get a connection</span>
  })
  .onSuccess(conn -&gt; {
    conn
      .preparedQuery(<span class="hljs-string">"SELECT * FROM user WHERE emp_id &gt; ?"</span>)
      <span class="hljs-comment">// the emp_id to look up</span>
      .execute(Tuple.of(<span class="hljs-number">1000</span>))
      .onFailure(e -&gt; {
        <span class="hljs-comment">// handle the failure</span>

        <span class="hljs-comment">// very important! don't forget to return the connection</span>
        conn.close();
      })
      .onSuccess(rows -&gt; {
        <span class="hljs-keyword">for</span> (Row row : rows) {
          System.out.println(row.getString(<span class="hljs-string">"FIRST_NAME"</span>));
        }

        <span class="hljs-comment">// very important! don't forget to return the connection</span>
        conn.close();
      });
  });</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_legacy_jdbc_client_api"><a class="anchor" href="#_legacy_jdbc_client_api"></a>Legacy JDBC Client API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The JDBC Client API created in Vert.x 3 is now deprecated and instead the new SQL Client API should be used.</p>
</div>
<div class="paragraph">
<p>It will remain supported for the life time of Vert.x 4 to allow applications to be migrated to the new SQL
Client API.</p>
</div>
<div class="sect2">
<h3 id="_getting_a_connection"><a class="anchor" href="#_getting_a_connection"></a>Getting a connection</h3>
<div class="paragraph">
<p>Once you&#8217;ve created a client you use <code><a href="../../apidocs/io/vertx/ext/sql/SQLClient.html#getConnection-io.vertx.core.Handler-">getConnection</a></code> to get
a connection.</p>
</div>
<div class="paragraph">
<p>This will return the connection in the handler when one is ready from the pool.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client.getConnection(res -&gt; {
  <span class="hljs-keyword">if</span> (res.succeeded()) {

    SQLConnection connection = res.result();

    connection.query(<span class="hljs-string">"SELECT * FROM some_table"</span>, res2 -&gt; {
      <span class="hljs-keyword">if</span> (res2.succeeded()) {

        ResultSet rs = res2.result();
        <span class="hljs-comment">// Do something with results</span>
      }
    });
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed to get connection - deal with it</span>
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The connection is an instance of <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html">SQLConnection</a></code> which is a common interface not only used by
the Vert.x JDBC Client.</p>
</div>
<div class="paragraph">
<p>You can learn how to use it in the <a href="http://vertx.io/docs/vertx-sql-common/java/">common sql interface</a> documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_simple_sql_operations"><a class="anchor" href="#_simple_sql_operations"></a>Simple SQL Operations</h3>
<div class="paragraph">
<p>There are times when you will want to run a single SQL operation, e.g.: a single select of a row, or a update to a
set of rows which do not require to be part of a transaction or have dependencies on the previous or next operation.</p>
</div>
<div class="paragraph">
<p>For these cases, clients provide a boilerplate-less API <code><a href="../../apidocs/io/vertx/ext/sql/SQLOperations.html">SQLOperations</a></code>. This interface will
perform the following steps for you:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>acquire a connection from the connection pool</p>
</li>
<li>
<p>perform your action</p>
</li>
<li>
<p>close and return the connection to the connection pool</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An example where users get loaded from the <code>USERS</code> table could be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client.query(<span class="hljs-string">"SELECT * FROM USERS"</span>, ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    <span class="hljs-keyword">if</span> (ar.succeeded()) {
      ResultSet result = ar.result();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// Failed!</span>
    }
    <span class="hljs-comment">// NOTE that you don't need to worry about</span>
    <span class="hljs-comment">// the connection management (e.g.: close)</span>
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can perform the following operations as a simple one "shot" method call:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/sql/SQLClient.html#query-java.lang.String-io.vertx.core.Handler-">query</a></code></p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/sql/SQLClient.html#queryWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-">queryWithParams</a></code></p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/sql/SQLOperations.html#querySingle-java.lang.String-io.vertx.core.Handler-">querySingle</a></code></p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/sql/SQLOperations.html#querySingleWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-">querySingleWithParams</a></code></p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/sql/SQLClient.html#update-java.lang.String-io.vertx.core.Handler-">update</a></code></p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/sql/SQLClient.html#updateWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-">updateWithParams</a></code></p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/sql/SQLClient.html#call-java.lang.String-io.vertx.core.Handler-">call</a></code></p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/sql/SQLClient.html#callWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.json.JsonArray-io.vertx.core.Handler-">callWithParams</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For further details on these API please refer to the <code><a href="../../apidocs/io/vertx/ext/sql/SQLOperations.html">SQLOperations</a></code> interface.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_the_client"><a class="anchor" href="#_creating_a_the_client"></a>Creating a the client</h3>
<div class="paragraph">
<p>There are several ways to create a client. Let&#8217;s go through them all.</p>
</div>
<div class="sect3">
<h4 id="_using_default_shared_data_source"><a class="anchor" href="#_using_default_shared_data_source"></a>Using default shared data source</h4>
<div class="paragraph">
<p>In most cases you will want to share a data source between different client instances.</p>
</div>
<div class="paragraph">
<p>E.g. you scale your application by deploying multiple instances of your verticle and you want each verticle instance
to share the same datasource so you don&#8217;t end up with multiple pools</p>
</div>
<div class="paragraph">
<p>You do this as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">SQLClient client = JDBCClient.createShared(vertx, config);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first call to <code><a href="../../apidocs/io/vertx/ext/jdbc/JDBCClient.html#createShared-io.vertx.core.Vertx-io.vertx.core.json.JsonObject-">JDBCClient.createShared</a></code>
will actually create the data source, and the specified config will be used.</p>
</div>
<div class="paragraph">
<p>Subsequent calls will return a new client instance that uses the same data source, so the configuration won&#8217;t be used.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specifying_a_data_source_name"><a class="anchor" href="#_specifying_a_data_source_name"></a>Specifying a data source name</h4>
<div class="paragraph">
<p>You can create a client specifying a data source name as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">SQLClient client = JDBCClient.createShared(vertx, config, <span class="hljs-string">"MyDataSource"</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If different clients are created using the same Vert.x instance and specifying the same data source name, they will
share the same data source.</p>
</div>
<div class="paragraph">
<p>The first call to <code><a href="../../apidocs/io/vertx/ext/jdbc/JDBCClient.html#createShared-io.vertx.core.Vertx-io.vertx.core.json.JsonObject-">JDBCClient.createShared</a></code>
will actually create the data source, and the specified config will be used.</p>
</div>
<div class="paragraph">
<p>Subsequent calls will return a new client instance that uses the same data source, so the configuration won&#8217;t be used.</p>
</div>
<div class="paragraph">
<p>Use this way of creating if you wish different groups of clients to have different data sources, e.g. they&#8217;re
interacting with different databases.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_client_with_a_non_shared_data_source"><a class="anchor" href="#_creating_a_client_with_a_non_shared_data_source"></a>Creating a client with a non shared data source</h4>
<div class="paragraph">
<p>In most cases you will want to share a data source between different client instances.
However, it&#8217;s possible you want to create a client instance that doesn&#8217;t share its data source with any other client.</p>
</div>
<div class="paragraph">
<p>In that case you can use <code><a href="../../apidocs/io/vertx/ext/jdbc/JDBCClient.html#create-io.vertx.core.Vertx-io.vertx.core.json.JsonObject-">JDBCClient.create</a></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">SQLClient client = JDBCClient.create(vertx, config);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is equivalent to calling <code><a href="../../apidocs/io/vertx/ext/jdbc/JDBCClient.html#createShared-io.vertx.core.Vertx-io.vertx.core.json.JsonObject-java.lang.String-">JDBCClient.createShared</a></code>
with a unique data source name each time.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specifying_a_data_source"><a class="anchor" href="#_specifying_a_data_source"></a>Specifying a data source</h4>
<div class="paragraph">
<p>If you already have a pre-existing data source, you can also create the client directly specifying that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">SQLClient client = JDBCClient.create(vertx, dataSource);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_closing_the_client"><a class="anchor" href="#_closing_the_client"></a>Closing the client</h3>
<div class="paragraph">
<p>It&#8217;s fine to keep hold of the client for a long time (e.g. the lifetime of your verticle), but once you&#8217;re
done with it you should close it.</p>
</div>
<div class="paragraph">
<p>Clients that share a data source with other client instances are reference counted. Once the last one that references
the same data source is closed, the data source will be closed.</p>
</div>
<div class="sect3">
<h4 id="_automatic_clean_up_in_verticles"><a class="anchor" href="#_automatic_clean_up_in_verticles"></a>Automatic clean-up in verticles</h4>
<div class="paragraph">
<p>If you&#8217;re creating clients from inside verticles, the clients will be automatically closed when the verticle is undeployed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_sql_connection"><a class="anchor" href="#_the_sql_connection"></a>The SQL Connection</h3>
<div class="paragraph">
<p>A connection to the database is represented by <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html">SQLConnection</a></code>.</p>
</div>
<div class="sect3">
<h4 id="_auto_commit"><a class="anchor" href="#_auto_commit"></a>Auto-commit</h4>
<div class="paragraph">
<p>When you obtain a connection auto commit is set to <code>true</code>. This means that each operation you perform will effectively
execute in its own transaction.</p>
</div>
<div class="paragraph">
<p>If you wish to perform multiple operations in a single transaction you should set auto commit to false with
<code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#setAutoCommit-boolean-io.vertx.core.Handler-">setAutoCommit</a></code>.</p>
</div>
<div class="paragraph">
<p>When the operation is complete, the handler will be called:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">connection.setAutoCommit(<span class="hljs-keyword">false</span>, res -&gt; {
  <span class="hljs-keyword">if</span> (res.succeeded()) {
    <span class="hljs-comment">// OK!</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_executing_queries"><a class="anchor" href="#_executing_queries"></a>Executing queries</h4>
<div class="paragraph">
<p>To execute a query use <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#query-java.lang.String-io.vertx.core.Handler-">query</a></code></p>
</div>
<div class="paragraph">
<p>The query string is raw SQL that is passed through without changes to the actual database.</p>
</div>
<div class="paragraph">
<p>The handler will be called with the results, represented by <code><a href="../../apidocs/io/vertx/ext/sql/ResultSet.html">ResultSet</a></code> when the query has
been run.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">connection.query(<span class="hljs-string">"SELECT ID, FNAME, LNAME, SHOE_SIZE from PEOPLE"</span>, res -&gt; {
  <span class="hljs-keyword">if</span> (res.succeeded()) {
    <span class="hljs-comment">// Get the result set</span>
    ResultSet resultSet = res.result();
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code><a href="../../apidocs/io/vertx/ext/sql/ResultSet.html">ResultSet</a></code> instance represents the results of a query.</p>
</div>
<div class="paragraph">
<p>The list of column names are available with <code><a href="../../apidocs/io/vertx/ext/sql/ResultSet.html#getColumnNames--">getColumnNames</a></code>, and the actual results
available with <code><a href="../../apidocs/io/vertx/ext/sql/ResultSet.html#getResults--">getResults</a></code></p>
</div>
<div class="paragraph">
<p>The results are a list of <code><a href="../../apidocs/io/vertx/core/json/JsonArray.html">JsonArray</a></code> instances, one for each row of the results.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">List&lt;String&gt; columnNames = resultSet.getColumnNames();

List&lt;JsonArray&gt; results = resultSet.getResults();

<span class="hljs-keyword">for</span> (JsonArray row : results) {

  String id = row.getString(<span class="hljs-number">0</span>);
  String fName = row.getString(<span class="hljs-number">1</span>);
  String lName = row.getString(<span class="hljs-number">2</span>);
  <span class="hljs-keyword">int</span> shoeSize = row.getInteger(<span class="hljs-number">3</span>);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also retrieve the rows as a list of Json object instances with <code><a href="../../apidocs/io/vertx/ext/sql/ResultSet.html#getRows--">getRows</a></code> -
this can give you a somewhat simpler API to work with, but please be aware that SQL results can contain duplicate
column names - if that&#8217;s the case you should use <code><a href="../../apidocs/io/vertx/ext/sql/ResultSet.html#getResults--">getResults</a></code> instead.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of iterating through the results as Json object instances:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">List&lt;JsonObject&gt; rows = resultSet.getRows();

<span class="hljs-keyword">for</span> (JsonObject row : rows) {

  String id = row.getString(<span class="hljs-string">"ID"</span>);
  String fName = row.getString(<span class="hljs-string">"FNAME"</span>);
  String lName = row.getString(<span class="hljs-string">"LNAME"</span>);
  <span class="hljs-keyword">int</span> shoeSize = row.getInteger(<span class="hljs-string">"SHOE_SIZE"</span>);

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_prepared_statement_queries"><a class="anchor" href="#_prepared_statement_queries"></a>Prepared statement queries</h4>
<div class="paragraph">
<p>To execute a prepared statement query you can use
<code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#queryWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-">queryWithParams</a></code>.</p>
</div>
<div class="paragraph">
<p>This takes the query, containing the parameter place holders, and a <code><a href="../../apidocs/io/vertx/core/json/JsonArray.html">JsonArray</a></code> or parameter
values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String query = <span class="hljs-string">"SELECT ID, FNAME, LNAME, SHOE_SIZE from PEOPLE WHERE LNAME=? AND SHOE_SIZE &gt; ?"</span>;
JsonArray params = <span class="hljs-keyword">new</span> JsonArray().add(<span class="hljs-string">"Fox"</span>).add(<span class="hljs-number">9</span>);

connection.queryWithParams(query, params, res -&gt; {

  <span class="hljs-keyword">if</span> (res.succeeded()) {
    <span class="hljs-comment">// Get the result set</span>
    ResultSet resultSet = res.result();
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_executing_insert_update_or_delete"><a class="anchor" href="#_executing_insert_update_or_delete"></a>Executing INSERT, UPDATE or DELETE</h4>
<div class="paragraph">
<p>To execute an operation which updates the database use <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#update-java.lang.String-io.vertx.core.Handler-">update</a></code>.</p>
</div>
<div class="paragraph">
<p>The update string is raw SQL that is passed through without changes to the actual database.</p>
</div>
<div class="paragraph">
<p>The handler will be called with the results, represented by <code><a href="../../apidocs/io/vertx/ext/sql/UpdateResult.html">UpdateResult</a></code> when the update has
been run.</p>
</div>
<div class="paragraph">
<p>The update result holds the number of rows updated with <code><a href="../../apidocs/io/vertx/ext/sql/UpdateResult.html#getUpdated--">getUpdated</a></code>, and
if the update generated keys, they are available with <code><a href="../../apidocs/io/vertx/ext/sql/UpdateResult.html#getKeys--">getKeys</a></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">connection.update(<span class="hljs-string">"INSERT INTO PEOPLE VALUES (null, 'john', 'smith', 9)"</span>, res -&gt; {
  <span class="hljs-keyword">if</span> (res.succeeded()) {

    UpdateResult result = res.result();
    System.out.println(<span class="hljs-string">"Updated no. of rows: "</span> + result.getUpdated());
    System.out.println(<span class="hljs-string">"Generated keys: "</span> + result.getKeys());

  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_prepared_statement_updates"><a class="anchor" href="#_prepared_statement_updates"></a>Prepared statement updates</h4>
<div class="paragraph">
<p>To execute a prepared statement update you can use
<code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#updateWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-">updateWithParams</a></code>.</p>
</div>
<div class="paragraph">
<p>This takes the update, containing the parameter place holders, and a <code><a href="../../apidocs/io/vertx/core/json/JsonArray.html">JsonArray</a></code> or parameter
values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String update = <span class="hljs-string">"UPDATE PEOPLE SET SHOE_SIZE = 10 WHERE LNAME=?"</span>;
JsonArray params = <span class="hljs-keyword">new</span> JsonArray().add(<span class="hljs-string">"Fox"</span>);

connection.updateWithParams(update, params, res -&gt; {

  <span class="hljs-keyword">if</span> (res.succeeded()) {

    UpdateResult updateResult = res.result();

    System.out.println(<span class="hljs-string">"No. of rows updated: "</span> + updateResult.getUpdated());

  } <span class="hljs-keyword">else</span> {

    <span class="hljs-comment">// Failed!</span>

  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_callable_statements"><a class="anchor" href="#_callable_statements"></a>Callable statements</h4>
<div class="paragraph">
<p>To execute a callable statement (either SQL functions or SQL procedures) you can use
<code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#callWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.json.JsonArray-io.vertx.core.Handler-">callWithParams</a></code>.</p>
</div>
<div class="paragraph">
<p>This takes the callable statement using the standard JDBC format <code>{ call func_proc_name() }</code>, optionally including
parameter place holders e.g.: <code>{ call func_proc_name(?, ?) }</code>, a <code><a href="../../apidocs/io/vertx/core/json/JsonArray.html">JsonArray</a></code> containing the
parameter values and finally a <code><a href="../../apidocs/io/vertx/core/json/JsonArray.html">JsonArray</a></code> containing the
output types e.g.: <code>[null, 'VARCHAR']</code>.</p>
</div>
<div class="paragraph">
<p>Note that the index of the output type is as important as the params array. If the return value is the second
argument then the output array must contain a null value as the first element.</p>
</div>
<div class="paragraph">
<p>A SQL function returns some output using the <code>return</code> keyword, and in this case one can call it like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String func = <span class="hljs-string">"{ call one_hour_ago() }"</span>;

connection.call(func, res -&gt; {

  <span class="hljs-keyword">if</span> (res.succeeded()) {
    ResultSet result = res.result();
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>When working with Procedures you and still return values from your procedures via its arguments, in the case you do
not return anything the usage is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String func = <span class="hljs-string">"{ call new_customer(?, ?) }"</span>;

connection.callWithParams(func, <span class="hljs-keyword">new</span> JsonArray().add(<span class="hljs-string">"John"</span>).add(<span class="hljs-string">"Doe"</span>), <span class="hljs-keyword">null</span>, res -&gt; {

  <span class="hljs-keyword">if</span> (res.succeeded()) {
    <span class="hljs-comment">// Success!</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>However you can also return values like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String func = <span class="hljs-string">"{ call customer_lastname(?, ?) }"</span>;

connection.callWithParams(func, <span class="hljs-keyword">new</span> JsonArray().add(<span class="hljs-string">"John"</span>), <span class="hljs-keyword">new</span> JsonArray().addNull().add(<span class="hljs-string">"VARCHAR"</span>), res -&gt; {

  <span class="hljs-keyword">if</span> (res.succeeded()) {
    ResultSet result = res.result();
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the index of the arguments matches the index of the <code>?</code> and that the output parameters expect to be a
String describing the type you want to receive.</p>
</div>
<div class="paragraph">
<p>To avoid ambiguation the implementations are expected to follow the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a place holder in the <code>IN</code> array is <code>NOT NULL</code> it will be taken</p>
</li>
<li>
<p>When the <code>IN</code> value is NULL a check is performed on the OUT
When the <code>OUT</code> value is not null it will be registered as a output parameter
When the <code>OUT</code> is also null it is expected that the IN value is the <code>NULL</code> value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The registered <code>OUT</code> parameters will be available as an array in the result set under the output property.</p>
</div>
</div>
<div class="sect3">
<h4 id="_batch_operations"><a class="anchor" href="#_batch_operations"></a>Batch operations</h4>
<div class="paragraph">
<p>The SQL common interface also defines how to execute batch operations. There are 3 types of batch operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Batched statements <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#batch-java.util.List-io.vertx.core.Handler-">batch</a></code></p>
</li>
<li>
<p>Batched prepared statements <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#batchWithParams-java.lang.String-java.util.List-io.vertx.core.Handler-">batchWithParams</a></code></p>
</li>
<li>
<p>Batched callable statements <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#batchCallableWithParams-java.lang.String-java.util.List-java.util.List-io.vertx.core.Handler-">batchCallableWithParams</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A batches statement will exeucte a list of sql statements as for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">List&lt;String&gt; batch = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
batch.add(<span class="hljs-string">"INSERT INTO emp (NAME) VALUES ('JOE')"</span>);
batch.add(<span class="hljs-string">"INSERT INTO emp (NAME) VALUES ('JANE')"</span>);

connection.batch(batch, res -&gt; {
  <span class="hljs-keyword">if</span> (res.succeeded()) {
    List&lt;Integer&gt; result = res.result();
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>While a prepared or callable statement batch will reuse the sql statement and take an list of arguments as for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">List&lt;JsonArray&gt; batch = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
batch.add(<span class="hljs-keyword">new</span> JsonArray().add(<span class="hljs-string">"joe"</span>));
batch.add(<span class="hljs-keyword">new</span> JsonArray().add(<span class="hljs-string">"jane"</span>));

connection.batchWithParams(<span class="hljs-string">"INSERT INTO emp (name) VALUES (?)"</span>, batch, res -&gt; {
  <span class="hljs-keyword">if</span> (res.succeeded()) {
    List&lt;Integer&gt; result = res.result();
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_executing_other_operations"><a class="anchor" href="#_executing_other_operations"></a>Executing other operations</h4>
<div class="paragraph">
<p>To execute any other database operation, e.g. a <code>CREATE TABLE</code> you can use
<code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#execute-java.lang.String-io.vertx.core.Handler-">execute</a></code>.</p>
</div>
<div class="paragraph">
<p>The string is passed through without changes to the actual database. The handler is called when the operation
is complete</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String sql = <span class="hljs-string">"CREATE TABLE PEOPLE (ID int generated by default as identity (start with 1 increment by 1) not null,"</span> +
  <span class="hljs-string">"FNAME varchar(255), LNAME varchar(255), SHOE_SIZE int);"</span>;

connection.execute(sql, execute -&gt; {
  <span class="hljs-keyword">if</span> (execute.succeeded()) {
    System.out.println(<span class="hljs-string">"Table created !"</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multiple_resultset_responses"><a class="anchor" href="#_multiple_resultset_responses"></a>Multiple ResultSet responses</h4>
<div class="paragraph">
<p>In some cases your query might return more than one result set, in this case and to preserve the compatibility when
the returned result set object is converted to pure json, the next result sets are chained to the current result set
under the property <code>next</code>. A simple walk of all result sets can be achieved like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">while</span> (rs != <span class="hljs-keyword">null</span>) {
  <span class="hljs-comment">// do something with the result set...</span>

  <span class="hljs-comment">// next step</span>
  rs = rs.getNext();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_streaming"><a class="anchor" href="#_streaming"></a>Streaming</h4>
<div class="paragraph">
<p>When dealing with large data sets, it is not advised to use API just described but to stream data since it avoids
inflating the whole response into memory and JSON and data is just processed on a row by row basis, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">connection.queryStream(<span class="hljs-string">"SELECT * FROM large_table"</span>, stream -&gt; {
  <span class="hljs-keyword">if</span> (stream.succeeded()) {
    stream.result().handler(row -&gt; {
      <span class="hljs-comment">// do something with the row...</span>
    });
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>You still have full control on when the stream is pauses, resumed and ended. For cases where your query returns
multiple result sets you should use the result set ended event to fetch the next one if available. If there is more
data the stream handler will receive the new data, otherwise the end handler is invoked.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">connection.queryStream(<span class="hljs-string">"SELECT * FROM large_table; SELECT * FROM other_table"</span>, stream -&gt; {
  <span class="hljs-keyword">if</span> (stream.succeeded()) {
    SQLRowStream sqlRowStream = stream.result();

    sqlRowStream
      .resultSetClosedHandler(v -&gt; {
        <span class="hljs-comment">// will ask to restart the stream with the new result set if any</span>
        sqlRowStream.moreResults();
      })
      .handler(row -&gt; {
        <span class="hljs-comment">// do something with the row...</span>
      })
      .endHandler(v -&gt; {
        <span class="hljs-comment">// no more data available...</span>
      });
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_transactions"><a class="anchor" href="#_using_transactions"></a>Using transactions</h4>
<div class="paragraph">
<p>To use transactions first set auto-commit to false with <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#setAutoCommit-boolean-io.vertx.core.Handler-">setAutoCommit</a></code>.</p>
</div>
<div class="paragraph">
<p>You then do your transactional operations and when you want to commit or rollback use
<code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#commit-io.vertx.core.Handler-">commit</a></code> or
<code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#rollback-io.vertx.core.Handler-">rollback</a></code>.</p>
</div>
<div class="paragraph">
<p>Once the commit/rollback is complete the handler will be called and the next transaction will be automatically started.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">connection.commit(res -&gt; {
  <span class="hljs-keyword">if</span> (res.succeeded()) {
    <span class="hljs-comment">// Committed OK!</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Failed!</span>
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_closing_connections"><a class="anchor" href="#_closing_connections"></a>Closing connections</h4>
<div class="paragraph">
<p>When you&#8217;ve done with the connection you should return it to the pool with <code><a href="../../apidocs/io/vertx/ext/sql/SQLConnection.html#close-io.vertx.core.Handler-">close</a></code>.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in index.adoc - include::override/rxjava2.adoc[]</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h3>
<div class="paragraph">
<p>Configuration is passed to the client when creating or deploying it.</p>
</div>
<div class="paragraph">
<p>The following configuration properties generally apply:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>provider_class</code></dt>
<dd>
<p>The class name of the class actually used to manage the database connections. By default this is
<code>io.vertx.ext.jdbc.spi.impl.C3P0DataSourceProvider</code> but if you want to use a different provider you can override
this property and provide your implementation.</p>
</dd>
<dt class="hdlist1"><code>row_stream_fetch_size</code></dt>
<dd>
<p>The size of <code>SQLRowStream</code> internal cache which used to better performance. By default
it equals to <code>128</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Assuming the C3P0 implementation is being used (the default), the following extra configuration properties apply:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>url</code></dt>
<dd>
<p>the JDBC connection URL for the database</p>
</dd>
<dt class="hdlist1"><code>driver_class</code></dt>
<dd>
<p>the class of the JDBC driver</p>
</dd>
<dt class="hdlist1"><code>user</code></dt>
<dd>
<p>the username for the database</p>
</dd>
<dt class="hdlist1"><code>password</code></dt>
<dd>
<p>the password for the database</p>
</dd>
<dt class="hdlist1"><code>max_pool_size</code></dt>
<dd>
<p>the maximum number of connections to pool - default is <code>15</code></p>
</dd>
<dt class="hdlist1"><code>initial_pool_size</code></dt>
<dd>
<p>the number of connections to initialise the pool with - default is <code>3</code></p>
</dd>
<dt class="hdlist1"><code>min_pool_size</code></dt>
<dd>
<p>the minimum number of connections to pool</p>
</dd>
<dt class="hdlist1"><code>max_statements</code></dt>
<dd>
<p>the maximum number of prepared statements to cache - default is <code>0</code>.</p>
</dd>
<dt class="hdlist1"><code>max_statements_per_connection</code></dt>
<dd>
<p>the maximum number of prepared statements to cache per connection - default is <code>0</code>.</p>
</dd>
<dt class="hdlist1"><code>max_idle_time</code></dt>
<dd>
<p>number of seconds after which an idle connection will be closed - default is <code>0</code> (never expire).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Other Connection Pool providers are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hikari</p>
</li>
<li>
<p>Agroal</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Similar to C3P0 they can be configured by passing the configuration values on the JSON config object. For the special
case where you do not want to deploy your app as a fat jar but run with a vert.x distribution, then it is recommented
to use Agroal if you have no write permissions to add the JDBC driver to the vert.x lib directory and are passing it
using the <code>-cp</code> command line flag.</p>
</div>
<div class="paragraph">
<p>If you want to configure any other C3P0 properties, you can add a file <code>c3p0.properties</code> to the classpath.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of configuring a service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">JsonObject config = <span class="hljs-keyword">new</span> JsonObject()
  .put(<span class="hljs-string">"url"</span>, <span class="hljs-string">"jdbc:hsqldb:mem:test?shutdown=true"</span>)
  .put(<span class="hljs-string">"driver_class"</span>, <span class="hljs-string">"org.hsqldb.jdbcDriver"</span>)
  .put(<span class="hljs-string">"max_pool_size"</span>, <span class="hljs-number">30</span>);

SQLClient client = JDBCClient.createShared(vertx, config);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hikari uses a different set of properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jdbcUrl</code> for the JDBC URL</p>
</li>
<li>
<p><code>driverClassName</code> for the JDBC driven class name</p>
</li>
<li>
<p><code>maximumPoolSize</code> for the pool size</p>
</li>
<li>
<p><code>username</code> for the login (<code>password</code> for the password)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Refer to the <a href="https://github.com/brettwooldridge/HikariCP#configuration-knobs-baby">Hikari documentation</a>
for further details. Also refer to the <a href="https://agroal.github.io/">Agroal documentation</a>
to configure Agroal.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jdbc_drivers"><a class="anchor" href="#_jdbc_drivers"></a>JDBC Drivers</h3>
<div class="paragraph">
<p>If you are using the default <code>DataSourceProvider</code> (relying on c3p0), you would need to copy the JDBC driver class
in your <em>classpath</em>.</p>
</div>
<div class="paragraph">
<p>If your application is packaged as a <em>fat jar</em>, be sure to embed the jdbc driver. If your application is launched
with the <code>vertx</code> command line, copy the JDBC driver to <code>${VERTX_HOME}/lib</code>.</p>
</div>
<div class="paragraph">
<p>The behavior may be different when using a different connection pool.</p>
</div>
</div>
<div class="sect2">
<h3 id="_data_types"><a class="anchor" href="#_data_types"></a>Data types</h3>
<div class="paragraph">
<p>Due to the fact that Vert.x uses JSON as its standard message format there will be many limitations to the data types
accepted by the client. You will get out of the box the standard:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>null</p>
</li>
<li>
<p>boolean</p>
</li>
<li>
<p>number</p>
</li>
<li>
<p>string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is also an optimistic cast for temporal types (TIME, DATE, TIMESTAMP) and optionally disabled for UUID. UUIDs
are supported by many databases but not all. For example MySQL does not support it so the recommended way is to use
a VARCHAR(36) column. For other engines UUID optimistic casting can be enabled using the client config json as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{ "castUUID": true }</pre>
</div>
</div>
<div class="paragraph">
<p>When this config is present UUIDs will be handled as a native type.</p>
</div>
</div>
</div>
</div></div></div></div></div></div><footer><div class="container"><div class="footer-nav-section"><div class="footer-nav-list footer-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="footer-nav-list"><h5>Eclipse Vert.x</h5><ul class=""><li><a class="navbar-menu-item" href="/docs/">Docs</a></li><li><a href="/download/">Download</a></li><li><a href="/faq/">FAQ</a></li><li><a href="/blog/">Blog</a></li><li><a href="/community/">Community</a></li><li><a href="/channels/">Channels</a></li></ul></div><div class="footer-nav-list"><h5>Eclipse</h5><ul class=""><li><a href="https://www.eclipse.org/">Eclipse Foundation</a></li><li><a href="https://www.eclipse.org/legal/privacy.php">Privacy Policy</a></li><li><a href="https://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li><li><a href="https://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li><li><a href="https://www.eclipse.org/legal/">Legal Resources</a></li></ul></div></div><div class="footer-copyright"><div class="footer-copyright-remarks"> <!-- -->2020<!-- --> Eclipse Vert.x<br/>Eclipse Vert.x is open source and dual-licensed under the <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer">Eclipse Public License 2.0</a> and the <a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache License 2.0</a>. <br class="footer-copyright-break"/>Website design by <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer">Michel Krmer</a>.</div><div class="footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyODEuMyA5MS4xIiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGU+LnN0MHtmaWxsOiNmNzk0MjJ9LnN0MXtmaWxsOiMzZDNjM2J9PC9zdHlsZT48ZyBpZD0iTGF5ZXJfMV8xXyI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTI2NS43IDg0TDI1NyA3M2gtMi43djE3LjdoMy4zdi0xMmw5LjMgMTJoMi4xVjczaC0zLjN2MTF6bS0zMi40LTguM2M0LjIgMCA1LjggMy4zIDUuOCA2LjNzLTEuNiA2LTUuOCA2LTUuNy0zLjEtNS44LTYgMS43LTYuMyA1LjgtNi4zem0wLTNjLTYuMSAwLTkuMSA0LjctOS4xIDkuMyAwIDQuNyAyLjkgOS4xIDkuMSA5LjFzOS00LjYgOS4xLTkuMi0zLTkuMi05LjEtOS4yem0tMjEuMiAxOFY3M2gtMy4zdjE3LjdoMy4zem0tMjMuNiAwaDMuM1Y3Nmg1LjZ2LTNoLTE0LjZ2M2g1LjZsLjEgMTQuN3ptLTE4LjktNi41SDE2M2wzLjMtNy42IDMuMyA3LjZ6bTIuOCA2LjVoMy42TDE2OC4yIDczaC0zLjZsLTggMTcuN2gzLjZsMS41LTMuM2g5LjNsMS40IDMuM3ptLTM4LTE0LjZoMy42YzMuOSAwIDUuNSAyLjggNS41IDUuNS4xIDIuOC0xLjUgNS44LTUuNSA1LjhoLTMuNlY3Ni4xem0zLjctMy4xaC02Ljl2MTcuN2g2LjljNi4yIDAgOC45LTQuNSA4LjktOXMtMi44LTguNy04LjktOC43em0tMjIuNCAxMUwxMDcgNzNoLTIuN3YxNy43aDMuM3YtMTJsOS4zIDEyaDIuMVY3M2gtMy4zdjExek04OC4yIDczdjEwLjJjMCAzLTEuNiA0LjktNC4zIDQuOXMtNC42LTEuNy00LjYtNC45VjczSDc2djEwLjFjMCA1LjMgMy42IDcuOSA3LjkgNy45IDQuNCAwIDcuNy0yLjcgNy43LTcuOVY3M2gtMy40em0tMzMgMi43YzQuMiAwIDUuOCAzLjMgNS44IDYuM3MtMS42IDYtNS44IDYtNS43LTMuMS01LjgtNiAxLjctNi4zIDUuOC02LjN6bTAtM2MtNi4xIDAtOS4xIDQuNy05LjEgOS4zczIuOSA5LjEgOS4xIDkuMSA5LTQuNiA5LjEtOS4yLTMtOS4yLTkuMS05LjJ6bS0yOS43IDE4di02LjVoOC45di0zLjFoLTguOXYtNC44aDkuNFY3M0gyMi4ydjE3LjZoMy4zeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjkuNCA1NC40aC0yMi4ydi04LjloMjEuNHYtNi45aC0yMS40di05LjFoMjIuMnYtNy4yaC0yOS42djM5LjVoMjkuNnYtNy40em0tNDAtMjUuNmMtMy02LjEtOS40LTcuOC0xNS41LTcuOC03LjMgMC0xNS4zIDMuNC0xNS4zIDExLjUgMCA4LjkgNy40IDExIDE1LjUgMTIgNS4yLjYgOS4xIDIuMSA5LjEgNS44IDAgNC4zLTQuNCA1LjktOS4xIDUuOXMtOS40LTEuOS0xMS4xLTYuM2wtNi4yIDMuMmMyLjkgNy4yIDkuMSA5LjcgMTcuMiA5LjcgOC44IDAgMTYuNi0zLjggMTYuNi0xMi42IDAtOS40LTcuNy0xMS42LTE1LjktMTIuNi00LjctLjYtOC44LTEuNS04LjgtNSAwLTIuOSAyLjYtNS4yIDguMi01LjIgNC4zIDAgOCAyLjIgOS40IDQuNGw1LjktM3pNMTc2IDIyLjJjLTYuMi0uMS0xMi40IDAtMTguNiAwdjM5LjVoNy40VjUwLjFIMTc2YzE5LjQgMCAxOS40LTI3LjkgMC0yNy45em0tMTEuMSA3LjFIMTc2YzkuNSAwIDkuNSAxNCAwIDE0aC0xMS4ybC4xLTE0em0tMTggMzIuNVYyMi4yaC03LjR2MzkuNWw3LjQuMXptLTQ0LTM5LjZ2MzkuNWgyNy43di02LjloLTIwLjNWMjIuMmgtNy40ek05MC43IDUxLjdjLTIuNyAyLjUtNi4yIDQtOS45IDQtOS44IDAtMTMuNS02LjgtMTMuNi0xMy40czQuMS0xMy43IDEzLjYtMTMuN2MzLjUtLjEgNyAxLjMgOS41IDMuN2w1LTQuOGMtMy44LTMuOS05LjEtNi0xNC41LTYtMTQuMyAwLTIxIDEwLjUtMjAuOSAyMC44czYuMyAyMC4zIDIwLjkgMjAuM2M1LjYuMSAxMS0yIDE1LTUuOWwtNS4xLTV6bS0zOSAyLjdIMjkuNXYtOC45aDIxLjR2LTYuOUgyOS41di05LjFoMjIuMnYtNy4ySDIyLjJ2MzkuNWgyOS42bC0uMS03LjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuOCAxOC4yQzE4LjggNC4xIDM2LjktLjggNTIuMSA2bC0xLS43QzM1LjctNC42IDE1LjItLjEgNS4zIDE1LjNzLTUuNCAzNS45IDEwIDQ1LjhsMS4xLjZDMy44IDUwLjguOCAzMi4zIDkuOCAxOC4yeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzIuMiAyNi4xYzAtMi41IDIuMS00LjYgNC42LTQuNiAyLjUgMCA0LjYgMi4xIDQuNiA0LjYgMCAyLjUtMi4xIDQuNi00LjYgNC42LTIuNiAwLTQuNi0yLjEtNC42LTQuNnptOC42IDBjMC0yLjItMS44LTQuMS00LTQuMXMtNC4xIDEuOC00LjEgNC4xYzAgMi4yIDEuNyA0IDMuOSA0LjFoLjFjMi4zIDAgNC4xLTEuOCA0LjEtNC4xem0tNi0yLjVoMi4zYzEuMSAwIDEuOS41IDEuOSAxLjYgMCAuNy0uNCAxLjMtMS4xIDEuNWwxLjIgMS43aC0xLjRsLTEtMS41aC0uN3YxLjVoLTEuMWwtLjEtNC44em0yLjIgMi4zYy41IDAgLjgtLjMuOC0uN3MtLjMtLjctLjgtLjdoLTF2MS4zbDEgLjF6Ii8+PC9nPjwvc3ZnPg==" alt="Eclipse foundation Logo"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"vertx-jdbc-client/java","title":"Vert.x JDBC client","fallbackGitHubStars":91,"toc":"\u003cdiv id=\"toc\" class=\"toc\"\u003e\n\u003cdiv id=\"toctitle\"\u003eTable of Contents\u003c/div\u003e\n\u003cul class=\"sectlevel1\"\u003e\n\u003cli\u003e\u003ca href=\"#_using_the_sql_client_api\"\u003eUsing the Sql Client API\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_creating_a_db_pool\"\u003eCreating a DB Pool\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_legacy_jdbc_client_api\"\u003eLegacy JDBC Client API\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_getting_a_connection\"\u003eGetting a connection\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_simple_sql_operations\"\u003eSimple SQL Operations\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_creating_a_the_client\"\u003eCreating a the client\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_closing_the_client\"\u003eClosing the client\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_the_sql_connection\"\u003eThe SQL Connection\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_configuration\"\u003eConfiguration\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_jdbc_drivers\"\u003eJDBC Drivers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_data_types\"\u003eData types\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e","contents":"\u003ch1\u003eVert.x JDBC client\u003c/h1\u003e\n\n\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis client allows you to interact with any JDBC compliant database using an asynchronous API from your Vert.x\napplication.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe client API is represented with the interface \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/jdbc/JDBCClient.html\"\u003eJDBCClient\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use this project, add the following dependency to the \u003cem\u003edependencies\u003c/em\u003e section of your build descriptor:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eMaven (in your \u003ccode\u003epom.xml\u003c/code\u003e):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-jdbc-client\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e4.0.0\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eGradle (in your \u003ccode\u003ebuild.gradle\u003c/code\u003e file):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003ecompile \u003cspan class=\"hljs-string\"\u003e'io.vertx:vertx-jdbc-client:4.0.0'\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_the_sql_client_api\"\u003e\u003ca class=\"anchor\" href=\"#_using_the_sql_client_api\"\u003e\u003c/a\u003eUsing the Sql Client API\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSql Client is the vert.x reactive API to communicate with SQL databases. There are already several implementations of the\nAPI for popular engines such as \u003ccode\u003eMySQL\u003c/code\u003e, \u003ccode\u003ePostgreSQL\u003c/code\u003e, \u003ccode\u003eMSSQL\u003c/code\u003e and \u003ccode\u003eIBM DB2\u003c/code\u003e. However as there are still many other\nengines that have no asynchronous drivers, the JDBC Client also implements the same API to allow the usage of JDBC\ndrivers until such asynchronous support is implemented (eventually).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_creating_a_db_pool\"\u003e\u003ca class=\"anchor\" href=\"#_creating_a_db_pool\"\u003e\u003c/a\u003eCreating a DB Pool\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt all starts with a pool. Creating a pool is simple. The shortest example would be:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eJDBCPool pool = JDBCPool.pool(vertx, config);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn this case we are reusing the JDBC client API to create the pool. The configuration is free form and users need to\nlook up the properties required for the underlying connection pool of choice.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor a type safe alternative, a second factory method is present. This second factory method ensures that the config is\ncorrect (as it\u0026#8217;s properties and type is validated by the compiler) but currently only works with the \u003ccode\u003eAgroal\u003c/code\u003e connection\npool.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eJDBCPool pool = JDBCPool.pool(\n  vertx,\n  \u003cspan class=\"hljs-comment\"\u003e// configure the connection\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JDBCConnectOptions()\n    \u003cspan class=\"hljs-comment\"\u003e// H2 connection string\u003c/span\u003e\n    .setJdbcUrl(\u003cspan class=\"hljs-string\"\u003e\"jdbc:h2:~/test\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-comment\"\u003e// username\u003c/span\u003e\n    .setUser(\u003cspan class=\"hljs-string\"\u003e\"sa\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-comment\"\u003e// password\u003c/span\u003e\n    .setPassword(\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e),\n  \u003cspan class=\"hljs-comment\"\u003e// configure the pool\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e PoolOptions()\n    .setMaxSize(\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e)\n);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_using_the_pool\"\u003e\u003ca class=\"anchor\" href=\"#_using_the_pool\"\u003e\u003c/a\u003eUsing the Pool\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOnce you have a pool, you can start using your database, the pool operates in 2 modes:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"olist arabic\"\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\n\u003cp\u003eManaged connection mode\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eManual connection mode\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen working in managed connection mode, as a user, you don\u0026#8217;t need to worry to fetch and return connections to the pool.\nQueries can be run directly against the pool and the pool ensures that a connection is acquired and returned after the\nquery is terminated.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool\n  .query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM user\"\u003c/span\u003e)\n  .execute()\n  .onFailure(e -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// handle the failure\u003c/span\u003e\n  })\n  .onSuccess(rows -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (Row row : rows) {\n      System.out.println(row.getString(\u003cspan class=\"hljs-string\"\u003e\"FIRST_NAME\"\u003c/span\u003e));\n    }\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is also applicable for prepared statements:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM user WHERE emp_id \u0026gt; ?\"\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e// the emp id to look up\u003c/span\u003e\n  .execute(Tuple.of(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e))\n  .onFailure(e -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// handle the failure\u003c/span\u003e\n  })\n  .onSuccess(rows -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (Row row : rows) {\n      System.out.println(row.getString(\u003cspan class=\"hljs-string\"\u003e\"FIRST_NAME\"\u003c/span\u003e));\n    }\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUsing this mode is quite convenient as it allows you to focus on the business logic, not on the connection management.\nThere are times when order and causality may need to be preserved. In this case we need to execute queries on a manual\nconnection mode:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool\n  .getConnection()\n  .onFailure(e -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// failed to get a connection\u003c/span\u003e\n  })\n  .onSuccess(conn -\u0026gt; {\n    conn\n      .query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM user\"\u003c/span\u003e)\n      .execute()\n      .onFailure(e -\u0026gt; {\n        \u003cspan class=\"hljs-comment\"\u003e// handle the failure\u003c/span\u003e\n\n        \u003cspan class=\"hljs-comment\"\u003e// very important! don't forget to return the connection\u003c/span\u003e\n        conn.close();\n      })\n      .onSuccess(rows -\u0026gt; {\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (Row row : rows) {\n          System.out.println(row.getString(\u003cspan class=\"hljs-string\"\u003e\"FIRST_NAME\"\u003c/span\u003e));\n        }\n\n        \u003cspan class=\"hljs-comment\"\u003e// very important! don't forget to return the connection\u003c/span\u003e\n        conn.close();\n      });\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOf course same is to say that prepared statements are also applicable to this mode:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool\n  .getConnection()\n  .onFailure(e -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// failed to get a connection\u003c/span\u003e\n  })\n  .onSuccess(conn -\u0026gt; {\n    conn\n      .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM user WHERE emp_id \u0026gt; ?\"\u003c/span\u003e)\n      \u003cspan class=\"hljs-comment\"\u003e// the emp_id to look up\u003c/span\u003e\n      .execute(Tuple.of(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e))\n      .onFailure(e -\u0026gt; {\n        \u003cspan class=\"hljs-comment\"\u003e// handle the failure\u003c/span\u003e\n\n        \u003cspan class=\"hljs-comment\"\u003e// very important! don't forget to return the connection\u003c/span\u003e\n        conn.close();\n      })\n      .onSuccess(rows -\u0026gt; {\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (Row row : rows) {\n          System.out.println(row.getString(\u003cspan class=\"hljs-string\"\u003e\"FIRST_NAME\"\u003c/span\u003e));\n        }\n\n        \u003cspan class=\"hljs-comment\"\u003e// very important! don't forget to return the connection\u003c/span\u003e\n        conn.close();\n      });\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_legacy_jdbc_client_api\"\u003e\u003ca class=\"anchor\" href=\"#_legacy_jdbc_client_api\"\u003e\u003c/a\u003eLegacy JDBC Client API\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe JDBC Client API created in Vert.x 3 is now deprecated and instead the new SQL Client API should be used.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt will remain supported for the life time of Vert.x 4 to allow applications to be migrated to the new SQL\nClient API.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_getting_a_connection\"\u003e\u003ca class=\"anchor\" href=\"#_getting_a_connection\"\u003e\u003c/a\u003eGetting a connection\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOnce you\u0026#8217;ve created a client you use \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLClient.html#getConnection-io.vertx.core.Handler-\"\u003egetConnection\u003c/a\u003e\u003c/code\u003e to get\na connection.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis will return the connection in the handler when one is ready from the pool.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eclient.getConnection(res -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n\n    SQLConnection connection = res.result();\n\n    connection.query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM some_table\"\u003c/span\u003e, res2 -\u0026gt; {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res2.succeeded()) {\n\n        ResultSet rs = res2.result();\n        \u003cspan class=\"hljs-comment\"\u003e// Do something with results\u003c/span\u003e\n      }\n    });\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed to get connection - deal with it\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe connection is an instance of \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html\"\u003eSQLConnection\u003c/a\u003e\u003c/code\u003e which is a common interface not only used by\nthe Vert.x JDBC Client.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can learn how to use it in the \u003ca href=\"http://vertx.io/docs/vertx-sql-common/java/\"\u003ecommon sql interface\u003c/a\u003e documentation.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_simple_sql_operations\"\u003e\u003ca class=\"anchor\" href=\"#_simple_sql_operations\"\u003e\u003c/a\u003eSimple SQL Operations\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere are times when you will want to run a single SQL operation, e.g.: a single select of a row, or a update to a\nset of rows which do not require to be part of a transaction or have dependencies on the previous or next operation.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor these cases, clients provide a boilerplate-less API \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLOperations.html\"\u003eSQLOperations\u003c/a\u003e\u003c/code\u003e. This interface will\nperform the following steps for you:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"olist arabic\"\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\n\u003cp\u003eacquire a connection from the connection pool\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eperform your action\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eclose and return the connection to the connection pool\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAn example where users get loaded from the \u003ccode\u003eUSERS\u003c/code\u003e table could be:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eclient.query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM USERS\"\u003c/span\u003e, ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n      ResultSet result = ar.result();\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n    }\n    \u003cspan class=\"hljs-comment\"\u003e// NOTE that you don't need to worry about\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// the connection management (e.g.: close)\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can perform the following operations as a simple one \"shot\" method call:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLClient.html#query-java.lang.String-io.vertx.core.Handler-\"\u003equery\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLClient.html#queryWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-\"\u003equeryWithParams\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLOperations.html#querySingle-java.lang.String-io.vertx.core.Handler-\"\u003equerySingle\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLOperations.html#querySingleWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-\"\u003equerySingleWithParams\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLClient.html#update-java.lang.String-io.vertx.core.Handler-\"\u003eupdate\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLClient.html#updateWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-\"\u003eupdateWithParams\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLClient.html#call-java.lang.String-io.vertx.core.Handler-\"\u003ecall\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLClient.html#callWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.json.JsonArray-io.vertx.core.Handler-\"\u003ecallWithParams\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor further details on these API please refer to the \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLOperations.html\"\u003eSQLOperations\u003c/a\u003e\u003c/code\u003e interface.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_creating_a_the_client\"\u003e\u003ca class=\"anchor\" href=\"#_creating_a_the_client\"\u003e\u003c/a\u003eCreating a the client\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere are several ways to create a client. Let\u0026#8217;s go through them all.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_using_default_shared_data_source\"\u003e\u003ca class=\"anchor\" href=\"#_using_default_shared_data_source\"\u003e\u003c/a\u003eUsing default shared data source\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn most cases you will want to share a data source between different client instances.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eE.g. you scale your application by deploying multiple instances of your verticle and you want each verticle instance\nto share the same datasource so you don\u0026#8217;t end up with multiple pools\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou do this as follows:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eSQLClient client = JDBCClient.createShared(vertx, config);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe first call to \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/jdbc/JDBCClient.html#createShared-io.vertx.core.Vertx-io.vertx.core.json.JsonObject-\"\u003eJDBCClient.createShared\u003c/a\u003e\u003c/code\u003e\nwill actually create the data source, and the specified config will be used.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSubsequent calls will return a new client instance that uses the same data source, so the configuration won\u0026#8217;t be used.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_specifying_a_data_source_name\"\u003e\u003ca class=\"anchor\" href=\"#_specifying_a_data_source_name\"\u003e\u003c/a\u003eSpecifying a data source name\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can create a client specifying a data source name as follows\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eSQLClient client = JDBCClient.createShared(vertx, config, \u003cspan class=\"hljs-string\"\u003e\"MyDataSource\"\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf different clients are created using the same Vert.x instance and specifying the same data source name, they will\nshare the same data source.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe first call to \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/jdbc/JDBCClient.html#createShared-io.vertx.core.Vertx-io.vertx.core.json.JsonObject-\"\u003eJDBCClient.createShared\u003c/a\u003e\u003c/code\u003e\nwill actually create the data source, and the specified config will be used.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSubsequent calls will return a new client instance that uses the same data source, so the configuration won\u0026#8217;t be used.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUse this way of creating if you wish different groups of clients to have different data sources, e.g. they\u0026#8217;re\ninteracting with different databases.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_creating_a_client_with_a_non_shared_data_source\"\u003e\u003ca class=\"anchor\" href=\"#_creating_a_client_with_a_non_shared_data_source\"\u003e\u003c/a\u003eCreating a client with a non shared data source\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn most cases you will want to share a data source between different client instances.\nHowever, it\u0026#8217;s possible you want to create a client instance that doesn\u0026#8217;t share its data source with any other client.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn that case you can use \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/jdbc/JDBCClient.html#create-io.vertx.core.Vertx-io.vertx.core.json.JsonObject-\"\u003eJDBCClient.create\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eSQLClient client = JDBCClient.create(vertx, config);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is equivalent to calling \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/jdbc/JDBCClient.html#createShared-io.vertx.core.Vertx-io.vertx.core.json.JsonObject-java.lang.String-\"\u003eJDBCClient.createShared\u003c/a\u003e\u003c/code\u003e\nwith a unique data source name each time.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_specifying_a_data_source\"\u003e\u003ca class=\"anchor\" href=\"#_specifying_a_data_source\"\u003e\u003c/a\u003eSpecifying a data source\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you already have a pre-existing data source, you can also create the client directly specifying that:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eSQLClient client = JDBCClient.create(vertx, dataSource);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_closing_the_client\"\u003e\u003ca class=\"anchor\" href=\"#_closing_the_client\"\u003e\u003c/a\u003eClosing the client\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt\u0026#8217;s fine to keep hold of the client for a long time (e.g. the lifetime of your verticle), but once you\u0026#8217;re\ndone with it you should close it.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eClients that share a data source with other client instances are reference counted. Once the last one that references\nthe same data source is closed, the data source will be closed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_automatic_clean_up_in_verticles\"\u003e\u003ca class=\"anchor\" href=\"#_automatic_clean_up_in_verticles\"\u003e\u003c/a\u003eAutomatic clean-up in verticles\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you\u0026#8217;re creating clients from inside verticles, the clients will be automatically closed when the verticle is undeployed.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_the_sql_connection\"\u003e\u003ca class=\"anchor\" href=\"#_the_sql_connection\"\u003e\u003c/a\u003eThe SQL Connection\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA connection to the database is represented by \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html\"\u003eSQLConnection\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_auto_commit\"\u003e\u003ca class=\"anchor\" href=\"#_auto_commit\"\u003e\u003c/a\u003eAuto-commit\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you obtain a connection auto commit is set to \u003ccode\u003etrue\u003c/code\u003e. This means that each operation you perform will effectively\nexecute in its own transaction.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you wish to perform multiple operations in a single transaction you should set auto commit to false with\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#setAutoCommit-boolean-io.vertx.core.Handler-\"\u003esetAutoCommit\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen the operation is complete, the handler will be called:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003econnection.setAutoCommit(\u003cspan class=\"hljs-keyword\"\u003efalse\u003c/span\u003e, res -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    \u003cspan class=\"hljs-comment\"\u003e// OK!\u003c/span\u003e\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_executing_queries\"\u003e\u003ca class=\"anchor\" href=\"#_executing_queries\"\u003e\u003c/a\u003eExecuting queries\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo execute a query use \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#query-java.lang.String-io.vertx.core.Handler-\"\u003equery\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe query string is raw SQL that is passed through without changes to the actual database.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe handler will be called with the results, represented by \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/ResultSet.html\"\u003eResultSet\u003c/a\u003e\u003c/code\u003e when the query has\nbeen run.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003econnection.query(\u003cspan class=\"hljs-string\"\u003e\"SELECT ID, FNAME, LNAME, SHOE_SIZE from PEOPLE\"\u003c/span\u003e, res -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    \u003cspan class=\"hljs-comment\"\u003e// Get the result set\u003c/span\u003e\n    ResultSet resultSet = res.result();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/ResultSet.html\"\u003eResultSet\u003c/a\u003e\u003c/code\u003e instance represents the results of a query.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe list of column names are available with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/ResultSet.html#getColumnNames--\"\u003egetColumnNames\u003c/a\u003e\u003c/code\u003e, and the actual results\navailable with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/ResultSet.html#getResults--\"\u003egetResults\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe results are a list of \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/json/JsonArray.html\"\u003eJsonArray\u003c/a\u003e\u003c/code\u003e instances, one for each row of the results.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eList\u0026lt;String\u0026gt; columnNames = resultSet.getColumnNames();\n\nList\u0026lt;JsonArray\u0026gt; results = resultSet.getResults();\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (JsonArray row : results) {\n\n  String id = row.getString(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e);\n  String fName = row.getString(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e);\n  String lName = row.getString(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e shoeSize = row.getInteger(\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e);\n\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also retrieve the rows as a list of Json object instances with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/ResultSet.html#getRows--\"\u003egetRows\u003c/a\u003e\u003c/code\u003e -\nthis can give you a somewhat simpler API to work with, but please be aware that SQL results can contain duplicate\ncolumn names - if that\u0026#8217;s the case you should use \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/ResultSet.html#getResults--\"\u003egetResults\u003c/a\u003e\u003c/code\u003e instead.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of iterating through the results as Json object instances:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eList\u0026lt;JsonObject\u0026gt; rows = resultSet.getRows();\n\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (JsonObject row : rows) {\n\n  String id = row.getString(\u003cspan class=\"hljs-string\"\u003e\"ID\"\u003c/span\u003e);\n  String fName = row.getString(\u003cspan class=\"hljs-string\"\u003e\"FNAME\"\u003c/span\u003e);\n  String lName = row.getString(\u003cspan class=\"hljs-string\"\u003e\"LNAME\"\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e shoeSize = row.getInteger(\u003cspan class=\"hljs-string\"\u003e\"SHOE_SIZE\"\u003c/span\u003e);\n\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_prepared_statement_queries\"\u003e\u003ca class=\"anchor\" href=\"#_prepared_statement_queries\"\u003e\u003c/a\u003ePrepared statement queries\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo execute a prepared statement query you can use\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#queryWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-\"\u003equeryWithParams\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis takes the query, containing the parameter place holders, and a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/json/JsonArray.html\"\u003eJsonArray\u003c/a\u003e\u003c/code\u003e or parameter\nvalues.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eString query = \u003cspan class=\"hljs-string\"\u003e\"SELECT ID, FNAME, LNAME, SHOE_SIZE from PEOPLE WHERE LNAME=? AND SHOE_SIZE \u0026gt; ?\"\u003c/span\u003e;\nJsonArray params = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonArray().add(\u003cspan class=\"hljs-string\"\u003e\"Fox\"\u003c/span\u003e).add(\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e);\n\nconnection.queryWithParams(query, params, res -\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    \u003cspan class=\"hljs-comment\"\u003e// Get the result set\u003c/span\u003e\n    ResultSet resultSet = res.result();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_executing_insert_update_or_delete\"\u003e\u003ca class=\"anchor\" href=\"#_executing_insert_update_or_delete\"\u003e\u003c/a\u003eExecuting INSERT, UPDATE or DELETE\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo execute an operation which updates the database use \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#update-java.lang.String-io.vertx.core.Handler-\"\u003eupdate\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe update string is raw SQL that is passed through without changes to the actual database.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe handler will be called with the results, represented by \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/UpdateResult.html\"\u003eUpdateResult\u003c/a\u003e\u003c/code\u003e when the update has\nbeen run.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe update result holds the number of rows updated with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/UpdateResult.html#getUpdated--\"\u003egetUpdated\u003c/a\u003e\u003c/code\u003e, and\nif the update generated keys, they are available with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/UpdateResult.html#getKeys--\"\u003egetKeys\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003econnection.update(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO PEOPLE VALUES (null, 'john', 'smith', 9)\"\u003c/span\u003e, res -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n\n    UpdateResult result = res.result();\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Updated no. of rows: \"\u003c/span\u003e + result.getUpdated());\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Generated keys: \"\u003c/span\u003e + result.getKeys());\n\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_prepared_statement_updates\"\u003e\u003ca class=\"anchor\" href=\"#_prepared_statement_updates\"\u003e\u003c/a\u003ePrepared statement updates\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo execute a prepared statement update you can use\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#updateWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.Handler-\"\u003eupdateWithParams\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis takes the update, containing the parameter place holders, and a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/json/JsonArray.html\"\u003eJsonArray\u003c/a\u003e\u003c/code\u003e or parameter\nvalues.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eString update = \u003cspan class=\"hljs-string\"\u003e\"UPDATE PEOPLE SET SHOE_SIZE = 10 WHERE LNAME=?\"\u003c/span\u003e;\nJsonArray params = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonArray().add(\u003cspan class=\"hljs-string\"\u003e\"Fox\"\u003c/span\u003e);\n\nconnection.updateWithParams(update, params, res -\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n\n    UpdateResult updateResult = res.result();\n\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"No. of rows updated: \"\u003c/span\u003e + updateResult.getUpdated());\n\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_callable_statements\"\u003e\u003ca class=\"anchor\" href=\"#_callable_statements\"\u003e\u003c/a\u003eCallable statements\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo execute a callable statement (either SQL functions or SQL procedures) you can use\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#callWithParams-java.lang.String-io.vertx.core.json.JsonArray-io.vertx.core.json.JsonArray-io.vertx.core.Handler-\"\u003ecallWithParams\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis takes the callable statement using the standard JDBC format \u003ccode\u003e{ call func_proc_name() }\u003c/code\u003e, optionally including\nparameter place holders e.g.: \u003ccode\u003e{ call func_proc_name(?, ?) }\u003c/code\u003e, a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/json/JsonArray.html\"\u003eJsonArray\u003c/a\u003e\u003c/code\u003e containing the\nparameter values and finally a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/json/JsonArray.html\"\u003eJsonArray\u003c/a\u003e\u003c/code\u003e containing the\noutput types e.g.: \u003ccode\u003e[null, 'VARCHAR']\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNote that the index of the output type is as important as the params array. If the return value is the second\nargument then the output array must contain a null value as the first element.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA SQL function returns some output using the \u003ccode\u003ereturn\u003c/code\u003e keyword, and in this case one can call it like this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eString func = \u003cspan class=\"hljs-string\"\u003e\"{ call one_hour_ago() }\"\u003c/span\u003e;\n\nconnection.call(func, res -\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    ResultSet result = res.result();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen working with Procedures you and still return values from your procedures via its arguments, in the case you do\nnot return anything the usage is as follows:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eString func = \u003cspan class=\"hljs-string\"\u003e\"{ call new_customer(?, ?) }\"\u003c/span\u003e;\n\nconnection.callWithParams(func, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonArray().add(\u003cspan class=\"hljs-string\"\u003e\"John\"\u003c/span\u003e).add(\u003cspan class=\"hljs-string\"\u003e\"Doe\"\u003c/span\u003e), \u003cspan class=\"hljs-keyword\"\u003enull\u003c/span\u003e, res -\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    \u003cspan class=\"hljs-comment\"\u003e// Success!\u003c/span\u003e\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHowever you can also return values like this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eString func = \u003cspan class=\"hljs-string\"\u003e\"{ call customer_lastname(?, ?) }\"\u003c/span\u003e;\n\nconnection.callWithParams(func, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonArray().add(\u003cspan class=\"hljs-string\"\u003e\"John\"\u003c/span\u003e), \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonArray().addNull().add(\u003cspan class=\"hljs-string\"\u003e\"VARCHAR\"\u003c/span\u003e), res -\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    ResultSet result = res.result();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNote that the index of the arguments matches the index of the \u003ccode\u003e?\u003c/code\u003e and that the output parameters expect to be a\nString describing the type you want to receive.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo avoid ambiguation the implementations are expected to follow the following rules:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eWhen a place holder in the \u003ccode\u003eIN\u003c/code\u003e array is \u003ccode\u003eNOT NULL\u003c/code\u003e it will be taken\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWhen the \u003ccode\u003eIN\u003c/code\u003e value is NULL a check is performed on the OUT\nWhen the \u003ccode\u003eOUT\u003c/code\u003e value is not null it will be registered as a output parameter\nWhen the \u003ccode\u003eOUT\u003c/code\u003e is also null it is expected that the IN value is the \u003ccode\u003eNULL\u003c/code\u003e value.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe registered \u003ccode\u003eOUT\u003c/code\u003e parameters will be available as an array in the result set under the output property.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_batch_operations\"\u003e\u003ca class=\"anchor\" href=\"#_batch_operations\"\u003e\u003c/a\u003eBatch operations\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe SQL common interface also defines how to execute batch operations. There are 3 types of batch operations:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eBatched statements \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#batch-java.util.List-io.vertx.core.Handler-\"\u003ebatch\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBatched prepared statements \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#batchWithParams-java.lang.String-java.util.List-io.vertx.core.Handler-\"\u003ebatchWithParams\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBatched callable statements \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#batchCallableWithParams-java.lang.String-java.util.List-java.util.List-io.vertx.core.Handler-\"\u003ebatchCallableWithParams\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA batches statement will exeucte a list of sql statements as for example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eList\u0026lt;String\u0026gt; batch = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ArrayList\u0026lt;\u0026gt;();\nbatch.add(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO emp (NAME) VALUES ('JOE')\"\u003c/span\u003e);\nbatch.add(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO emp (NAME) VALUES ('JANE')\"\u003c/span\u003e);\n\nconnection.batch(batch, res -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    List\u0026lt;Integer\u0026gt; result = res.result();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhile a prepared or callable statement batch will reuse the sql statement and take an list of arguments as for example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eList\u0026lt;JsonArray\u0026gt; batch = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ArrayList\u0026lt;\u0026gt;();\nbatch.add(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonArray().add(\u003cspan class=\"hljs-string\"\u003e\"joe\"\u003c/span\u003e));\nbatch.add(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonArray().add(\u003cspan class=\"hljs-string\"\u003e\"jane\"\u003c/span\u003e));\n\nconnection.batchWithParams(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO emp (name) VALUES (?)\"\u003c/span\u003e, batch, res -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    List\u0026lt;Integer\u0026gt; result = res.result();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_executing_other_operations\"\u003e\u003ca class=\"anchor\" href=\"#_executing_other_operations\"\u003e\u003c/a\u003eExecuting other operations\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo execute any other database operation, e.g. a \u003ccode\u003eCREATE TABLE\u003c/code\u003e you can use\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#execute-java.lang.String-io.vertx.core.Handler-\"\u003eexecute\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe string is passed through without changes to the actual database. The handler is called when the operation\nis complete\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eString sql = \u003cspan class=\"hljs-string\"\u003e\"CREATE TABLE PEOPLE (ID int generated by default as identity (start with 1 increment by 1) not null,\"\u003c/span\u003e +\n  \u003cspan class=\"hljs-string\"\u003e\"FNAME varchar(255), LNAME varchar(255), SHOE_SIZE int);\"\u003c/span\u003e;\n\nconnection.execute(sql, execute -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (execute.succeeded()) {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Table created !\"\u003c/span\u003e);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_multiple_resultset_responses\"\u003e\u003ca class=\"anchor\" href=\"#_multiple_resultset_responses\"\u003e\u003c/a\u003eMultiple ResultSet responses\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn some cases your query might return more than one result set, in this case and to preserve the compatibility when\nthe returned result set object is converted to pure json, the next result sets are chained to the current result set\nunder the property \u003ccode\u003enext\u003c/code\u003e. A simple walk of all result sets can be achieved like this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e (rs != \u003cspan class=\"hljs-keyword\"\u003enull\u003c/span\u003e) {\n  \u003cspan class=\"hljs-comment\"\u003e// do something with the result set...\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e// next step\u003c/span\u003e\n  rs = rs.getNext();\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_streaming\"\u003e\u003ca class=\"anchor\" href=\"#_streaming\"\u003e\u003c/a\u003eStreaming\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen dealing with large data sets, it is not advised to use API just described but to stream data since it avoids\ninflating the whole response into memory and JSON and data is just processed on a row by row basis, for example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003econnection.queryStream(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM large_table\"\u003c/span\u003e, stream -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (stream.succeeded()) {\n    stream.result().handler(row -\u0026gt; {\n      \u003cspan class=\"hljs-comment\"\u003e// do something with the row...\u003c/span\u003e\n    });\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou still have full control on when the stream is pauses, resumed and ended. For cases where your query returns\nmultiple result sets you should use the result set ended event to fetch the next one if available. If there is more\ndata the stream handler will receive the new data, otherwise the end handler is invoked.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003econnection.queryStream(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM large_table; SELECT * FROM other_table\"\u003c/span\u003e, stream -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (stream.succeeded()) {\n    SQLRowStream sqlRowStream = stream.result();\n\n    sqlRowStream\n      .resultSetClosedHandler(v -\u0026gt; {\n        \u003cspan class=\"hljs-comment\"\u003e// will ask to restart the stream with the new result set if any\u003c/span\u003e\n        sqlRowStream.moreResults();\n      })\n      .handler(row -\u0026gt; {\n        \u003cspan class=\"hljs-comment\"\u003e// do something with the row...\u003c/span\u003e\n      })\n      .endHandler(v -\u0026gt; {\n        \u003cspan class=\"hljs-comment\"\u003e// no more data available...\u003c/span\u003e\n      });\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_using_transactions\"\u003e\u003ca class=\"anchor\" href=\"#_using_transactions\"\u003e\u003c/a\u003eUsing transactions\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use transactions first set auto-commit to false with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#setAutoCommit-boolean-io.vertx.core.Handler-\"\u003esetAutoCommit\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou then do your transactional operations and when you want to commit or rollback use\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#commit-io.vertx.core.Handler-\"\u003ecommit\u003c/a\u003e\u003c/code\u003e or\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#rollback-io.vertx.core.Handler-\"\u003erollback\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOnce the commit/rollback is complete the handler will be called and the next transaction will be automatically started.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003econnection.commit(res -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n    \u003cspan class=\"hljs-comment\"\u003e// Committed OK!\u003c/span\u003e\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Failed!\u003c/span\u003e\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_closing_connections\"\u003e\u003ca class=\"anchor\" href=\"#_closing_connections\"\u003e\u003c/a\u003eClosing connections\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you\u0026#8217;ve done with the connection you should return it to the pool with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/sql/SQLConnection.html#close-io.vertx.core.Handler-\"\u003eclose\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUnresolved directive in index.adoc - include::override/rxjava2.adoc[]\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_configuration\"\u003e\u003ca class=\"anchor\" href=\"#_configuration\"\u003e\u003c/a\u003eConfiguration\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eConfiguration is passed to the client when creating or deploying it.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe following configuration properties generally apply:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003eprovider_class\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThe class name of the class actually used to manage the database connections. By default this is\n\u003ccode\u003eio.vertx.ext.jdbc.spi.impl.C3P0DataSourceProvider\u003c/code\u003e but if you want to use a different provider you can override\nthis property and provide your implementation.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003erow_stream_fetch_size\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThe size of \u003ccode\u003eSQLRowStream\u003c/code\u003e internal cache which used to better performance. By default\nit equals to \u003ccode\u003e128\u003c/code\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAssuming the C3P0 implementation is being used (the default), the following extra configuration properties apply:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003eurl\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe JDBC connection URL for the database\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003edriver_class\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe class of the JDBC driver\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003euser\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe username for the database\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003epassword\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe password for the database\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003emax_pool_size\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe maximum number of connections to pool - default is \u003ccode\u003e15\u003c/code\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003einitial_pool_size\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe number of connections to initialise the pool with - default is \u003ccode\u003e3\u003c/code\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003emin_pool_size\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe minimum number of connections to pool\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003emax_statements\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe maximum number of prepared statements to cache - default is \u003ccode\u003e0\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003emax_statements_per_connection\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003ethe maximum number of prepared statements to cache per connection - default is \u003ccode\u003e0\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003emax_idle_time\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003enumber of seconds after which an idle connection will be closed - default is \u003ccode\u003e0\u003c/code\u003e (never expire).\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOther Connection Pool providers are:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eHikari\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAgroal\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSimilar to C3P0 they can be configured by passing the configuration values on the JSON config object. For the special\ncase where you do not want to deploy your app as a fat jar but run with a vert.x distribution, then it is recommented\nto use Agroal if you have no write permissions to add the JDBC driver to the vert.x lib directory and are passing it\nusing the \u003ccode\u003e-cp\u003c/code\u003e command line flag.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to configure any other C3P0 properties, you can add a file \u003ccode\u003ec3p0.properties\u003c/code\u003e to the classpath.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of configuring a service:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eJsonObject config = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonObject()\n  .put(\u003cspan class=\"hljs-string\"\u003e\"url\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"jdbc:hsqldb:mem:test?shutdown=true\"\u003c/span\u003e)\n  .put(\u003cspan class=\"hljs-string\"\u003e\"driver_class\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"org.hsqldb.jdbcDriver\"\u003c/span\u003e)\n  .put(\u003cspan class=\"hljs-string\"\u003e\"max_pool_size\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e30\u003c/span\u003e);\n\nSQLClient client = JDBCClient.createShared(vertx, config);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHikari uses a different set of properties:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ejdbcUrl\u003c/code\u003e for the JDBC URL\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edriverClassName\u003c/code\u003e for the JDBC driven class name\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003emaximumPoolSize\u003c/code\u003e for the pool size\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eusername\u003c/code\u003e for the login (\u003ccode\u003epassword\u003c/code\u003e for the password)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRefer to the \u003ca href=\"https://github.com/brettwooldridge/HikariCP#configuration-knobs-baby\"\u003eHikari documentation\u003c/a\u003e\nfor further details. Also refer to the \u003ca href=\"https://agroal.github.io/\"\u003eAgroal documentation\u003c/a\u003e\nto configure Agroal.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_jdbc_drivers\"\u003e\u003ca class=\"anchor\" href=\"#_jdbc_drivers\"\u003e\u003c/a\u003eJDBC Drivers\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you are using the default \u003ccode\u003eDataSourceProvider\u003c/code\u003e (relying on c3p0), you would need to copy the JDBC driver class\nin your \u003cem\u003eclasspath\u003c/em\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf your application is packaged as a \u003cem\u003efat jar\u003c/em\u003e, be sure to embed the jdbc driver. If your application is launched\nwith the \u003ccode\u003evertx\u003c/code\u003e command line, copy the JDBC driver to \u003ccode\u003e${VERTX_HOME}/lib\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe behavior may be different when using a different connection pool.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_data_types\"\u003e\u003ca class=\"anchor\" href=\"#_data_types\"\u003e\u003c/a\u003eData types\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eDue to the fact that Vert.x uses JSON as its standard message format there will be many limitations to the data types\naccepted by the client. You will get out of the box the standard:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003enull\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eboolean\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003enumber\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003estring\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere is also an optimistic cast for temporal types (TIME, DATE, TIMESTAMP) and optionally disabled for UUID. UUIDs\nare supported by many databases but not all. For example MySQL does not support it so the recommended way is to use\na VARCHAR(36) column. For other engines UUID optimistic casting can be enabled using the client config json as:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e{ \"castUUID\": true }\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen this config is present UUIDs will be handled as a native type.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e"},"__N_SSG":true},"page":"/docs/[[...slug]]","query":{"slug":["vertx-jdbc-client","java"]},"buildId":"D20Fcx-FR9X8CwgKxXrRx","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-7cde6f5ea12aaa40097b.js"></script><script src="/_next/static/chunks/main-b6e20584df76f29b6f35.js" async=""></script><script src="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" async=""></script><script src="/_next/static/chunks/framework.fcef98db13e2318579fb.js" async=""></script><script src="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" async=""></script><script src="/_next/static/chunks/styles.6a5cc0a07ce13c54adf1.js" async=""></script><script src="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" async=""></script><script src="/_next/static/chunks/5e2acbba0c73eb7c5c0e969bcd552d3808de9969.4d0eb9c3d4239c66cc89.js" async=""></script><script src="/_next/static/chunks/31acfd8439b7c9eee4abe9f59c7500d6c943ee0d.46f4cf2c4741679ce3eb.js" async=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-a0e26e250e9304ae7812.js" async=""></script><script src="/_next/static/D20Fcx-FR9X8CwgKxXrRx/_buildManifest.js" async=""></script><script src="/_next/static/D20Fcx-FR9X8CwgKxXrRx/_ssgManifest.js" async=""></script></body></html>