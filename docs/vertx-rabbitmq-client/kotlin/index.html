<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><title>RabbitMQ Client for Vert.x</title><meta name="next-head-count" content="9"/><link rel="preload" href="/_next/static/css/styles.1c04e68d.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.1c04e68d.chunk.css"/><link rel="preload" href="/_next/static/w7osvGTwfmYtkb6ZcZNeN/pages/docs/%5B...slug%5D.js" as="script"/><link rel="preload" href="/_next/static/w7osvGTwfmYtkb6ZcZNeN/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.2452a08f25aa09397355.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5e3e47f192c8968126d4.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.233404fc46c3d542410b.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-590ad82901df6081bdd1.js" as="script"/><link rel="preload" href="/_next/static/chunks/7f45b2959c91c8c7a63599f2d2a94aa1e936364f.a45d4def287f6d9b5832.js" as="script"/></head><body><div id="__next"><main class="page docs"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4="/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><a class="navbar-menu-item" href="/">Ecosystem</a><a class="navbar-menu-item" href="/docs/">Docs</a><a class="navbar-menu-item" href="/">FAQ</a><a class="navbar-menu-item" href="/">Blog</a><a class="navbar-menu-item" href="/">Community</a></div><div class="navbar-social"><span class="navbar-social-version">v4.0.0</span><a href="https://www.youtube.com/results?search_query=vert.x" class="navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M23.495 6.205a3.007 3.007 0 0 0-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 0 0 .527 6.205a31.247 31.247 0 0 0-.522 5.805 31.247 31.247 0 0 0 .522 5.783 3.007 3.007 0 0 0 2.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 0 0 2.088-2.088 31.247 31.247 0 0 0 .5-5.783 31.247 31.247 0 0 0-.5-5.805zM9.609 15.601V8.408l6.264 3.602z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://gitter.im/eclipse-vertx/vertx-users" class="navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M8.501 4.001H10.5V24H8.501V4.001zm6.999 0V24h-2V4.001h2zM3.5 0h2.001v15H3.5V0zm15 4.001h2V15h-2V4.001z"></path></svg></a></div></div></div></div></header><div class="page-content docs-content"><div class="container"><div class="docs-search"><input type="text" placeholder="Search..." value=""/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="docs-search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="docs-search-icon-delete"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div><div><div class="docs-content-inner"><h1>RabbitMQ Client for Vert.x</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A Vert.x client allowing applications to interact with a RabbitMQ broker (AMQP 0.9.1)</p>
</div>
<div class="paragraph">
<p><strong>This service is experimental and the APIs are likely to change before settling down.</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_maven">Maven</h3>
<div class="paragraph">
<p>Add the following dependency to your maven project</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-rabbitmq-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.0-milestone4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gradle">Gradle</h3>
<div class="paragraph">
<p>Add the following dependency to your gradle project</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">dependencies {
 compile <span class="hljs-string">'io.vertx:vertx-rabbitmq-client:4.0.0-milestone4'</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_client">Create a client</h3>
<div class="paragraph">
<p>You can create a client instance as follows using a full amqp uri:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> config = RabbitMQOptions()
<span class="hljs-comment">// full amqp uri</span>
config.uri = <span class="hljs-string">"amqp://xvjvsrrc:VbuL1atClKt7zVNQha0bnnScbNvGiqgb@moose.rmq.cloudamqp.com/xvjvsrrc"</span>
<span class="hljs-keyword">var</span> client = RabbitMQClient.create(vertx, config)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can also specify individual parameters manually:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> config = RabbitMQOptions()
<span class="hljs-comment">// Each parameter is optional</span>
<span class="hljs-comment">// The default parameter with be used if the parameter is not set</span>
config.user = <span class="hljs-string">"user1"</span>
config.password = <span class="hljs-string">"password1"</span>
config.host = <span class="hljs-string">"localhost"</span>
config.port = <span class="hljs-number">5672</span>
config.virtualHost = <span class="hljs-string">"vhost1"</span>
config.connectionTimeout = <span class="hljs-number">6000</span>
config.requestedHeartbeat = <span class="hljs-number">60</span>
config.handshakeTimeout = <span class="hljs-number">6000</span>
config.requestedChannelMax = <span class="hljs-number">5</span>
config.networkRecoveryInterval = <span class="hljs-number">500</span>
config.automaticRecoveryEnabled = <span class="hljs-literal">true</span>

<span class="hljs-keyword">var</span> client = RabbitMQClient.create(vertx, config)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can set multiples addresses to connect to a cluster;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> config = RabbitMQOptions()
config.user = <span class="hljs-string">"user1"</span>
config.password = <span class="hljs-string">"password1"</span>
config.virtualHost = <span class="hljs-string">"vhost1"</span>

config.addresses = listOf(com.rabbitmq.client.Address.parseAddresses(<span class="hljs-string">"firstHost,secondHost:5672"</span>))

<span class="hljs-keyword">var</span> client = RabbitMQClient.create(vertx, config)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_declare_exchange_with_additional_config">Declare exchange with additional config</h3>
<div class="paragraph">
<p>You can pass additional config parameters to RabbitMQ&#8217;s exchangeDeclare method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> config = json {
  obj()
}

config.put(<span class="hljs-string">"x-dead-letter-exchange"</span>, <span class="hljs-string">"my.deadletter.exchange"</span>)
config.put(<span class="hljs-string">"alternate-exchange"</span>, <span class="hljs-string">"my.alternate.exchange"</span>)
<span class="hljs-comment">// ...</span>
client.exchangeDeclare(<span class="hljs-string">"my.exchange"</span>, <span class="hljs-string">"fanout"</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, config, { onResult -&gt;
  <span class="hljs-keyword">if</span> (onResult.succeeded()) {
    println(<span class="hljs-string">"Exchange successfully declared with config"</span>)
  } <span class="hljs-keyword">else</span> {
    onResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_declare_queue_with_additional_config">Declare queue with additional config</h3>
<div class="paragraph">
<p>You can pass additional config parameters to RabbitMQs queueDeclare method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> config = json {
  obj()
}
config.put(<span class="hljs-string">"x-message-ttl"</span>, <span class="hljs-number">10000L</span>)

client.queueDeclare(<span class="hljs-string">"my-queue"</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, config, { queueResult -&gt;
  <span class="hljs-keyword">if</span> (queueResult.succeeded()) {
    println(<span class="hljs-string">"Queue declared!"</span>)
  } <span class="hljs-keyword">else</span> {
    System.err.println(<span class="hljs-string">"Queue failed to be declared!"</span>)
    queueResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operations">Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following are some examples of the operations supported by the RabbitMQService API.
Consult the javadoc/documentation for detailed information on all API methods.</p>
</div>
<div class="sect2">
<h3 id="_publish">Publish</h3>
<div class="paragraph">
<p>Publish a message to a queue</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> message = Buffer.buffer(<span class="hljs-string">"body"</span>, <span class="hljs-string">"Hello RabbitMQ, from Vert.x !"</span>)
client.basicPublish(<span class="hljs-string">""</span>, <span class="hljs-string">"my.queue"</span>, message, { pubResult -&gt;
  <span class="hljs-keyword">if</span> (pubResult.succeeded()) {
    println(<span class="hljs-string">"Message published !"</span>)
  } <span class="hljs-keyword">else</span> {
    pubResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_publish_with_confirm">Publish with confirm</h3>
<div class="paragraph">
<p>Publish a message to a queue and confirm the broker acknowledged it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> message = Buffer.buffer(<span class="hljs-string">"body"</span>, <span class="hljs-string">"Hello RabbitMQ, from Vert.x !"</span>)

<span class="hljs-comment">// Put the channel in confirm mode. This can be done once at init.</span>
client.confirmSelect({ confirmResult -&gt;
  <span class="hljs-keyword">if</span> (confirmResult.succeeded()) {
    client.basicPublish(<span class="hljs-string">""</span>, <span class="hljs-string">"my.queue"</span>, message, { pubResult -&gt;
      <span class="hljs-keyword">if</span> (pubResult.succeeded()) {
        <span class="hljs-comment">// Check the message got confirmed by the broker.</span>
        client.waitForConfirms({ waitResult -&gt;
          <span class="hljs-keyword">if</span> (waitResult.succeeded()) {
            println(<span class="hljs-string">"Message published !"</span>)} <span class="hljs-keyword">else</span> {
            waitResult.cause().printStackTrace()}
        })
      } <span class="hljs-keyword">else</span> {
        pubResult.cause().printStackTrace()
      }
    })
  } <span class="hljs-keyword">else</span> {
    confirmResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_consume">Consume</h3>
<div class="paragraph">
<p>Consume messages from a queue.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-comment">// Create a stream of messages from a queue</span>
client.basicConsumer(<span class="hljs-string">"my.queue"</span>, { rabbitMQConsumerAsyncResult -&gt;
  <span class="hljs-keyword">if</span> (rabbitMQConsumerAsyncResult.succeeded()) {
    println(<span class="hljs-string">"RabbitMQ consumer created !"</span>)
    <span class="hljs-keyword">var</span> mqConsumer = rabbitMQConsumerAsyncResult.result()
    mqConsumer.handler({ message -&gt;
      println(<span class="hljs-string">"Got message: <span class="hljs-subst">${message.body().toString()}</span>"</span>)
    })
  } <span class="hljs-keyword">else</span> {
    rabbitMQConsumerAsyncResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>At any moment of time you can pause or resume the stream. When stream is paused you won&#8217;t receive any message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">consumer.pause()
consumer.resume()</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are actually a set of options to specify when creating a consumption stream.</p>
</div>
<div class="paragraph">
<p>The <code>QueueOptions</code> lets you specify:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The size of internal queue with <code>setMaxInternalQueueSize</code></p>
</li>
<li>
<p>Should the stream keep more recent messages when queue size is exceed with <code>setKeepMostRecent</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> options = QueueOptions(
  maxInternalQueueSize = <span class="hljs-number">1000</span>,
  keepMostRecent = <span class="hljs-literal">true</span>)

client.basicConsumer(<span class="hljs-string">"my.queue"</span>, options, { rabbitMQConsumerAsyncResult -&gt;
  <span class="hljs-keyword">if</span> (rabbitMQConsumerAsyncResult.succeeded()) {
    println(<span class="hljs-string">"RabbitMQ consumer created !"</span>)
  } <span class="hljs-keyword">else</span> {
    rabbitMQConsumerAsyncResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you want to stop consuming message from a queue, you can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">rabbitMQConsumer.cancel({ cancelResult -&gt;
  <span class="hljs-keyword">if</span> (cancelResult.succeeded()) {
    println(<span class="hljs-string">"Consumption successfully stopped"</span>)
  } <span class="hljs-keyword">else</span> {
    println(<span class="hljs-string">"Tired in attempt to stop consumption"</span>)
    cancelResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can get notified by the end handler when the queue won&#8217;t process any more messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">rabbitMQConsumer.endHandler({ v -&gt;
  println(<span class="hljs-string">"It is the end of the stream"</span>)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can set the exception handler to be notified of any error that may occur when a message is processed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">consumer.exceptionHandler({ e -&gt;
  println(<span class="hljs-string">"An exception occurred in the process of message handling"</span>)
  e.printStackTrace()
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>And finally, you may want to retrive a related to the consumer tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-keyword">var</span> consumerTag = consumer.consumerTag()
println(<span class="hljs-string">"Consumer tag is: <span class="hljs-subst">${consumerTag}</span>"</span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_get">Get</h3>
<div class="paragraph">
<p>Will get a message from a queue</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">client.basicGet(<span class="hljs-string">"my.queue"</span>, <span class="hljs-literal">true</span>, { getResult -&gt;
  <span class="hljs-keyword">if</span> (getResult.succeeded()) {
    <span class="hljs-keyword">var</span> msg = getResult.result()
    println(<span class="hljs-string">"Got message: <span class="hljs-subst">${msg.body()}</span>"</span>)
  } <span class="hljs-keyword">else</span> {
    getResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_consume_messages_without_auto_ack">Consume messages without auto-ack</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin"><span class="hljs-comment">// Setup the rabbitmq consumer</span>
client.basicConsumer(<span class="hljs-string">"my.queue"</span>, QueueOptions(
  autoAck = <span class="hljs-literal">false</span>), { consumeResult -&gt;
  <span class="hljs-keyword">if</span> (consumeResult.succeeded()) {
    println(<span class="hljs-string">"RabbitMQ consumer created !"</span>)
    <span class="hljs-keyword">var</span> consumer = consumeResult.result()

    <span class="hljs-comment">// Set the handler which messages will be sent to</span>
    consumer.handler({ msg -&gt;
      <span class="hljs-keyword">var</span> json = msg.body()
      println(<span class="hljs-string">"Got message: <span class="hljs-subst">${json.getString(<span class="hljs-string">"body"</span>)}</span>"</span>)
      <span class="hljs-comment">// ack</span>
      client.basicAck(json.getLong(<span class="hljs-string">"deliveryTag"</span>), <span class="hljs-literal">false</span>, { asyncResult -&gt;
      })
    })
  } <span class="hljs-keyword">else</span> {
    consumeResult.cause().printStackTrace()
  }
})</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_tests">Running the tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will need to have RabbitMQ installed and running with default ports on localhost for this to work.</p>
</div>
</div>
</div></div></div><div class="docs-content-no-search-results">No results.</div></div></div><footer></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"RabbitMQ Client for Vert.x","contents":"\u003ch1\u003eRabbitMQ Client for Vert.x\u003c/h1\u003e\n\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA Vert.x client allowing applications to interact with a RabbitMQ broker (AMQP 0.9.1)\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cstrong\u003eThis service is experimental and the APIs are likely to change before settling down.\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_getting_started\"\u003eGetting Started\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_maven\"\u003eMaven\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAdd the following dependency to your maven project\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-rabbitmq-client\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e4.0.0-milestone4\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_gradle\"\u003eGradle\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAdd the following dependency to your gradle project\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003edependencies {\n compile \u003cspan class=\"hljs-string\"\u003e'io.vertx:vertx-rabbitmq-client:4.0.0-milestone4'\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_create_a_client\"\u003eCreate a client\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can create a client instance as follows using a full amqp uri:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e config = RabbitMQOptions()\n\u003cspan class=\"hljs-comment\"\u003e// full amqp uri\u003c/span\u003e\nconfig.uri = \u003cspan class=\"hljs-string\"\u003e\"amqp://xvjvsrrc:VbuL1atClKt7zVNQha0bnnScbNvGiqgb@moose.rmq.cloudamqp.com/xvjvsrrc\"\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e client = RabbitMQClient.create(vertx, config)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOr you can also specify individual parameters manually:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e config = RabbitMQOptions()\n\u003cspan class=\"hljs-comment\"\u003e// Each parameter is optional\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// The default parameter with be used if the parameter is not set\u003c/span\u003e\nconfig.user = \u003cspan class=\"hljs-string\"\u003e\"user1\"\u003c/span\u003e\nconfig.password = \u003cspan class=\"hljs-string\"\u003e\"password1\"\u003c/span\u003e\nconfig.host = \u003cspan class=\"hljs-string\"\u003e\"localhost\"\u003c/span\u003e\nconfig.port = \u003cspan class=\"hljs-number\"\u003e5672\u003c/span\u003e\nconfig.virtualHost = \u003cspan class=\"hljs-string\"\u003e\"vhost1\"\u003c/span\u003e\nconfig.connectionTimeout = \u003cspan class=\"hljs-number\"\u003e6000\u003c/span\u003e\nconfig.requestedHeartbeat = \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e\nconfig.handshakeTimeout = \u003cspan class=\"hljs-number\"\u003e6000\u003c/span\u003e\nconfig.requestedChannelMax = \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\nconfig.networkRecoveryInterval = \u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e\nconfig.automaticRecoveryEnabled = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e client = RabbitMQClient.create(vertx, config)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can set multiples addresses to connect to a cluster;\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e config = RabbitMQOptions()\nconfig.user = \u003cspan class=\"hljs-string\"\u003e\"user1\"\u003c/span\u003e\nconfig.password = \u003cspan class=\"hljs-string\"\u003e\"password1\"\u003c/span\u003e\nconfig.virtualHost = \u003cspan class=\"hljs-string\"\u003e\"vhost1\"\u003c/span\u003e\n\nconfig.addresses = listOf(com.rabbitmq.client.Address.parseAddresses(\u003cspan class=\"hljs-string\"\u003e\"firstHost,secondHost:5672\"\u003c/span\u003e))\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e client = RabbitMQClient.create(vertx, config)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_declare_exchange_with_additional_config\"\u003eDeclare exchange with additional config\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can pass additional config parameters to RabbitMQ\u0026#8217;s exchangeDeclare method\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e config = json {\n  obj()\n}\n\nconfig.put(\u003cspan class=\"hljs-string\"\u003e\"x-dead-letter-exchange\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"my.deadletter.exchange\"\u003c/span\u003e)\nconfig.put(\u003cspan class=\"hljs-string\"\u003e\"alternate-exchange\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"my.alternate.exchange\"\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\nclient.exchangeDeclare(\u003cspan class=\"hljs-string\"\u003e\"my.exchange\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"fanout\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e, config, { onResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (onResult.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Exchange successfully declared with config\"\u003c/span\u003e)\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    onResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_declare_queue_with_additional_config\"\u003eDeclare queue with additional config\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can pass additional config parameters to RabbitMQs queueDeclare method\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e config = json {\n  obj()\n}\nconfig.put(\u003cspan class=\"hljs-string\"\u003e\"x-message-ttl\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10000L\u003c/span\u003e)\n\nclient.queueDeclare(\u003cspan class=\"hljs-string\"\u003e\"my-queue\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, config, { queueResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (queueResult.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Queue declared!\"\u003c/span\u003e)\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.err.println(\u003cspan class=\"hljs-string\"\u003e\"Queue failed to be declared!\"\u003c/span\u003e)\n    queueResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_operations\"\u003eOperations\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe following are some examples of the operations supported by the RabbitMQService API.\nConsult the javadoc/documentation for detailed information on all API methods.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_publish\"\u003ePublish\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePublish a message to a queue\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e message = Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\"body\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Hello RabbitMQ, from Vert.x !\"\u003c/span\u003e)\nclient.basicPublish(\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"my.queue\"\u003c/span\u003e, message, { pubResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (pubResult.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Message published !\"\u003c/span\u003e)\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    pubResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_publish_with_confirm\"\u003ePublish with confirm\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePublish a message to a queue and confirm the broker acknowledged it.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e message = Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\"body\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Hello RabbitMQ, from Vert.x !\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// Put the channel in confirm mode. This can be done once at init.\u003c/span\u003e\nclient.confirmSelect({ confirmResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (confirmResult.succeeded()) {\n    client.basicPublish(\u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"my.queue\"\u003c/span\u003e, message, { pubResult -\u0026gt;\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (pubResult.succeeded()) {\n        \u003cspan class=\"hljs-comment\"\u003e// Check the message got confirmed by the broker.\u003c/span\u003e\n        client.waitForConfirms({ waitResult -\u0026gt;\n          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (waitResult.succeeded()) {\n            println(\u003cspan class=\"hljs-string\"\u003e\"Message published !\"\u003c/span\u003e)} \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n            waitResult.cause().printStackTrace()}\n        })\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        pubResult.cause().printStackTrace()\n      }\n    })\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    confirmResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_consume\"\u003eConsume\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eConsume messages from a queue.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Create a stream of messages from a queue\u003c/span\u003e\nclient.basicConsumer(\u003cspan class=\"hljs-string\"\u003e\"my.queue\"\u003c/span\u003e, { rabbitMQConsumerAsyncResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (rabbitMQConsumerAsyncResult.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"RabbitMQ consumer created !\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e mqConsumer = rabbitMQConsumerAsyncResult.result()\n    mqConsumer.handler({ message -\u0026gt;\n      println(\u003cspan class=\"hljs-string\"\u003e\"Got message: \u003cspan class=\"hljs-subst\"\u003e${message.body().toString()}\u003c/span\u003e\"\u003c/span\u003e)\n    })\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    rabbitMQConsumerAsyncResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAt any moment of time you can pause or resume the stream. When stream is paused you won\u0026#8217;t receive any message.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003econsumer.pause()\nconsumer.resume()\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere are actually a set of options to specify when creating a consumption stream.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003eQueueOptions\u003c/code\u003e lets you specify:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eThe size of internal queue with \u003ccode\u003esetMaxInternalQueueSize\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eShould the stream keep more recent messages when queue size is exceed with \u003ccode\u003esetKeepMostRecent\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = QueueOptions(\n  maxInternalQueueSize = \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e,\n  keepMostRecent = \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n\nclient.basicConsumer(\u003cspan class=\"hljs-string\"\u003e\"my.queue\"\u003c/span\u003e, options, { rabbitMQConsumerAsyncResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (rabbitMQConsumerAsyncResult.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"RabbitMQ consumer created !\"\u003c/span\u003e)\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    rabbitMQConsumerAsyncResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you want to stop consuming message from a queue, you can do:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003erabbitMQConsumer.cancel({ cancelResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (cancelResult.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Consumption successfully stopped\"\u003c/span\u003e)\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    println(\u003cspan class=\"hljs-string\"\u003e\"Tired in attempt to stop consumption\"\u003c/span\u003e)\n    cancelResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can get notified by the end handler when the queue won\u0026#8217;t process any more messages:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003erabbitMQConsumer.endHandler({ v -\u0026gt;\n  println(\u003cspan class=\"hljs-string\"\u003e\"It is the end of the stream\"\u003c/span\u003e)\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can set the exception handler to be notified of any error that may occur when a message is processed:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003econsumer.exceptionHandler({ e -\u0026gt;\n  println(\u003cspan class=\"hljs-string\"\u003e\"An exception occurred in the process of message handling\"\u003c/span\u003e)\n  e.printStackTrace()\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAnd finally, you may want to retrive a related to the consumer tag:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e consumerTag = consumer.consumerTag()\nprintln(\u003cspan class=\"hljs-string\"\u003e\"Consumer tag is: \u003cspan class=\"hljs-subst\"\u003e${consumerTag}\u003c/span\u003e\"\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_get\"\u003eGet\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWill get a message from a queue\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003eclient.basicGet(\u003cspan class=\"hljs-string\"\u003e\"my.queue\"\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, { getResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (getResult.succeeded()) {\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e msg = getResult.result()\n    println(\u003cspan class=\"hljs-string\"\u003e\"Got message: \u003cspan class=\"hljs-subst\"\u003e${msg.body()}\u003c/span\u003e\"\u003c/span\u003e)\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    getResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_consume_messages_without_auto_ack\"\u003eConsume messages without auto-ack\u003c/h3\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-kotlin\" data-lang=\"kotlin\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Setup the rabbitmq consumer\u003c/span\u003e\nclient.basicConsumer(\u003cspan class=\"hljs-string\"\u003e\"my.queue\"\u003c/span\u003e, QueueOptions(\n  autoAck = \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e), { consumeResult -\u0026gt;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (consumeResult.succeeded()) {\n    println(\u003cspan class=\"hljs-string\"\u003e\"RabbitMQ consumer created !\"\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e consumer = consumeResult.result()\n\n    \u003cspan class=\"hljs-comment\"\u003e// Set the handler which messages will be sent to\u003c/span\u003e\n    consumer.handler({ msg -\u0026gt;\n      \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e json = msg.body()\n      println(\u003cspan class=\"hljs-string\"\u003e\"Got message: \u003cspan class=\"hljs-subst\"\u003e${json.getString(\u003cspan class=\"hljs-string\"\u003e\"body\"\u003c/span\u003e)}\u003c/span\u003e\"\u003c/span\u003e)\n      \u003cspan class=\"hljs-comment\"\u003e// ack\u003c/span\u003e\n      client.basicAck(json.getLong(\u003cspan class=\"hljs-string\"\u003e\"deliveryTag\"\u003c/span\u003e), \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e, { asyncResult -\u0026gt;\n      })\n    })\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    consumeResult.cause().printStackTrace()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_running_the_tests\"\u003eRunning the tests\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou will need to have RabbitMQ installed and running with default ports on localhost for this to work.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e"},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["vertx-rabbitmq-client","kotlin"]},"buildId":"w7osvGTwfmYtkb6ZcZNeN","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-c8375bd94e53fd10a8dd.js"></script><script async="" data-next-page="/docs/[...slug]" src="/_next/static/w7osvGTwfmYtkb6ZcZNeN/pages/docs/%5B...slug%5D.js"></script><script async="" data-next-page="/_app" src="/_next/static/w7osvGTwfmYtkb6ZcZNeN/pages/_app.js"></script><script src="/_next/static/runtime/webpack-9369c5c69dbf6d4912cb.js" async=""></script><script src="/_next/static/chunks/framework.2452a08f25aa09397355.js" async=""></script><script src="/_next/static/chunks/commons.5e3e47f192c8968126d4.js" async=""></script><script src="/_next/static/chunks/styles.233404fc46c3d542410b.js" async=""></script><script src="/_next/static/runtime/main-590ad82901df6081bdd1.js" async=""></script><script src="/_next/static/chunks/7f45b2959c91c8c7a63599f2d2a94aa1e936364f.a45d4def287f6d9b5832.js" async=""></script><script src="/_next/static/w7osvGTwfmYtkb6ZcZNeN/_buildManifest.js" async=""></script><script src="/_next/static/w7osvGTwfmYtkb6ZcZNeN/_ssgManifest.js" async=""></script></body></html>